import{d as e,c as t,t as i,i as n,a as r,S as a,F as o,b as l,e as d,m as s,f as c,s as u,M as v,g as h,h as g,j as _,u as p,o as m,k as b,r as f}from"./vendor-BEJxU4kO.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const i of e)if("childList"===i.type)for(const e of i.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const y="_app_17rx3_15",w="_header_17rx3_21",x="_headerTitle_17rx3_31",S="_userInfo_17rx3_41",$="_logoutButton_17rx3_48",k="_orgSwitcher_17rx3_62",C="_orgName_17rx3_77",j="_container_17rx3_84",L="_sidebar_17rx3_90",T="_active_17rx3_123",E="_sidebarHeader_17rx3_129",P="_loading_17rx3_163",I="_pageList_17rx3_169",z="_sidebarFooter_17rx3_175",N="_pageItem_17rx3_192",R="_main_17rx3_222",D="_error_17rx3_230",A="_welcome_17rx3_238",B="_createForm_17rx3_254",O="_editor_17rx3_262",F="_editorHeader_17rx3_268",W="_editorStatus_17rx3_277",U="_unsavedIndicator_17rx3_285",G="_savingIndicator_17rx3_290",M="_savedIndicator_17rx3_296",H="_titleInput_17rx3_310",J="_editorActions_17rx3_321",q="_createButton_17rx3_327",V="_sidebarActions_17rx3_349",Y="_nodeIcon_17rx3_368",K="_welcomeActions_17rx3_373",Q="_nodeContent_17rx3_379",X="_editorContent_17rx3_386",Z="_databaseView_17rx3_395",ee="_databaseHeader_17rx3_403",te="_viewToggle_17rx3_410",ie="_sidebarNodeWrapper_17rx3_431",ne="_childList_17rx3_437",re="_pageTitleText_17rx3_443",ae="_expandIcon_17rx3_449",oe="_expanded_17rx3_462",le="_hidden_17rx3_466",de="_breadcrumbs_17rx3_470",se="_breadcrumbItem_17rx3_480",ce="_breadcrumbSeparator_17rx3_489",ue="_contentInput_17rx3_493",ve="_historyPanel_17rx3_512",he="_historyList_17rx3_527",ge="_historyItem_17rx3_534",_e="_historyMeta_17rx3_551",pe="_historyDate_17rx3_558",me="_historyHash_17rx3_562",be="_historyMessage_17rx3_569";var fe=i("<ul>"),ye=i("<li><div><span>‚ñ∂</span><span></span><span>");function we(e){const[i,v]=t(!0),h=e=>{e.stopPropagation(),v(!i())};return g=ye(),_=g.firstChild,p=_.firstChild,m=p.nextSibling,b=m.nextSibling,_.$$click=()=>e.onSelect(e.node),p.$$click=h,n(m,()=>"database"===e.node.type?"üìä":"üìÑ"),n(b,()=>e.node.title),n(g,r(a,{get when(){var t;return s(()=>!!i())()&&(null==(t=e.node.children)?void 0:t.length)},get children(){var t=fe();return n(t,r(o,{get each(){return e.node.children},children:t=>r(we,{node:t,get selectedId(){return e.selectedId},get onSelect(){return e.onSelect},get depth(){return e.depth+1}})})),l(()=>d(t,ne)),t}}),null),l(t=>{var n,r=ie,a=N,o={[`${T}`]:e.selectedId===e.node.id},l=12*e.depth+8+"px",s=ae,v={[`${oe}`]:i(),[`${le}`]:!(null==(n=e.node.children)?void 0:n.length)},h=Y,f=re;return r!==t.e&&d(g,t.e=r),a!==t.t&&d(_,t.t=a),t.a=c(_,o,t.a),l!==t.o&&u(_,"padding-left",t.o=l),s!==t.i&&d(p,t.i=s),t.n=c(p,v,t.n),h!==t.s&&d(m,t.s=h),f!==t.h&&d(b,t.h=f),t},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),g;var g,_,p,m,b}e(["click"]);const xe="_preview_3gc71_1";var Se=i('<div role=region aria-label="Markdown preview">');const $e=new v({html:!0,linkify:!0,typographer:!0}),ke=$e.renderer.rules.image||function(e,t,i,n,r){return r.renderToken(e,t,i)};function Ce(e){return t=Se(),l(i=>{var n=xe,r=$e.render(e.content,{orgId:e.orgId});return n!==i.e&&d(t,i.e=n),r!==i.t&&(t.innerHTML=i.t=r),i},{e:void 0,t:void 0}),t;var t}$e.renderer.rules.image=(e,t,i,n,r)=>{const a=e[t],o=a.attrIndex("src"),l=a.attrs,d=null==n?void 0:n.orgId;if(l&&o>=0&&d){let e=l[o][1];if(e.startsWith("assets/")){const t=e.split("/");t.length>=2&&(e=`/assets/${d}/${t.slice(1).join("/")}`,l[o][1]=e)}}return ke(e,t,i,n,r)};const je="_container_x612v_1",Le="_tableWrapper_x612v_10",Te="_table_x612v_10",Ee="_headerRow_x612v_25",Pe="_headerCell_x612v_33",Ie="_row_x612v_46",ze="_cell_x612v_55",Ne="_editing_x612v_69",Re="_cellContent_x612v_74",De="_editContainer_x612v_82",Ae="_input_x612v_88",Be="_editActions_x612v_105",Oe="_saveBtn_x612v_110",Fe="_cancelBtn_x612v_111",We="_actionsCell_x612v_132",Ue="_deleteBtn_x612v_140",Ge="_addBtn_x612v_155",Me="_newRow_x612v_171",He="_required_x612v_180",Je="_empty_x612v_186",qe="_loadMore_x612v_193";var Ve=i("<input type=checkbox>"),Ye=i("<select><option value>--"),Ke=i("<option>"),Qe=i("<input type=number>"),Xe=i("<input type=date>"),Ze=i("<input type=text>"),et=i("<tr><td><button>+"),tt=i("<div>No records. Click + to add one."),it=i("<div><button>Load More"),nt=i("<div><div><table><thead><tr><th>Actions</th></tr></thead><tbody>"),rt=i("<span>*"),at=i("<th>"),ot=i('<button title="Delete record">‚úï'),lt=i("<tr><td>"),dt=i("<div><div><button>‚úì</button><button>‚úï"),st=i("<td>"),ct=i("<div>");function ut(e){const[i,s]=t(null),[u,v]=t(""),[h,g]=t({}),_=e=>{v(e)},p=()=>{e.onAddRecord&&Object.keys(h()).length>0&&(e.onAddRecord(h()),g({}))},m=(t,i)=>{const n=((t,i)=>{const n=e.columns.find(e=>e.id===i);return n?t.data[n.name]??"":""})(t,i.id);switch(i.type){case"checkbox":return n?"‚úì":"";case"select":case"multi_select":case"number":default:return String(n);case"date":return n?new Date(n).toLocaleDateString():""}},b=(e,t)=>{switch(e.type){case"checkbox":return(u=Ve()).addEventListener("change",e=>_(String(e.target.checked))),l(()=>d(u,Ae)),l(()=>u.checked=Boolean(t)),u;case"select":return(c=Ye()).firstChild,c.addEventListener("change",e=>_(e.target.value)),c.value=t,n(c,r(o,{get each(){return e.options??[]},children:e=>{return(t=Ke()).value=e,n(t,e),t;var t}}),null),l(()=>d(c,Ae)),c;case"number":return(s=Qe()).$$input=e=>_(e.target.value),s.value=t,l(()=>d(s,Ae)),s;case"date":return(a=Xe()).$$input=e=>_(e.target.value),a.value=t,l(()=>d(a,Ae)),a;default:return(i=Ze()).$$input=e=>_(e.target.value),i.value=t,l(()=>d(i,Ae)),i}var i,a,s,c,u};return f=nt(),y=f.firstChild,w=y.firstChild,x=w.firstChild,S=x.firstChild,$=S.firstChild,k=x.nextSibling,n(S,r(o,{get each(){return e.columns},children:e=>{return t=at(),n(t,()=>e.name,null),n(t,r(a,{get when(){return e.required},get children(){var e=rt();return l(()=>d(e,He)),e}}),null),l(()=>d(t,Pe)),t;var t}}),null),n(k,r(o,{get each(){return e.records},children:t=>{return h=lt(),g=h.firstChild,n(g,r(a,{get when(){return e.onDeleteRecord},get children(){var i=ot();return i.$$click=()=>{var i;return null==(i=e.onDeleteRecord)?void 0:i.call(e,t.id)},l(()=>d(i,Ue)),i}})),n(h,r(o,{get each(){return e.columns},children:o=>{const h=()=>{var e,n;return(null==(e=i())?void 0:e.recordId)===t.id&&(null==(n=i())?void 0:n.columnId)===o.id};return(g=st()).$$click=()=>((t,i)=>{var n;const r=e.columns.find(e=>e.id===i),a=(null==(n=e.records.find(e=>e.id===t))?void 0:n.data[(null==r?void 0:r.name)??""])??"";s({recordId:t,columnId:i}),v(String(a))})(t.id,o.id),n(g,r(a,{get when(){return h()},get fallback(){return e=ct(),n(e,()=>m(t,o)),l(()=>d(e,Re)),e;var e},get children(){var i=dt(),r=i.firstChild,a=r.firstChild,c=a.nextSibling;return n(i,()=>b(o,u()),r),a.$$click=()=>((t,i)=>{const n=e.columns.find(e=>e.id===i);if(!n||!e.onUpdateRecord)return;const r=e.records.find(e=>e.id===t);if(!r)return;const a={...r.data};a[n.name]=u(),e.onUpdateRecord(t,a),s(null)})(t.id,o.id),c.$$click=()=>s(null),l(e=>{var t=De,n=Be,o=Oe,l=Fe;return t!==e.e&&d(i,e.e=t),n!==e.t&&d(r,e.t=n),o!==e.a&&d(a,e.a=o),l!==e.o&&d(c,e.o=l),e},{e:void 0,t:void 0,a:void 0,o:void 0}),i}})),l(e=>{var t=ze,i={[`${Ne}`]:h()};return t!==e.e&&d(g,e.e=t),e.t=c(g,i,e.t),e},{e:void 0,t:void 0}),g;var g}}),null),l(e=>{var t=Ie,i=We;return t!==e.e&&d(h,e.e=t),i!==e.t&&d(g,e.t=i),e},{e:void 0,t:void 0}),h;var h,g}}),null),n(k,r(a,{get when(){return e.onAddRecord},get children(){var t=et(),i=t.firstChild,a=i.firstChild;return a.$$click=p,n(t,r(o,{get each(){return e.columns},children:e=>{return t=st(),n(t,()=>b(e,String(h()[e.name]??""))),l(()=>d(t,ze)),t;var t}}),null),l(e=>{var n=Me,r=We,o=Ge;return n!==e.e&&d(t,e.e=n),r!==e.t&&d(i,e.t=r),o!==e.a&&d(a,e.a=o),e},{e:void 0,t:void 0,a:void 0}),t}}),null),n(f,r(a,{get when(){return 0===e.records.length},get children(){var e=tt();return l(()=>d(e,Je)),e}}),null),n(f,r(a,{get when(){return e.hasMore},get children(){var t=it();return t.firstChild.$$click=()=>{var t;return null==(t=e.onLoadMore)?void 0:t.call(e)},l(()=>d(t,qe)),t}}),null),l(e=>{var t=je,i=Le,n=Te,r=Ee,a=Pe;return t!==e.e&&d(f,e.e=t),i!==e.t&&d(y,e.t=i),n!==e.a&&d(w,e.a=n),r!==e.o&&d(S,e.o=r),a!==e.i&&d($,e.i=a),e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),f;var f,y,w,x,S,$,k}e(["input","click"]);const vt="_grid_xvgf8_1",ht="_card_xvgf8_8",gt="_cardHeader_xvgf8_21",_t="_deleteBtn_xvgf8_29",pt="_cardBody_xvgf8_42",mt="_field_xvgf8_48",bt="_fieldName_xvgf8_53",ft="_fieldValue_xvgf8_60";var yt=i("<div>"),wt=i("<div><div><strong></strong><button>√ó</button></div><div>"),xt=i("<div><span>:</span><span>");function St(e){return t=yt(),n(t,r(o,{get each(){return e.records},children:t=>{return i=wt(),a=i.firstChild,s=a.firstChild,c=s.nextSibling,u=a.nextSibling,n(s,()=>String((e.columns[0]?t.data[e.columns[0].name]:null)||"Untitled")),c.$$click=()=>e.onDeleteRecord(t.id),n(u,r(o,{get each(){return e.columns.slice(1,4)},children:e=>{return i=xt(),r=i.firstChild,a=r.firstChild,o=r.nextSibling,n(r,()=>e.name,a),n(o,()=>String(t.data[e.name]||"-")),l(e=>{var t=mt,n=bt,a=ft;return t!==e.e&&d(i,e.e=t),n!==e.t&&d(r,e.t=n),a!==e.a&&d(o,e.a=a),e},{e:void 0,t:void 0,a:void 0}),i;var i,r,a,o}})),l(e=>{var t=ht,n=gt,r=_t,o=pt;return t!==e.e&&d(i,e.e=t),n!==e.t&&d(a,e.t=n),r!==e.a&&d(c,e.a=r),o!==e.o&&d(u,e.o=o),e},{e:void 0,t:void 0,a:void 0,o:void 0}),i;var i,a,s,c,u}})),l(()=>d(t,vt)),t;var t}e(["click"]);const $t="_gallery_lpkrc_1",kt="_card_lpkrc_8",Ct="_imageContainer_lpkrc_26",jt="_image_lpkrc_26",Lt="_imagePlaceholder_lpkrc_42",Tt="_cardContent_lpkrc_47",Et="_cardHeader_lpkrc_51",Pt="_deleteBtn_lpkrc_58",It="_cardBody_lpkrc_74",zt="_field_lpkrc_78",Nt="_fieldName_lpkrc_86",Rt="_fieldValue_lpkrc_92";var Dt=i("<div>"),At=i("<div><div><div><strong></strong><button>‚úï</button></div><div>"),Bt=i("<img>"),Ot=i("<div>No Image"),Ft=i("<div><span>:</span><span>");function Wt(e){return t=Dt(),n(t,r(o,{get each(){return e.records},children:t=>{const i=e.columns.find(e=>e.name.toLowerCase().includes("image")||e.name.toLowerCase().includes("cover")||e.name.toLowerCase().includes("url"));return s=At(),c=s.firstChild,u=c.firstChild,v=u.firstChild,g=v.nextSibling,_=u.nextSibling,n(s,r(a,{when:i,children:i=>{return o=Dt(),n(o,r(a,{get when(){return t.data[i().name]},get fallback(){return e=Ot(),l(()=>d(e,Lt)),e;var e},get children(){var n=Bt();return l(r=>{var a=String(t.data[i().name]),o=String((e.columns[0]?t.data[e.columns[0].name]:null)||"Record"),l=jt;return a!==r.e&&h(n,"src",r.e=a),o!==r.t&&h(n,"alt",r.t=o),l!==r.a&&d(n,r.a=l),r},{e:void 0,t:void 0,a:void 0}),n}})),l(()=>d(o,Ct)),o;var o}}),c),n(v,()=>String((e.columns[0]?t.data[e.columns[0].name]:null)||"Untitled")),g.$$click=()=>e.onDeleteRecord(t.id),n(_,r(o,{get each(){return e.columns.slice(1,3)},children:e=>{return i=Ft(),r=i.firstChild,a=r.firstChild,o=r.nextSibling,n(r,()=>e.name,a),n(o,()=>String(t.data[e.name]||"-")),l(e=>{var t=zt,n=Nt,a=Rt;return t!==e.e&&d(i,e.e=t),n!==e.t&&d(r,e.t=n),a!==e.a&&d(o,e.a=a),e},{e:void 0,t:void 0,a:void 0}),i;var i,r,a,o}})),l(e=>{var t=kt,i=Tt,n=Et,r=Pt,a=It;return t!==e.e&&d(s,e.e=t),i!==e.t&&d(c,e.t=i),n!==e.a&&d(u,e.a=n),r!==e.o&&d(g,e.o=r),a!==e.i&&d(_,e.i=a),e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),s;var s,c,u,v,g,_}})),l(()=>d(t,$t)),t;var t}e(["click"]);const Ut="_board_1et8f_1",Gt="_noGroup_1et8f_7",Mt="_columns_1et8f_16",Ht="_column_1et8f_16",Jt="_columnHeader_1et8f_32",qt="_columnName_1et8f_39",Vt="_columnCount_1et8f_47",Yt="_cards_1et8f_56",Kt="_card_1et8f_56",Qt="_cardHeader_1et8f_76",Xt="_deleteBtn_1et8f_90",Zt="_cardBody_1et8f_104",ei="_field_1et8f_108",ti="_fieldName_1et8f_114",ii="_fieldValue_1et8f_119";var ni=i("<div>"),ri=i('<div>Add a "select" column to group by status.'),ai=i("<div><div><span></span><span></span></div><div>"),oi=i("<div><div><strong></strong><button>√ó</button></div><div>"),li=i("<div><span>:</span><span>");function di(e){const t=()=>e.columns.find(e=>"select"===e.type||"multi_select"===e.type),i=g(()=>{const i=t();if(!i)return[{name:"All Records",records:e.records}];const n=i.options||[],r={};return n.forEach(e=>{r[e]={name:e,records:[]}}),r.__none__={name:"No "+i.name,records:[]},e.records.forEach(e=>{const t=e.data[i.name];if(t&&"string"==typeof t&&n.includes(t)){const i=r[t];i&&i.records.push(e)}else{const t=r.__none__;t&&t.records.push(e)}}),Object.values(r).filter(e=>e.records.length>0||n.includes(e.name))});return s=ni(),n(s,r(a,{get when(){return t()},get fallback(){return e=ri(),l(()=>d(e,Gt)),e;var e},get children(){var a=ni();return n(a,r(o,{get each(){return i()},children:i=>{return a=ai(),s=a.firstChild,c=s.firstChild,u=c.nextSibling,v=s.nextSibling,n(c,()=>i.name),n(u,()=>i.records.length),n(v,r(o,{get each(){return i.records},children:i=>{return a=oi(),s=a.firstChild,c=s.firstChild,u=c.nextSibling,v=s.nextSibling,n(c,()=>String((e.columns[0]?i.data[e.columns[0].name]:null)||"Untitled")),u.$$click=()=>e.onDeleteRecord(i.id),n(v,r(o,{get each(){return e.columns.slice(1,4).filter(e=>{var i;return e.id!==(null==(i=t())?void 0:i.id)})},children:e=>{return t=li(),r=t.firstChild,a=r.firstChild,o=r.nextSibling,n(r,()=>e.name,a),n(o,()=>String(i.data[e.name]||"-")),l(e=>{var i=ei,n=ti,a=ii;return i!==e.e&&d(t,e.e=i),n!==e.t&&d(r,e.t=n),a!==e.a&&d(o,e.a=a),e},{e:void 0,t:void 0,a:void 0}),t;var t,r,a,o}})),l(e=>{var t=Kt,i=Qt,n=Xt,r=Zt;return t!==e.e&&d(a,e.e=t),i!==e.t&&d(s,e.t=i),n!==e.a&&d(u,e.a=n),r!==e.o&&d(v,e.o=r),e},{e:void 0,t:void 0,a:void 0,o:void 0}),a;var a,s,c,u,v}})),l(e=>{var t=Ht,i=Jt,n=qt,r=Vt,o=Yt;return t!==e.e&&d(a,e.e=t),i!==e.t&&d(s,e.t=i),n!==e.a&&d(c,e.a=n),r!==e.o&&d(u,e.o=r),o!==e.i&&d(v,e.i=o),e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),a;var a,s,c,u,v}})),l(()=>d(a,Mt)),a}})),l(()=>d(s,Ut)),s;var s}e(["click"]);const si="_settings_4iycv_1",ci="_header_4iycv_7",ui="_closeButton_4iycv_16",vi="_section_4iycv_28",hi="_table_4iycv_38",gi="_roleSelect_4iycv_56",_i="_error_4iycv_62",pi="_success_4iycv_70",mi="_tabs_4iycv_79",bi="_activeTab_4iycv_101",fi="_settingsForm_4iycv_106",yi="_formItem_4iycv_113",wi="_checkboxLabel_4iycv_133",xi="_saveButton_4iycv_146",Si="_hint_4iycv_165",$i="_inviteSection_4iycv_171",ki="_inviteForm_4iycv_175",Ci="_formGroup_4iycv_186",ji="_addRemoteSection_4iycv_217",Li="_actions_4iycv_229",Ti="_smallButton_4iycv_234",Ei="_deleteButtonSmall_4iycv_248";var Pi=i("<button>Git Sync"),Ii=i("<div>"),zi=i("<table><thead><tr><th>Name</th><th>Email</th><th>Role</th></tr></thead><tbody>"),Ni=i("<h4>Pending Invitations"),Ri=i("<table><thead><tr><th>Email</th><th>Role</th><th>Sent</th></tr></thead><tbody>"),Di=i('<div><form><h4>Invite new member</h4><div><input type=email placeholder="Email address"required><select><option value=admin>Admin</option><option value=editor>Editor</option><option value=viewer>Viewer</option></select><button type=submit>Invite'),Ai=i("<section><h3>Members"),Bi=i("<section><h3>Personal Settings</h3><form><div><label>Theme</label><select><option value=light>Light</option><option value=dark>Dark</option><option value=system>System</option></select></div><div><label>Language</label><select><option value=en>English</option><option value=fr>French</option><option value=de>German</option><option value=es>Spanish</option></select></div><div><label><input type=checkbox>Enable notifications for this workspace</label></div><button type=submit>Save Changes"),Oi=i('<form><div><label>Organization Name</label><input type=text disabled title="Rename is not supported yet"></div><div><label><input type=checkbox>Allow public access (Read-only)</label></div><div><label>Allowed Email Domains (comma separated)</label><input type=text placeholder="example.com, company.org"><p>Users with these email domains can join automatically.</p></div><button type=submit>Save Workspace Settings'),Fi=i("<section><h3>Workspace Settings"),Wi=i("<table><thead><tr><th>Name</th><th>URL</th><th>Last Sync</th><th>Actions</th></tr></thead><tbody>"),Ui=i("<section><h3>Git Synchronization</h3><p>Synchronize your workspace data with an external Git repository.</p><div><h4>Add New Remote</h4><form><div><label>Remote Name</label><input type=text placeholder=origin required></div><div><label>Repository URL</label><input type=url placeholder=https://github.com/user/repo.git required></div><div><label>Personal Access Token (optional)</label><input type=password placeholder=ghp_...><p>Used for authentication when pushing.</p></div><button type=submit>Add Remote"),Gi=i("<div><header><h2>Settings</h2><button>&times;</button></header><div><button>Members</button><button>Personal</button><button>Workspace"),Mi=i("<p>Only admins can view member list."),Hi=i("<select><option value=admin>Admin</option><option value=editor>Editor</option><option value=viewer>Viewer"),Ji=i("<tr><td></td><td></td><td>"),qi=i("<p>Only admins can modify workspace settings."),Vi=i("<tr><td></td><td></td><td></td><td><button>Push</button><button>Remove");function Yi(e){const[i,c]=t("members"),[u,v]=t([]),[h,g]=t([]),[p,m]=t([]),[b,f]=t("origin"),[y,w]=t(""),[x,S]=t(""),[$,k]=t(""),[C,j]=t("viewer"),[L,T]=t("light"),[E,P]=t("en"),[I,z]=t(!0);_(()=>{var t,i;T((null==(t=e.user.settings)?void 0:t.theme)||"light"),P((null==(i=e.user.settings)?void 0:i.language)||"en")});const[N,R]=t(""),[D,A]=t(!1),[B,O]=t(""),[F,W]=t(!1),[U,G]=t(null),[M,H]=t(null),J=async(t,i={})=>{var n;let r=t;t.startsWith("/api/")&&!t.startsWith("/api/auth/")&&(r=`/api/${e.user.organization_id}${t.substring(4)}`);const a=await fetch(r,{...i,headers:{...i.headers,Authorization:`Bearer ${e.token}`}});if(!a.ok){const e=await a.json();throw new Error((null==(n=e.error)?void 0:n.message)||e.error||"Request failed")}return a},q=async()=>{var t,n,r,a,o,l,d;try{W(!0),G(null);const s=[];if("members"===i()&&"admin"===e.user.role&&(s.push(J("/api/users")),s.push(J("/api/invitations"))),"workspace"===i()&&s.push(J("/api/settings/organization")),"sync"===i()&&"admin"===e.user.role&&s.push(J("/api/settings/git/remotes")),0===s.length)return;const c=await Promise.all(s);if("members"===i()&&"admin"===e.user.role){const e=await c[0].json(),i=await c[1].json();v((null==(t=e.users)?void 0:t.filter(Boolean))||[]),g((null==(n=i.invitations)?void 0:n.filter(Boolean))||[])}if("workspace"===i()){const e=await c[c.length-1].json();R(e.name),A((null==(r=e.settings)?void 0:r.public_access)||!1),O((null==(o=null==(a=e.settings)?void 0:a.allowed_domains)?void 0:o.join(", "))||"")}if("sync"===i()&&"admin"===e.user.role){const e=await c[c.length-1].json();m(e.remotes||[])}const u=null==(l=e.user.memberships)?void 0:l.find(t=>t.organization_id===e.user.organization_id);u&&z((null==(d=u.settings)?void 0:d.notifications)??!0)}catch(s){G("Failed to load settings: "+s)}finally{W(!1)}};_(()=>{q()});const V=async e=>{if(e.preventDefault(),$())try{W(!0),await J("/api/invitations",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:$(),role:C()})}),k(""),H("Invitation sent successfully"),q()}catch(t){G("Failed to send invitation: "+t)}finally{W(!1)}},Y=async e=>{e.preventDefault();try{W(!0),G(null),H(null);const e={theme:L(),language:E()},t={notifications:I()};await Promise.all([J("/api/auth/settings",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({settings:e})}),J("/api/settings/membership",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({settings:t})})]),H("Personal settings saved successfully")}catch(t){G("Failed to save settings: "+t)}finally{W(!1)}},K=async e=>{e.preventDefault();try{W(!0),G(null),H(null);const e={public_access:D(),allowed_domains:B()?B().split(",").map(e=>e.trim()):[]};await J("/api/settings/organization",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({settings:e})}),H("Workspace settings saved successfully")}catch(t){G("Failed to save workspace settings: "+t)}finally{W(!1)}},Q=async e=>{e.preventDefault();try{W(!0),G(null),await J("/api/settings/git/remotes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:b(),url:y(),token:x(),type:"custom",auth_type:x()?"token":"none"})}),H("Remote added"),w(""),S(""),q()}catch(t){G("Failed to add remote: "+t)}finally{W(!1)}};return X=Gi(),Z=X.firstChild,ee=Z.firstChild.nextSibling,te=Z.nextSibling,ie=te.firstChild,ne=ie.nextSibling,re=ne.nextSibling,ee.$$click=()=>e.onClose(),ie.$$click=()=>c("members"),ne.$$click=()=>c("personal"),re.$$click=()=>c("workspace"),n(te,r(a,{get when(){return"admin"===e.user.role},get children(){var e=Pi();return e.$$click=()=>c("sync"),l(()=>d(e,"sync"===i()?bi:"")),e}}),null),n(X,r(a,{get when(){return U()},get children(){var e=Ii();return n(e,U),l(()=>d(e,_i)),e}}),null),n(X,r(a,{get when(){return M()},get children(){var e=Ii();return n(e,M),l(()=>d(e,pi)),e}}),null),n(X,r(a,{get when(){return"members"===i()},get children(){var t=Ai();return t.firstChild,n(t,r(a,{get when(){return"admin"===e.user.role},get fallback(){return Mi()},get children(){return[(_=zi(),p=_.firstChild.nextSibling,n(p,r(o,{get each(){return u()},children:t=>{return i=Ji(),o=i.firstChild,s=o.nextSibling,c=s.nextSibling,n(o,()=>t.name),n(s,()=>t.email),n(c,r(a,{get when(){return t.id!==e.user.id},get fallback(){return t.role},get children(){var e=Hi();return e.addEventListener("change",e=>(async(e,t)=>{try{W(!0),await J("/api/users/role",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:e,role:t})}),H("Role updated"),q()}catch(i){G("Failed to update role: "+i)}finally{W(!1)}})(t.id,e.target.value)),l(()=>d(e,gi)),l(()=>e.value=t.role),e}})),i;var i,o,s,c}})),l(()=>d(_,hi)),_),(t=Di(),i=t.firstChild,s=i.firstChild.nextSibling,c=s.firstChild,v=c.nextSibling,g=v.nextSibling,i.addEventListener("submit",V),c.$$input=e=>k(e.target.value),v.addEventListener("change",e=>j(e.target.value)),n(t,r(a,{get when(){return h().length>0},get children(){return[Ni(),(e=Ri(),t=e.firstChild.nextSibling,n(t,r(o,{get each(){return h()},children:e=>{return t=Ji(),i=t.firstChild,r=i.nextSibling,a=r.nextSibling,n(i,()=>e.email),n(r,()=>e.role),n(a,()=>new Date(e.created).toLocaleDateString()),t;var t,i,r,a}})),l(()=>d(e,hi)),e)];var e,t}}),null),l(e=>{var n=$i,r=ki,a=Ci,o=F();return n!==e.e&&d(t,e.e=n),r!==e.t&&d(i,e.t=r),a!==e.a&&d(s,e.a=a),o!==e.o&&(g.disabled=e.o=o),e},{e:void 0,t:void 0,a:void 0,o:void 0}),l(()=>c.value=$()),l(()=>v.value=C()),t)];var t,i,s,c,v,g,_,p}}),null),l(()=>d(t,vi)),t}}),null),n(X,r(a,{get when(){return"personal"===i()},get children(){var e=Bi(),t=e.firstChild.nextSibling,i=t.firstChild,n=i.firstChild.nextSibling,r=i.nextSibling,a=r.firstChild.nextSibling,o=r.nextSibling,s=o.firstChild,c=s.firstChild,u=o.nextSibling;return t.addEventListener("submit",Y),n.addEventListener("change",e=>T(e.target.value)),a.addEventListener("change",e=>P(e.target.value)),c.addEventListener("change",e=>z(e.currentTarget.checked)),l(n=>{var a=vi,l=fi,c=yi,v=yi,h=yi,g=wi,_=xi,p=F();return a!==n.e&&d(e,n.e=a),l!==n.t&&d(t,n.t=l),c!==n.a&&d(i,n.a=c),v!==n.o&&d(r,n.o=v),h!==n.i&&d(o,n.i=h),g!==n.n&&d(s,n.n=g),_!==n.s&&d(u,n.s=_),p!==n.h&&(u.disabled=n.h=p),n},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),l(()=>n.value=L()),l(()=>a.value=E()),l(()=>c.checked=I()),e}}),null),n(X,r(a,{get when(){return"workspace"===i()},get children(){var t=Fi();return t.firstChild,n(t,r(a,{get when(){return"admin"===e.user.role},get fallback(){return qi()},get children(){var e=Oi(),t=e.firstChild,i=t.firstChild.nextSibling,n=t.nextSibling,r=n.firstChild,a=r.firstChild,o=n.nextSibling,s=o.firstChild.nextSibling,c=s.nextSibling,u=o.nextSibling;return e.addEventListener("submit",K),i.$$input=e=>R(e.target.value),a.addEventListener("change",e=>A(e.currentTarget.checked)),s.$$input=e=>O(e.target.value),l(i=>{var a=fi,l=yi,s=yi,v=wi,h=yi,g=Si,_=xi,p=F();return a!==i.e&&d(e,i.e=a),l!==i.t&&d(t,i.t=l),s!==i.a&&d(n,i.a=s),v!==i.o&&d(r,i.o=v),h!==i.i&&d(o,i.i=h),g!==i.n&&d(c,i.n=g),_!==i.s&&d(u,i.s=_),p!==i.h&&(u.disabled=i.h=p),i},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),l(()=>i.value=N()),l(()=>a.checked=D()),l(()=>s.value=B()),e}}),null),l(()=>d(t,vi)),t}}),null),n(X,r(a,{get when(){return"sync"===i()},get children(){var e=Ui(),t=e.firstChild.nextSibling,i=t.nextSibling,c=i.firstChild.nextSibling,u=c.firstChild,v=u.firstChild.nextSibling,h=u.nextSibling,g=h.firstChild.nextSibling,_=h.nextSibling,m=_.firstChild.nextSibling,$=m.nextSibling,k=_.nextSibling;return n(e,r(a,{get when(){return p().length>0},get children(){var e=Wi(),t=e.firstChild.nextSibling;return n(t,r(o,{get each(){return p()},children:e=>{return i=Vi(),r=i.firstChild,a=r.nextSibling,o=a.nextSibling,c=o.nextSibling,u=c.firstChild,v=u.nextSibling,n(r,()=>e.name),n(a,()=>e.url),n(o,(t=s(()=>!!e.last_sync),()=>t()?new Date(e.last_sync).toLocaleString():"Never")),u.$$click=()=>(async e=>{try{W(!0),G(null),H(null),await J(`/api/settings/git/remotes/${e}/push`,{method:"POST"}),H("Push successful"),q()}catch(t){G("Push failed: "+t)}finally{W(!1)}})(e.id),v.$$click=()=>(async e=>{if(confirm("Are you sure you want to remove this remote?"))try{W(!0),G(null),await J(`/api/settings/git/remotes/${e}`,{method:"DELETE"}),H("Remote removed"),q()}catch(t){G("Failed to remove remote: "+t)}finally{W(!1)}})(e.id),l(e=>{var t=Li,i=F(),n=Ti,r=F(),a=Ei;return t!==e.e&&d(c,e.e=t),i!==e.t&&(u.disabled=e.t=i),n!==e.a&&d(u,e.a=n),r!==e.o&&(v.disabled=e.o=r),a!==e.i&&d(v,e.i=a),e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),i;var t,i,r,a,o,c,u,v}})),l(()=>d(e,hi)),e}}),i),c.addEventListener("submit",Q),v.$$input=e=>f(e.target.value),g.$$input=e=>w(e.target.value),m.$$input=e=>S(e.target.value),l(n=>{var r=vi,a=Si,o=ji,l=fi,s=yi,v=yi,g=yi,p=Si,m=xi,b=F();return r!==n.e&&d(e,n.e=r),a!==n.t&&d(t,n.t=a),o!==n.a&&d(i,n.a=o),l!==n.o&&d(c,n.o=l),s!==n.i&&d(u,n.i=s),v!==n.n&&d(h,n.n=v),g!==n.s&&d(_,n.s=g),p!==n.h&&d($,n.h=p),m!==n.r&&d(k,n.r=m),b!==n.d&&(k.disabled=n.d=b),n},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0}),l(()=>v.value=b()),l(()=>g.value=y()),l(()=>m.value=x()),e}}),null),l(e=>{var t=si,n=ci,r=ui,a=mi,o="members"===i()?bi:"",l="personal"===i()?bi:"",s="workspace"===i()?bi:"";return t!==e.e&&d(X,e.e=t),n!==e.t&&d(Z,e.t=n),r!==e.a&&d(ee,e.a=r),a!==e.o&&d(te,e.o=a),o!==e.i&&d(ie,e.i=o),l!==e.n&&d(ne,e.n=l),s!==e.s&&d(re,e.s=s),e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),X;var X,Z,ee,te,ie,ne,re}e(["click","input"]);const Ki="_overlay_s4zcj_1",Qi="_modal_s4zcj_15",Xi="_header_s4zcj_36",Zi="_content_s4zcj_51",en="_step_s4zcj_55",tn="_formGroup_s4zcj_61",nn="_hint_s4zcj_86",rn="_illustration_s4zcj_92",an="_primaryButton_s4zcj_98",on="_secondaryButton_s4zcj_121",ln="_actions_s4zcj_136",dn="_error_s4zcj_152",sn="_footer_s4zcj_161",cn="_progress_s4zcj_167",un="_dot_s4zcj_172",vn="_active_s4zcj_179",hn="_gitForm_s4zcj_184";var gn=i("<div>"),_n=i("<div><h3>Confirm Workspace Name</h3><div><label>Workspace Name</label><input type=text disabled><p>This is derived from your registration name.</p></div><button>Next: Invite Team"),pn=i("<div><h3>Team Collaboration</h3><p>You can invite your team members now or later in settings.</p><div>üë•</div><button>Next: Git Sync"),mn=i("<div><h3>Advanced Sync (Optional)</h3><p>Keep your data safe by synchronizing with a private Git repository.</p><form><div><label>GitHub/GitLab Repository URL</label><input type=url placeholder=https://github.com/user/repo.git></div><div><label>Personal Access Token</label><input type=password placeholder=ghp_...></div><div><button type=button>Skip for now</button><button type=submit>"),bn=i("<div><div><header><h2>Welcome to mddb!</h2><p>Let's get your workspace ready.</p></header><div></div><div><div><div></div><div></div><div>");function fn(e){const[i,o]=t(p(()=>{var t;return(null==(t=e.user.onboarding)?void 0:t.step)||"name"})),[s,u]=t(!1),[v,h]=t(null),[g,_]=t(p(()=>{var t,i;return(null==(i=null==(t=e.user.memberships)?void 0:t[0])?void 0:i.organization_name)||""})),[m,b]=t(""),[f,y]=t(""),w=async(t,i={})=>{let n=t;t.startsWith("/api/")&&!t.startsWith("/api/auth/")&&(n=`/api/${e.user.organization_id}${t.substring(4)}`);return await fetch(n,{...i,headers:{...i.headers,Authorization:`Bearer ${e.token}`}})},x=async(t,i=!1)=>{try{u(!0),h(null);if(!(await w("/api/onboarding",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({state:{completed:i,step:t,updated_at:(new Date).toISOString()}})})).ok)throw new Error("Failed to update onboarding state");i?e.onComplete():o(t)}catch(n){h("Error: "+n)}finally{u(!1)}},S=()=>{x("done",!0)},$=async e=>{e.preventDefault();try{u(!0);if(!(await w("/api/settings/git/remotes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:"origin",url:m(),token:f(),type:"custom",auth_type:f()?"token":"none"})})).ok)throw new Error("Failed to setup git remote");x("done",!0)}catch(t){h("Git setup failed: "+t)}finally{u(!1)}};return k=bn(),C=k.firstChild,j=C.firstChild,L=j.nextSibling,T=L.nextSibling,E=T.firstChild,P=E.firstChild,I=P.nextSibling,z=I.nextSibling,n(C,r(a,{get when(){return v()},get children(){var e=gn();return n(e,v),l(()=>d(e,dn)),e}}),L),n(L,r(a,{get when(){return"name"===i()},get children(){var e=_n(),t=e.firstChild.nextSibling,i=t.firstChild.nextSibling,n=i.nextSibling,r=t.nextSibling;return i.$$input=e=>_(e.target.value),r.$$click=()=>x("members"),l(i=>{var a=en,o=tn,l=nn,s=an;return a!==i.e&&d(e,i.e=a),o!==i.t&&d(t,i.t=o),l!==i.a&&d(n,i.a=l),s!==i.o&&d(r,i.o=s),i},{e:void 0,t:void 0,a:void 0,o:void 0}),l(()=>i.value=g()),e}}),null),n(L,r(a,{get when(){return"members"===i()},get children(){var e=pn(),t=e.firstChild.nextSibling.nextSibling,i=t.nextSibling;return i.$$click=()=>x("git"),l(n=>{var r=en,a=rn,o=an;return r!==n.e&&d(e,n.e=r),a!==n.t&&d(t,n.t=a),o!==n.a&&d(i,n.a=o),n},{e:void 0,t:void 0,a:void 0}),e}}),null),n(L,r(a,{get when(){return"git"===i()},get children(){var e=mn(),t=e.firstChild.nextSibling.nextSibling,i=t.firstChild,r=i.firstChild.nextSibling,a=i.nextSibling,o=a.firstChild.nextSibling,c=a.nextSibling,u=c.firstChild,v=u.nextSibling;return t.addEventListener("submit",$),r.$$input=e=>b(e.target.value),o.$$input=e=>y(e.target.value),u.$$click=S,n(v,()=>s()?"Saving...":"Setup & Finish"),l(n=>{var r=en,o=hn,l=tn,h=tn,g=ln,_=on,p=an,b=!m()||s();return r!==n.e&&d(e,n.e=r),o!==n.t&&d(t,n.t=o),l!==n.a&&d(i,n.a=l),h!==n.o&&d(a,n.o=h),g!==n.i&&d(c,n.i=g),_!==n.n&&d(u,n.n=_),p!==n.s&&d(v,n.s=p),b!==n.h&&(v.disabled=n.h=b),n},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),l(()=>r.value=m()),l(()=>o.value=f()),e}}),null),l(e=>{var t=Ki,n=Qi,r=Xi,a=Zi,o=sn,l=cn,s={[un]:!0,[vn]:"name"===i()},u={[un]:!0,[vn]:"members"===i()},v={[un]:!0,[vn]:"git"===i()};return t!==e.e&&d(k,e.e=t),n!==e.t&&d(C,e.t=n),r!==e.a&&d(j,e.a=r),a!==e.o&&d(L,e.o=a),o!==e.i&&d(T,e.i=o),l!==e.n&&d(E,e.n=l),e.s=c(P,s,e.s),e.h=c(I,u,e.h),e.r=c(z,v,e.r),e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0}),k;var k,C,j,L,T,E,P,I,z}e(["input","click"]);const yn="_authContainer_2kal9_1",wn="_authForm_2kal9_9",xn="_formGroup_2kal9_25",Sn="_error_2kal9_63",$n="_toggle_2kal9_72",kn="_authFooter_2kal9_94",Cn="_oauthSection_2kal9_112",jn="_divider_2kal9_116",Ln="_oauthButtons_2kal9_135",Tn="_googleButton_2kal9_141",En="_microsoftButton_2kal9_142";var Pn=i("<div><label for=name>Name</label><input id=name name=name type=text required autocomplete=name>"),In=i("<div><form><h2></h2><div><label for=email>Email</label><input id=email name=email type=email required autocomplete=email></div><div><label for=password>Password</label><input id=password name=password type=password required></div><button type=submit></button><div><div><span>or</span></div><div><a href=/api/auth/oauth/google>Login with Google</a><a href=/api/auth/oauth/microsoft>Login with Microsoft</a></div></div><p><button type=button></button></p><div><a href=/privacy>Privacy Policy"),zn=i("<div>");function Nn(e){const[i,o]=t(!1),[c,u]=t(""),[v,g]=t(""),[_,p]=t(""),[m,b]=t(null),[f,y]=t(!1),w=async t=>{var n;t.preventDefault(),b(null),y(!0);const r=i()?"/api/auth/register":"/api/auth/login",a=i()?{email:c(),password:v(),name:_()}:{email:c(),password:v()};try{const t=await fetch(r,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}),i=await t.json();if(!t.ok){return void b((null==(n=i.error)?void 0:n.message)||"Authentication failed")}i.token&&i.user?e.onLogin(i.token,i.user):b("Invalid response from server")}catch(o){b("An error occurred. Please try again.")}finally{y(!1)}};return $=In(),k=$.firstChild,C=k.firstChild,j=C.nextSibling,L=j.firstChild.nextSibling,T=j.nextSibling,E=T.firstChild.nextSibling,P=T.nextSibling,I=P.nextSibling,z=I.firstChild,N=z.nextSibling,R=N.firstChild,D=R.nextSibling,A=I.nextSibling,B=A.firstChild,O=A.nextSibling,F=O.firstChild,k.addEventListener("submit",w),n(C,()=>i()?"Create Account":"Login to mddb"),n(k,(x=s(()=>!!m()),()=>{return x()&&(e=zn(),n(e,m),l(()=>d(e,Sn)),e);var e}),j),n(k,r(a,{get when(){return i()},get children(){var e=Pn(),t=e.firstChild.nextSibling;return t.$$input=e=>p(e.target.value),l(()=>d(e,xn)),l(()=>t.value=_()),e}}),j),L.$$input=e=>u(e.target.value),E.$$input=e=>g(e.target.value),n(P,(S=s(()=>!!f()),()=>S()?"Please wait...":i()?"Register":"Login")),n(A,()=>i()?"Already have an account?":"Don't have an account?",B),B.$$click=()=>o(!i()),n(B,()=>i()?"Login":"Register"),F.$$click=e=>{e.preventDefault(),window.history.pushState(null,"","/privacy"),window.dispatchEvent(new PopStateEvent("popstate"))},l(e=>{var t=yn,n=wn,r=xn,a=xn,o=i()?"new-password":"current-password",l=f(),s=Cn,c=jn,u=Ln,v=Tn,g=En,_=$n,p=kn;return t!==e.e&&d($,e.e=t),n!==e.t&&d(k,e.t=n),r!==e.a&&d(j,e.a=r),a!==e.o&&d(T,e.o=a),o!==e.i&&h(E,"autocomplete",e.i=o),l!==e.n&&(P.disabled=e.n=l),s!==e.s&&d(I,e.s=s),c!==e.h&&d(z,e.h=c),u!==e.r&&d(N,e.r=u),v!==e.d&&d(R,e.d=v),g!==e.l&&d(D,e.l=g),_!==e.u&&d(A,e.u=_),p!==e.c&&d(O,e.c=p),e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0}),l(()=>L.value=c()),l(()=>E.value=v()),$;var x,S,$,k,C,j,L,T,E,P,I,z,N,R,D,A,B,O,F}e(["input","click"]);const Rn="_container_1lj5r_1",Dn="_content_1lj5r_10",An="_header_1lj5r_20",Bn="_section_1lj5r_37",On="_footer_1lj5r_51",Fn="_backButton_1lj5r_59";var Wn=i("<div><div><header><h1>Privacy Policy</h1><p>Last updated: January 18, 2026</p></header><section><h2>1. Introduction</h2><p>Welcome to mddb. We are committed to protecting your personal information and your right to privacy. If you have any questions or concerns about our policy, or our practices with regards to your personal information, please contact us.</p></section><section><h2>2. Information We Collect</h2><p>We collect personal information that you voluntarily provide to us when registering at the mddb Express interest in obtaining information about us or our products and services, when participating in activities on the mddb or otherwise contacting us.</p><p>The personal information that we collect depends on the context of your interactions with us and the mddb, the choices you make and the products and features you use.</p></section><section><h2>3. How We Use Your Information</h2><p>We use personal information collected via our mddb for a variety of business purposes described below. We process your personal information for these purposes in reliance on our legitimate business interests, in order to enter into or perform a contract with you, with your consent, and/or for compliance with our legal obligations.</p></section><section><h2>4. Your Data, Your Control</h2><p>mddb is designed to be local-first and markdown-based. Your documents and databases are stored in the location you specify. If you use a hosted version, the provider has access to your data.</p></section><footer><button>Go Back");function Un(){return e=Wn(),t=e.firstChild,i=t.firstChild,n=i.nextSibling,r=n.nextSibling,a=r.nextSibling,o=a.nextSibling,s=o.nextSibling,(c=s.firstChild).$$click=()=>window.history.back(),l(l=>{var u=Rn,v=Dn,h=An,g=Bn,_=Bn,p=Bn,m=Bn,b=On,f=Fn;return u!==l.e&&d(e,l.e=u),v!==l.t&&d(t,l.t=v),h!==l.a&&d(i,l.a=h),g!==l.o&&d(n,l.o=g),_!==l.i&&d(r,l.i=_),p!==l.n&&d(a,l.n=p),m!==l.s&&d(o,l.s=m),b!==l.h&&d(s,l.h=b),f!==l.r&&d(c,l.r=f),l},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0}),e;var e,t,i,n,r,a,o,s,c}e(["click"]);var Gn=i("<select>"),Mn=i("<span>"),Hn=i("<p>Loading..."),Jn=i("<nav>"),qn=i("<div>"),Vn=i("<span>‚óè Unsaved"),Yn=i("<span>‚ü≥ Saving..."),Kn=i("<span>‚úì Saved"),Qn=i("<li>No history available"),Xn=i("<div><h3>Version History</h3><ul>"),Zn=i('<div><textarea placeholder="Write your content in markdown...">'),er=i("<div><div><h3>Database Records</h3><div><button>Table</button><button>Grid</button><button>Gallery</button><button>Board"),tr=i("<div><div><input type=text placeholder=Title><div></div><div><button></button><button></button><button>Delete</button></div></div><div>"),ir=i('<div><header><div><h1>mddb</h1><p>A seamless markdown-based document and database system</p></div><div><span> (<!>)</span><button>Logout</button></div></header><div><aside><div><h2>Workspace</h2><div><button title="Workspace Settings">‚öô</button><button title="New Page">+P</button><button title="New Database">+D</button></div></div><ul></ul><div><a href=/privacy>Privacy Policy</a></div></aside><main>'),nr=i("<option>"),rr=i("<span>/"),ar=i("<div><h2>Welcome to mddb</h2><p>Select a node from the sidebar or create a new one to get started.</p><div><input type=text placeholder=Title><div><button>Create Page</button><button>Create Database"),or=i("<li><div><span></span><span></span></div><div>");const lr=e=>e.toString().toLowerCase().trim().replace(/\s+/g,"-").replace(/[^\w-]+/g,"").replace(/--+/g,"-");function dr(){const[e,i]=t(null),[u,v]=t(localStorage.getItem("mddb_token")),[h,g]=t([]),[p,f]=t([]),[N,Y]=t(null),[ie,ne]=t(!1),[re,ae]=t(!1),[oe,le]=t("table"),[fe,ye]=t(""),[xe,Se]=t(""),[$e,ke]=t(!1),[je,Le]=t(null),[Te,Ee]=t(!1),[Pe,Ie]=t("idle"),[ze,Ne]=t(!1),[Re,De]=t([]),[Ae,Be]=t(!1),Oe=async(t,i={})=>{var n;let r=t;if(t.startsWith("/api/")&&!t.startsWith("/api/auth/")&&!t.startsWith("/api/health")){const i=null==(n=e())?void 0:n.organization_id;i&&(r=`/api/${i}${t.substring(4)}`)}const a={...i.headers,Authorization:`Bearer ${u()}`},o=await fetch(r,{...i,headers:a});if(401===o.status)throw Fe(),new Error("Session expired");return o},Fe=()=>{localStorage.removeItem("mddb_token"),v(null),i(null),window.history.pushState(null,"","/")},We=(e,t)=>{localStorage.setItem("mddb_token",e),v(e),i(t)};async function Ue(e,t=!0){try{ke(!0);const i=await Oe("/api/auth/switch-org",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({org_id:e})}),n=await i.json();We(n.token,n.user),Y(null),t&&window.history.pushState(null,"","/"),await He()}catch(i){throw Le("Failed to switch organization: "+i),i}finally{ke(!1)}}const Ge=function(e,t){let i=null;return(...n)=>{null!==i&&clearTimeout(i),i=setTimeout(()=>{e(...n),i=null},t)}}(async()=>{var t;const i=N();if(i&&Te())try{Ie("saving"),await Oe(`/api/pages/${i}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:fe(),content:xe()})}),Ee(!1),Ie("saved");const n=lr(fe()),r=null==(t=e())?void 0:t.organization_id;if(r){const e=window.location.pathname,t=`/${r}/${i}${n?"-"+n:""}`;e!==t&&window.history.replaceState(null,"",t)}setTimeout(()=>{"saved"===Pe()&&Ie("idle")},2e3)}catch(n){Le("Auto-save failed: "+n),Ie("idle")}},2e3);_(()=>{const t=new URLSearchParams(window.location.search).get("token");t&&(localStorage.setItem("mddb_token",t),v(t),window.history.replaceState({},document.title,window.location.pathname));const n=u(),r=e();if(n&&!r){(async()=>{try{const e=await Oe("/api/auth/me");if(e.ok){const t=await e.json();i(t)}}catch(e){console.error("Failed to load user",e)}})()}});const Me=async()=>{var t,i,n;const r=window.location.pathname;if("/privacy"===r)return void ae(!0);ae(!1);const a=r.match(/^\/([^/]+)\/(\d+)(?:-.*)?$/);if(a){const r=a[1],l=a[2];if(e()&&(null==(t=e())?void 0:t.organization_id)!==r)try{if(!(null==(n=null==(i=e())?void 0:i.memberships)?void 0:n.some(e=>e.organization_id===r)))return void Le(`You do not have access to organization ${r}`);await Ue(r,!1)}catch(o){return}return void(l!==N()&&Je(l,!1))}Y(null),ye(""),Se("")};async function He(){var e;try{ke(!0);const t=await Oe("/api/nodes"),i=await t.json();g((null==(e=i.nodes)?void 0:e.filter(Boolean))||[]),Le(null)}catch(t){Le("Failed to load nodes: "+t)}finally{ke(!1)}}async function Je(t,i=!0){var n;try{ke(!0),Ne(!1);const r=await Oe(`/api/nodes/${t}`);if(!r.ok)throw new Error("Node not found");const a=await r.json();Y(a.id),ye(a.title),Se(a.content||""),Ee(!1),Ie("idle"),Le(null);const o=lr(a.title),l=null==(n=e())?void 0:n.organization_id;if(l){const e=`/${l}/${a.id}${o?"-"+o:""}`;i?window.location.pathname!==e&&window.history.pushState(null,"",e):window.location.pathname!==e&&window.history.replaceState(null,"",e)}if("database"===a.type||"hybrid"===a.type){const e=await Oe(`/api/databases/${t}/records?offset=0&limit=50`),i=(await e.json()).records||[];f(i),Be(50===i.length)}else f([]),Be(!1)}catch(r){Le("Failed to load node: "+r)}finally{ke(!1)}}async function qe(e="document"){if(fe().trim())try{ke(!0);const t=await Oe("/api/nodes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:fe(),type:e})}),i=await t.json();await He(),Je(i.id),ye(""),Se(""),Ee(!1),Ie("idle"),Le(null)}catch(t){Le("Failed to create node: "+t)}finally{ke(!1)}else Le("Title is required")}async function Ve(){const e=N();if(e)try{ke(!0),await Oe(`/api/pages/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:fe(),content:xe()})}),await He(),Ee(!1),Ie("idle"),Le(null);const t=lr(fe()),i=window.location.pathname,n=`/${e}${t?"-"+t:""}`;i!==n&&window.history.replaceState(null,"",n)}catch(t){Le("Failed to save node: "+t)}finally{ke(!1)}}async function Ye(){const e=N();if(e&&confirm("Are you sure you want to delete this node?"))try{ke(!0),await Oe(`/api/pages/${e}`,{method:"DELETE"}),await He(),Y(null),ye(""),Se(""),Ee(!1),Ie("idle"),Le(null),window.history.pushState(null,"","/")}catch(t){Le("Failed to delete node: "+t)}finally{ke(!1)}}m(()=>{window.addEventListener("popstate",Me),b(()=>window.removeEventListener("popstate",Me))}),_(()=>{e()?(He(),Me()):Me()});const Ke=e=>{Je(e.id)};async function Qe(e){const t=N();if(t)try{ke(!0);if(!(await Oe(`/api/databases/${t}/records`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({data:e})})).ok)return void Le("Failed to create record");Je(t),Le(null)}catch(i){Le("Failed to add record: "+i)}finally{ke(!1)}}async function Xe(e){const t=N();if(t&&confirm("Delete this record?"))try{ke(!0),await Oe(`/api/databases/${t}/records/${e}`,{method:"DELETE"}),Je(t),Le(null)}catch(i){Le("Failed to delete record: "+i)}finally{ke(!1)}}async function Ze(){const e=N();if(e&&!$e())try{ke(!0);const t=p().length,i=await Oe(`/api/databases/${e}/records?offset=${t}&limit=50`),n=(await i.json()).records||[];f([...p(),...n]),Be(50===n.length)}catch(t){Le("Failed to load more records: "+t)}finally{ke(!1)}}return r(a,{get when(){return!re()},get fallback(){return r(Un,{})},get children(){return r(a,{get when(){return e()},get fallback(){return r(Nn,{onLogin:We})},get children(){return[r(a,{get when(){var t,i;return s(()=>{var t;return"admin"===(null==(t=e())?void 0:t.role)})()&&!(null==(i=null==(t=e())?void 0:t.onboarding)?void 0:i.completed)},get children(){return r(fn,{get user(){return e()},get token(){return u()},onComplete:()=>{(async()=>{const e=await Oe("/api/auth/me");if(e.ok){const t=await e.json();i(t)}})()}})}}),(()=>{var t=ir(),i=t.firstChild,v=i.firstChild,g=v.nextSibling,_=g.firstChild,m=_.firstChild,b=m.nextSibling;b.nextSibling;var f=_.nextSibling,re=i.nextSibling,ae=re.firstChild,Ie=ae.firstChild,Be=Ie.firstChild.nextSibling,We=Be.firstChild,Me=We.nextSibling,He=Me.nextSibling,Je=Ie.nextSibling,et=Je.nextSibling,tt=et.firstChild,it=ae.nextSibling;return n(g,r(a,{get when(){var t,i;return((null==(i=null==(t=e())?void 0:t.memberships)?void 0:i.length)??0)>1},get children(){var t=Gn();return t.addEventListener("change",e=>Ue(e.target.value)),n(t,r(o,{get each(){var t;return null==(t=e())?void 0:t.memberships},children:e=>{return t=nr(),n(t,()=>e.organization_name||e.organization_id),l(()=>t.value=e.organization_id),t;var t}})),l(()=>d(t,k)),l(()=>{var i;return t.value=null==(i=e())?void 0:i.organization_id}),t}}),_),n(g,r(a,{get when(){var t,i;return 1===(null==(i=null==(t=e())?void 0:t.memberships)?void 0:i.length)},get children(){var t=Mn();return n(t,()=>{var t,i,n;return(null==(n=null==(i=null==(t=e())?void 0:t.memberships)?void 0:i[0])?void 0:n.organization_name)||"My Org"}),l(()=>d(t,C)),t}}),_),n(_,()=>{var t;return null==(t=e())?void 0:t.name},m),n(_,()=>{var t;return null==(t=e())?void 0:t.role},b),f.$$click=Fe,We.$$click=()=>{ne(!0),Y(null)},Me.$$click=()=>{ne(!1),qe("document")},He.$$click=()=>{ne(!1),qe("database")},n(ae,r(a,{get when(){return s(()=>!!$e())()&&0===h().length},fallback:null,get children(){var e=Hn();return l(()=>d(e,P)),e}}),Je),n(Je,r(o,{get each(){return h()},children:e=>r(we,{node:e,get selectedId(){return N()},onSelect:Ke,depth:0})})),tt.$$click=e=>{e.preventDefault(),window.history.pushState(null,"","/privacy"),window.dispatchEvent(new PopStateEvent("popstate"))},n(it,r(a,{get when(){return s(()=>!(!ie()||!e()))()&&u()},get children(){return r(Yi,{get user(){return e()},get token(){return u()},onClose:()=>ne(!1)})}}),null),n(it,r(a,{get when(){return!ie()},get children(){return[r(a,{get when(){return N()},get children(){var e=Jn();return n(e,r(o,{get each(){return(e=>{if(!e)return[];const t=[],i=(e,n)=>{for(const r of e){if(r.id===n)return t.push(r),!0;if(r.children&&i(r.children,n))return t.unshift(r),!0}return!1};return i(h(),e),t})(N())},children:(e,t)=>{return[r(a,{get when(){return t()>0},get children(){var e=rr();return l(()=>d(e,ce)),e}}),(i=Mn(),i.$$click=()=>Ke(e),n(i,()=>e.title),l(()=>d(i,se)),i)];var i}})),l(()=>d(e,de)),e}}),r(a,{get when(){return je()},fallback:null,get children(){var e=qn();return n(e,je),l(()=>d(e,D)),e}}),r(a,{get when(){return N()},get fallback(){return e=ar(),t=e.firstChild.nextSibling.nextSibling,i=t.firstChild,n=i.nextSibling,r=n.firstChild,a=r.nextSibling,i.$$input=e=>ye(e.target.value),r.$$click=()=>qe("document"),a.$$click=()=>qe("database"),l(o=>{var l=A,s=B,c=H,u=K,v=q,h=q;return l!==o.e&&d(e,o.e=l),s!==o.t&&d(t,o.t=s),c!==o.a&&d(i,o.a=c),u!==o.o&&d(n,o.o=u),v!==o.i&&d(r,o.i=v),h!==o.n&&d(a,o.n=h),o},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0}),l(()=>i.value=fe()),e;var e,t,i,n,r,a},get children(){var t=tr(),i=t.firstChild,s=i.firstChild,u=s.nextSibling,v=u.nextSibling,g=v.firstChild,_=g.nextSibling,m=_.nextSibling,b=i.nextSibling;return s.$$input=e=>{ye(e.target.value),Ee(!0),Ge()},n(u,r(a,{get when(){return Te()},get children(){var e=Vn();return l(()=>d(e,U)),e}}),null),n(u,r(a,{get when(){return"saving"===Pe()},get children(){var e=Yn();return l(()=>d(e,G)),e}}),null),n(u,r(a,{get when(){return"saved"===Pe()},get children(){var e=Kn();return l(()=>d(e,M)),e}}),null),g.$$click=()=>{const e=N();e&&async function(e){var t;if(ze())Ne(!1);else try{ke(!0);const i=await Oe(`/api/pages/${e}/history`),n=await i.json();De((null==(t=n.history)?void 0:t.filter(Boolean))||[]),Ne(!0)}catch(i){Le("Failed to load history: "+i)}finally{ke(!1)}}(e)},n(g,()=>ze()?"Hide History":"History"),_.$$click=Ve,n(_,()=>$e()?"Saving...":"Save"),m.$$click=Ye,n(t,r(a,{get when(){return ze()},get children(){var e=Xn(),t=e.firstChild.nextSibling;return n(t,r(o,{get each(){return Re()},children:e=>{return t=or(),i=t.firstChild,r=i.firstChild,a=r.nextSibling,o=i.nextSibling,t.$$click=()=>{const t=N();t&&async function(e,t){if(confirm("This will replace current editor content with the selected version. Unsaved changes will be lost. Continue?"))try{ke(!0);const i=await Oe(`/api/pages/${e}/history/${t}`),n=await i.json();Se(n.content),Ee(!0),Ne(!1)}catch(i){Le("Failed to load version: "+i)}finally{ke(!1)}}(t,e.hash)},n(r,()=>new Date(e.timestamp).toLocaleString()),n(a,()=>e.hash.substring(0,7)),n(o,()=>e.message),l(e=>{var n=ge,l=_e,s=pe,c=me,u=be;return n!==e.e&&d(t,e.e=n),l!==e.t&&d(i,e.t=l),s!==e.a&&d(r,e.a=s),c!==e.o&&d(a,e.o=c),u!==e.i&&d(o,e.i=u),e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),t;var t,i,r,a,o}}),null),n(t,r(a,{get when(){return 0===Re().length},get children(){var e=Qn();return l(()=>d(e,ge)),e}}),null),l(i=>{var n=ve,r=he;return n!==i.e&&d(e,i.e=n),r!==i.t&&d(t,i.t=r),i},{e:void 0,t:void 0}),e}}),b),n(b,r(a,{get when(){var e;return"database"!==(null==(e=h().find(e=>e.id===N()))?void 0:e.type)},get children(){var t=Zn(),i=t.firstChild;return i.$$input=e=>{Se(e.target.value),Ee(!0),Ge()},n(t,r(Ce,{get content(){return xe()},get orgId(){var t;return null==(t=e())?void 0:t.organization_id}}),null),l(e=>{var n=X,r=ue;return n!==e.e&&d(t,e.e=n),r!==e.t&&d(i,e.t=r),e},{e:void 0,t:void 0}),l(()=>i.value=xe()),t}}),null),n(b,r(a,{get when(){var e;return"document"!==(null==(e=h().find(e=>e.id===N()))?void 0:e.type)},get children(){var e=er(),t=e.firstChild,i=t.firstChild.nextSibling,o=i.firstChild,s=o.nextSibling,u=s.nextSibling,v=u.nextSibling;return o.$$click=()=>le("table"),s.$$click=()=>le("grid"),u.$$click=()=>le("gallery"),v.$$click=()=>le("board"),n(e,r(a,{get when(){return"table"===oe()},get children(){return r(ut,{get databaseId(){return N()||""},get columns(){var e;return(null==(e=h().find(e=>e.id===N()))?void 0:e.columns)||[]},get records(){return p()},onAddRecord:Qe,onDeleteRecord:Xe,onLoadMore:Ze,get hasMore(){return Ae()}})}}),null),n(e,r(a,{get when(){return"grid"===oe()},get children(){return r(St,{get records(){return p()},get columns(){var e;return(null==(e=h().find(e=>e.id===N()))?void 0:e.columns)||[]},onDeleteRecord:Xe})}}),null),n(e,r(a,{get when(){return"gallery"===oe()},get children(){return r(Wt,{get records(){return p()},get columns(){var e;return(null==(e=h().find(e=>e.id===N()))?void 0:e.columns)||[]},onDeleteRecord:Xe})}}),null),n(e,r(a,{get when(){return"board"===oe()},get children(){return r(di,{get records(){return p()},get columns(){var e;return(null==(e=h().find(e=>e.id===N()))?void 0:e.columns)||[]},onDeleteRecord:Xe})}}),null),l(n=>{var r=Z,a=ee,l=te,h={[`${T}`]:"table"===oe()},g={[`${T}`]:"grid"===oe()},_={[`${T}`]:"gallery"===oe()},p={[`${T}`]:"board"===oe()};return r!==n.e&&d(e,n.e=r),a!==n.t&&d(t,n.t=a),l!==n.a&&d(i,n.a=l),n.o=c(o,h,n.o),n.i=c(s,g,n.i),n.n=c(u,_,n.n),n.s=c(v,p,n.s),n},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),e}}),null),l(e=>{var n=O,r=F,a=H,o=W,l=J,c=$e(),h=$e(),p=$e(),f=Q;return n!==e.e&&d(t,e.e=n),r!==e.t&&d(i,e.t=r),a!==e.a&&d(s,e.a=a),o!==e.o&&d(u,e.o=o),l!==e.i&&d(v,e.i=l),c!==e.n&&(g.disabled=e.n=c),h!==e.s&&(_.disabled=e.s=h),p!==e.h&&(m.disabled=e.h=p),f!==e.r&&d(b,e.r=f),e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0}),l(()=>s.value=fe()),t}})]}}),null),l(e=>{var n=y,r=w,a=x,o=S,l=$,s=j,c=L,u=E,h=V,_=I,p=z,m=R;return n!==e.e&&d(t,e.e=n),r!==e.t&&d(i,e.t=r),a!==e.a&&d(v,e.a=a),o!==e.o&&d(g,e.o=o),l!==e.i&&d(f,e.i=l),s!==e.n&&d(re,e.n=s),c!==e.s&&d(ae,e.s=c),u!==e.h&&d(Ie,e.h=u),h!==e.r&&d(Be,e.r=h),_!==e.d&&d(Je,e.d=_),p!==e.l&&d(et,e.l=p),m!==e.u&&d(it,e.u=m),e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0}),t})()]}})}})}e(["click","input"]);const sr=document.getElementById("app");sr&&f(()=>r(dr,{}),sr);
