import{d as e,c as t,t as i,i as n,a as r,S as a,F as o,b as l,e as d,m as s,f as c,s as u,M as v,g as h,h as g,j as _,o as p,k as m,r as f}from"./vendor-DWzAzpJi.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const i of e)if("childList"===i.type)for(const e of i.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const b="_app_1m9ik_15",w="_header_1m9ik_21",y="_headerTitle_1m9ik_31",k="_userInfo_1m9ik_41",S="_logoutButton_1m9ik_48",x="_orgSwitcher_1m9ik_62",$="_orgName_1m9ik_77",C="_container_1m9ik_84",L="_sidebar_1m9ik_90",T="_active_1m9ik_123",z="_sidebarHeader_1m9ik_129",I="_loading_1m9ik_163",E="_pageList_1m9ik_169",j="_pageItem_1m9ik_175",D="_main_1m9ik_205",N="_error_1m9ik_213",P="_welcome_1m9ik_221",R="_createForm_1m9ik_237",B="_editor_1m9ik_245",A="_editorHeader_1m9ik_251",O="_editorStatus_1m9ik_260",F="_unsavedIndicator_1m9ik_268",M="_savingIndicator_1m9ik_273",W="_savedIndicator_1m9ik_279",U="_titleInput_1m9ik_293",H="_editorActions_1m9ik_304",J="_createButton_1m9ik_310",q="_sidebarActions_1m9ik_332",G="_nodeIcon_1m9ik_351",V="_welcomeActions_1m9ik_356",K="_nodeContent_1m9ik_362",Y="_editorContent_1m9ik_369",Q="_databaseView_1m9ik_378",X="_databaseHeader_1m9ik_386",Z="_viewToggle_1m9ik_393",ee="_sidebarNodeWrapper_1m9ik_414",te="_childList_1m9ik_420",ie="_pageTitleText_1m9ik_426",ne="_expandIcon_1m9ik_432",re="_expanded_1m9ik_445",ae="_hidden_1m9ik_449",oe="_breadcrumbs_1m9ik_453",le="_breadcrumbItem_1m9ik_463",de="_breadcrumbSeparator_1m9ik_472",se="_contentInput_1m9ik_476",ce="_historyPanel_1m9ik_495",ue="_historyList_1m9ik_510",ve="_historyItem_1m9ik_517",he="_historyMeta_1m9ik_534",ge="_historyDate_1m9ik_541",_e="_historyHash_1m9ik_545",pe="_historyMessage_1m9ik_552";var me=i("<ul>"),fe=i("<li><div><span>‚ñ∂</span><span></span><span>");function be(e){const[i,v]=t(!0),h=e=>{e.stopPropagation(),v(!i())};return g=fe(),_=g.firstChild,p=_.firstChild,m=p.nextSibling,f=m.nextSibling,_.$$click=()=>e.onSelect(e.node),p.$$click=h,n(m,()=>"database"===e.node.type?"üìä":"üìÑ"),n(f,()=>e.node.title),n(g,r(a,{get when(){var t;return s(()=>!!i())()&&(null==(t=e.node.children)?void 0:t.length)},get children(){var t=me();return n(t,r(o,{get each(){return e.node.children},children:t=>r(be,{node:t,get selectedId(){return e.selectedId},get onSelect(){return e.onSelect},get depth(){return e.depth+1}})})),l(()=>d(t,te)),t}}),null),l(t=>{var n,r=ee,a=j,o={[`${T}`]:e.selectedId===e.node.id},l=12*e.depth+8+"px",s=ne,v={[`${re}`]:i(),[`${ae}`]:!(null==(n=e.node.children)?void 0:n.length)},h=G,b=ie;return r!==t.e&&d(g,t.e=r),a!==t.t&&d(_,t.t=a),t.a=c(_,o,t.a),l!==t.o&&u(_,"padding-left",t.o=l),s!==t.i&&d(p,t.i=s),t.n=c(p,v,t.n),h!==t.s&&d(m,t.s=h),b!==t.h&&d(f,t.h=b),t},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),g;var g,_,p,m,f}e(["click"]);const we="_preview_3gc71_1";var ye=i('<div role=region aria-label="Markdown preview">');const ke=new v({html:!0,linkify:!0,typographer:!0}),Se=ke.renderer.rules.image||function(e,t,i,n,r){return r.renderToken(e,t,i)};function xe(e){return t=ye(),l(i=>{var n=we,r=ke.render(e.content,{orgId:e.orgId});return n!==i.e&&d(t,i.e=n),r!==i.t&&(t.innerHTML=i.t=r),i},{e:void 0,t:void 0}),t;var t}ke.renderer.rules.image=(e,t,i,n,r)=>{const a=e[t],o=a.attrIndex("src"),l=a.attrs,d=null==n?void 0:n.orgId;if(l&&o>=0&&d){let e=l[o][1];if(e.startsWith("assets/")){const t=e.split("/");t.length>=2&&(e=`/assets/${d}/${t.slice(1).join("/")}`,l[o][1]=e)}}return Se(e,t,i,n,r)};const $e="_container_x612v_1",Ce="_tableWrapper_x612v_10",Le="_table_x612v_10",Te="_headerRow_x612v_25",ze="_headerCell_x612v_33",Ie="_row_x612v_46",Ee="_cell_x612v_55",je="_editing_x612v_69",De="_cellContent_x612v_74",Ne="_editContainer_x612v_82",Pe="_input_x612v_88",Re="_editActions_x612v_105",Be="_saveBtn_x612v_110",Ae="_cancelBtn_x612v_111",Oe="_actionsCell_x612v_132",Fe="_deleteBtn_x612v_140",Me="_addBtn_x612v_155",We="_newRow_x612v_171",Ue="_required_x612v_180",He="_empty_x612v_186",Je="_loadMore_x612v_193";var qe=i("<input type=checkbox>"),Ge=i("<select><option value>--"),Ve=i("<option>"),Ke=i("<input type=number>"),Ye=i("<input type=date>"),Qe=i("<input type=text>"),Xe=i("<tr><td><button>+"),Ze=i("<div>No records. Click + to add one."),et=i("<div><button>Load More"),tt=i("<div><div><table><thead><tr><th>Actions</th></tr></thead><tbody>"),it=i("<span>*"),nt=i("<th>"),rt=i('<button title="Delete record">‚úï'),at=i("<tr><td>"),ot=i("<div><div><button>‚úì</button><button>‚úï"),lt=i("<td>"),dt=i("<div>");function st(e){const[i,s]=t(null),[u,v]=t(""),[h,g]=t({}),_=e=>{v(e)},p=()=>{e.onAddRecord&&Object.keys(h()).length>0&&(e.onAddRecord(h()),g({}))},m=(t,i)=>{const n=((t,i)=>{const n=e.columns.find(e=>e.id===i);return n?t.data[n.name]??"":""})(t,i.id);switch(i.type){case"checkbox":return n?"‚úì":"";case"select":case"multi_select":case"number":default:return String(n);case"date":return n?new Date(n).toLocaleDateString():""}},f=(e,t)=>{switch(e.type){case"checkbox":return(u=qe()).addEventListener("change",e=>_(String(e.target.checked))),l(()=>d(u,Pe)),l(()=>u.checked=Boolean(t)),u;case"select":return(c=Ge()).firstChild,c.addEventListener("change",e=>_(e.target.value)),c.value=t,n(c,r(o,{get each(){return e.options??[]},children:e=>{return(t=Ve()).value=e,n(t,e),t;var t}}),null),l(()=>d(c,Pe)),c;case"number":return(s=Ke()).$$input=e=>_(e.target.value),s.value=t,l(()=>d(s,Pe)),s;case"date":return(a=Ye()).$$input=e=>_(e.target.value),a.value=t,l(()=>d(a,Pe)),a;default:return(i=Qe()).$$input=e=>_(e.target.value),i.value=t,l(()=>d(i,Pe)),i}var i,a,s,c,u};return b=tt(),w=b.firstChild,y=w.firstChild,k=y.firstChild,S=k.firstChild,x=S.firstChild,$=k.nextSibling,n(S,r(o,{get each(){return e.columns},children:e=>{return t=nt(),n(t,()=>e.name,null),n(t,r(a,{get when(){return e.required},get children(){var e=it();return l(()=>d(e,Ue)),e}}),null),l(()=>d(t,ze)),t;var t}}),null),n($,r(o,{get each(){return e.records},children:t=>{return h=at(),g=h.firstChild,n(g,r(a,{get when(){return e.onDeleteRecord},get children(){var i=rt();return i.$$click=()=>{var i;return null==(i=e.onDeleteRecord)?void 0:i.call(e,t.id)},l(()=>d(i,Fe)),i}})),n(h,r(o,{get each(){return e.columns},children:o=>{const h=()=>{var e,n;return(null==(e=i())?void 0:e.recordId)===t.id&&(null==(n=i())?void 0:n.columnId)===o.id};return(g=lt()).$$click=()=>((t,i)=>{var n;const r=e.columns.find(e=>e.id===i),a=(null==(n=e.records.find(e=>e.id===t))?void 0:n.data[(null==r?void 0:r.name)??""])??"";s({recordId:t,columnId:i}),v(String(a))})(t.id,o.id),n(g,r(a,{get when(){return h()},get fallback(){return e=dt(),n(e,()=>m(t,o)),l(()=>d(e,De)),e;var e},get children(){var i=ot(),r=i.firstChild,a=r.firstChild,c=a.nextSibling;return n(i,()=>f(o,u()),r),a.$$click=()=>((t,i)=>{const n=e.columns.find(e=>e.id===i);if(!n||!e.onUpdateRecord)return;const r=e.records.find(e=>e.id===t);if(!r)return;const a={...r.data};a[n.name]=u(),e.onUpdateRecord(t,a),s(null)})(t.id,o.id),c.$$click=()=>s(null),l(e=>{var t=Ne,n=Re,o=Be,l=Ae;return t!==e.e&&d(i,e.e=t),n!==e.t&&d(r,e.t=n),o!==e.a&&d(a,e.a=o),l!==e.o&&d(c,e.o=l),e},{e:void 0,t:void 0,a:void 0,o:void 0}),i}})),l(e=>{var t=Ee,i={[`${je}`]:h()};return t!==e.e&&d(g,e.e=t),e.t=c(g,i,e.t),e},{e:void 0,t:void 0}),g;var g}}),null),l(e=>{var t=Ie,i=Oe;return t!==e.e&&d(h,e.e=t),i!==e.t&&d(g,e.t=i),e},{e:void 0,t:void 0}),h;var h,g}}),null),n($,r(a,{get when(){return e.onAddRecord},get children(){var t=Xe(),i=t.firstChild,a=i.firstChild;return a.$$click=p,n(t,r(o,{get each(){return e.columns},children:e=>{return t=lt(),n(t,()=>f(e,String(h()[e.name]??""))),l(()=>d(t,Ee)),t;var t}}),null),l(e=>{var n=We,r=Oe,o=Me;return n!==e.e&&d(t,e.e=n),r!==e.t&&d(i,e.t=r),o!==e.a&&d(a,e.a=o),e},{e:void 0,t:void 0,a:void 0}),t}}),null),n(b,r(a,{get when(){return 0===e.records.length},get children(){var e=Ze();return l(()=>d(e,He)),e}}),null),n(b,r(a,{get when(){return e.hasMore},get children(){var t=et();return t.firstChild.$$click=()=>{var t;return null==(t=e.onLoadMore)?void 0:t.call(e)},l(()=>d(t,Je)),t}}),null),l(e=>{var t=$e,i=Ce,n=Le,r=Te,a=ze;return t!==e.e&&d(b,e.e=t),i!==e.t&&d(w,e.t=i),n!==e.a&&d(y,e.a=n),r!==e.o&&d(S,e.o=r),a!==e.i&&d(x,e.i=a),e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),b;var b,w,y,k,S,x,$}e(["input","click"]);const ct="_grid_xvgf8_1",ut="_card_xvgf8_8",vt="_cardHeader_xvgf8_21",ht="_deleteBtn_xvgf8_29",gt="_cardBody_xvgf8_42",_t="_field_xvgf8_48",pt="_fieldName_xvgf8_53",mt="_fieldValue_xvgf8_60";var ft=i("<div>"),bt=i("<div><div><strong></strong><button>√ó</button></div><div>"),wt=i("<div><span>:</span><span>");function yt(e){return t=ft(),n(t,r(o,{get each(){return e.records},children:t=>{return i=bt(),a=i.firstChild,s=a.firstChild,c=s.nextSibling,u=a.nextSibling,n(s,()=>String((e.columns[0]?t.data[e.columns[0].name]:null)||"Untitled")),c.$$click=()=>e.onDeleteRecord(t.id),n(u,r(o,{get each(){return e.columns.slice(1,4)},children:e=>{return i=wt(),r=i.firstChild,a=r.firstChild,o=r.nextSibling,n(r,()=>e.name,a),n(o,()=>String(t.data[e.name]||"-")),l(e=>{var t=_t,n=pt,a=mt;return t!==e.e&&d(i,e.e=t),n!==e.t&&d(r,e.t=n),a!==e.a&&d(o,e.a=a),e},{e:void 0,t:void 0,a:void 0}),i;var i,r,a,o}})),l(e=>{var t=ut,n=vt,r=ht,o=gt;return t!==e.e&&d(i,e.e=t),n!==e.t&&d(a,e.t=n),r!==e.a&&d(c,e.a=r),o!==e.o&&d(u,e.o=o),e},{e:void 0,t:void 0,a:void 0,o:void 0}),i;var i,a,s,c,u}})),l(()=>d(t,ct)),t;var t}e(["click"]);const kt="_gallery_lpkrc_1",St="_card_lpkrc_8",xt="_imageContainer_lpkrc_26",$t="_image_lpkrc_26",Ct="_imagePlaceholder_lpkrc_42",Lt="_cardContent_lpkrc_47",Tt="_cardHeader_lpkrc_51",zt="_deleteBtn_lpkrc_58",It="_cardBody_lpkrc_74",Et="_field_lpkrc_78",jt="_fieldName_lpkrc_86",Dt="_fieldValue_lpkrc_92";var Nt=i("<div>"),Pt=i("<div><div><div><strong></strong><button>‚úï</button></div><div>"),Rt=i("<img>"),Bt=i("<div>No Image"),At=i("<div><span>:</span><span>");function Ot(e){return t=Nt(),n(t,r(o,{get each(){return e.records},children:t=>{const i=e.columns.find(e=>e.name.toLowerCase().includes("image")||e.name.toLowerCase().includes("cover")||e.name.toLowerCase().includes("url"));return s=Pt(),c=s.firstChild,u=c.firstChild,v=u.firstChild,g=v.nextSibling,_=u.nextSibling,n(s,r(a,{when:i,children:i=>{return o=Nt(),n(o,r(a,{get when(){return t.data[i().name]},get fallback(){return e=Bt(),l(()=>d(e,Ct)),e;var e},get children(){var n=Rt();return l(r=>{var a=String(t.data[i().name]),o=String((e.columns[0]?t.data[e.columns[0].name]:null)||"Record"),l=$t;return a!==r.e&&h(n,"src",r.e=a),o!==r.t&&h(n,"alt",r.t=o),l!==r.a&&d(n,r.a=l),r},{e:void 0,t:void 0,a:void 0}),n}})),l(()=>d(o,xt)),o;var o}}),c),n(v,()=>String((e.columns[0]?t.data[e.columns[0].name]:null)||"Untitled")),g.$$click=()=>e.onDeleteRecord(t.id),n(_,r(o,{get each(){return e.columns.slice(1,3)},children:e=>{return i=At(),r=i.firstChild,a=r.firstChild,o=r.nextSibling,n(r,()=>e.name,a),n(o,()=>String(t.data[e.name]||"-")),l(e=>{var t=Et,n=jt,a=Dt;return t!==e.e&&d(i,e.e=t),n!==e.t&&d(r,e.t=n),a!==e.a&&d(o,e.a=a),e},{e:void 0,t:void 0,a:void 0}),i;var i,r,a,o}})),l(e=>{var t=St,i=Lt,n=Tt,r=zt,a=It;return t!==e.e&&d(s,e.e=t),i!==e.t&&d(c,e.t=i),n!==e.a&&d(u,e.a=n),r!==e.o&&d(g,e.o=r),a!==e.i&&d(_,e.i=a),e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),s;var s,c,u,v,g,_}})),l(()=>d(t,kt)),t;var t}e(["click"]);const Ft="_board_1et8f_1",Mt="_noGroup_1et8f_7",Wt="_columns_1et8f_16",Ut="_column_1et8f_16",Ht="_columnHeader_1et8f_32",Jt="_columnName_1et8f_39",qt="_columnCount_1et8f_47",Gt="_cards_1et8f_56",Vt="_card_1et8f_56",Kt="_cardHeader_1et8f_76",Yt="_deleteBtn_1et8f_90",Qt="_cardBody_1et8f_104",Xt="_field_1et8f_108",Zt="_fieldName_1et8f_114",ei="_fieldValue_1et8f_119";var ti=i("<div>"),ii=i('<div>Add a "select" column to group by status.'),ni=i("<div><div><span></span><span></span></div><div>"),ri=i("<div><div><strong></strong><button>√ó</button></div><div>"),ai=i("<div><span>:</span><span>");function oi(e){const t=()=>e.columns.find(e=>"select"===e.type||"multi_select"===e.type),i=g(()=>{const i=t();if(!i)return[{name:"All Records",records:e.records}];const n=i.options||[],r={};return n.forEach(e=>{r[e]={name:e,records:[]}}),r.__none__={name:"No "+i.name,records:[]},e.records.forEach(e=>{const t=e.data[i.name];if(t&&"string"==typeof t&&n.includes(t)){const i=r[t];i&&i.records.push(e)}else{const t=r.__none__;t&&t.records.push(e)}}),Object.values(r).filter(e=>e.records.length>0||n.includes(e.name))});return s=ti(),n(s,r(a,{get when(){return t()},get fallback(){return e=ii(),l(()=>d(e,Mt)),e;var e},get children(){var a=ti();return n(a,r(o,{get each(){return i()},children:i=>{return a=ni(),s=a.firstChild,c=s.firstChild,u=c.nextSibling,v=s.nextSibling,n(c,()=>i.name),n(u,()=>i.records.length),n(v,r(o,{get each(){return i.records},children:i=>{return a=ri(),s=a.firstChild,c=s.firstChild,u=c.nextSibling,v=s.nextSibling,n(c,()=>String((e.columns[0]?i.data[e.columns[0].name]:null)||"Untitled")),u.$$click=()=>e.onDeleteRecord(i.id),n(v,r(o,{get each(){return e.columns.slice(1,4).filter(e=>{var i;return e.id!==(null==(i=t())?void 0:i.id)})},children:e=>{return t=ai(),r=t.firstChild,a=r.firstChild,o=r.nextSibling,n(r,()=>e.name,a),n(o,()=>String(i.data[e.name]||"-")),l(e=>{var i=Xt,n=Zt,a=ei;return i!==e.e&&d(t,e.e=i),n!==e.t&&d(r,e.t=n),a!==e.a&&d(o,e.a=a),e},{e:void 0,t:void 0,a:void 0}),t;var t,r,a,o}})),l(e=>{var t=Vt,i=Kt,n=Yt,r=Qt;return t!==e.e&&d(a,e.e=t),i!==e.t&&d(s,e.t=i),n!==e.a&&d(u,e.a=n),r!==e.o&&d(v,e.o=r),e},{e:void 0,t:void 0,a:void 0,o:void 0}),a;var a,s,c,u,v}})),l(e=>{var t=Ut,i=Ht,n=Jt,r=qt,o=Gt;return t!==e.e&&d(a,e.e=t),i!==e.t&&d(s,e.t=i),n!==e.a&&d(c,e.a=n),r!==e.o&&d(u,e.o=r),o!==e.i&&d(v,e.i=o),e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),a;var a,s,c,u,v}})),l(()=>d(a,Wt)),a}})),l(()=>d(s,Ft)),s;var s}e(["click"]);const li="_settings_1crze_1",di="_header_1crze_7",si="_closeButton_1crze_16",ci="_section_1crze_28",ui="_table_1crze_38",vi="_roleSelect_1crze_56",hi="_error_1crze_62",gi="_success_1crze_70",_i="_tabs_1crze_79",pi="_activeTab_1crze_101",mi="_settingsForm_1crze_106",fi="_formItem_1crze_113",bi="_checkboxLabel_1crze_133",wi="_saveButton_1crze_146",yi="_hint_1crze_165",ki="_inviteSection_1crze_171",Si="_inviteForm_1crze_175",xi="_formGroup_1crze_186";var $i=i("<div>"),Ci=i("<table><thead><tr><th>Name</th><th>Email</th><th>Role</th></tr></thead><tbody>"),Li=i("<h4>Pending Invitations"),Ti=i("<table><thead><tr><th>Email</th><th>Role</th><th>Sent</th></tr></thead><tbody>"),zi=i('<div><form><h4>Invite new member</h4><div><input type=email placeholder="Email address"required><select><option value=admin>Admin</option><option value=editor>Editor</option><option value=viewer>Viewer</option></select><button type=submit>Invite'),Ii=i("<section><h3>Members"),Ei=i("<section><h3>Personal Settings</h3><form><div><label>Theme</label><select><option value=light>Light</option><option value=dark>Dark</option><option value=system>System</option></select></div><div><label>Language</label><select><option value=en>English</option><option value=fr>French</option><option value=de>German</option><option value=es>Spanish</option></select></div><div><label><input type=checkbox>Enable notifications for this workspace</label></div><button type=submit>Save Changes"),ji=i('<form><div><label>Organization Name</label><input type=text disabled title="Rename is not supported yet"></div><div><label><input type=checkbox>Allow public access (Read-only)</label></div><div><label>Allowed Email Domains (comma separated)</label><input type=text placeholder="example.com, company.org"><p>Users with these email domains can join automatically.</p></div><button type=submit>Save Workspace Settings'),Di=i("<section><h3>Workspace Settings"),Ni=i("<div><header><h2>Settings</h2><button>&times;</button></header><div><button>Members</button><button>Personal</button><button>Workspace"),Pi=i("<p>Only admins can view member list."),Ri=i("<select><option value=admin>Admin</option><option value=editor>Editor</option><option value=viewer>Viewer"),Bi=i("<tr><td></td><td></td><td>"),Ai=i("<p>Only admins can modify workspace settings.");function Oi(e){const[i,s]=t("members"),[c,u]=t([]),[v,h]=t([]),[g,p]=t(""),[m,f]=t("viewer"),[b,w]=t("light"),[y,k]=t("en"),[S,x]=t(!0);_(()=>{var t,i;w((null==(t=e.user.settings)?void 0:t.theme)||"light"),k((null==(i=e.user.settings)?void 0:i.language)||"en")});const[$,C]=t(""),[L,T]=t(!1),[z,I]=t(""),[E,j]=t(!1),[D,N]=t(null),[P,R]=t(null),B=async(t,i={})=>{var n;let r=t;t.startsWith("/api/")&&!t.startsWith("/api/auth/")&&(r=`/api/${e.user.organization_id}${t.substring(4)}`);const a=await fetch(r,{...i,headers:{...i.headers,Authorization:`Bearer ${e.token}`}});if(!a.ok){const e=await a.json();throw new Error((null==(n=e.error)?void 0:n.message)||e.error||"Request failed")}return a},A=async()=>{var t,n,r,a,o,l,d;try{j(!0),N(null);const s=[];if("members"===i()&&"admin"===e.user.role&&(s.push(B("/api/users")),s.push(B("/api/invitations"))),"workspace"===i()&&s.push(B("/api/settings/organization")),0===s.length)return;const c=await Promise.all(s);if("members"===i()&&"admin"===e.user.role){const e=await c[0].json(),i=await c[1].json();u((null==(t=e.users)?void 0:t.filter(Boolean))||[]),h((null==(n=i.invitations)?void 0:n.filter(Boolean))||[])}if("workspace"===i()){const e=await c[c.length-1].json();C(e.name),T((null==(r=e.settings)?void 0:r.public_access)||!1),I((null==(o=null==(a=e.settings)?void 0:a.allowed_domains)?void 0:o.join(", "))||"")}const v=null==(l=e.user.memberships)?void 0:l.find(t=>t.organization_id===e.user.organization_id);v&&x((null==(d=v.settings)?void 0:d.notifications)??!0)}catch(s){N("Failed to load settings: "+s)}finally{j(!1)}};_(()=>{A()});const O=async e=>{if(e.preventDefault(),g())try{j(!0),await B("/api/invitations",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:g(),role:m()})}),p(""),R("Invitation sent successfully"),A()}catch(t){N("Failed to send invitation: "+t)}finally{j(!1)}},F=async e=>{e.preventDefault();try{j(!0),N(null),R(null);const e={theme:b(),language:y()},t={notifications:S()};await Promise.all([B("/api/auth/settings",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({settings:e})}),B("/api/settings/membership",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({settings:t})})]),R("Personal settings saved successfully")}catch(t){N("Failed to save settings: "+t)}finally{j(!1)}},M=async e=>{e.preventDefault();try{j(!0),N(null),R(null);const e={public_access:L(),allowed_domains:z()?z().split(",").map(e=>e.trim()):[]};await B("/api/settings/organization",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({settings:e})}),R("Workspace settings saved successfully")}catch(t){N("Failed to save workspace settings: "+t)}finally{j(!1)}};return W=Ni(),U=W.firstChild,H=U.firstChild.nextSibling,J=U.nextSibling,q=J.firstChild,G=q.nextSibling,V=G.nextSibling,H.$$click=()=>e.onClose(),q.$$click=()=>s("members"),G.$$click=()=>s("personal"),V.$$click=()=>s("workspace"),n(W,r(a,{get when(){return D()},get children(){var e=$i();return n(e,D),l(()=>d(e,hi)),e}}),null),n(W,r(a,{get when(){return P()},get children(){var e=$i();return n(e,P),l(()=>d(e,gi)),e}}),null),n(W,r(a,{get when(){return"members"===i()},get children(){var t=Ii();return t.firstChild,n(t,r(a,{get when(){return"admin"===e.user.role},get fallback(){return Pi()},get children(){return[(b=Ci(),w=b.firstChild.nextSibling,n(w,r(o,{get each(){return c()},children:t=>{return i=Bi(),o=i.firstChild,s=o.nextSibling,c=s.nextSibling,n(o,()=>t.name),n(s,()=>t.email),n(c,r(a,{get when(){return t.id!==e.user.id},get fallback(){return t.role},get children(){var e=Ri();return e.addEventListener("change",e=>(async(e,t)=>{try{j(!0),await B("/api/users/role",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:e,role:t})}),R("Role updated"),A()}catch(i){N("Failed to update role: "+i)}finally{j(!1)}})(t.id,e.target.value)),l(()=>d(e,vi)),l(()=>e.value=t.role),e}})),i;var i,o,s,c}})),l(()=>d(b,ui)),b),(t=zi(),i=t.firstChild,s=i.firstChild.nextSibling,u=s.firstChild,h=u.nextSibling,_=h.nextSibling,i.addEventListener("submit",O),u.$$input=e=>p(e.target.value),h.addEventListener("change",e=>f(e.target.value)),n(t,r(a,{get when(){return v().length>0},get children(){return[Li(),(e=Ti(),t=e.firstChild.nextSibling,n(t,r(o,{get each(){return v()},children:e=>{return t=Bi(),i=t.firstChild,r=i.nextSibling,a=r.nextSibling,n(i,()=>e.email),n(r,()=>e.role),n(a,()=>new Date(e.created).toLocaleDateString()),t;var t,i,r,a}})),l(()=>d(e,ui)),e)];var e,t}}),null),l(e=>{var n=ki,r=Si,a=xi,o=E();return n!==e.e&&d(t,e.e=n),r!==e.t&&d(i,e.t=r),a!==e.a&&d(s,e.a=a),o!==e.o&&(_.disabled=e.o=o),e},{e:void 0,t:void 0,a:void 0,o:void 0}),l(()=>u.value=g()),l(()=>h.value=m()),t)];var t,i,s,u,h,_,b,w}}),null),l(()=>d(t,ci)),t}}),null),n(W,r(a,{get when(){return"personal"===i()},get children(){var e=Ei(),t=e.firstChild.nextSibling,i=t.firstChild,n=i.firstChild.nextSibling,r=i.nextSibling,a=r.firstChild.nextSibling,o=r.nextSibling,s=o.firstChild,c=s.firstChild,u=o.nextSibling;return t.addEventListener("submit",F),n.addEventListener("change",e=>w(e.target.value)),a.addEventListener("change",e=>k(e.target.value)),c.addEventListener("change",e=>x(e.currentTarget.checked)),l(n=>{var a=ci,l=mi,c=fi,v=fi,h=fi,g=bi,_=wi,p=E();return a!==n.e&&d(e,n.e=a),l!==n.t&&d(t,n.t=l),c!==n.a&&d(i,n.a=c),v!==n.o&&d(r,n.o=v),h!==n.i&&d(o,n.i=h),g!==n.n&&d(s,n.n=g),_!==n.s&&d(u,n.s=_),p!==n.h&&(u.disabled=n.h=p),n},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),l(()=>n.value=b()),l(()=>a.value=y()),l(()=>c.checked=S()),e}}),null),n(W,r(a,{get when(){return"workspace"===i()},get children(){var t=Di();return t.firstChild,n(t,r(a,{get when(){return"admin"===e.user.role},get fallback(){return Ai()},get children(){var e=ji(),t=e.firstChild,i=t.firstChild.nextSibling,n=t.nextSibling,r=n.firstChild,a=r.firstChild,o=n.nextSibling,s=o.firstChild.nextSibling,c=s.nextSibling,u=o.nextSibling;return e.addEventListener("submit",M),i.$$input=e=>C(e.target.value),a.addEventListener("change",e=>T(e.currentTarget.checked)),s.$$input=e=>I(e.target.value),l(i=>{var a=mi,l=fi,s=fi,v=bi,h=fi,g=yi,_=wi,p=E();return a!==i.e&&d(e,i.e=a),l!==i.t&&d(t,i.t=l),s!==i.a&&d(n,i.a=s),v!==i.o&&d(r,i.o=v),h!==i.i&&d(o,i.i=h),g!==i.n&&d(c,i.n=g),_!==i.s&&d(u,i.s=_),p!==i.h&&(u.disabled=i.h=p),i},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),l(()=>i.value=$()),l(()=>a.checked=L()),l(()=>s.value=z()),e}}),null),l(()=>d(t,ci)),t}}),null),l(e=>{var t=li,n=di,r=si,a=_i,o="members"===i()?pi:"",l="personal"===i()?pi:"",s="workspace"===i()?pi:"";return t!==e.e&&d(W,e.e=t),n!==e.t&&d(U,e.t=n),r!==e.a&&d(H,e.a=r),a!==e.o&&d(J,e.o=a),o!==e.i&&d(q,e.i=o),l!==e.n&&d(G,e.n=l),s!==e.s&&d(V,e.s=s),e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),W;var W,U,H,J,q,G,V}e(["click","input"]);const Fi="_authContainer_vwl2g_1",Mi="_authForm_vwl2g_9",Wi="_formGroup_vwl2g_25",Ui="_error_vwl2g_63",Hi="_toggle_vwl2g_72",Ji="_oauthSection_vwl2g_94",qi="_divider_vwl2g_98",Gi="_oauthButtons_vwl2g_117",Vi="_googleButton_vwl2g_123",Ki="_microsoftButton_vwl2g_124";var Yi=i("<div><label for=name>Name</label><input id=name name=name type=text required autocomplete=name>"),Qi=i("<div><form><h2></h2><div><label for=email>Email</label><input id=email name=email type=email required autocomplete=email></div><div><label for=password>Password</label><input id=password name=password type=password required></div><button type=submit></button><div><div><span>or</span></div><div><a href=/api/auth/oauth/google>Login with Google</a><a href=/api/auth/oauth/microsoft>Login with Microsoft</a></div></div><p><button type=button>"),Xi=i("<div>");function Zi(e){const[i,o]=t(!1),[c,u]=t(""),[v,g]=t(""),[_,p]=t(""),[m,f]=t(null),[b,w]=t(!1),y=async t=>{var n;t.preventDefault(),f(null),w(!0);const r=i()?"/api/auth/register":"/api/auth/login",a=i()?{email:c(),password:v(),name:_()}:{email:c(),password:v()};try{const t=await fetch(r,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}),i=await t.json();if(!t.ok){return void f((null==(n=i.error)?void 0:n.message)||"Authentication failed")}i.token&&i.user?e.onLogin(i.token,i.user):f("Invalid response from server")}catch(o){f("An error occurred. Please try again.")}finally{w(!1)}};return x=Qi(),$=x.firstChild,C=$.firstChild,L=C.nextSibling,T=L.firstChild.nextSibling,z=L.nextSibling,I=z.firstChild.nextSibling,E=z.nextSibling,j=E.nextSibling,D=j.firstChild,N=D.nextSibling,P=N.firstChild,R=P.nextSibling,B=j.nextSibling,A=B.firstChild,$.addEventListener("submit",y),n(C,()=>i()?"Create Account":"Login to mddb"),n($,(k=s(()=>!!m()),()=>{return k()&&(e=Xi(),n(e,m),l(()=>d(e,Ui)),e);var e}),L),n($,r(a,{get when(){return i()},get children(){var e=Yi(),t=e.firstChild.nextSibling;return t.$$input=e=>p(e.target.value),l(()=>d(e,Wi)),l(()=>t.value=_()),e}}),L),T.$$input=e=>u(e.target.value),I.$$input=e=>g(e.target.value),n(E,(S=s(()=>!!b()),()=>S()?"Please wait...":i()?"Register":"Login")),n(B,()=>i()?"Already have an account?":"Don't have an account?",A),A.$$click=()=>o(!i()),n(A,()=>i()?"Login":"Register"),l(e=>{var t=Fi,n=Mi,r=Wi,a=Wi,o=i()?"new-password":"current-password",l=b(),s=Ji,c=qi,u=Gi,v=Vi,g=Ki,_=Hi;return t!==e.e&&d(x,e.e=t),n!==e.t&&d($,e.t=n),r!==e.a&&d(L,e.a=r),a!==e.o&&d(z,e.o=a),o!==e.i&&h(I,"autocomplete",e.i=o),l!==e.n&&(E.disabled=e.n=l),s!==e.s&&d(j,e.s=s),c!==e.h&&d(D,e.h=c),u!==e.r&&d(N,e.r=u),v!==e.d&&d(P,e.d=v),g!==e.l&&d(R,e.l=g),_!==e.u&&d(B,e.u=_),e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0}),l(()=>T.value=c()),l(()=>I.value=v()),x;var k,S,x,$,C,L,T,z,I,E,j,D,N,P,R,B,A}e(["input","click"]);var en=i("<select>"),tn=i("<span>"),nn=i("<p>Loading..."),rn=i("<nav>"),an=i("<div>"),on=i("<span>‚óè Unsaved"),ln=i("<span>‚ü≥ Saving..."),dn=i("<span>‚úì Saved"),sn=i("<li>No history available"),cn=i("<div><h3>Version History</h3><ul>"),un=i('<div><textarea placeholder="Write your content in markdown...">'),vn=i("<div><div><h3>Database Records</h3><div><button>Table</button><button>Grid</button><button>Gallery</button><button>Board"),hn=i("<div><div><input type=text placeholder=Title><div></div><div><button></button><button></button><button>Delete</button></div></div><div>"),gn=i('<div><header><div><h1>mddb</h1><p>A seamless markdown-based document and database system</p></div><div><span> (<!>)</span><button>Logout</button></div></header><div><aside><div><h2>Workspace</h2><div><button title="Workspace Settings">‚öô</button><button title="New Page">+P</button><button title="New Database">+D</button></div></div><ul></ul></aside><main>'),_n=i("<option>"),pn=i("<span>/"),mn=i("<div><h2>Welcome to mddb</h2><p>Select a node from the sidebar or create a new one to get started.</p><div><input type=text placeholder=Title><div><button>Create Page</button><button>Create Database"),fn=i("<li><div><span></span><span></span></div><div>");const bn=e=>e.toString().toLowerCase().trim().replace(/\s+/g,"-").replace(/[^\w-]+/g,"").replace(/--+/g,"-");function wn(){const[e,i]=t(null),[u,v]=t(localStorage.getItem("mddb_token")),[h,g]=t([]),[f,j]=t([]),[G,ee]=t(null),[te,ie]=t(!1),[ne,re]=t("table"),[ae,me]=t(""),[fe,we]=t(""),[ye,ke]=t(!1),[Se,$e]=t(null),[Ce,Le]=t(!1),[Te,ze]=t("idle"),[Ie,Ee]=t(!1),[je,De]=t([]),[Ne,Pe]=t(!1),Re=async(t,i={})=>{var n;let r=t;if(t.startsWith("/api/")&&!t.startsWith("/api/auth/")&&!t.startsWith("/api/health")){const i=null==(n=e())?void 0:n.organization_id;i&&(r=`/api/${i}${t.substring(4)}`)}const a={...i.headers,Authorization:`Bearer ${u()}`},o=await fetch(r,{...i,headers:a});if(401===o.status)throw Be(),new Error("Session expired");return o},Be=()=>{localStorage.removeItem("mddb_token"),v(null),i(null),window.history.pushState(null,"","/")},Ae=(e,t)=>{localStorage.setItem("mddb_token",e),v(e),i(t)};async function Oe(e,t=!0){try{ke(!0);const i=await Re("/api/auth/switch-org",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({org_id:e})}),n=await i.json();Ae(n.token,n.user),ee(null),t&&window.history.pushState(null,"","/"),await We()}catch(i){throw $e("Failed to switch organization: "+i),i}finally{ke(!1)}}const Fe=function(e,t){let i=null;return(...n)=>{null!==i&&clearTimeout(i),i=setTimeout(()=>{e(...n),i=null},t)}}(async()=>{var t;const i=G();if(i&&Ce())try{ze("saving"),await Re(`/api/pages/${i}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:ae(),content:fe()})}),Le(!1),ze("saved");const n=bn(ae()),r=null==(t=e())?void 0:t.organization_id;if(r){const e=window.location.pathname,t=`/${r}/${i}${n?"-"+n:""}`;e!==t&&window.history.replaceState(null,"",t)}setTimeout(()=>{"saved"===Te()&&ze("idle")},2e3)}catch(n){$e("Auto-save failed: "+n),ze("idle")}},2e3);_(()=>{const t=new URLSearchParams(window.location.search).get("token");t&&(localStorage.setItem("mddb_token",t),v(t),window.history.replaceState({},document.title,window.location.pathname));const n=u(),r=e();if(n&&!r){(async()=>{try{const e=await Re("/api/auth/me");if(e.ok){const t=await e.json();i(t)}}catch(e){console.error("Failed to load user",e)}})()}});const Me=async()=>{var t,i,n;const r=window.location.pathname.match(/^\/([^/]+)\/(\d+)(?:-.*)?$/);if(r){const o=r[1],l=r[2];if(e()&&(null==(t=e())?void 0:t.organization_id)!==o)try{if(!(null==(n=null==(i=e())?void 0:i.memberships)?void 0:n.some(e=>e.organization_id===o)))return void $e(`You do not have access to organization ${o}`);await Oe(o,!1)}catch(a){return}return void(l!==G()&&Ue(l,!1))}ee(null),me(""),we("")};async function We(){var e;try{ke(!0);const t=await Re("/api/nodes"),i=await t.json();g((null==(e=i.nodes)?void 0:e.filter(Boolean))||[]),$e(null)}catch(t){$e("Failed to load nodes: "+t)}finally{ke(!1)}}async function Ue(t,i=!0){var n;try{ke(!0),Ee(!1);const r=await Re(`/api/nodes/${t}`);if(!r.ok)throw new Error("Node not found");const a=await r.json();ee(a.id),me(a.title),we(a.content||""),Le(!1),ze("idle"),$e(null);const o=bn(a.title),l=null==(n=e())?void 0:n.organization_id;if(l){const e=`/${l}/${a.id}${o?"-"+o:""}`;i?window.location.pathname!==e&&window.history.pushState(null,"",e):window.location.pathname!==e&&window.history.replaceState(null,"",e)}if("database"===a.type||"hybrid"===a.type){const e=await Re(`/api/databases/${t}/records?offset=0&limit=50`),i=(await e.json()).records||[];j(i),Pe(50===i.length)}else j([]),Pe(!1)}catch(r){$e("Failed to load node: "+r)}finally{ke(!1)}}async function He(e="document"){if(ae().trim())try{ke(!0);const t=await Re("/api/nodes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:ae(),type:e})}),i=await t.json();await We(),Ue(i.id),me(""),we(""),Le(!1),ze("idle"),$e(null)}catch(t){$e("Failed to create node: "+t)}finally{ke(!1)}else $e("Title is required")}async function Je(){const e=G();if(e)try{ke(!0),await Re(`/api/pages/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:ae(),content:fe()})}),await We(),Le(!1),ze("idle"),$e(null);const t=bn(ae()),i=window.location.pathname,n=`/${e}${t?"-"+t:""}`;i!==n&&window.history.replaceState(null,"",n)}catch(t){$e("Failed to save node: "+t)}finally{ke(!1)}}async function qe(){const e=G();if(e&&confirm("Are you sure you want to delete this node?"))try{ke(!0),await Re(`/api/pages/${e}`,{method:"DELETE"}),await We(),ee(null),me(""),we(""),Le(!1),ze("idle"),$e(null),window.history.pushState(null,"","/")}catch(t){$e("Failed to delete node: "+t)}finally{ke(!1)}}p(()=>{window.addEventListener("popstate",Me),m(()=>window.removeEventListener("popstate",Me))}),_(()=>{e()&&(We(),Me())});const Ge=e=>{Ue(e.id)};async function Ve(e){const t=G();if(t)try{ke(!0);if(!(await Re(`/api/databases/${t}/records`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({data:e})})).ok)return void $e("Failed to create record");Ue(t),$e(null)}catch(i){$e("Failed to add record: "+i)}finally{ke(!1)}}async function Ke(e){const t=G();if(t&&confirm("Delete this record?"))try{ke(!0),await Re(`/api/databases/${t}/records/${e}`,{method:"DELETE"}),Ue(t),$e(null)}catch(i){$e("Failed to delete record: "+i)}finally{ke(!1)}}async function Ye(){const e=G();if(e&&!ye())try{ke(!0);const t=f().length,i=await Re(`/api/databases/${e}/records?offset=${t}&limit=50`),n=(await i.json()).records||[];j([...f(),...n]),Pe(50===n.length)}catch(t){$e("Failed to load more records: "+t)}finally{ke(!1)}}return r(a,{get when(){return e()},get fallback(){return r(Zi,{onLogin:Ae})},get children(){var t=gn(),i=t.firstChild,v=i.firstChild,g=v.nextSibling,_=g.firstChild,p=_.firstChild,m=p.nextSibling;m.nextSibling;var j=_.nextSibling,ze=i.nextSibling,Pe=ze.firstChild,Ae=Pe.firstChild,Me=Ae.firstChild.nextSibling,We=Me.firstChild,Ue=We.nextSibling,Qe=Ue.nextSibling,Xe=Ae.nextSibling,Ze=Pe.nextSibling;return n(g,r(a,{get when(){var t,i;return((null==(i=null==(t=e())?void 0:t.memberships)?void 0:i.length)??0)>1},get children(){var t=en();return t.addEventListener("change",e=>Oe(e.target.value)),n(t,r(o,{get each(){var t;return null==(t=e())?void 0:t.memberships},children:e=>{return t=_n(),n(t,()=>e.organization_name||e.organization_id),l(()=>t.value=e.organization_id),t;var t}})),l(()=>d(t,x)),l(()=>{var i;return t.value=null==(i=e())?void 0:i.organization_id}),t}}),_),n(g,r(a,{get when(){var t,i;return 1===(null==(i=null==(t=e())?void 0:t.memberships)?void 0:i.length)},get children(){var t=tn();return n(t,()=>{var t,i,n;return(null==(n=null==(i=null==(t=e())?void 0:t.memberships)?void 0:i[0])?void 0:n.organization_name)||"My Org"}),l(()=>d(t,$)),t}}),_),n(_,()=>{var t;return null==(t=e())?void 0:t.name},p),n(_,()=>{var t;return null==(t=e())?void 0:t.role},m),j.$$click=Be,We.$$click=()=>{ie(!0),ee(null)},Ue.$$click=()=>{ie(!1),He("document")},Qe.$$click=()=>{ie(!1),He("database")},n(Pe,r(a,{get when(){return s(()=>!!ye())()&&0===h().length},fallback:null,get children(){var e=nn();return l(()=>d(e,I)),e}}),Xe),n(Xe,r(o,{get each(){return h()},children:e=>r(be,{node:e,get selectedId(){return G()},onSelect:Ge,depth:0})})),n(Ze,r(a,{get when(){return s(()=>!(!te()||!e()))()&&u()},get children(){return r(Oi,{get user(){return e()},get token(){return u()},onClose:()=>ie(!1)})}}),null),n(Ze,r(a,{get when(){return!te()},get children(){return[r(a,{get when(){return G()},get children(){var e=rn();return n(e,r(o,{get each(){return(e=>{if(!e)return[];const t=[],i=(e,n)=>{for(const r of e){if(r.id===n)return t.push(r),!0;if(r.children&&i(r.children,n))return t.unshift(r),!0}return!1};return i(h(),e),t})(G())},children:(e,t)=>{return[r(a,{get when(){return t()>0},get children(){var e=pn();return l(()=>d(e,de)),e}}),(i=tn(),i.$$click=()=>Ge(e),n(i,()=>e.title),l(()=>d(i,le)),i)];var i}})),l(()=>d(e,oe)),e}}),r(a,{get when(){return Se()},fallback:null,get children(){var e=an();return n(e,Se),l(()=>d(e,N)),e}}),r(a,{get when(){return G()},get fallback(){return e=mn(),t=e.firstChild.nextSibling.nextSibling,i=t.firstChild,n=i.nextSibling,r=n.firstChild,a=r.nextSibling,i.$$input=e=>me(e.target.value),r.$$click=()=>He("document"),a.$$click=()=>He("database"),l(o=>{var l=P,s=R,c=U,u=V,v=J,h=J;return l!==o.e&&d(e,o.e=l),s!==o.t&&d(t,o.t=s),c!==o.a&&d(i,o.a=c),u!==o.o&&d(n,o.o=u),v!==o.i&&d(r,o.i=v),h!==o.n&&d(a,o.n=h),o},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0}),l(()=>i.value=ae()),e;var e,t,i,n,r,a},get children(){var t=hn(),i=t.firstChild,s=i.firstChild,u=s.nextSibling,v=u.nextSibling,g=v.firstChild,_=g.nextSibling,p=_.nextSibling,m=i.nextSibling;return s.$$input=e=>{me(e.target.value),Le(!0),Fe()},n(u,r(a,{get when(){return Ce()},get children(){var e=on();return l(()=>d(e,F)),e}}),null),n(u,r(a,{get when(){return"saving"===Te()},get children(){var e=ln();return l(()=>d(e,M)),e}}),null),n(u,r(a,{get when(){return"saved"===Te()},get children(){var e=dn();return l(()=>d(e,W)),e}}),null),g.$$click=()=>{const e=G();e&&async function(e){var t;if(Ie())Ee(!1);else try{ke(!0);const i=await Re(`/api/pages/${e}/history`),n=await i.json();De((null==(t=n.history)?void 0:t.filter(Boolean))||[]),Ee(!0)}catch(i){$e("Failed to load history: "+i)}finally{ke(!1)}}(e)},n(g,()=>Ie()?"Hide History":"History"),_.$$click=Je,n(_,()=>ye()?"Saving...":"Save"),p.$$click=qe,n(t,r(a,{get when(){return Ie()},get children(){var e=cn(),t=e.firstChild.nextSibling;return n(t,r(o,{get each(){return je()},children:e=>{return t=fn(),i=t.firstChild,r=i.firstChild,a=r.nextSibling,o=i.nextSibling,t.$$click=()=>{const t=G();t&&async function(e,t){if(confirm("This will replace current editor content with the selected version. Unsaved changes will be lost. Continue?"))try{ke(!0);const i=await Re(`/api/pages/${e}/history/${t}`),n=await i.json();we(n.content),Le(!0),Ee(!1)}catch(i){$e("Failed to load version: "+i)}finally{ke(!1)}}(t,e.hash)},n(r,()=>new Date(e.timestamp).toLocaleString()),n(a,()=>e.hash.substring(0,7)),n(o,()=>e.message),l(e=>{var n=ve,l=he,s=ge,c=_e,u=pe;return n!==e.e&&d(t,e.e=n),l!==e.t&&d(i,e.t=l),s!==e.a&&d(r,e.a=s),c!==e.o&&d(a,e.o=c),u!==e.i&&d(o,e.i=u),e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),t;var t,i,r,a,o}}),null),n(t,r(a,{get when(){return 0===je().length},get children(){var e=sn();return l(()=>d(e,ve)),e}}),null),l(i=>{var n=ce,r=ue;return n!==i.e&&d(e,i.e=n),r!==i.t&&d(t,i.t=r),i},{e:void 0,t:void 0}),e}}),m),n(m,r(a,{get when(){var e;return"database"!==(null==(e=h().find(e=>e.id===G()))?void 0:e.type)},get children(){var t=un(),i=t.firstChild;return i.$$input=e=>{we(e.target.value),Le(!0),Fe()},n(t,r(xe,{get content(){return fe()},get orgId(){var t;return null==(t=e())?void 0:t.organization_id}}),null),l(e=>{var n=Y,r=se;return n!==e.e&&d(t,e.e=n),r!==e.t&&d(i,e.t=r),e},{e:void 0,t:void 0}),l(()=>i.value=fe()),t}}),null),n(m,r(a,{get when(){var e;return"document"!==(null==(e=h().find(e=>e.id===G()))?void 0:e.type)},get children(){var e=vn(),t=e.firstChild,i=t.firstChild.nextSibling,o=i.firstChild,s=o.nextSibling,u=s.nextSibling,v=u.nextSibling;return o.$$click=()=>re("table"),s.$$click=()=>re("grid"),u.$$click=()=>re("gallery"),v.$$click=()=>re("board"),n(e,r(a,{get when(){return"table"===ne()},get children(){return r(st,{get databaseId(){return G()||""},get columns(){var e;return(null==(e=h().find(e=>e.id===G()))?void 0:e.columns)||[]},get records(){return f()},onAddRecord:Ve,onDeleteRecord:Ke,onLoadMore:Ye,get hasMore(){return Ne()}})}}),null),n(e,r(a,{get when(){return"grid"===ne()},get children(){return r(yt,{get records(){return f()},get columns(){var e;return(null==(e=h().find(e=>e.id===G()))?void 0:e.columns)||[]},onDeleteRecord:Ke})}}),null),n(e,r(a,{get when(){return"gallery"===ne()},get children(){return r(Ot,{get records(){return f()},get columns(){var e;return(null==(e=h().find(e=>e.id===G()))?void 0:e.columns)||[]},onDeleteRecord:Ke})}}),null),n(e,r(a,{get when(){return"board"===ne()},get children(){return r(oi,{get records(){return f()},get columns(){var e;return(null==(e=h().find(e=>e.id===G()))?void 0:e.columns)||[]},onDeleteRecord:Ke})}}),null),l(n=>{var r=Q,a=X,l=Z,h={[`${T}`]:"table"===ne()},g={[`${T}`]:"grid"===ne()},_={[`${T}`]:"gallery"===ne()},p={[`${T}`]:"board"===ne()};return r!==n.e&&d(e,n.e=r),a!==n.t&&d(t,n.t=a),l!==n.a&&d(i,n.a=l),n.o=c(o,h,n.o),n.i=c(s,g,n.i),n.n=c(u,_,n.n),n.s=c(v,p,n.s),n},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),e}}),null),l(e=>{var n=B,r=A,a=U,o=O,l=H,c=ye(),h=ye(),f=ye(),b=K;return n!==e.e&&d(t,e.e=n),r!==e.t&&d(i,e.t=r),a!==e.a&&d(s,e.a=a),o!==e.o&&d(u,e.o=o),l!==e.i&&d(v,e.i=l),c!==e.n&&(g.disabled=e.n=c),h!==e.s&&(_.disabled=e.s=h),f!==e.h&&(p.disabled=e.h=f),b!==e.r&&d(m,e.r=b),e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0}),l(()=>s.value=ae()),t}})]}}),null),l(e=>{var n=b,r=w,a=y,o=k,l=S,s=C,c=L,u=z,h=q,_=E,p=D;return n!==e.e&&d(t,e.e=n),r!==e.t&&d(i,e.t=r),a!==e.a&&d(v,e.a=a),o!==e.o&&d(g,e.o=o),l!==e.i&&d(j,e.i=l),s!==e.n&&d(ze,e.n=s),c!==e.s&&d(Pe,e.s=c),u!==e.h&&d(Ae,e.h=u),h!==e.r&&d(Me,e.r=h),_!==e.d&&d(Xe,e.d=_),p!==e.l&&d(Ze,e.l=p),e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0}),t}})}e(["click","input"]);const yn=document.getElementById("app");yn&&f(()=>r(wn,{}),yn);
