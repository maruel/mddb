import{C as e,c as t,h as i,q as n,d as r,s as a,v as s,S as o,z as l,F as g,w as v,n as u}from"./vendor-CcKkUxsI.js";import{u as d,d as _,s as c,e as h,f as p}from"./index-BS2beyq2.js";const f="_profile_vysi4_3",m="_userInfoSection_vysi4_7",y="_avatarLarge_vysi4_17",b="_avatarImageLarge_vysi4_29",S="_initialsLarge_vysi4_35",k="_userDetails_vysi4_41",w="_userName_vysi4_45",C="_userEmail_vysi4_51",x="_userRole_vysi4_56",L="_section_vysi4_66",z="_error_vysi4_75",E="_success_vysi4_83",I="_settingsForm_vysi4_91",$="_formItem_vysi4_98",D="_checkboxLabel_vysi4_117",N="_saveButton_vysi4_130",U="_orgList_vysi4_149",F="_orgItem_vysi4_155",T="_orgInfo_vysi4_165",j="_orgName_vysi4_171",O="_orgNameLink_vysi4_175",P="_orgRole_vysi4_185",R="_emptyState_vysi4_194";var q=v("<div>"),A=v("<span>"),B=v("<section><div></div><div><h3></h3><p>"),M=v("<section><h3>"),W=v("<div><label><input type=checkbox>"),G=v("<section><h3></h3><form><div><label></label><select><option value=light></option><option value=dark></option><option value=system></option></select></div><div><label></label><select><option value=en></option><option value=fr></option><option value=de></option><option value=es></option></select></div><button type=submit>"),H=v("<img referrerpolicy=no-referrer>"),J=v("<p>"),K=v("<a>"),Q=v("<div><div><span>");function V(){const{t:v,setLocale:u}=d(),V=e(),{user:X,api:Y,wsApi:Z}=_(),[ee,te]=t("light"),[ie,ne]=t("en"),[re,ae]=t(!0),[se,oe]=t(!1),[le,ge]=t(null),[ve,ue]=t(null),de=()=>{const e=X(),t=e?.name||e?.email||"",i=t.split(/[\s@]+/);return i.length>=2&&i[0]&&i[1]?((i[0][0]||"")+(i[1][0]||"")).toUpperCase():t.slice(0,2).toUpperCase()};i(()=>{const e=X();te(e?.settings?.theme||"light"),ne(e?.settings?.language||"en")});i(()=>{(async()=>{const e=X();if(e)try{oe(!0),ge(null);const t=e.workspaces?.find(t=>t.workspace_id===e.workspace_id);t&&ae(t.settings?.notifications??!0)}catch(t){ge(`${v("errors.failedToLoad")}: ${t}`)}finally{oe(!1)}})()});const _e=async e=>{e.preventDefault();const t=Z();try{oe(!0),ge(null),ue(null);const e={theme:ee(),language:ie()},i=[Y().auth.updateUserSettings({settings:e})];if(t){const e={notifications:re()};i.push(t.settings.updateWSMembershipSettings({settings:e}))}await Promise.all(i);const n=ie();u(n),localStorage.setItem("mddb_locale",n),ue(v("success.personalSettingsSaved")||"Personal settings saved successfully")}catch(i){ge(`${v("errors.failedToSave")}: ${i}`)}finally{oe(!1)}};return ce=q(),n(ce,r(o,{get when(){return le()},get children(){var e=q();return n(e,le),a(()=>s(e,z)),e}}),null),n(ce,r(o,{get when(){return ve()},get children(){var e=q();return n(e,ve),a(()=>s(e,E)),e}}),null),n(ce,r(o,{get when(){return X()},children:e=>{return[(me=B(),ye=me.firstChild,be=ye.nextSibling,Se=be.firstChild,ke=Se.nextSibling,n(ye,r(o,{get when(){return(()=>{const e=X()?.oauth_identities;if(!e)return null;for(const t of e)if(t.avatar_url)return t.avatar_url;return null})()},get fallback(){return e=A(),n(e,de),a(()=>s(e,S)),e;var e},children:t=>{return i=H(),a(n=>{var r=t(),a=e().name||"User",o=b;return r!==n.e&&l(i,"src",n.e=r),a!==n.t&&l(i,"alt",n.t=a),o!==n.a&&s(i,n.a=o),n},{e:void 0,t:void 0,a:void 0}),i;var i}})),n(Se,()=>e().name),n(ke,()=>e().email),n(be,r(o,{get when(){return e().workspace_role},get children(){var t=A();return n(t,()=>e().workspace_role),a(()=>s(t,x)),t}}),null),a(e=>{var t=m,i=y,n=k,r=w,a=C;return t!==e.e&&s(me,e.e=t),i!==e.t&&s(ye,e.t=i),n!==e.a&&s(be,e.a=n),r!==e.o&&s(Se,e.o=r),a!==e.i&&s(ke,e.i=a),e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),me),(pe=M(),fe=pe.firstChild,n(fe,()=>v("profile.myOrganizations")),n(pe,r(o,{get when(){return e().organizations?.length},get fallback(){return e=J(),n(e,()=>v("profile.noOrganizations")),a(()=>s(e,R)),e;var e},get children(){var t=q();return n(t,r(g,{get each(){return e().organizations},children:e=>{const t=e.organization_name||e.organization_id;return i=Q(),g=i.firstChild,v=g.firstChild,n(g,r(o,{get when(){return e.role===h||e.role===p},get fallback(){return e=A(),n(e,t),a(()=>s(e,j)),e;var e},get children(){var i=K();return i.$$click=t=>{t.preventDefault(),(e=>{V(c("org",e.organization_id,e.organization_name))})(e)},n(i,t),a(t=>{var n=c("org",e.organization_id,e.organization_name),r=O;return n!==t.e&&l(i,"href",t.e=n),r!==t.t&&s(i,t.t=r),t},{e:void 0,t:void 0}),i}}),v),n(v,()=>e.role),a(e=>{var t=F,n=T,r=P;return t!==e.e&&s(i,e.e=t),n!==e.t&&s(g,e.t=n),r!==e.a&&s(v,e.a=r),e},{e:void 0,t:void 0,a:void 0}),i;var i,g,v}})),a(()=>s(t,U)),t}}),null),a(()=>s(pe,L)),pe),(t=G(),i=t.firstChild,u=i.nextSibling,d=u.firstChild,_=d.firstChild,f=_.nextSibling,z=f.firstChild,E=z.nextSibling,Y=E.nextSibling,Z=d.nextSibling,oe=Z.firstChild,le=oe.nextSibling,ge=le.firstChild,ve=ge.nextSibling,ue=ve.nextSibling,ce=ue.nextSibling,he=Z.nextSibling,n(i,()=>v("settings.personalSettings")),u.addEventListener("submit",_e),n(_,()=>v("settings.theme")),f.addEventListener("change",e=>te(e.target.value)),n(z,()=>v("settings.themeLight")),n(E,()=>v("settings.themeDark")),n(Y,()=>v("settings.themeSystem")),n(oe,()=>v("settings.language")),le.addEventListener("change",e=>ne(e.target.value)),n(ge,()=>v("settings.languageEn")),n(ve,()=>v("settings.languageFr")),n(ue,()=>v("settings.languageDe")),n(ce,()=>v("settings.languageEs")),n(u,r(o,{get when(){return e().workspace_id},get children(){var e=W(),t=e.firstChild,i=t.firstChild;return i.addEventListener("change",e=>ae(e.currentTarget.checked)),n(t,()=>v("settings.enableNotifications"),null),a(i=>{var n=$,r=D;return n!==i.e&&s(e,i.e=n),r!==i.t&&s(t,i.t=r),i},{e:void 0,t:void 0}),a(()=>i.checked=re()),e}}),he),n(he,()=>v("settings.saveChanges")),a(e=>{var i=L,n=I,r=$,a=$,o=N,l=se();return i!==e.e&&s(t,e.e=i),n!==e.t&&s(u,e.t=n),r!==e.a&&s(d,e.a=r),a!==e.o&&s(Z,e.o=a),o!==e.i&&s(he,e.i=o),l!==e.n&&(he.disabled=e.n=l),e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0}),a(()=>f.value=ee()),a(()=>le.value=ie()),t)];var t,i,u,d,_,f,z,E,Y,Z,oe,le,ge,ve,ue,ce,he,pe,fe,me,ye,be,Se,ke}}),null),a(()=>s(ce,f)),ce;var ce}u(["click"]);export{V as default};
