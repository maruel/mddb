import{G as e,D as t,c as i,g as n,h as a,s as r,d as s,v as l,w as o,S as u,x as m,q as g}from"./vendor-DudX5Zyp.js";import{u as d,d as b,f as v,e as p}from"./index-B1TEd129.js";import{M as _,I as c}from"./InviteForm-xNpfy6H2.js";import"./editor-vendor-oxYk7t8G.js";const x="_panel_1lewj_3",f="_tabs_1lewj_7",h="_activeTab_1lewj_29",y="_section_1lewj_34",$="_error_1lewj_43",w="_success_1lewj_51",S="_settingsForm_1lewj_59",I="_formItem_1lewj_66",C="_formGrid_1lewj_85",j="_saveButton_1lewj_106";var k=m("<div>"),z=m("<section><h3>"),O=m("<form><div><label></label><input type=text required></div><h4></h4><div><div><label></label><input type=number min=1></div><div><label></label><input type=number min=1></div><div><label></label><input type=number min=1></div><div><label></label><input type=number min=1></div><div><label></label><input type=number min=0></div><div><label></label><input type=number min=0></div><div><label></label><input type=number min=0></div><div><label></label><input type=number min=0></div><div><label></label><input type=number min=0></div><div><label></label><input type=number min=0></div></div><button type=submit>"),q=m("<div><div><button></button><button>"),P=m("<p>");function T(m){const{t:g}=d(),T=e(),M=t(),{user:R,api:U}=b(),[B,A]=i("settings"===m.section?"settings":"members"),[F,W]=i([]),[D,G]=i([]),[L,E]=i(""),[N,Q]=i(""),[H,J]=i(0),[K,V]=i(0),[X,Y]=i(0),[Z,ee]=i(0),[te,ie]=i(0),[ne,ae]=i(0),[re,se]=i(0),[le,oe]=i(0),[ue,me]=i(0),[ge,de]=i(0),[be,ve]=i(!1),[pe,_e]=i(null),[ce,xe]=i(null),fe=n(()=>U().org(m.orgId)),he=n(()=>{const e=R()?.organizations?.find(e=>e.organization_id===m.orgId);return e?.role}),ye=n(()=>{const e=he();return e===v||e===p}),$e=e=>{A(e);const t="members"===e?"":`#${e}`;T(M.pathname+t,{replace:!0})},we=async()=>{const e=fe();try{if(ve(!0),_e(null),"members"===B()&&ye()){const[t,i]=await Promise.all([e.users.listUsers(),e.invitations.listOrgInvitations()]);W(t.users?.filter(e=>!!e)||[]),G(i.invitations?.filter(e=>!!e)||[])}if("settings"===B()){const t=await e.organizations.getOrganization();E(t.name),Q(t.name),J(t.quotas.max_workspaces_per_org),V(t.quotas.max_members_per_org),Y(t.quotas.max_members_per_workspace),ee(t.quotas.max_total_storage_bytes),ie(t.quotas.max_pages),ae(t.quotas.max_storage_bytes),se(t.quotas.max_records_per_table),oe(t.quotas.max_asset_size_bytes),me(t.quotas.max_tables_per_workspace),de(t.quotas.max_columns_per_table)}}catch(t){_e(`${g("errors.failedToLoad")}: ${t}`)}finally{ve(!1)}};a(()=>{we()}),a(()=>{const e=m.section;"settings"===e?A("settings"):"members"!==e&&e||A("members")});const Se=async(e,t)=>{const i=fe();try{ve(!0),await i.invitations.createOrgInvitation({email:e,role:t}),xe(g("success.invitationSent")||"Invitation sent successfully"),we()}catch(n){_e(`${g("errors.failedToInvite")}: ${n}`)}finally{ve(!1)}},Ie=async(e,t)=>{const i=fe();try{ve(!0),await i.users.updateOrgMemberRole({user_id:e,role:t}),xe(g("success.roleUpdated")||"Role updated"),we()}catch(n){_e(`${g("errors.failedToUpdateRole")}: ${n}`)}finally{ve(!1)}},Ce=async e=>{e.preventDefault();const t=fe();try{ve(!0),_e(null),xe(null),L()!==N()&&L().trim()&&(await t.organizations.updateOrganization({name:L().trim()}),Q(L().trim())),await t.settings.updateOrgPreferences({quotas:{max_workspaces_per_org:H(),max_members_per_org:K(),max_members_per_workspace:X(),max_total_storage_bytes:Z(),max_pages:te(),max_storage_bytes:ne(),max_records_per_table:re(),max_asset_size_bytes:le(),max_tables_per_workspace:ue(),max_columns_per_table:ge()}}),xe(g("success.orgSettingsSaved")||"Organization settings saved")}catch(i){_e(`${g("errors.failedToSave")}: ${i}`)}finally{ve(!1)}},je=[{value:"owner",label:g("settings.roleOwner")},{value:"admin",label:g("settings.roleAdmin")},{value:"member",label:g("settings.roleMember")}],ke=[{value:"admin",label:g("settings.roleAdmin")},{value:"member",label:g("settings.roleMember")}];return ze=q(),Oe=ze.firstChild,qe=Oe.firstChild,Pe=qe.nextSibling,qe.$$click=()=>$e("members"),r(qe,()=>g("settings.members")),Pe.$$click=()=>$e("settings"),r(Pe,()=>g("settings.settings")),r(ze,s(u,{get when(){return pe()},get children(){var e=k();return r(e,pe),l(()=>o(e,$)),e}}),null),r(ze,s(u,{get when(){return ce()},get children(){var e=k();return r(e,ce),l(()=>o(e,w)),e}}),null),r(ze,s(u,{get when(){return"members"===B()},get children(){var e=z(),t=e.firstChild;return r(t,()=>g("settings.organizationMembers")),r(e,s(u,{get when(){return ye()},get fallback(){return e=P(),r(e,()=>g("settings.adminOnlyMembers")),e;var e},get children(){return[s(_,{get members(){return F()},get currentUserId(){return R()?.id||""},roleOptions:je,roleField:"org_role",onUpdateRole:Ie,get loading(){return be()}}),s(c,{roleOptions:ke,defaultRole:"member",get pendingInvitations(){return D().map(e=>({email:e.email,role:e.role,created:e.created}))},onInvite:Se,get loading(){return be()}})]}}),null),l(()=>o(e,y)),e}}),null),r(ze,s(u,{get when(){return"settings"===B()},get children(){var e=z(),t=e.firstChild;return r(t,()=>g("settings.organizationPreferences")),r(e,s(u,{get when(){return ye()},get fallback(){return e=P(),r(e,()=>g("settings.adminOnlySettings")),e;var e},get children(){var e=O(),t=e.firstChild,i=t.firstChild,n=i.nextSibling,a=t.nextSibling,s=a.nextSibling,u=s.firstChild,m=u.firstChild,d=m.nextSibling,b=u.nextSibling,v=b.firstChild,p=v.nextSibling,_=b.nextSibling,c=_.firstChild,x=c.nextSibling,f=_.nextSibling,h=f.firstChild,y=h.nextSibling,$=f.nextSibling,w=$.firstChild,k=w.nextSibling,z=$.nextSibling,q=z.firstChild,P=q.nextSibling,T=z.nextSibling,M=T.firstChild,R=M.nextSibling,U=T.nextSibling,B=U.firstChild,A=B.nextSibling,F=U.nextSibling,W=F.firstChild,D=W.nextSibling,G=F.nextSibling,N=G.firstChild,Q=N.nextSibling,ve=s.nextSibling;return e.addEventListener("submit",Ce),r(i,()=>g("settings.organizationName")),n.$$input=e=>E(e.target.value),r(a,()=>g("settings.organizationQuotas")),r(m,()=>g("settings.maxWorkspacesPerOrg")),d.$$input=e=>J(parseInt(e.target.value)||1),r(v,()=>g("settings.maxMembersPerOrg")),p.$$input=e=>V(parseInt(e.target.value)||1),r(c,()=>g("settings.maxMembersPerWorkspace")),x.$$input=e=>Y(parseInt(e.target.value)||1),r(h,()=>g("settings.maxTotalStorageBytes")),y.$$input=e=>ee(parseInt(e.target.value)||1),r(w,()=>g("settings.maxPages")),k.$$input=e=>ie(parseInt(e.target.value)||0),r(q,()=>g("settings.maxStorageBytes")),P.$$input=e=>ae(parseInt(e.target.value)||0),r(M,()=>g("settings.maxRecordsPerTable")),R.$$input=e=>se(parseInt(e.target.value)||0),r(B,()=>g("settings.maxAssetSizeBytes")),A.$$input=e=>oe(parseInt(e.target.value)||0),r(W,()=>g("settings.maxTablesPerWorkspace")),D.$$input=e=>me(parseInt(e.target.value)||0),r(N,()=>g("settings.maxColumnsPerTable")),Q.$$input=e=>de(parseInt(e.target.value)||0),r(ve,()=>g("common.save")),l(i=>{var n=S,a=I,r=C,l=I,m=I,g=I,d=I,v=I,p=I,c=I,x=I,h=I,y=I,w=j,k=be();return n!==i.e&&o(e,i.e=n),a!==i.t&&o(t,i.t=a),r!==i.a&&o(s,i.a=r),l!==i.o&&o(u,i.o=l),m!==i.i&&o(b,i.i=m),g!==i.n&&o(_,i.n=g),d!==i.s&&o(f,i.s=d),v!==i.h&&o($,i.h=v),p!==i.r&&o(z,i.r=p),c!==i.d&&o(T,i.d=c),x!==i.l&&o(U,i.l=x),h!==i.u&&o(F,i.u=h),y!==i.c&&o(G,i.c=y),w!==i.w&&o(ve,i.w=w),k!==i.m&&(ve.disabled=i.m=k),i},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0}),l(()=>n.value=L()),l(()=>d.value=H()),l(()=>p.value=K()),l(()=>x.value=X()),l(()=>y.value=Z()),l(()=>k.value=te()),l(()=>P.value=ne()),l(()=>R.value=re()),l(()=>A.value=le()),l(()=>D.value=ue()),l(()=>Q.value=ge()),e}}),null),l(()=>o(e,y)),e}}),null),l(e=>{var t=x,i=f,n="members"===B()?h:"",a="settings"===B()?h:"";return t!==e.e&&o(ze,e.e=t),i!==e.t&&o(Oe,e.t=i),n!==e.a&&o(qe,e.a=n),a!==e.o&&o(Pe,e.o=a),e},{e:void 0,t:void 0,a:void 0,o:void 0}),ze;var ze,Oe,qe,Pe}g(["click","input"]);export{T as default};
//# sourceMappingURL=OrgSettingsPanel-UE-qlXvi.js.map
