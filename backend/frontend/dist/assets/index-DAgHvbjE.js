const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ProfileSettings-ocxfe9Px.js","assets/vendor-DshmF2G-.js","assets/editor-vendor-DPxZwULu.js","assets/ProfileSettings-DXvtq14s.css","assets/WorkspaceSettingsPanel-CHeSDBAE.js","assets/InviteForm-BvniekQe.js","assets/InviteForm-Bmuo23QD.css","assets/WorkspaceSettingsPanel-CefhRi2L.css","assets/OrgSettingsPanel-DgVW6JYI.js","assets/OrgSettingsPanel-DAbswSRk.css","assets/ServerSettingsPanel-N804IKPQ.js","assets/ServerSettingsPanel-CwAILPxT.css","assets/Editor-5YHlmngp.js","assets/Editor-BZbCnfWv.css","assets/Auth-Bun_a15f.js","assets/Auth-D9cCVgJl.css","assets/Privacy-Djsm_YTW.js","assets/Privacy-COJkLvXG.css","assets/Terms-DVvdE5sJ.js","assets/Onboarding-Cro45Wch.js"])))=>i.map(i=>d[i]);
import{u as e,c as t,a as n,d as r,e as i,t as o,r as a,f as s,g as l,o as d,h as c,i as u,j as p,p as g,l as h,m as v,n as _,E as f,q as m,s as w,v as b,w as k,S as y,x as $,y as C,z as x,F as S,A as I,B as D,C as T,D as E,N as R,G as L,H as N,I as P,J as A,K as O,L as j,M as z,P as W,Q as M,T as V,U,V as B,W as H,X as F,Y as q,Z as G,_ as K,$ as J,a0 as X,a1 as Y,a2 as Z,a3 as Q,a4 as ee,a5 as te,a6 as ne,a7 as re,a8 as ie,a9 as oe,aa as ae,ab as se}from"./vendor-DshmF2G-.js";import{M as le}from"./editor-vendor-DPxZwULu.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const de={},ce=function(e,t,n){let r=Promise.resolve();if(t&&t.length>0){let e=function(e){return Promise.all(e.map(e=>Promise.resolve(e).then(e=>({status:"fulfilled",value:e}),e=>({status:"rejected",reason:e}))))};document.getElementsByTagName("link");const n=document.querySelector("meta[property=csp-nonce]"),i=n?.nonce||n?.getAttribute("nonce");r=e(t.map(e=>{if((e=function(e){return"/"+e}(e))in de)return;de[e]=!0;const t=e.endsWith(".css"),n=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${n}`))return;const r=document.createElement("link");return r.rel=t?"stylesheet":"modulepreload",t||(r.as="script"),r.crossOrigin="",r.href=e,i&&r.setAttribute("nonce",i),document.head.appendChild(r),t?new Promise((t,n)=>{r.addEventListener("load",t),r.addEventListener("error",()=>n(new Error(`Unable to preload CSS for ${e}`)))}):void 0}))}function i(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return r.then(t=>{for(const e of t||[])"rejected"===e.status&&i(e.reason);return e().catch(i)})};async function ue(e){const t=await((e,t,n)=>{const r=e[t];return r?"function"==typeof r?r():Promise.resolve(r):new Promise((e,r)=>{("function"==typeof queueMicrotask?queueMicrotask:setTimeout)(r.bind(null,new Error("Unknown variable dynamic import: "+t+(t.split("/").length!==n?". Note that variables only represent file names one level deep.":""))))})})(Object.assign({"./dictionaries/de.ts":()=>ce(()=>import("./de-GRVng3aR.js"),[]),"./dictionaries/en.ts":()=>ce(()=>import("./en-eSQ8cVZ9.js"),[]),"./dictionaries/es.ts":()=>ce(()=>import("./es-DRbGuPZG.js"),[]),"./dictionaries/fr.ts":()=>ce(()=>import("./fr-Bp5TFFge.js"),[])}),`./dictionaries/${e}.ts`,3);return s(t.dict)}const pe=i(),ge=e=>{const[i,s]=t(e.initialLocale||"en"),[l]=n(i,ue),d=o(l,a),c=(e,...t)=>(l(),d(e,...t)),u={locale:i,setLocale:s,t:c,translateError:e=>{const t=`errors.${e}`,n=c(t);return n&&n!==t?n:c("errors.unknown")||"An error occurred"},ready:()=>"ready"===l.state};return r(pe.Provider,{value:u,get children(){return e.children}})};function he(){const t=e(pe);if(!t)throw new Error("useI18n must be used within I18nProvider");return t}class ve extends Error{constructor(e,t){super(t.error.message),this.status=e,this.response=t,this.name="APIError"}}async function _e(e,t){const n=await e(t);if(!n.ok){const e=await n.json();throw new ve(n.status,e)}return n.json()}async function fe(e,t,n){const r={method:"POST"};n&&(r.headers={"Content-Type":"application/json"},r.body=JSON.stringify(n));const i=await e(t,r);if(!i.ok){const e=await i.json();throw new ve(i.status,e)}return i.json()}function me(e){return{admin:{organizations:{listAllOrgs:()=>_e(e,"/api/v1/admin/organizations")},getAdminStats:()=>_e(e,"/api/v1/admin/stats"),listAllUsers:()=>_e(e,"/api/v1/admin/users")},auth:{email:{changeEmail:t=>fe(e,"/api/v1/auth/email",t),sendVerificationEmail:()=>fe(e,"/api/v1/auth/email/send-verification")},invitations:{acceptOrgInvitation:t=>fe(e,"/api/v1/auth/invitations/org/accept",t),acceptWSInvitation:t=>fe(e,"/api/v1/auth/invitations/ws/accept",t)},sessions:{listSessions:()=>_e(e,"/api/v1/auth/sessions"),revokeAllSessions:()=>fe(e,"/api/v1/auth/sessions/revoke-all"),revokeSession:t=>fe(e,"/api/v1/auth/sessions/revoke",t)},getMe:()=>_e(e,"/api/v1/auth/me"),listProviders:()=>_e(e,"/api/v1/auth/providers"),login:t=>fe(e,"/api/v1/auth/login",t),logout:()=>fe(e,"/api/v1/auth/logout"),register:t=>fe(e,"/api/v1/auth/register",t),setPassword:t=>fe(e,"/api/v1/auth/password",t),switchWorkspace:t=>fe(e,"/api/v1/auth/switch-workspace",t),updateUserSettings:t=>fe(e,"/api/v1/auth/settings",t)},organizations:{createOrganization:t=>fe(e,"/api/v1/organizations",t)},server:{getConfig:()=>_e(e,"/api/v1/server/config"),updateConfig:t=>fe(e,"/api/v1/server/config",t)},getHealth:()=>_e(e,"/api/v1/health"),org:t=>({invitations:{createOrgInvitation:n=>fe(e,`/api/v1/organizations/${t}/invitations`,n),listOrgInvitations:()=>_e(e,`/api/v1/organizations/${t}/invitations`)},notion:{getStatus:n=>_e(e,`/api/v1/organizations/${t}/notion/import/${n}/status`),startImport:n=>fe(e,`/api/v1/organizations/${t}/notion/import`,n)},organizations:{getOrganization:()=>_e(e,`/api/v1/organizations/${t}`),updateOrganization:n=>fe(e,`/api/v1/organizations/${t}`,n)},settings:{updateOrgPreferences:n=>fe(e,`/api/v1/organizations/${t}/settings`,n)},users:{listUsers:()=>_e(e,`/api/v1/organizations/${t}/users`),updateOrgMemberRole:n=>fe(e,`/api/v1/organizations/${t}/users/role`,n)},workspaces:{createWorkspace:n=>fe(e,`/api/v1/organizations/${t}/workspaces`,n)}}),ws:t=>({invitations:{createWSInvitation:n=>fe(e,`/api/v1/workspaces/${t}/invitations`,n),listWSInvitations:()=>_e(e,`/api/v1/workspaces/${t}/invitations`)},nodes:{assets:{deleteNodeAsset:(n,r)=>fe(e,`/api/v1/workspaces/${t}/nodes/${n}/assets/${r}/delete`),listNodeAssets:n=>_e(e,`/api/v1/workspaces/${t}/nodes/${n}/assets`)},history:{getNodeVersion:(n,r)=>_e(e,`/api/v1/workspaces/${t}/nodes/${n}/history/${r}`),async listNodeVersions(n,r){const i=new URLSearchParams;r.Limit&&i.set("limit",String(r.Limit));const o=`/api/v1/workspaces/${t}/nodes/${n}/history`+(i.toString()?`?${i}`:"");return _e(e,o)}},page:{createPage:(n,r)=>fe(e,`/api/v1/workspaces/${t}/nodes/${n}/page/create`,r),deletePage:n=>fe(e,`/api/v1/workspaces/${t}/nodes/${n}/page/delete`),getPage:n=>_e(e,`/api/v1/workspaces/${t}/nodes/${n}/page`),updatePage:(n,r)=>fe(e,`/api/v1/workspaces/${t}/nodes/${n}/page`,r)},table:{records:{createRecord:(n,r)=>fe(e,`/api/v1/workspaces/${t}/nodes/${n}/table/records/create`,r),deleteRecord:(n,r)=>fe(e,`/api/v1/workspaces/${t}/nodes/${n}/table/records/${r}/delete`),getRecord:(n,r)=>_e(e,`/api/v1/workspaces/${t}/nodes/${n}/table/records/${r}`),async listRecords(n,r){const i=new URLSearchParams;r.ViewID&&i.set("view_id",r.ViewID),r.Filters&&i.set("filters",r.Filters),r.Sorts&&i.set("sorts",r.Sorts),r.Offset&&i.set("offset",String(r.Offset)),r.Limit&&i.set("limit",String(r.Limit));const o=`/api/v1/workspaces/${t}/nodes/${n}/table/records`+(i.toString()?`?${i}`:"");return _e(e,o)},updateRecord:(n,r,i)=>fe(e,`/api/v1/workspaces/${t}/nodes/${n}/table/records/${r}`,i)},createTable:(n,r)=>fe(e,`/api/v1/workspaces/${t}/nodes/${n}/table/create`,r),deleteTable:n=>fe(e,`/api/v1/workspaces/${t}/nodes/${n}/table/delete`),getTable:n=>_e(e,`/api/v1/workspaces/${t}/nodes/${n}/table`),updateTable:(n,r)=>fe(e,`/api/v1/workspaces/${t}/nodes/${n}/table`,r)},views:{createView:(n,r)=>fe(e,`/api/v1/workspaces/${t}/nodes/${n}/views/create`,r),deleteView:(n,r)=>fe(e,`/api/v1/workspaces/${t}/nodes/${n}/views/${r}/delete`),updateView:(n,r,i)=>fe(e,`/api/v1/workspaces/${t}/nodes/${n}/views/${r}`,i)},deleteNode:n=>fe(e,`/api/v1/workspaces/${t}/nodes/${n}/delete`),getNode:n=>_e(e,`/api/v1/workspaces/${t}/nodes/${n}`),async getNodeTitles(n){const r=new URLSearchParams;n.IDs&&r.set("ids",n.IDs);const i=`/api/v1/workspaces/${t}/nodes/titles`+(r.toString()?`?${r}`:"");return _e(e,i)},listNodeChildren:n=>_e(e,`/api/v1/workspaces/${t}/nodes/${n}/children`)},notion:{cancelImport:()=>fe(e,`/api/v1/workspaces/${t}/notion/import/cancel`)},settings:{git:{deleteGitRemote:()=>fe(e,`/api/v1/workspaces/${t}/settings/git/delete`),getGitRemote:()=>_e(e,`/api/v1/workspaces/${t}/settings/git`),pushGit:()=>fe(e,`/api/v1/workspaces/${t}/settings/git/push`),updateGitRemote:n=>fe(e,`/api/v1/workspaces/${t}/settings/git`,n)},updateWSMembershipSettings:n=>fe(e,`/api/v1/workspaces/${t}/settings/membership`,n)},users:{updateWSMemberRole:n=>fe(e,`/api/v1/workspaces/${t}/users/role`,n)},workspaces:{getWorkspace:()=>_e(e,`/api/v1/workspaces/${t}`),updateWorkspace:n=>fe(e,`/api/v1/workspaces/${t}`,n)},search:n=>fe(e,`/api/v1/workspaces/${t}/search`,n)})}}const we=3,be=1e3,ke=3e4;function ye(e){return 429===e||e>=500&&e<600}function $e(e){if(!e)return null;const t=parseInt(e,10);if(!isNaN(t))return 1e3*t;const n=Date.parse(e);return isNaN(n)?null:Math.max(0,n-Date.now())}function Ce(e,t){if(null!==t)return Math.min(t,ke);const n=be*Math.pow(2,e);return Math.min(n,ke)}function xe(e,t){return n=async(n,r)=>{const i=e(),o={...r?.headers};i&&(o.Authorization=`Bearer ${i}`);const a=await fetch(n,{...r,headers:o});return 401===a.status&&t&&t(),a},async(e,t)=>{let r=0;for(;;){const i=await n(e,t);if(!ye(i.status)||r>=we)return i;const o=Ce(r,$e(i.headers.get("Retry-After")));await new Promise(e=>setTimeout(e,o)),r++}};var n}function Se(e,t){return me(xe(e,t))}const Ie=i(),De=e=>{const[n,i]=t(null),[o,a]=t(localStorage.getItem("mddb_token")),[s,u]=t(!1),p=async()=>{const e=o();if(e)try{const t=Se(()=>e,()=>{});await t.auth.logout()}catch{}localStorage.removeItem("mddb_token"),a(null),i(null)},g=l(()=>Se(()=>o(),p)),h=l(()=>{const e=n()?.workspace_id;return e?g().ws(e):null}),v=l(()=>{const e=n()?.organization_id;return e?g().org(e):null});d(async()=>{const e=new URLSearchParams(window.location.search).get("token");e&&(localStorage.setItem("mddb_token",e),a(e),window.history.replaceState({},document.title,window.location.pathname));if(e||localStorage.getItem("mddb_token"))try{const e=await g().auth.getMe();i(e)}catch(t){console.error("Failed to load user",t),t instanceof ve&&401===t.status&&(localStorage.removeItem("mddb_token"),a(null))}u(!0)});let _=!0;c(()=>{const e=o(),t=n();_?_=!1:e&&!t&&(async()=>{try{const e=await g().auth.getMe();i(e)}catch(e){console.error("Failed to load user",e),e instanceof ve&&401===e.status&&(localStorage.removeItem("mddb_token"),a(null))}})()});const f={user:n,token:o,ready:s,api:g,wsApi:h,orgApi:v,login:(e,t)=>{localStorage.setItem("mddb_token",e),a(e),i(t)},logout:p,setUser:i,refreshUser:async()=>{try{const e=await g().auth.getMe();i(e)}catch(e){console.error("Failed to refresh user",e),e instanceof ve&&401===e.status&&(localStorage.removeItem("mddb_token"),a(null),i(null))}}};return r(Ie.Provider,{value:f,get children(){return e.children}})};function Te(){const t=e(Ie);if(!t)throw new Error("useAuth must be used within an AuthProvider");return t}const Ee="select",Re="org:owner",Le="org:admin",Ne="ws:admin",Pe="google",Ae="microsoft",Oe="github",je=i(),ze=e=>{const{t:n,ready:i}=he(),{user:o,setUser:a,api:s,wsApi:l,login:d}=Te(),[v,_]=u([]),[f,m]=t(null),[w,b]=t(null),[k,y]=t([]),[$,C]=t(!1),[x,S]=t(null),[I,D]=t(!1),[T,E]=t(!1);let R=!1,L=null,N=null,P=null;function A(){const e=o();if(!e?.name)return"";return e.name.split(" ")[0]||e.name}async function O(e){await s().organizations.createOrganization({name:e.name});const t=await s().auth.getMe();a(t)}async function j(e){const t=o();if(!t||!t.organization_id)throw new Error("No organization selected");const n=await s().org(t.organization_id).workspaces.createWorkspace({name:e.name}),r=await s().auth.getMe();a(r),await z(n.id)}async function z(e){try{C(!0);const t=await s().auth.switchWorkspace({ws_id:e});if(!t.user)throw new Error("No user data returned");d(t.token,t.user),h(()=>{m(null),b(null),y([])}),P=null,L=null,await W()}catch(t){S(`${n("errors.failedToSwitch")}: ${t}`)}finally{C(!1)}}async function W(e=!1){const t=l(),r=o()?.workspace_id;if(t&&!R&&!(!e&&r&&L===r&&v.length>0))try{R=!0,C(!0);const e=await t.nodes.listNodeChildren("0");let i=e?.nodes||[];if(0===i.length&&I()){const e=await async function(){const e=l(),t=o();if(!e||!t)return null;if(t.workspace_role!==Ne&&"ws:editor"!==t.workspace_role)return null;try{const t=await e.nodes.page.createPage("0",{title:n("welcome.welcomePageTitle"),content:n("welcome.welcomePageContent")});return t?.id?String(t.id):null}catch(r){return S(`${n("errors.failedToCreate")}: ${r}`),null}}();if(e){const e=await t.nodes.listNodeChildren("0");i=e?.nodes||[]}}_(p(i)),L=r||null,S(null)}catch(i){S(`${n("errors.failedToLoad")}: ${i}`)}finally{R=!1,C(!1)}}c(()=>{const e=o();if(!e||!i()||I()||T())return;const t=e.organizations||[];if(0===t.length)return E(!0),void async function(){try{C(!0);const e=A(),t=e?n("onboarding.defaultOrgName",{name:e}):n("onboarding.defaultOrgNameFallback");await O({name:t})}catch(e){S(`${n("errors.failedToCreate")}: ${e}`)}finally{C(!1)}}().finally(()=>E(!1));const r=t[0];if(r){if(0===(e.workspaces?.filter(e=>e.organization_id===r.organization_id)||[]).length&&(r.role===Le||r.role===Re))return E(!0),void async function(){try{C(!0);const e=A(),t=e?n("onboarding.defaultWorkspaceName",{name:e}):n("onboarding.defaultWorkspaceNameFallback");await j({name:t})}catch(e){S(`${n("errors.failedToCreate")}: ${e}`)}finally{C(!1)}}().finally(()=>E(!1))}e.workspace_id&&D(!0)}),c(()=>{o()&&W()}),c(()=>{const e=o()?.workspace_id;e&&L!==e&&(P=null)});const M={nodes:v,setNodes:e=>{_(g(e))},selectedNodeId:f,setSelectedNodeId:m,selectedNodeData:w,setSelectedNodeData:b,breadcrumbPath:k,setBreadcrumbPath:y,loading:$,setLoading:C,error:x,setError:S,firstLoginCheckDone:I,setFirstLoginCheckDone:D,switchWorkspace:z,createOrganization:O,createWorkspace:j,loadNodes:W,loadNode:async function(e){const t=l();if(t&&N!==e&&P!==e)try{N=e,C(!0);const n=await t.nodes.getNode(e);h(()=>{m(n.id),b(n)}),P=n.id,S(null);const r=[n];let i=n;for(;i.parent_id&&"0"!==i.parent_id;)try{const e=await t.nodes.getNode(i.parent_id);r.unshift(e),i=e}catch{break}return y(r),n}catch(r){return void S(`${n("errors.failedToLoad")}: ${r}`)}finally{N=null,C(!1)}},fetchNodeChildren:async function(e){const t=l();if(t)try{const n=await t.nodes.listNodeChildren(e),r=n.nodes?.filter(Boolean)||[];_(g(t=>{const n=t=>{for(const i of t){if(i.id===e)return i.children=r,i.has_children=r.length>0,!0;if(i.children&&n(i.children))return!0}return!1};n(t)}))}catch(n){console.error("Failed to fetch children:",n)}},removeNode:e=>{_(g(t=>{const n=t=>{const r=t.findIndex(t=>t.id===e);if(-1!==r)return t.splice(r,1),!0;for(const e of t)if(e.children&&n(e.children))return 0===e.children.length&&(e.has_children=!1),!0;return!1};n(t)}))},updateNodeTitle:(e,t)=>{_(g(n=>{const r=n=>{for(const i of n){if(i.id===e)return i.title=t,!0;if(i.children&&r(i.children))return!0}return!1};r(n)})),y(n=>n.map(n=>n.id===e?{...n,title:t}:n))}};return r(je.Provider,{value:M,get children(){return e.children}})};function We(){const t=e(je);if(!t)throw new Error("useWorkspace must be used within a WorkspaceProvider");return t}function Me(e){const t=e.indexOf("+");return t>=0?e.substring(0,t):e}function Ve(e){return e.toString().toLowerCase().trim().replace(/\s+/g,"-").replace(/[^\w-]+/g,"").replace(/--+/g,"-")}function Ue(e,t){return`/w/${e}+${Ve(t||"workspace")}/`}function Be(e,t,n,r){const i=Ve(t||"workspace"),o=r?Ve(r):"";return`/w/${e}+${i}/${n}${o?"+"+o:""}`}function He(e,t,n){if(!e||"user"===e)return"/settings/user";if("server"===e)return"/settings/server";return`/settings/${e}/${t}+${Ve(n||e)}`}function Fe(e){return!e.includes("://")&&!e.startsWith("/")}function qe(e,t){if(!t||0===Object.keys(t).length)return e;let n=e.replace(/!\[([^\]]*)\]\(([^/)][^)]*)\)/g,(e,n,r)=>{if(!Fe(r))return e;const i=t[r];return i?`![${n}](${i})`:e});return n=n.replace(/\[([^\]]+)\]\(([^/)][^)]*)\)/g,(e,n,r)=>{if(!Fe(r))return e;const i=t[r];return i?`[${n}](${i})`:e}),n}const Ge=/^\/assets\/[^/]+\/[^/]+\/([^?]+)/;function Ke(e){const t=e.match(Ge);return t&&t[1]?decodeURIComponent(t[1]):null}function Je(e,t){const n={};for(const[i,o]of Object.entries(t||{}))n[o]=i;let r=e.replace(/!\[([^\]]*)\]\(([^)]+)\)/g,(e,t,r)=>{const i=n[o=r]?n[o]:Ke(o);var o;return i?`![${t}](${i})`:e});return r=r.replace(/\[([^\]]+)\]\(([^)]+)\)/g,(e,t,n)=>{const r=Ke(n);return r?`[${t}](${r})`:e}),r}const Xe=/\[([^\]]*)\]\(\/w\/([^/+]+)(?:\+[^/]*)?\/([A-Za-z0-9]+)(?:\+[^)]*)?\)/g;function Ye(e,t,n){return e&&n&&t&&0!==Object.keys(t).length?e.replace(/\[([^\]]*)\]\((\/w\/([^/+]+)(?:\+[^/]*)?\/([A-Za-z0-9]+)(?:\+[^)]*)?)\)/g,(e,r,i,o,a)=>{if(o!==n)return e;const s=t[a];return void 0!==s?`[${s}](${i})`:e}):e}const Ze=i(),Qe=e=>{const{t:n}=he(),{user:i,wsApi:o}=Te(),{selectedNodeId:a,selectedNodeData:s,updateNodeTitle:l,setLoading:d,setError:u}=We(),[p,g]=t(""),[h,_]=t(""),[f,m]=t(!1),[w,b]=t("idle"),[k,y]=t({}),[$,C]=t(!1),[x,S]=t([]),I=function(e,t){let n=null,r=null;const i=(...i)=>{r=i,null!==n&&clearTimeout(n),n=setTimeout(()=>{n=null,r=null,e(...i)},t)};return i.flush=()=>{if(null!==n&&null!==r){clearTimeout(n);const t=r;n=null,r=null,e(...t)}},i.cancel=()=>{null!==n&&(clearTimeout(n),n=null,r=null)},i.pending=()=>null!==n,i}(async()=>{const e=a(),t=o();if(e&&f()&&t)try{b("saving"),await t.nodes.page.updatePage(e,{title:p(),content:h()}),m(!1),b("saved");const n=i()?.workspace_id,r=i()?.workspace_name;if(n){const t=window.location.pathname,i=Be(n,r,e,p());t!==i&&window.history.replaceState(null,"",i)}setTimeout(()=>{"saved"===w()&&b("idle")},2e3)}catch(r){u(`${n("errors.autoSaveFailed")}: ${r}`),b("idle")}},2e3);async function D(e){const t=o(),n=i()?.workspace_id;if(!t||!n||!e)return void y({});const r=function(e,t){if(!e||!t)return[];const n=new Set,r=new RegExp(Xe.source,"g");let i;for(;null!==(i=r.exec(e));){const e=i[2],r=i[3];e===t&&r&&!n.has(r)&&n.add(r)}return Array.from(n)}(e,n);if(0!==r.length)try{const e=await t.nodes.getNodeTitles({IDs:r.join(",")});y(e.titles||{})}catch{y({})}else y({})}function T(){g(""),_(""),m(!1),b("idle"),C(!1),S([]),y({})}v(()=>{I.flush()}),c(()=>{const e=s();e?(g(e.title),_(e.content||""),m(!1),b("idle"),C(!1),D(e.content||"")):T()});const E={title:p,setTitle:g,content:h,setContent:_,hasUnsavedChanges:f,setHasUnsavedChanges:m,autoSaveStatus:w,assetUrls:()=>s()?.asset_urls||{},linkedNodeTitles:k,showHistory:$,setShowHistory:C,history:x,loadHistory:async function(e){if($())return void C(!1);const t=o();if(t)try{d(!0);const n=await t.nodes.history.listNodeVersions(e,{Limit:100});S(n.history?.filter(Boolean)||[]),C(!0)}catch(r){u(`${n("errors.failedToLoad")}: ${r}`)}finally{d(!1)}},triggerAutoSave:I,flushAutoSave:I.flush,resetEditor:T,handleTitleChange:function(e){g(e);const t=a();t&&l(t,e),m(!0),I()},handleContentChange:function(e){_(e),m(!0),I()}};return r(Ze.Provider,{value:E,get children(){return e.children}})};function et(){const t=e(Ze);if(!t)throw new Error("useEditor must be used within an EditorProvider");return t}const tt=i(),nt=e=>{const{t:n}=he(),{wsApi:i}=Te(),{selectedNodeId:o,selectedNodeData:a,loading:s,setLoading:l,setError:d}=We(),[u,p]=t([]),[g,v]=t(!1),[_,f]=t([]),[m,w]=t(),[b,k]=t([]),[y,$]=t([]),C="__default__";function x(){p([]),v(!1),f([]),w(void 0),k([]),$([])}function S(e){if(e===m())return;const t=_().find(t=>t.id===e);h(()=>{w(e),t?(k(t.filters||[]),$(t.sorts||[])):(k([]),$([]))});const n=o();n&&I(n)}async function I(e){const t=i();if(t)try{l(!0);const n=b().length>0?JSON.stringify(b()):void 0,r=y().length>0?JSON.stringify(y()):void 0,i=m(),o=i===C?"":i||"",a=(await t.nodes.table.records.listRecords(e,{Offset:0,Limit:50,ViewID:o,Filters:n||"",Sorts:r||""})).records||[];p(a),v(50===a.length)}catch(r){d(`${n("errors.failedToLoad")}: ${r}`)}finally{l(!1)}}c(()=>{const e=a();e?.has_table?(h(()=>{const t=e.views||[];if(t.length>0){f(t);const e=t.find(e=>e.default)||t[0];e&&(w(e.id),k(e.filters||[]),$(e.sorts||[]))}else{const e={id:C,name:n("table.all")||"All",type:"table",default:!0,filters:[],sorts:[],columns:[],groups:[]};f([e]),w(C),k([]),$([])}}),I(e.id)):x()});const D={records:u,hasMore:g,views:_,activeViewId:m,activeFilters:b,activeSorts:y,loadRecords:I,loadMoreRecords:async function(){const e=o(),t=i();if(e&&!s()&&t)try{l(!0);const n=u().length,r=b().length>0?JSON.stringify(b()):void 0,i=y().length>0?JSON.stringify(y()):void 0,o=m(),a=o===C?"":o||"",s=(await t.nodes.table.records.listRecords(e,{Offset:n,Limit:50,ViewID:a,Filters:r||"",Sorts:i||""})).records||[];p([...u(),...s]),v(50===s.length)}catch(r){d(`${n("errors.failedToLoad")}: ${r}`)}finally{l(!1)}},addRecord:async function(e){const t=o(),r=i();if(t&&r)try{l(!0),await r.nodes.table.records.createRecord(t,{data:e}),await I(t),d(null)}catch(a){d(`${n("errors.failedToCreate")}: ${a}`)}finally{l(!1)}},updateRecord:async function(e,t){const r=o(),a=i();if(r&&a)try{l(!0),await a.nodes.table.records.updateRecord(r,e,{data:t}),await I(r),d(null)}catch(s){d(`${n("errors.failedToSave")}: ${s}`)}finally{l(!1)}},deleteRecord:async function(e){const t=o(),r=i();if(t&&r&&confirm(n("table.confirmDeleteRecord")||"Delete this record?"))try{l(!0),await r.nodes.table.records.deleteRecord(t,e),await I(t),d(null)}catch(a){d(`${n("errors.failedToDelete")}: ${a}`)}finally{l(!1)}},clearRecords:x,setActiveViewId:S,setFilters:function(e){k(e);const t=o();t&&I(t)},setSorts:function(e){$(e);const t=o();t&&I(t)},createView:async function(e,t){const r=o(),a=i();if(r&&a)try{l(!0);const n=await a.nodes.views.createView(r,{name:e,type:t}),i={id:n.id,name:e,type:t,default:!1,filters:[],sorts:[],columns:[],groups:[]};h(()=>{f([..._(),i]),w(n.id),k([]),$([])})}catch(s){d(`${n("errors.failedToCreate")}: ${s}`)}finally{l(!1)}},updateView:async function(e,t){const r=o(),a=i();if(r&&a)try{l(!0),await a.nodes.views.updateView(r,e,t),f(_().map(n=>n.id===e?{...n,...t}:n)),e===m()&&(t.filters&&k(t.filters),t.sorts&&$(t.sorts),(t.filters||t.sorts)&&await I(r))}catch(s){d(`${n("errors.failedToSave")}: ${s}`)}finally{l(!1)}},deleteView:async function(e){const t=o(),r=i();if(t&&r&&confirm(n("table.confirmDeleteView")||"Delete this view?"))try{l(!0),await r.nodes.views.deleteView(t,e);const n=_().filter(t=>t.id!==e);if(f(n),m()===e){const e=n[0];S(e?e.id:void 0)}}catch(a){d(`${n("errors.failedToDelete")}: ${a}`)}finally{l(!1)}}};return r(tt.Provider,{value:D,get children(){return e.children}})};function rt(){const t=e(tt);if(!t)throw new Error("useRecords must be used within a RecordsProvider");return t}const it="_errorBoundary_1gyxj_3",ot="_errorMessage_1gyxj_21",at="_errorDetails_1gyxj_27",st="_retryButton_1gyxj_51";var lt=k("<div role=alert><h2>Something went wrong</h2><p></p><details><summary>Technical details</summary><pre></pre></details><button>Try again");function dt(e){return t=lt(),n=t.firstChild.nextSibling,r=n.nextSibling,i=r.firstChild.nextSibling,o=r.nextSibling,m(n,()=>e.error.message),m(i,()=>e.error.stack),o.$$click=()=>e.reset(),w(e=>{var i=it,a=ot,s=at,l=st;return i!==e.e&&b(t,e.e=i),a!==e.t&&b(n,e.t=a),s!==e.a&&b(r,e.a=s),l!==e.o&&b(o,e.o=l),e},{e:void 0,t:void 0,a:void 0,o:void 0}),t;var t,n,r,i,o}const ct=e=>r(f,{fallback:(e,t)=>r(dt,{error:e,reset:t}),get children(){return e.children}});_(["click"]);const ut="_banner_172qk_1",pt="_content_172qk_23",gt="_title_172qk_27",ht="_message_172qk_32",vt="_actions_172qk_37",_t="_installButton_172qk_42",ft="_dismissButton_172qk_56";var mt=k("<div><div><div></div><div></div></div><div><button></button><button>");const wt="mddb_pwa_dismissed";function bt(){const{t:e}=he(),[n,i]=t(null),[o,a]=t(!1);d(()=>{if(function(){const e=localStorage.getItem(wt);if(!e)return!1;const t=new Date(e);return((new Date).getTime()-t.getTime())/864e5<30}())return;const e=e=>{e.preventDefault(),i(e),a(!0)},t=()=>{a(!1),i(null)};window.addEventListener("beforeinstallprompt",e),window.addEventListener("appinstalled",t),v(()=>{window.removeEventListener("beforeinstallprompt",e),window.removeEventListener("appinstalled",t)})});const s=async()=>{const e=n();if(!e)return;await e.prompt();const{outcome:t}=await e.userChoice;"accepted"===t&&a(!1),i(null)},l=()=>{localStorage.setItem(wt,(new Date).toISOString()),a(!1)};return r(y,{get when(){return $(()=>!!o())()&&n()},get children(){var t=mt(),n=t.firstChild,r=n.firstChild,i=r.nextSibling,o=n.nextSibling,a=o.firstChild,d=a.nextSibling;return m(r,()=>e("pwa.installTitle")),m(i,()=>e("pwa.installMessage")),a.$$click=l,m(a,()=>e("pwa.dismissButton")),d.$$click=s,m(d,()=>e("pwa.installButton")),w(e=>{var s=ut,l=pt,c=gt,u=ht,p=vt,g=ft,h=_t;return s!==e.e&&b(t,e.e=s),l!==e.t&&b(n,e.t=l),c!==e.a&&b(r,e.a=c),u!==e.o&&b(i,e.o=u),p!==e.i&&b(o,e.i=p),g!==e.n&&b(a,e.n=g),h!==e.s&&b(d,e.s=h),e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),t}})}_(["click"]);const kt="_navItemWrapper_p232u_3",yt="_navItem_p232u_3",$t="_active_p232u_27",Ct="_section_p232u_34",xt="_separator_p232u_56",St="_expandIcon_p232u_62",It="_expanded_p232u_80",Dt="_expandSpacer_p232u_84",Tt="_label_p232u_90",Et="_children_p232u_97";var Rt=k("<span>"),Lt=k("<div>"),Nt=k("<div><a><span>");function Pt(e){const n=()=>e.item.children&&e.item.children.length>0,i=()=>{if(!n())return!1;const t=e.currentRoute,r=n=>{for(const i of n){if(e.isActive(i.url,t))return!0;if(i.children&&r(i.children))return!0}return!1};return r(e.item.children||[])},[o,a]=t(C(()=>0===e.depth||i()));c(()=>{e.currentRoute&&i()&&a(!0)});const s=t=>{t.preventDefault(),n()&&!e.item.url?a(!o()):e.item.url&&(n()&&a(!0),e.onNavigate(e.item.url))},l=e=>{e.preventDefault(),e.stopPropagation(),a(!o())};return d=Nt(),u=d.firstChild,p=u.firstChild,u.$$click=s,m(u,r(y,{get when(){return n()},get fallback(){return e=Rt(),w(()=>b(e,Dt)),e;var e},get children(){var e=Rt();return e.$$click=l,m(e,r(x,{})),w(()=>b(e,(()=>{let e=St;return o()&&(e+=" "+It),e})())),e}}),p),m(p,()=>e.item.label),m(d,r(y,{get when(){return $(()=>!!o())()&&n()},get children(){var t=Lt();return m(t,r(S,{get each(){return e.item.children},children:t=>r(Pt,{item:t,get depth(){return e.depth+1},get isActive(){return e.isActive},get onNavigate(){return e.onNavigate},get currentRoute(){return e.currentRoute}})})),w(()=>b(t,Et)),t}}),null),w(t=>{var r=kt,i=e.item.url||"#",o=(()=>{let t=yt;return e.isActive(e.item.url,e.currentRoute)&&(t+=" "+$t),0===e.depth&&n()&&(t+=" "+Ct),e.item.separator&&(t+=" "+xt),t})(),a=12*e.depth+16+"px",s=Tt;return r!==t.e&&b(d,t.e=r),i!==t.t&&I(u,"href",t.t=i),o!==t.a&&b(u,t.a=o),a!==t.o&&D(u,"padding-left",t.o=a),s!==t.i&&b(p,t.i=s),t},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),d;var d,u,p}_(["click"]);const At="_sidebar_dpyfy_3",Ot="_nav_dpyfy_13",jt="_mobileOpen_dpyfy_31";var zt=k("<aside><nav>");function Wt(e){const{t:t}=he(),{user:n}=Te(),i=T(),o=E(),a=()=>e.currentRoute??(()=>{const e=i.pathname,t=i.hash?.slice(1)||void 0;if("/settings/user"===e||"/settings/user/"===e)return{type:"profile"};if("/settings/server"===e||"/settings/server/"===e)return{type:"server"};const n=e.match(/^\/settings\/workspace\/([^+/]+)/);if(n)return{type:"workspace",id:n[1],section:t};const r=e.match(/^\/settings\/org\/([^+/]+)/);return r?{type:"org",id:r[1],section:t}:{type:"profile"}})(),s=t=>{e.onNavigate?e.onNavigate(t):o(t)},l=(e,t)=>{if(!e)return!1;if("/settings/user"===e&&"profile"===t.type)return!0;if("/settings/server"===e&&"server"===t.type)return!0;if("workspace"===t.type&&t.id){const n=e.match(/^\/settings\/workspace\/([^+/]+)/);if(n&&n[1]===t.id){const[,n]=e.split("#");return n?t.section===n:!t.section}}if("org"===t.type&&t.id){const n=e.match(/^\/settings\/org\/([^+/]+)/);if(n&&n[1]===t.id){const[,n]=e.split("#");return n?t.section===n:!t.section}}return!1};return d=zt(),c=d.firstChild,m(c,r(S,{get each(){return(()=>{const e=[],r=n();if(!r)return e;e.push({id:"user",label:t("settings.personal"),url:He("user")});const i=r.workspaces||[];if(i.length>0){const n=i.map(e=>{const n=e.workspace_id,r=e.workspace_name||n,i=e.role===Ne,o=[{id:`ws-${n}-members`,label:t("settings.members"),url:He("workspace",n,r)+"#members"},{id:`ws-${n}-settings`,label:t("settings.settings"),url:He("workspace",n,r)+"#settings"}];return i&&o.push({id:`ws-${n}-sync`,label:t("settings.gitSync"),url:He("workspace",n,r)+"#sync"}),{id:`ws-${n}`,label:r,url:He("workspace",n,r),children:o}});e.push({id:"workspaces",label:t("settings.workspaces"),url:"",children:n})}const o=(r.organizations||[]).filter(e=>e.role===Le||e.role===Re);if(o.length>0){const n=o.map(e=>{const n=e.organization_id,r=e.organization_name||n;return{id:`org-${n}`,label:r,url:He("org",n,r),children:[{id:`org-${n}-members`,label:t("settings.members"),url:He("org",n,r)+"#members"},{id:`org-${n}-settings`,label:t("settings.settings"),url:He("org",n,r)+"#settings"}]}});e.push({id:"organizations",label:t("settings.organizations"),url:"",children:n})}return r.is_global_admin&&e.push({id:"server",label:t("server.serverSettings"),url:He("server")}),e.push({id:"privacy",label:t("app.privacyPolicy"),url:"/privacy",separator:!0}),e.push({id:"terms",label:t("app.terms"),url:"/terms"}),e})()},children:e=>r(Pt,{item:e,depth:0,isActive:l,onNavigate:s,get currentRoute(){return a()}})})),w(t=>{var n=`${At} ${e.isOpen?jt:""}`,r=Ot;return n!==t.e&&b(d,t.e=n),r!==t.t&&b(c,t.t=r),t},{e:void 0,t:void 0}),d;var d,c}const Mt="_settingsPage_1ihhv_3",Vt="_header_1ihhv_10",Ut="_headerLeft_1ihhv_21",Bt="_hamburger_1ihhv_27",Ht="_backButton_1ihhv_37",Ft="_title_1ihhv_53",qt="_layout_1ihhv_64",Gt="_content_1ihhv_70",Kt="_mobileBackdrop_1ihhv_81";var Jt=k("<div>"),Xt=k('<div><header><div><button aria-label="Toggle settings menu">&#9776;</button><button>&larr; </button><h1></h1></div></header><div><main>');function Yt(e){const{t:n}=he(),{user:i}=Te(),o=E(),a=T(),[s,l]=t(!1),c=e=>{"Escape"===e.key&&s()&&l(!1)};d(()=>{window.addEventListener("keydown",c),v(()=>window.removeEventListener("keydown",c))});const u=()=>{o(-1)},p=()=>{const e=i()?.workspace_id,t=i()?.workspace_name;e&&o(Ue(e,t))},g=e=>{l(!1),o(e)};return(()=>{var t=Xt(),i=t.firstChild,o=i.firstChild,d=o.firstChild,c=d.nextSibling;c.firstChild;var h=c.nextSibling,v=i.nextSibling,_=v.firstChild;return d.$$click=()=>l(!s()),c.$$click=u,m(c,()=>n("common.back"),null),h.$$click=p,m(h,()=>n("settings.title")),m(v,r(y,{get when(){return s()},get children(){var e=Jt();return e.$$click=()=>l(!1),w(()=>b(e,Kt)),e}}),_),m(v,r(Wt,{get isOpen(){return s()},get currentRoute(){return(()=>{const e=a.pathname,t=a.hash?.slice(1)||void 0;if("/settings/user"===e||"/settings/user/"===e)return{type:"profile"};if("/settings/server"===e||"/settings/server/"===e)return{type:"server"};const n=e.match(/^\/settings\/workspace\/([^+/]+)/);if(n)return{type:"workspace",id:n[1],section:t};const r=e.match(/^\/settings\/org\/([^+/]+)/);return r?{type:"org",id:r[1],section:t}:{type:"profile"}})()},onNavigate:g}),_),m(_,()=>e.children),w(e=>{var n=Mt,r=Vt,a=Ut,s=Bt,l=Ht,u=Ft,p=qt,g=Gt;return n!==e.e&&b(t,e.e=n),r!==e.t&&b(i,e.t=r),a!==e.a&&b(o,e.a=a),s!==e.o&&b(d,e.o=s),l!==e.i&&b(c,e.i=l),u!==e.n&&b(h,e.n=u),p!==e.s&&b(v,e.s=p),g!==e.h&&b(_,e.h=g),e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),t})()}_(["click"]);var Zt=k("<div style=padding:2rem;color:var(--c-text-light)>");const Qt=P(()=>ce(()=>import("./ProfileSettings-ocxfe9Px.js"),__vite__mapDeps([0,1,2,3]))),en=P(()=>ce(()=>import("./WorkspaceSettingsPanel-CHeSDBAE.js"),__vite__mapDeps([4,1,5,6,2,7]))),tn=P(()=>ce(()=>import("./OrgSettingsPanel-DgVW6JYI.js"),__vite__mapDeps([8,1,5,6,2,9]))),nn=P(()=>ce(()=>import("./ServerSettingsPanel-N804IKPQ.js"),__vite__mapDeps([10,1,2,11])));function rn(){const{t:e}=he();return t=Zt(),m(t,()=>e("common.loading")),t;var t}function on(){const{user:e}=Te();return r(y,{get when(){return e()?.is_global_admin},get fallback(){return r(R,{href:"/settings/user"})},get children(){return r(L,{get fallback(){return r(rn,{})},get children(){return r(nn,{})}})}})}function an(){const e=N(),t=T(),n=E(),{user:i}=Te(),o=()=>{const t=e.wsId;return t?.split("+")[0]||""},a=(e,t)=>{n(He("org",e,t))};return r(y,{get when(){return(()=>{const e=i();return e?.workspaces?.some(e=>e.workspace_id===o())})()},get fallback(){return r(R,{href:"/settings/user"})},get children(){return r(L,{get fallback(){return r(rn,{})},get children(){return r(en,{get wsId(){return o()},get section(){return t.hash?.slice(1)||void 0},onNavigateToOrgSettings:a})}})}})}function sn(){const e=N(),t=T(),{user:n}=Te(),i=()=>{const t=e.orgId;return t?.split("+")[0]||""};return r(y,{get when(){return(()=>{const e=n();return e?.organizations?.some(e=>e.organization_id===i())})()},get fallback(){return r(R,{href:"/settings/user"})},get children(){return r(L,{get fallback(){return r(rn,{})},get children(){return r(tn,{get orgId(){return i()},get section(){return t.hash?.slice(1)||void 0}})}})}})}function ln(){return r(L,{get fallback(){return r(rn,{})},get children(){return r(Qt,{})}})}function dn(){return r(R,{href:"/settings/user"})}function cn(e){return r(Yt,{get children(){return e.children}})}function un(e,t){d(()=>{const n=n=>{const r=e();r&&!r.contains(n.target)&&t()};document.addEventListener("mousedown",n),v(()=>{document.removeEventListener("mousedown",n)})})}const pn="_sidebarNodeWrapper_13zjr_1",gn="_childList_13zjr_2",hn="_pageItem_13zjr_13",vn="_active_13zjr_28",_n="_iconSlot_13zjr_34",fn="_hasChildren_13zjr_44",mn="_nodeIcon_13zjr_48",wn="_expandIcon_13zjr_60",bn="_pageTitleText_13zjr_65",kn="_loading_13zjr_93",yn="_expanded_13zjr_98",$n="_contextMenu_13zjr_122",Cn="_contextMenuItem_13zjr_134",xn="_contextMenuDivider_13zjr_151",Sn="_hoverDeleteButton_13zjr_158";var In=k("<div><button data-testid=create-subpage-button> </button><button data-testid=create-subtable-button> </button><div></div><button data-testid=show-history-button> "),Dn=k("<ul>"),Tn=k("<li><div><span><span></span><span></span></span><span></span><button data-testid=delete-node-button>");function En(e){const{t:n}=he(),i=C(()=>0===e.depth||e.ancestorIds.includes(e.node.id)),[o,a]=t(i),[s,l]=t(!1),[d,u]=t({x:0,y:0}),[p,g]=t(!1);let h;un(()=>h,()=>l(!1));const v=()=>e.node.children??[],_=()=>!!(e.node.children&&e.node.children.length>0)||!0===e.node.has_children;c(()=>{const t=e.selectedId,n=v();t&&n.some(e=>e.id===t)&&a(!0)});let f=!1;c(A(()=>e.ancestorIds.length,(t,n)=>{(void 0===n||0===n)&&t>0&&!f&&e.ancestorIds.includes(e.node.id)&&(f=!0,a(!0))})),c(()=>{o()&&_()&&!e.node.children&&e.onFetchChildren&&(g(!0),e.onFetchChildren(e.node.id).finally(()=>g(!1)))});const k=e=>{e.preventDefault(),e.stopPropagation(),u({x:e.clientX,y:e.clientY}),l(!0)};return R=Tn(),L=R.firstChild,N=L.firstChild,P=N.firstChild,U=P.nextSibling,B=N.nextSibling,H=B.nextSibling,L.$$contextmenu=k,L.$$click=()=>e.onSelect(e.node),N.$$click=e=>_()&&(e=>{e.stopPropagation(),a(!o())})(e),m(P,(T=$(()=>!(!e.node.has_table||e.node.has_page)),()=>T()?r(O,{}):r(j,{}))),m(U,(E=$(()=>!!p()),()=>E()?"â—‹":r(x,{}))),m(B,()=>e.node.title),H.$$click=t=>{t.stopPropagation(),e.onDeleteNode?.(e.node.id)},m(H,r(z,{})),m(R,r(y,{get when(){return s()},get children(){var t=In(),i=t.firstChild,o=i.firstChild,a=i.nextSibling,s=a.firstChild,c=a.nextSibling,u=c.nextSibling,p=u.firstChild;return t.$$click=e=>e.stopPropagation(),"function"==typeof h?V(h,t):h=t,i.$$click=()=>{e.onCreateChildPage(e.node.id),l(!1)},m(i,r(j,{}),o),m(i,()=>n("app.createSubPage"),null),a.$$click=()=>{e.onCreateChildTable(e.node.id),l(!1)},m(a,r(O,{}),s),m(a,()=>n("app.createSubTable"),null),u.$$click=()=>{e.onShowHistory?.(e.node.id),l(!1)},m(u,r(W,{}),p),m(u,()=>n("editor.history"),null),w(e=>{var n=$n,r=`${d().x}px`,o=`${d().y}px`,s=Cn,l=Cn,p=xn,g=Cn;return n!==e.e&&b(t,e.e=n),r!==e.t&&D(t,"left",e.t=r),o!==e.a&&D(t,"top",e.a=o),s!==e.o&&b(i,e.o=s),l!==e.i&&b(a,e.i=l),p!==e.n&&b(c,e.n=p),g!==e.s&&b(u,e.s=g),e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),t}}),null),m(R,r(y,{get when(){return $(()=>!!o())()&&v().length>0},get children(){var t=Dn();return m(t,r(S,{get each(){return v()},children:t=>r(En,{node:t,get selectedId(){return e.selectedId},get ancestorIds(){return e.ancestorIds},get onSelect(){return e.onSelect},get onCreateChildPage(){return e.onCreateChildPage},get onCreateChildTable(){return e.onCreateChildTable},get onFetchChildren(){return e.onFetchChildren},get onDeleteNode(){return e.onDeleteNode},get onShowHistory(){return e.onShowHistory},get depth(){return e.depth+1}})})),w(()=>b(t,gn)),t}}),null),w(t=>{var r=pn,i=`sidebar-node-${e.node.id}`,a=hn,s={[`${vn}`]:e.selectedId===e.node.id},l=12*e.depth+8+"px",d=_n,c={[`${fn}`]:_()},u=`expand-icon-${e.node.id}`,g=mn,h=wn,v={[`${yn}`]:o(),[`${kn}`]:p()},f=bn,m=Sn,w=n("common.delete")||"Delete";return r!==t.e&&b(R,t.e=r),i!==t.t&&I(R,"data-testid",t.t=i),a!==t.a&&b(L,t.a=a),t.o=M(L,s,t.o),l!==t.i&&D(L,"padding-left",t.i=l),d!==t.n&&b(N,t.n=d),t.s=M(N,c,t.s),u!==t.h&&I(N,"data-testid",t.h=u),g!==t.r&&b(P,t.r=g),h!==t.d&&b(U,t.d=h),t.l=M(U,v,t.l),f!==t.u&&b(B,t.u=f),m!==t.c&&b(H,t.c=m),w!==t.w&&I(H,"title",t.w=w),t},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0}),R;var T,E,R,L,N,P,U,B,H}_(["click","contextmenu"]);const Rn="_sidebar_1pc1u_1",Ln="_open_1pc1u_16",Nn="_collapseButton_1pc1u_20",Pn="_workspaceHeader_1pc1u_43",An="_workspaceName_1pc1u_52",On="_editable_1pc1u_63",jn="_workspaceNameInput_1pc1u_74",zn="_settingsButton_1pc1u_92",Wn="_loading_1pc1u_122",Mn="_pageList_1pc1u_128",Vn="_otherWorkspaces_1pc1u_137",Un="_otherWorkspacesToggle_1pc1u_142",Bn="_toggleChevron_1pc1u_160",Hn="_expanded_1pc1u_171",Fn="_otherWorkspacesList_1pc1u_175",qn="_orgLabel_1pc1u_179",Gn="_otherWorkspaceItem_1pc1u_188",Kn="_sidebarActions_1pc1u_209",Jn="_actionButton_1pc1u_215",Xn="_actionIcon_1pc1u_237";var Yn=k("<input type=text>"),Zn=k("<p>"),Qn=k("<button><span>"),er=k("<div>"),tr=k("<aside><div><button data-testid=workspace-settings-button></button><button></button></div><ul></ul><div><div><button data-testid=create-workspace-button><span></span></button><button data-testid=import-notion-button><span>"),nr=k("<span>"),rr=k("<button>");function ir(e){const{t:n}=he(),{user:i,wsApi:o,refreshUser:a}=Te(),{switchWorkspace:s}=We(),[d,c]=t(!1),[u,p]=t(!1),[g,h]=t(""),[v,_]=t(!1),f=()=>i()?.workspace_id||"",k=()=>{const e=i();if(!e)return n("app.workspace");const t=e.workspaces?.find(t=>t.workspace_id===e.workspace_id);return t?.workspace_name||n("app.workspace")},C=()=>i()?.workspace_role===Ne,D=()=>{C()&&(h(k()),p(!0))},T=()=>{p(!1),h("")},E=async()=>{const e=o(),t=g().trim();if(e&&t&&t!==k())try{_(!0),await e.workspaces.updateWorkspace({name:t}),await a(),p(!1)}catch(n){console.error("Failed to update workspace name:",n)}finally{_(!1)}else T()},R=e=>{"Enter"===e.key?(e.preventDefault(),E()):"Escape"===e.key&&(e.preventDefault(),T())},L=l(()=>{const e=i();if(!e)return[];const t=new Map,n=e.organizations||[],r=e.workspaces||[];for(const i of n)t.set(i.organization_id,{orgId:i.organization_id,orgName:i.organization_name||i.organization_id,workspaces:[]});for(const i of r){const e=t.get(i.organization_id);e&&e.workspaces.push(i)}return Array.from(t.values()).filter(e=>e.workspaces.length>0)}),N=l(()=>{const e=f();return L().flatMap(t=>t.workspaces.filter(t=>t.workspace_id!==e))}),P=l(()=>L().length>1);return A=tr(),O=A.firstChild,j=O.firstChild,z=j.nextSibling,W=O.nextSibling,M=W.nextSibling,q=M.firstChild,G=q.firstChild,K=G.firstChild,J=G.nextSibling,X=J.firstChild,m(O,r(y,{get when(){return u()},get fallback(){return(e=nr()).$$click=D,m(e,k),w(t=>{var r=`${An} ${C()?On:""}`,i=C()?n("settings.clickToEditName")||"Click to edit name":void 0;return r!==t.e&&b(e,t.e=r),i!==t.t&&I(e,"title",t.t=i),t},{e:void 0,t:void 0}),e;var e},get children(){var e=Yn();return e.addEventListener("blur",E),e.$$keydown=R,e.$$input=e=>h(e.target.value),V(e=>setTimeout(()=>e.focus(),0),e),w(t=>{var n=jn,r=v();return n!==t.e&&b(e,t.e=n),r!==t.t&&(e.disabled=t.t=r),t},{e:void 0,t:void 0}),w(()=>e.value=g()),e}}),j),j.$$click=()=>e.onOpenSettings(),m(j,r(U,{})),z.$$click=()=>e.onCloseMobileSidebar(),m(z,r(B,{})),m(A,r(y,{get when(){return $(()=>!!e.loading)()&&0===e.nodes.length},get children(){var e=Zn();return m(e,()=>n("common.loading")),w(()=>b(e,Wn)),e}}),W),m(W,r(S,{get each(){return e.nodes},children:t=>r(En,{node:t,get selectedId(){return e.selectedNodeId},get ancestorIds(){return e.ancestorIds},get onSelect(){return e.onSelectNode},get onCreateChildPage(){return e.onCreateChildPage},get onCreateChildTable(){return e.onCreateChildTable},get onFetchChildren(){return e.onFetchChildren},get onDeleteNode(){return e.onDeleteNode},get onShowHistory(){return e.onShowHistory},depth:0})})),m(M,r(y,{get when(){return N().length>0},get children(){return[(e=Qn(),t=e.firstChild,e.$$click=()=>c(!d()),m(t,r(x,{})),m(e,()=>n("app.otherWorkspaces")||"Other workspaces",null),w(n=>{var r=Un,i=`${Bn} ${d()?Hn:""}`;return r!==n.e&&b(e,n.e=r),i!==n.t&&b(t,n.t=i),n},{e:void 0,t:void 0}),e),r(y,{get when(){return d()},get children(){var e=er();return m(e,r(S,{get each(){return L()},children:e=>[r(y,{get when(){return P()},get children(){var t=er();return m(t,()=>e.orgName),w(()=>b(t,qn)),t}}),r(S,{get each(){return e.workspaces.filter(e=>e.workspace_id!==f())},children:e=>{return(t=rr()).$$click=()=>{var t;(t=e.workspace_id)!==f()&&s(t)},m(t,()=>e.workspace_name||e.workspace_id),w(()=>b(t,Gn)),t;var t}})]})),w(()=>b(e,Fn)),e}})];var e,t}}),q),G.$$click=()=>e.onCreateWorkspace(),m(K,r(H,{})),m(G,()=>n("createWorkspace.title")||"Create workspace",null),J.$$click=()=>e.onImportFromNotion(),m(X,r(F,{})),m(J,()=>n("notionImport.title")||"Import from Notion",null),w(t=>{var r=`${Rn} ${e.isOpen?Ln:""}`,i=Pn,o=zn,a=n("app.settings")||"Settings",s=Nn,l=n("app.collapseSidebar")||"Collapse sidebar",d=Mn,c=Vn,u=Kn,p=Jn,g=Xn,h=Jn,v=Xn;return r!==t.e&&b(A,t.e=r),i!==t.t&&b(O,t.t=i),o!==t.a&&b(j,t.a=o),a!==t.o&&I(j,"title",t.o=a),s!==t.i&&b(z,t.i=s),l!==t.n&&I(z,"title",t.n=l),d!==t.s&&b(W,t.s=d),c!==t.h&&b(M,t.h=c),u!==t.r&&b(q,t.r=u),p!==t.d&&b(G,t.d=p),g!==t.l&&b(K,t.l=g),h!==t.u&&b(J,t.u=h),v!==t.c&&b(X,t.c=v),t},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0}),A;var A,O,j,z,W,M,q,G,K,J,X}_(["input","keydown","click"]);const or="_userMenu_o60yu_1",ar="_avatarButton_o60yu_5",sr="_avatarImage_o60yu_24",lr="_initials_o60yu_30",dr="_dropdown_o60yu_37",cr="_userInfo_o60yu_50",ur="_userName_o60yu_57",pr="_userEmail_o60yu_63",gr="_userRole_o60yu_68",hr="_divider_o60yu_78",vr="_menuItem_o60yu_83";var _r=k("<span>"),fr=k("<div role=menu><div><span></span><span></span></div><div></div><button role=menuitem></button><button role=menuitem>"),mr=k("<div><button aria-haspopup=menu data-testid=user-menu-button>"),wr=k("<img referrerpolicy=no-referrer>");function br(e){const n=E(),{t:i}=he(),{user:o,logout:a}=Te(),[s,l]=t(!1);let d;const c=()=>{const e=o();if(!e)return"";const t=e.name||e.email||"",n=t.split(/[\s@]+/);return n.length>=2&&n[0]&&n[1]?((n[0][0]||"")+(n[1][0]||"")).toUpperCase():t.slice(0,2).toUpperCase()},u=()=>o()?.name||"",p=()=>o()?.email||"",g=()=>o()?.workspace_role;un(()=>d,()=>l(!1));const h=async()=>{l(!1),await a(),n("/")},v=()=>{l(!1),e.onProfile()};return _=mr(),f=_.firstChild,"function"==typeof d?V(d,_):d=_,f.$$click=()=>l(!s()),m(f,r(y,{get when(){return(()=>{const e=o();if(!e)return null;const t=e.oauth_identities;if(!t)return null;for(const n of t)if(n.avatar_url)return n.avatar_url;return null})()},get fallback(){return e=_r(),m(e,c),w(()=>b(e,lr)),e;var e},children:e=>{return t=wr(),w(n=>{var r=e(),i=u()||"User",o=sr;return r!==n.e&&I(t,"src",n.e=r),i!==n.t&&I(t,"alt",n.t=i),o!==n.a&&b(t,n.a=o),n},{e:void 0,t:void 0,a:void 0}),t;var t}})),m(_,r(y,{get when(){return s()},get children(){var e=fr(),t=e.firstChild,n=t.firstChild,o=n.nextSibling,a=t.nextSibling,s=a.nextSibling,l=s.nextSibling;return m(n,u),m(o,p),m(t,r(y,{get when(){return g()},get children(){var e=_r();return m(e,g),w(()=>b(e,gr)),e}}),null),s.$$click=v,m(s,()=>i("userMenu.profile")),l.$$click=h,m(l,()=>i("userMenu.logout")),w(r=>{var i=dr,d=cr,c=ur,u=pr,p=hr,g=vr,h=vr;return i!==r.e&&b(e,r.e=i),d!==r.t&&b(t,r.t=d),c!==r.a&&b(n,r.a=c),u!==r.o&&b(o,r.o=u),p!==r.i&&b(a,r.i=p),g!==r.n&&b(s,r.n=g),h!==r.s&&b(l,r.s=h),r},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),e}}),null),w(e=>{var t=or,n=ar,r=u()||p(),o=i("userMenu.profile")||"User menu",a=s();return t!==e.e&&b(_,e.e=t),n!==e.t&&b(f,e.t=n),r!==e.a&&I(f,"title",e.a=r),o!==e.o&&I(f,"aria-label",e.o=o),a!==e.i&&I(f,"aria-expanded",e.i=a),e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),_;var _,f}_(["click"]);const kr="_banner_tmw21_1",yr="_success_tmw21_11",$r="_error_tmw21_16",Cr="_cancelled_tmw21_21",xr="_icon_tmw21_26",Sr="_content_tmw21_30",Ir="_message_tmw21_37",Dr="_progress_tmw21_41",Tr="_stats_tmw21_46",Er="_stat_tmw21_46",Rr="_statValue_tmw21_58",Lr="_actions_tmw21_63",Nr="_cancelButton_tmw21_68",Pr="_dismissButton_tmw21_82",Ar="_spinner_tmw21_95";var Or=k("<span>&#x21BB;"),jr=k("<span>&#x2713;"),zr=k("<span>&#x2717;"),Wr=k("<span>&#x26A0;"),Mr=k("<span>/<!>: "),Vr=k("<span><span></span> "),Ur=k("<div>"),Br=k("<span>"),Hr=k("<button>"),Fr=k("<div><span></span><div><span></span></div><div>");function qr(e){const{t:t}=he(),n=()=>e.status,i=()=>{switch(n().status){case"running":return t("notionImport.importInProgress");case"completed":return t("notionImport.importCompleted");case"failed":return t("notionImport.importFailed");case"cancelled":return t("notionImport.importCancelled");default:return""}},o=()=>{switch(n().status){case"running":return e=Or(),w(()=>b(e,Ar)),e;case"completed":return jr();case"failed":return zr();case"cancelled":return Wr();default:return null}var e},a=()=>["completed","failed","cancelled"].includes(n().status);return s=Fr(),l=s.firstChild,d=l.nextSibling,c=d.firstChild,u=d.nextSibling,m(l,o),m(c,i),m(d,r(y,{get when(){return $(()=>"running"===n().status)()&&n().message},get children(){var e=Mr(),t=e.firstChild,r=t.nextSibling;return r.nextSibling,m(e,()=>n().progress,t),m(e,()=>n().total,r),m(e,()=>n().message,null),w(()=>b(e,Dr)),e}}),null),m(d,r(y,{get when(){return $(()=>!!a())()&&(n().pages||n().databases||n().records)},get children(){var e=Ur();return m(e,r(y,{get when(){return n().pages},get children(){var e=Vr(),r=e.firstChild;return r.nextSibling,m(r,()=>n().pages),m(e,()=>t("notionImport.pagesImported"),null),w(t=>{var n=Er,i=Rr;return n!==t.e&&b(e,t.e=n),i!==t.t&&b(r,t.t=i),t},{e:void 0,t:void 0}),e}}),null),m(e,r(y,{get when(){return n().databases},get children(){var e=Vr(),r=e.firstChild;return r.nextSibling,m(r,()=>n().databases),m(e,()=>t("notionImport.databasesImported"),null),w(t=>{var n=Er,i=Rr;return n!==t.e&&b(e,t.e=n),i!==t.t&&b(r,t.t=i),t},{e:void 0,t:void 0}),e}}),null),m(e,r(y,{get when(){return n().records},get children(){var e=Vr(),r=e.firstChild;return r.nextSibling,m(r,()=>n().records),m(e,()=>t("notionImport.recordsImported"),null),w(t=>{var n=Er,i=Rr;return n!==t.e&&b(e,t.e=n),i!==t.t&&b(r,t.t=i),t},{e:void 0,t:void 0}),e}}),null),m(e,r(y,{get when(){return n().assets},get children(){var e=Vr(),r=e.firstChild;return r.nextSibling,m(r,()=>n().assets),m(e,()=>t("notionImport.assetsImported"),null),w(t=>{var n=Er,i=Rr;return n!==t.e&&b(e,t.e=n),i!==t.t&&b(r,t.t=i),t},{e:void 0,t:void 0}),e}}),null),m(e,r(y,{get when(){return n().errors},get children(){var e=Vr(),r=e.firstChild;return r.nextSibling,m(r,()=>n().errors),m(e,()=>t("notionImport.errorsEncountered"),null),w(t=>{var n=Er,i=Rr;return n!==t.e&&b(e,t.e=n),i!==t.t&&b(r,t.t=i),t},{e:void 0,t:void 0}),e}}),null),w(()=>b(e,Tr)),e}}),null),m(d,r(y,{get when(){return $(()=>"failed"===n().status)()&&n().message},get children(){var e=Br();return m(e,()=>n().message),w(()=>b(e,Dr)),e}}),null),m(u,r(y,{get when(){return"running"===n().status},get children(){var n=Hr();return n.$$click=()=>e.onCancel(),m(n,()=>t("notionImport.cancel")),w(()=>b(n,Nr)),n}}),null),m(u,r(y,{get when(){return a()},get children(){var n=Hr();return n.$$click=()=>e.onDismiss(),m(n,()=>t("notionImport.dismiss")),w(()=>b(n,Pr)),n}}),null),w(e=>{var t=(()=>{switch(n().status){case"completed":return`${kr} ${yr}`;case"failed":return`${kr} ${$r}`;case"cancelled":return`${kr} ${Cr}`;default:return kr}})(),r=xr,i=Sr,o=Ir,a=Lr;return t!==e.e&&b(s,e.e=t),r!==e.t&&b(l,e.t=r),i!==e.a&&b(d,e.a=i),o!==e.o&&b(c,e.o=o),a!==e.i&&b(u,e.i=a),e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),s;var s,l,d,c,u}_(["click"]);const Gr="_overlay_v0iwf_1",Kr="_modal_v0iwf_11",Jr="_header_v0iwf_28",Xr="_formGroup_v0iwf_53",Yr="_primaryButton_v0iwf_76",Zr="_secondaryButton_v0iwf_99",Qr="_actions_v0iwf_113",ei="_error_v0iwf_127";var ti=k("<button type=button>"),ni=k("<div><div><header><h2></h2><p></p></header><form><div><label></label><input type=text autofocus></div><div><button type=submit>"),ri=k("<div>");function ii(e){const{t:n}=he(),[i,o]=t(""),[a,s]=t(!1),[l,d]=t(null),c=async t=>{if(t.preventDefault(),i().trim())try{s(!0),d(null),await e.onCreate({name:i().trim()}),e.onClose()}catch(n){d(String(n))}finally{s(!1)}},u=t=>{e.isFirstWorkspace||t.target!==t.currentTarget||e.onClose()};return _=ni(),f=_.firstChild,k=f.firstChild,C=k.firstChild,x=C.nextSibling,S=k.nextSibling,D=S.firstChild,T=D.firstChild,E=T.nextSibling,R=D.nextSibling,L=R.firstChild,_.$$click=u,m(C,(p=$(()=>!!e.isFirstWorkspace),()=>p()?n("createWorkspace.firstWorkspaceTitle"):n("createWorkspace.title"))),m(x,(g=$(()=>!!e.isFirstWorkspace),()=>g()?n("createWorkspace.firstWorkspaceDescription"):n("createWorkspace.description"))),m(f,(h=$(()=>!!l()),()=>{return h()&&(e=ri(),m(e,l),w(()=>b(e,ei)),e);var e}),S),S.addEventListener("submit",c),m(T,()=>n("createWorkspace.nameLabel")),E.$$input=e=>o(e.target.value),m(R,r(y,{get when(){return!e.isFirstWorkspace},get children(){var t=ti();return t.$$click=()=>e.onClose(),m(t,()=>n("common.cancel")),w(()=>b(t,Zr)),t}}),L),m(L,(v=$(()=>!!a()),()=>v()?n("common.creating"):n("createWorkspace.create"))),w(t=>{var r=Gr,o=Kr,s=Jr,l=Xr,d=n("createWorkspace.namePlaceholder")||"",c=Qr,u=Yr,p=!i().trim()||a(),g=e.isFirstWorkspace?{flex:1}:void 0;return r!==t.e&&b(_,t.e=r),o!==t.t&&b(f,t.t=o),s!==t.a&&b(k,t.a=s),l!==t.o&&b(D,t.o=l),d!==t.i&&I(E,"placeholder",t.i=d),c!==t.n&&b(R,t.n=c),u!==t.s&&b(L,t.s=u),p!==t.h&&(L.disabled=t.h=p),t.r=q(L,g,t.r),t},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0}),w(()=>E.value=i()),_;var p,g,h,v,_,f,k,C,x,S,D,T,E,R,L}_(["click","input"]);const oi="_overlay_1l8b3_1",ai="_modal_1l8b3_11",si="_header_1l8b3_28",li="_error_1l8b3_43",di="_setupBox_1l8b3_53",ci="_setupHeader_1l8b3_61",ui="_setupTitle_1l8b3_70",pi="_createLink_1l8b3_75",gi="_setupSteps_1l8b3_93",hi="_subSteps_1l8b3_109",vi="_formGroup_1l8b3_119",_i="_actions_1l8b3_137",fi="_primaryButton_1l8b3_143",mi="_secondaryButton_1l8b3_166";var wi=k('<div><div><header><h2></h2><p></p></header><div><div><span></span><a href=https://www.notion.so/profile/integrations/form/new-integration target=_blank rel="noopener noreferrer"> &#x2197;</a></div><ol><li><ol><li></li><li></li><li></li><li></li></ol></li><li><ol><li></li><li></li></ol></li><li><ol><li></li><li></li></ol></li></ol></div><form><div><label></label><input type=password autofocus></div><div><button type=button></button><button type=submit>'),bi=k("<div>");function ki(e){const{t:n}=he(),[r,i]=t(""),[o,a]=t(!1),[s,l]=t(null),c=t=>{"Escape"!==t.key||o()||e.onClose()};d(()=>{document.addEventListener("keydown",c)}),v(()=>{document.removeEventListener("keydown",c)});const u=async t=>{if(t.preventDefault(),r().trim())try{a(!0),l(null),await e.onImport({notionToken:r().trim()}),e.onClose()}catch(n){l(String(n))}finally{a(!1)}},p=t=>{t.target===t.currentTarget&&e.onClose()};return _=wi(),f=_.firstChild,k=f.firstChild,y=k.firstChild,C=y.nextSibling,x=k.nextSibling,S=x.firstChild,D=S.firstChild,T=D.nextSibling,E=T.firstChild,R=S.nextSibling,L=R.firstChild,N=L.firstChild,P=N.firstChild,A=P.nextSibling,O=A.nextSibling,j=O.nextSibling,z=L.nextSibling,W=z.firstChild,M=W.firstChild,V=M.nextSibling,U=z.nextSibling,B=U.firstChild,H=B.firstChild,F=H.nextSibling,q=x.nextSibling,G=q.firstChild,K=G.firstChild,J=K.nextSibling,X=G.nextSibling,Y=X.firstChild,Z=Y.nextSibling,_.$$click=p,m(y,()=>n("notionImport.title")),m(C,()=>n("notionImport.description")),m(f,(g=$(()=>!!s()),()=>{return g()&&(e=bi(),m(e,s),w(()=>b(e,li)),e);var e}),x),m(D,()=>n("notionImport.setupTitle")),m(T,()=>n("notionImport.createIntegration"),E),m(L,()=>n("notionImport.step1Header"),N),m(P,()=>n("notionImport.step1a")),m(A,()=>n("notionImport.step1b")),m(O,()=>n("notionImport.step1c")),m(j,()=>n("notionImport.step1d")),m(z,()=>n("notionImport.step2Header"),W),m(M,()=>n("notionImport.step2a")),m(V,()=>n("notionImport.step2b")),m(U,()=>n("notionImport.step3Header"),B),m(H,()=>n("notionImport.step3a")),m(F,()=>n("notionImport.step3b")),q.addEventListener("submit",u),m(K,()=>n("notionImport.notionToken")),J.$$input=e=>i(e.target.value),Y.$$click=()=>e.onClose(),m(Y,()=>n("common.cancel")),m(Z,(h=$(()=>!!o()),()=>h()?n("notionImport.importing"):n("notionImport.startImport"))),w(e=>{var t=oi,i=ai,a=si,s=di,l=ci,d=ui,c=pi,u=gi,p=hi,g=hi,h=hi,v=vi,m=n("notionImport.notionTokenPlaceholder")||"",w=_i,y=mi,$=fi,C=!r().trim()||o();return t!==e.e&&b(_,e.e=t),i!==e.t&&b(f,e.t=i),a!==e.a&&b(k,e.a=a),s!==e.o&&b(x,e.o=s),l!==e.i&&b(S,e.i=l),d!==e.n&&b(D,e.n=d),c!==e.s&&b(T,e.s=c),u!==e.h&&b(R,e.h=u),p!==e.r&&b(N,e.r=p),g!==e.d&&b(W,e.d=g),h!==e.l&&b(B,e.l=h),v!==e.u&&b(G,e.u=v),m!==e.c&&I(J,"placeholder",e.c=m),w!==e.w&&b(X,e.w=w),y!==e.m&&b(Y,e.m=y),$!==e.f&&b(Z,e.f=$),C!==e.y&&(Z.disabled=e.y=C),e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0}),w(()=>J.value=r()),_;var g,h,_,f,k,y,C,x,S,D,T,E,R,L,N,P,A,O,j,z,W,M,V,U,B,H,F,q,G,K,J,X,Y,Z}_(["click","input"]);const yi="_app_agixi_3",$i="_sidebarOpen_agixi_11",Ci="_hamburger_agixi_15",xi="_header_agixi_19",Si="_headerLeft_agixi_31",Ii="_userInfo_agixi_39",Di="_container_agixi_46",Ti="_main_agixi_52",Ei="_error_agixi_60",Ri="_editor_agixi_68",Li="_editorLoading_agixi_76",Ni="_editorHeader_agixi_81",Pi="_editorStatus_agixi_90",Ai="_unsavedIndicator_agixi_98",Oi="_savingIndicator_agixi_103",ji="_savedIndicator_agixi_108",zi="_titleInput_agixi_118",Wi="_nodeContent_agixi_128",Mi="_tableView_agixi_135",Vi="_breadcrumbs_agixi_143",Ui="_breadcrumbItem_agixi_154",Bi="_breadcrumbSeparator_agixi_165",Hi="_historyPanel_agixi_170",Fi="_historyList_agixi_184",qi="_historyItem_agixi_191",Gi="_activeHistoryItem_agixi_204",Ki="_historyMeta_agixi_209",Ji="_historyDate_agixi_217",Xi="_historyHash_agixi_221",Yi="_historyMessage_agixi_228",Zi="_mobileBackdrop_agixi_247",Qi="_mobileBackdropVisible_agixi_251",eo="_previewPane_agixi_305",to="_previewHeader_agixi_315",no="_previewInfo_agixi_324",ro="_previewMeta_agixi_335",io="_closePreviewButton_agixi_340",oo="_previewContent_agixi_355";var ao=k("<nav>"),so=k("<div role=alert aria-live=polite>"),lo=k('<div><header><div><button aria-label="Toggle menu"></button></div><div></div></header><div><div></div><main>'),co=k("<span>/"),uo=k("<span>");const po=e=>{const{t:n}=he(),i=E(),{user:o,wsApi:a,orgApi:s}=Te(),{nodes:l,selectedNodeId:d,breadcrumbPath:c,loading:u,setLoading:p,error:g,setError:h,switchWorkspace:_,createWorkspace:f,loadNodes:k,fetchNodeChildren:$,removeNode:C}=We(),{flushAutoSave:x,loadHistory:I}=et(),[D,T]=t(window.innerWidth>768),[R,L]=t(!1),[N,P]=t(!1),[A,O]=t(null),[j,z]=t(null),[W,M]=t(null);let V;const U=async e=>{const t=s();if(!t)return;const n=await t.notion.startImport({notion_token:e.notionToken});await _(n.workspace_id);const r=o(),a=r?.workspace_id,l=r?.workspace_name;var d;a&&i(Ue(a,l)),d=n.workspace_id,z(d),V=window.setInterval(async()=>{const e=s();if(e)try{const t=await e.notion.getStatus(d);O(t),["completed","failed","cancelled"].includes(t.status)&&(window.clearInterval(V),V=void 0,"completed"===t.status&&k(!0))}catch{window.clearInterval(V),V=void 0}},2e3),O({status:"running",progress:0,total:0})},B=async()=>{const e=a(),t=j();if(e&&t)try{await e.notion.cancelImport(),O(e=>e?{...e,status:"cancelled"}:null)}catch{}},H=()=>{V&&(window.clearInterval(V),V=void 0),O(null),z(null)};async function F(e="document",t){const r=a();if(r)try{p(!0);const a=t||W()||"0";let s;const l="table"===e?n("welcome.untitledTable")||"Untitled Table":n("welcome.untitledPage")||"Untitled Page";if("table"===e){s=(await r.nodes.table.createTable(a,{title:l,properties:[{name:"Name",type:"text",required:!1}]})).id}else{s=(await r.nodes.page.createPage(a,{title:l})).id}await k(!0);const d=o(),c=d?.workspace_id,u=d?.workspace_name;c&&i(Be(c,u,String(s),l)),h(null),M(null)}catch(s){h(`${n("errors.failedToCreate")}: ${s}`)}finally{p(!1)}}v(()=>{V&&window.clearInterval(V)});const q=e=>{x();const t=o(),n=t?.workspace_id,r=t?.workspace_name;n&&i(Be(n,r,e.id,e.title)),window.innerWidth<=768&&T(!1)};function K(e,t=l,n=null){const r=t.findIndex(t=>t.id===e);if(-1!==r)return{parent:n,siblings:t,index:r};for(const i of t)if(i.children){const t=K(e,i.children,i);if(t)return t}return null}async function J(e){const t=a();if(!t)return;if(!confirm(n("table.confirmDeleteRecord")||"Delete this item?"))return;let r=null;if(e===d()){const t=K(e);if(t){const{parent:e,siblings:n,index:i}=t;e&&"0"!==e.id?r=e:i>0?r=n[i-1]??null:n.length>1&&(r=n[1]??null)}}try{if(p(!0),await t.nodes.deleteNode(e),C(e),e===d()){const e=o(),t=e?.workspace_id,n=e?.workspace_name;r&&t?i(Be(t,n,r.id,r.title)):t&&(await k(!0),i(`/w/${t}+${n||"workspace"}/`))}}catch(s){h(`${n("errors.failedToDelete")}: ${s}`)}finally{p(!1)}}return X=lo(),Y=X.firstChild,Z=Y.firstChild,Q=Z.firstChild,ee=Z.nextSibling,te=Y.nextSibling,ne=te.firstChild,re=ne.nextSibling,m(X,r(y,{get when(){return A()},keyed:!0,children:e=>r(qr,{status:e,onCancel:B,onDismiss:H})}),Y),Q.$$click=()=>T(!D()),m(Q,r(G,{})),m(Z,r(y,{get when(){return d()},get children(){var e=ao();return m(e,r(S,{get each(){return c()},children:(e,t)=>{return[r(y,{get when(){return t()>0},get children(){var e=co();return w(()=>b(e,Bi)),e}}),(n=uo(),n.$$click=()=>q(e),m(n,()=>e.title),w(()=>b(n,Ui)),n)];var n}})),w(()=>b(e,Vi)),e}}),null),m(ee,r(br,{onProfile:()=>{i(He("user"))}})),ne.$$click=()=>T(!1),m(te,r(ir,{get isOpen(){return D()},get loading(){return u()},nodes:l,get selectedNodeId(){return d()},get ancestorIds(){return c().map(e=>e.id)},onCreatePage:()=>{M(null),F("document"),T(!1)},onCreateTable:()=>{M(null),F("table"),T(!1)},onCreateChildPage:e=>{M(e),F("document",e),T(!1)},onCreateChildTable:e=>{M(e),F("table",e),T(!1)},onSelectNode:q,onCloseMobileSidebar:()=>T(!1),onFetchChildren:$,onDeleteNode:J,onShowHistory:e=>{const t=o(),n=t?.workspace_id,r=t?.workspace_name;e!==d()&&n?(i(Be(n,r,e)),setTimeout(()=>I(e),100)):I(e)},onOpenSettings:()=>{const e=o()?.workspace_id,t=o()?.workspace_name;e&&(T(!1),i(He("workspace",e,t)))},onCreateWorkspace:()=>L(!0),onImportFromNotion:()=>P(!0)}),re),m(re,r(y,{get when(){return g()},get children(){var e=so();return m(e,g),w(()=>b(e,Ei)),e}}),null),m(re,()=>e.children,null),m(X,r(y,{get when(){return R()},get children(){return r(ii,{onClose:()=>L(!1),onCreate:f,isFirstWorkspace:!0})}}),null),m(X,r(y,{get when(){return N()},get children(){return r(ki,{onClose:()=>P(!1),onImport:U})}}),null),w(e=>{var t=`${yi} ${D()?$i:""}`,n=xi,r=Si,i=Ci,o=Ii,a=Di,s=`${Zi} ${D()?Qi:""}`,l=Ti;return t!==e.e&&b(X,e.e=t),n!==e.t&&b(Y,e.t=n),r!==e.a&&b(Z,e.a=r),i!==e.o&&b(Q,e.o=i),o!==e.i&&b(ee,e.i=o),a!==e.n&&b(te,e.n=a),s!==e.s&&b(ne,e.s=s),l!==e.h&&b(re,e.h=l),e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),X;var X,Y,Z,Q,ee,te,ne,re};function go(){const e=E(),t=N(),{user:n}=Te(),{nodes:r,loading:i}=We();return c(()=>{if(i())return;const o=r;if(o.length>0&&o[0]){const r=o[0],i=n(),a=i?.workspace_id||Me(t.wsId),s=i?.workspace_name;a&&e(Be(a,s,r.id,r.title),{replace:!0})}}),null}_(["click"]);const ho="_container_k5jgw_3",vo="_tableWrapper_k5jgw_11",_o="_table_k5jgw_11",fo="_headerRow_k5jgw_23",mo="_headerCell_k5jgw_31",wo="_row_k5jgw_43",bo="_actionsCell_k5jgw_51",ko="_deleteBtn_k5jgw_51",yo="_actionsHeader_k5jgw_56",$o="_handleHeader_k5jgw_70",Co="_handleCell_k5jgw_76",xo="_cell_k5jgw_94",So="_editing_k5jgw_102",Io="_cellContent_k5jgw_107",Do="_input_k5jgw_118",To="_required_k5jgw_154",Eo="_newRow_k5jgw_161",Ro="_newRowPlaceholder_k5jgw_173",Lo="_empty_k5jgw_184",No="_loadMore_k5jgw_191",Po="_addColumnCell_k5jgw_211",Ao="_addColumnWrapper_k5jgw_216",Oo="_addColumnBtn_k5jgw_221",jo="_addColumnDropdown_k5jgw_242",zo="_columnNameInput_k5jgw_259",Wo="_columnTypeSelect_k5jgw_260",Mo="_addColumnActions_k5jgw_276",Vo="_addColumnConfirm_k5jgw_282",Uo="_addColumnCancel_k5jgw_283",Bo="_handle_15xkm_1",Ho="_icon_15xkm_30";var Fo=k('<div draggable=true aria-label="Drag handle"data-testid=row-handle><svg viewBox="0 0 12 16"fill=currentColor xmlns=http://www.w3.org/2000/svg><circle cx=3 cy=3 r=1.5></circle><circle cx=3 cy=8 r=1.5></circle><circle cx=3 cy=13 r=1.5></circle><circle cx=9 cy=3 r=1.5></circle><circle cx=9 cy=8 r=1.5></circle><circle cx=9 cy=13 r=1.5>');function qo(e){const t=t=>{t.stopPropagation(),e.onDragStart(t,e.rowId)},n=t=>{t.preventDefault(),t.stopPropagation(),e.onContextMenu(t,e.rowId)},r=t=>{t.stopPropagation(),e.onClick?.(t,e.rowId)};return i=Fo(),o=i.firstChild,i.$$click=r,i.$$contextmenu=n,i.addEventListener("dragstart",t),w(t=>{var n=`${Bo} ${e.class||""}`,r=Ho;return n!==t.e&&b(i,t.e=n),r!==t.t&&I(o,"class",t.t=r),t},{e:void 0,t:void 0}),i;var i,o}_(["contextmenu","click"]);const Go="_menu_1y3gs_1",Ko="_separator_1y3gs_14",Jo="_item_1y3gs_20",Xo="_focused_1y3gs_36",Yo="_disabled_1y3gs_40",Zo="_danger_1y3gs_50",Qo="_icon_1y3gs_59",ea="_label_1y3gs_73",ta="_shortcut_1y3gs_80";var na=k('<div role=menu tabindex=-1 aria-label="Context menu">'),ra=k("<div role=separator>"),ia=k("<span>"),oa=k("<button role=menuitem tabindex=-1><span>");function aa(e){let n;const[i,o]=t(0),[a,s]=t({x:0,y:0});c(()=>{if(!n)return;const t=n.getBoundingClientRect(),r=window.innerWidth,i=window.innerHeight;let o=e.position.x,a=e.position.y;o+t.width>r-8&&(o=Math.max(8,r-t.width-8)),a+t.height>i-8&&(a=Math.max(8,i-t.height-8)),s({x:o,y:a})}),c(()=>{const t=t=>{n&&!n.contains(t.target)&&e.onClose()},r=setTimeout(()=>{document.addEventListener("click",t),document.addEventListener("contextmenu",t)},0);v(()=>{clearTimeout(r),document.removeEventListener("click",t),document.removeEventListener("contextmenu",t)})}),c(()=>{const t=t=>{const n=e.actions.map((e,t)=>({action:e,i:t})).filter(({action:e})=>!e.disabled).map(({i:e})=>e);if(0!==n.length)switch(t.key){case"Escape":t.preventDefault(),e.onClose();break;case"ArrowDown":{t.preventDefault();const e=n.indexOf(i()),r=n[e>=0?(e+1)%n.length:0];void 0!==r&&o(r);break}case"ArrowUp":{t.preventDefault();const e=n.indexOf(i()),r=n[e>=0?(e-1+n.length)%n.length:n.length-1];void 0!==r&&o(r);break}case"Enter":case" ":t.preventDefault();{const t=e.actions[i()];t&&!t.disabled&&(e.onAction(t.id),e.onClose())}break;case"Tab":t.preventDefault()}};document.addEventListener("keydown",t),v(()=>document.removeEventListener("keydown",t))}),c(()=>{n?.focus()});return r(K,{get children(){var t=na();return"function"==typeof n?V(n,t):n=t,m(t,r(S,{get each(){return e.actions},children:(t,n)=>{return[r(y,{get when(){return t.separator},get children(){var e=ra();return w(()=>b(e,Ko)),e}}),(a=oa(),s=a.firstChild,a.addEventListener("mouseenter",()=>o(n())),a.$$click=()=>(t=>{t.disabled||(e.onAction(t.id),e.onClose())})(t),m(a,r(y,{get when(){return t.icon},get children(){var e=ia();return m(e,()=>t.icon),w(()=>b(e,Qo)),e}}),s),m(s,()=>t.label),m(a,r(y,{get when(){return t.shortcut},get children(){var e=ia();return m(e,()=>t.shortcut),w(()=>b(e,ta)),e}}),null),w(e=>{var r=((e,t)=>{let n=Jo;return e.danger&&(n+=` ${Zo}`),e.disabled&&(n+=` ${Yo}`),i()===t&&(n+=` ${Xo}`),n})(t,n()),o=t.disabled,l=t.disabled,d=ea;return r!==e.e&&b(a,e.e=r),o!==e.t&&(a.disabled=e.t=o),l!==e.a&&I(a,"aria-disabled",e.a=l),d!==e.o&&b(s,e.o=d),e},{e:void 0,t:void 0,a:void 0,o:void 0}),a)];var a,s}})),w(e=>{var n=Go,r=`${a().x}px`,i=`${a().y}px`;return n!==e.e&&b(t,e.e=n),r!==e.t&&D(t,"left",e.t=r),i!==e.a&&D(t,"top",e.a=i),e},{e:void 0,t:void 0,a:void 0}),t}})}_(["click"]);const sa="_row_9rnv3_3",la="_handleWrapper_9rnv3_10",da="_dragging_9rnv3_28",ca="_dropIndicator_9rnv3_33";var ua=k("<div>");const pa="application/x-table-record";function ga(e){const{t:n}=he(),[i,o]=t(null),a=(t,n)=>{t.dataTransfer?.setData(pa,e.recordId),t.dataTransfer&&(t.dataTransfer.effectAllowed="move"),e.onDragStart?.(e.recordId,t)},s=(e,t)=>{o({x:e.clientX,y:e.clientY})},l=t=>{switch(t){case"open":e.onOpen?.(e.recordId);break;case"duplicate":e.onDuplicate?.(e.recordId);break;case"delete":e.onDelete?.(e.recordId)}o(null)};return[r(y,{get when(){return e.showDropIndicator},get children(){var e=ua();return w(()=>b(e,ca)),e}}),r(J,{get component(){return"tr"===e.as?"tr":"div"},get class(){return`${sa} row-with-handle ${e.isDragging?da:""} ${e.class||""}`.trim()},onDragOver:t=>{t.preventDefault(),t.dataTransfer&&(t.dataTransfer.dropEffect="move"),e.onDragOver?.(e.recordId,t)},onDrop:t=>{t.preventDefault(),e.onDrop?.(e.recordId,t)},get children(){return[(t=ua(),m(t,r(qo,{get rowId(){return e.recordId},onDragStart:a,onContextMenu:s})),w(()=>b(t,la)),t),$(()=>e.children)];var t}}),r(y,{get when(){return i()},children:t=>r(aa,{get position(){return t()},get actions(){return(()=>{const t=[];return e.onOpen&&t.push({id:"open",label:n("table.openRecord")||"Open"}),e.onDuplicate&&t.push({id:"duplicate",label:n("table.duplicateRecord")||"Duplicate",shortcut:"âŒ˜D"}),e.onDelete&&t.push({id:"delete",label:n("table.deleteRecord")||"Delete",shortcut:"âŒ«",danger:!0,separator:t.length>0}),t})()},onAction:l,onClose:()=>o(null)})})]}var ha=k("<input type=checkbox>"),va=k("<select><option value>--"),_a=k("<option>"),fa=k("<input type=text>"),ma=k("<input type=number>"),wa=k("<input type=date>"),ba=k("<th>"),ka=k("<div><input type=text autofocus><select></select><div><button></button><button>"),ya=k("<th><div><button>+"),$a=k("<tr><td>+ "),Ca=k("<span> "),xa=k("<div>"),Sa=k("<div><button>"),Ia=k("<div><div><table><thead><tr><th></th></tr></thead><tbody>"),Da=k("<span>*"),Ta=k("<td><button>âœ•"),Ea=k("<tr><td>"),Ra=k("<td>");const La=[{type:"text",labelKey:"table.typeText"},{type:"number",labelKey:"table.typeNumber"},{type:"checkbox",labelKey:"table.typeCheckbox"},{type:"date",labelKey:"table.typeDate"},{type:"select",labelKey:"table.typeSelect"},{type:"url",labelKey:"table.typeUrl"},{type:"email",labelKey:"table.typeEmail"}];function Na(e){const{t:n}=he(),[i,o]=t(null),[a,s]=t(""),[l,d]=t(!1),[c,u]=t(null),[p,g]=t(!1),[h,v]=t(""),[_,f]=t("text"),k=()=>{const t=h().trim();if(!t||!e.onAddColumn)return;const n={name:t,type:_(),required:!1};e.onAddColumn(n),v(""),f("text"),g(!1)},C=(t,n)=>{if(l()||!i())return;const r=e.columns.find(e=>e.name===n);if(!r||!e.onUpdateRecord)return void o(null);const s=e.records.find(e=>e.id===t);if(!s)return void o(null);const d={...s.data};d[r.name]=a(),e.onUpdateRecord(t,d),o(null)},x=()=>{e.onAddRecord&&e.columns.length>0&&e.onAddRecord({})},D=(e,t)=>{e.dataTransfer?.setData(pa,t),e.dataTransfer&&(e.dataTransfer.effectAllowed="move")},T=e=>{e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect="move")},E=(e,t)=>{u({recordId:t,x:e.clientX,y:e.clientY})},R=t=>{const n=c();if(n){switch(t){case"open":e.onOpenRecord?.(n.recordId);break;case"duplicate":e.onDuplicateRecord?.(n.recordId);break;case"delete":e.onDeleteRecord?.(n.recordId)}u(null)}},L=(t,n)=>{const r=((t,n)=>{const r=e.columns.find(e=>e.name===n);return r?t.data[r.name]??"":""})(t,n.name);switch(n.type){case"checkbox":return r?"âœ“":"";case"select":case"multi_select":case"number":default:return String(r);case"date":return r?new Date(r).toLocaleDateString():""}};let N;const P=(e,t,n,i)=>{const a=e=>{N=e,setTimeout(()=>{e.focus(),e instanceof HTMLInputElement&&"text"===e.type&&e.select()},0)},c=()=>N?N instanceof HTMLInputElement&&"checkbox"===N.type?String(N.checked):N.value:t,u=e=>{"Enter"!==e.key&&"Tab"!==e.key||s(c()),((e,t,n)=>{"Enter"!==e.key||e.shiftKey?"Escape"===e.key?(e.preventDefault(),d(!0),o(null)):"Tab"===e.key&&C(t,n):(e.preventDefault(),C(t,n))})(e,n,i)},p=()=>{s(c()),C(n,i)},g=()=>{s(c()),((e,t)=>{l()?d(!1):C(e,t)})(n,i)};switch(e.type){case"checkbox":return(y=ha()).$$keydown=u,y.addEventListener("change",p),V(a,y),y.checked="true"===t,w(()=>b(y,Do)),y;case Ee:return e.options&&e.options.length>0?((k=va()).firstChild,k.$$keydown=u,k.addEventListener("blur",g),k.addEventListener("change",p),V(a,k),k.value=t,m(k,r(S,{get each(){return e.options},children:e=>{return t=_a(),m(t,()=>e.name),w(()=>t.value=e.id),t;var t}}),null),w(()=>b(k,Do)),k):((f=fa()).$$keydown=u,f.addEventListener("blur",g),V(a,f),f.value=t,w(()=>b(f,Do)),f);case"number":return(_=ma()).$$keydown=u,_.addEventListener("blur",g),V(a,_),_.value=t,w(()=>b(_,Do)),_;case"date":return(v=wa()).$$keydown=u,v.addEventListener("blur",g),V(a,v),v.value=t,w(()=>b(v,Do)),v;default:return(h=fa()).$$keydown=u,h.addEventListener("blur",g),V(a,h),h.value=t,w(()=>b(h,Do)),h}var h,v,_,f,k,y};return A=Ia(),O=A.firstChild,j=O.firstChild,z=j.firstChild,W=z.firstChild,M=W.firstChild,U=z.nextSibling,m(W,r(y,{get when(){return e.onDeleteRecord},get children(){var e=ba();return w(()=>b(e,yo)),e}}),null),m(W,r(S,{get each(){return e.columns},children:e=>{return t=ba(),m(t,()=>e.name,null),m(t,r(y,{get when(){return e.required},get children(){var e=Da();return w(()=>b(e,To)),e}}),null),w(()=>b(t,mo)),t;var t}}),null),m(W,r(y,{get when(){return e.onAddColumn},get children(){var e=ya(),t=e.firstChild,i=t.firstChild;return i.$$click=()=>g(!p()),m(t,r(y,{get when(){return p()},get children(){var e=ka(),t=e.firstChild,i=t.nextSibling,o=i.nextSibling,a=o.firstChild,s=a.nextSibling;return t.$$input=e=>v(e.target.value),i.addEventListener("change",e=>f(e.target.value)),m(i,r(S,{each:La,children:e=>{return t=_a(),m(t,()=>n(e.labelKey)||e.type),w(()=>t.value=e.type),t;var t}})),a.$$click=k,m(a,()=>n("common.confirm")||"Add"),s.$$click=()=>g(!1),m(s,()=>n("common.cancel")||"Cancel"),w(r=>{var l=jo,d=n("table.columnName")||"Column Name",c=zo,u=Wo,p=Mo,g=Vo,h=Uo;return l!==r.e&&b(e,r.e=l),d!==r.t&&I(t,"placeholder",r.t=d),c!==r.a&&b(t,r.a=c),u!==r.o&&b(i,r.o=u),p!==r.i&&b(o,r.i=p),g!==r.n&&b(a,r.n=g),h!==r.s&&b(s,r.s=h),r},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),w(()=>t.value=h()),w(()=>i.value=_()),e}}),null),w(r=>{var o=Po,a=Ao,s=Oo,l=n("table.addColumn")||"Add Column";return o!==r.e&&b(e,r.e=o),a!==r.t&&b(t,r.t=a),s!==r.a&&b(i,r.a=s),l!==r.o&&I(i,"title",r.o=l),r},{e:void 0,t:void 0,a:void 0,o:void 0}),e}}),null),m(U,r(S,{get each(){return e.records},children:t=>{return l=Ea(),d=l.firstChild,l.addEventListener("dragover",T),m(d,r(qo,{get rowId(){return t.id},onDragStart:D,onContextMenu:E})),m(l,r(y,{get when(){return e.onDeleteRecord},get children(){var r=Ta(),i=r.firstChild;return i.$$click=()=>e.onDeleteRecord?.(t.id),w(e=>{var t=bo,o=ko,a=n("table.deleteRecord")||"Delete";return t!==e.e&&b(r,e.e=t),o!==e.t&&b(i,e.t=o),a!==e.a&&I(i,"title",e.a=a),e},{e:void 0,t:void 0,a:void 0}),r}}),null),m(l,r(S,{get each(){return e.columns},children:n=>{const l=()=>i()?.recordId===t.id&&i()?.columnId===n.name;return(d=Ra()).$$click=()=>!l()&&((t,n)=>{const r=e.columns.find(e=>e.name===n),i=e.records.find(e=>e.id===t)?.data[r?.name??""]??"";o({recordId:t,columnId:n}),s(String(i))})(t.id,n.name),m(d,r(y,{get when(){return l()},get fallback(){return e=xa(),m(e,()=>L(t,n)),w(()=>b(e,Io)),e;var e},get children(){return P(n,a(),t.id,n.name)}})),w(()=>b(d,`${xo}${l()?` ${So}`:""}`)),d;var d}}),null),w(e=>{var t=wo,n=Co;return t!==e.e&&b(l,e.e=t),n!==e.t&&b(d,e.t=n),e},{e:void 0,t:void 0}),l;var l,d}}),null),m(U,r(y,{get when(){return $(()=>!!e.onAddRecord)()&&e.columns.length>0},get children(){var t=$a(),r=t.firstChild;return r.firstChild,r.$$click=x,m(r,()=>n("table.addRecord")||"New",null),w(n=>{var i=Eo,o=Ro,a=e.columns.length+1+(e.onDeleteRecord?1:0)+(e.onAddColumn?1:0);return i!==n.e&&b(t,n.e=i),o!==n.t&&b(r,n.t=o),a!==n.a&&I(r,"colspan",n.a=a),n},{e:void 0,t:void 0,a:void 0}),t}}),null),m(A,r(y,{get when(){return 0===e.columns.length},get children(){var t=xa();return m(t,()=>n("table.noColumns"),null),m(t,r(y,{get when(){return e.onAddColumn},get children(){var e=Ca();return e.firstChild,m(e,()=>n("table.addColumnFirst")||"Click + to add a column.",null),e}}),null),w(()=>b(t,Lo)),t}}),null),m(A,r(y,{get when(){return e.hasMore},get children(){var t=Sa(),r=t.firstChild;return r.$$click=()=>e.onLoadMore?.(),m(r,()=>n("table.loadMore")),w(()=>b(t,No)),t}}),null),m(A,r(y,{get when(){return c()},children:t=>r(aa,{get position(){return{x:t().x,y:t().y}},get actions(){return(()=>{const t=[];return e.onOpenRecord&&t.push({id:"open",label:n("table.openRecord")||"Open"}),e.onDuplicateRecord&&t.push({id:"duplicate",label:n("table.duplicateRecord")||"Duplicate",shortcut:"âŒ˜D"}),e.onDeleteRecord&&t.push({id:"delete",label:n("table.deleteRecord")||"Delete",shortcut:"âŒ«",danger:!0,separator:t.length>0}),t})()},onAction:R,onClose:()=>u(null)})}),null),w(e=>{var t=ho,n=vo,r=_o,i=fo,o=$o;return t!==e.e&&b(A,e.e=t),n!==e.t&&b(O,e.t=n),r!==e.a&&b(j,e.a=r),i!==e.o&&b(W,e.o=i),o!==e.i&&b(M,e.i=o),e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),A;var A,O,j,z,W,M,U}function Pa(e,t,n,r){if(e.data[t]===n||!r)return;const i={...e.data,[t]:n};r(e.id,i)}function Aa(e){"Enter"===e.key&&e.currentTarget.blur()}function Oa(e,t){if(!t)return"";const n=e.data[t];return null!=n?String(n):""}function ja(e,t){const n=t[0];return n?Oa(e,n.name):""}_(["keydown","click","input"]);const za="_grid_b2hmw_1",Wa="_card_b2hmw_8",Ma="_cardHeader_b2hmw_20",Va="_cardBody_b2hmw_28",Ua="_field_b2hmw_34",Ba="_fieldName_b2hmw_39",Ha="_titleInput_b2hmw_46",Fa="_fieldValueInput_b2hmw_63";var qa=k("<div>"),Ga=k("<div><strong><input type=text>"),Ka=k("<div><span>:</span><input type=text>");function Ja(e){const{t:t}=he();return n=qa(),m(n,r(S,{get each(){return e.records},children:n=>r(ga,{get recordId(){return n.id},get onDelete(){return e.onDeleteRecord},get onDuplicate(){return e.onDuplicateRecord},get onOpen(){return e.onOpenRecord},get class(){return Wa},get children(){return[(o=Ga(),a=o.firstChild.firstChild,X(a,"keydown",Aa,!0),a.addEventListener("blur",t=>e.columns[0]&&Pa(n,e.columns[0].name,t.target.value,e.onUpdateRecord)),w(e=>{var n=Ma,r=t("table.untitled")||"Untitled",i=Ha;return n!==e.e&&b(o,e.e=n),r!==e.t&&I(a,"placeholder",e.t=r),i!==e.a&&b(a,e.a=i),e},{e:void 0,t:void 0,a:void 0}),w(()=>a.value=ja(n,e.columns)),o),(i=qa(),m(i,r(S,{get each(){return e.columns.slice(1,4)},children:t=>{return r=Ka(),i=r.firstChild,o=i.firstChild,a=i.nextSibling,m(i,()=>t.name,o),X(a,"keydown",Aa,!0),a.addEventListener("blur",r=>Pa(n,t.name,r.target.value,e.onUpdateRecord)),w(e=>{var t=Ua,n=Ba,o=Fa;return t!==e.e&&b(r,e.e=t),n!==e.t&&b(i,e.t=n),o!==e.a&&b(a,e.a=o),e},{e:void 0,t:void 0,a:void 0}),w(()=>a.value=Oa(n,t.name)),r;var r,i,o,a}})),w(()=>b(i,Va)),i)];var i,o,a}})})),w(()=>b(n,za)),n;var n}_(["keydown"]);const Xa="_gallery_59dut_1",Ya="_card_59dut_8",Za="_imageContainer_59dut_23",Qa="_image_59dut_23",es="_imagePlaceholder_59dut_38",ts="_cardContent_59dut_43",ns="_cardHeader_59dut_47",rs="_cardBody_59dut_54",is="_field_59dut_58",os="_fieldName_59dut_64",as="_titleInput_59dut_70",ss="_fieldValueInput_59dut_87";var ls=k("<div>"),ds=k("<div><div><strong><input type=text></strong></div><div>"),cs=k("<img>"),us=k("<div><span>:</span><input type=text>");function ps(e){const{t:t}=he();return n=ls(),m(n,r(S,{get each(){return e.records},children:n=>{const i=e.columns.find(e=>e.name.toLowerCase().includes("image")||e.name.toLowerCase().includes("cover")||e.name.toLowerCase().includes("url"));return r(ga,{get recordId(){return n.id},get onDelete(){return e.onDeleteRecord},get onDuplicate(){return e.onDuplicateRecord},get onOpen(){return e.onOpenRecord},get class(){return Ya},get children(){return[r(y,{when:i,children:i=>{return o=ls(),m(o,r(y,{get when(){return n.data[i().name]},get fallback(){return e=ls(),m(e,()=>t("table.noImage")),w(()=>b(e,es)),e;var e},get children(){var t=cs();return w(r=>{var o=String(n.data[i().name]),a=ja(n,e.columns)||"Record",s=Qa;return o!==r.e&&I(t,"src",r.e=o),a!==r.t&&I(t,"alt",r.t=a),s!==r.a&&b(t,r.a=s),r},{e:void 0,t:void 0,a:void 0}),t}})),w(()=>b(o,Za)),o;var o}}),(o=ds(),a=o.firstChild,s=a.firstChild.firstChild,l=a.nextSibling,X(s,"keydown",Aa,!0),s.addEventListener("blur",t=>e.columns[0]&&Pa(n,e.columns[0].name,t.target.value,e.onUpdateRecord)),m(l,r(S,{get each(){return e.columns.slice(1,3)},children:t=>{return r=us(),i=r.firstChild,o=i.firstChild,a=i.nextSibling,m(i,()=>t.name,o),X(a,"keydown",Aa,!0),a.addEventListener("blur",r=>Pa(n,t.name,r.target.value,e.onUpdateRecord)),w(e=>{var t=is,n=os,o=ss;return t!==e.e&&b(r,e.e=t),n!==e.t&&b(i,e.t=n),o!==e.a&&b(a,e.a=o),e},{e:void 0,t:void 0,a:void 0}),w(()=>a.value=Oa(n,t.name)),r;var r,i,o,a}})),w(e=>{var n=ts,r=ns,i=t("table.untitled")||"Untitled",d=as,c=rs;return n!==e.e&&b(o,e.e=n),r!==e.t&&b(a,e.t=r),i!==e.a&&I(s,"placeholder",e.a=i),d!==e.o&&b(s,e.o=d),c!==e.i&&b(l,e.i=c),e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),w(()=>s.value=ja(n,e.columns)),o)];var o,a,s,l}})}})),w(()=>b(n,Xa)),n;var n}_(["keydown"]);const gs="_board_riuur_1",hs="_noGroup_riuur_7",vs="_columns_riuur_16",_s="_column_riuur_16",fs="_columnHeader_riuur_31",ms="_columnName_riuur_38",ws="_columnCount_riuur_45",bs="_cards_riuur_53",ks="_card_riuur_53",ys="_cardHeader_riuur_68",$s="_cardBody_riuur_80",Cs="_field_riuur_84",xs="_fieldName_riuur_90",Ss="_titleInput_riuur_95",Is="_fieldValueInput_riuur_112";var Ds=k("<div>"),Ts=k("<div><div><span></span><span></span></div><div>"),Es=k("<div><strong><input type=text>"),Rs=k("<div><span>:</span><input type=text>");function Ls(e){const{t:t}=he(),n=l(()=>e.columns.find(e=>e.type===Ee||"multi_select"===e.type)),i=l(()=>{const r=n();if(!r)return[{name:"All Records",records:e.records,fromOptions:!0}];const i={};return r.options&&r.options.forEach(e=>{i[e.id]={name:e.name,records:[],fromOptions:!0}}),i.__none__={name:t("table.noGroup")||"No Group",records:[],fromOptions:!0},e.records.forEach(e=>{const t=e.data[r.name];t&&"string"==typeof t?(i[t]||(i[t]={name:t,records:[]}),i[t].records.push(e)):i.__none__?.records.push(e)}),Object.values(i).filter(e=>e.records.length>0||e.fromOptions)});return o=Ds(),m(o,r(y,{get when(){return n()},get fallback(){return e=Ds(),m(e,()=>t("table.addSelectColumn")),w(()=>b(e,hs)),e;var e},get children(){var o=Ds();return m(o,r(S,{get each(){return i()},children:i=>{return o=Ts(),a=o.firstChild,s=a.firstChild,l=s.nextSibling,d=a.nextSibling,m(s,()=>i.name),m(l,()=>i.records.length),m(d,r(S,{get each(){return i.records},children:i=>r(ga,{get recordId(){return i.id},get onDelete(){return e.onDeleteRecord},get onDuplicate(){return e.onDuplicateRecord},get onOpen(){return e.onOpenRecord},get class(){return ks},get children(){return[(a=Es(),s=a.firstChild.firstChild,X(s,"keydown",Aa,!0),s.addEventListener("blur",t=>e.columns[0]&&Pa(i,e.columns[0].name,t.target.value,e.onUpdateRecord)),w(e=>{var n=ys,r=t("table.untitled")||"Untitled",i=Ss;return n!==e.e&&b(a,e.e=n),r!==e.t&&I(s,"placeholder",e.t=r),i!==e.a&&b(s,e.a=i),e},{e:void 0,t:void 0,a:void 0}),w(()=>s.value=ja(i,e.columns)),a),(o=Ds(),m(o,r(S,{get each(){return e.columns.slice(1,4).filter(e=>e.name!==n()?.name)},children:t=>{return n=Rs(),r=n.firstChild,o=r.firstChild,a=r.nextSibling,m(r,()=>t.name,o),X(a,"keydown",Aa,!0),a.addEventListener("blur",n=>Pa(i,t.name,n.target.value,e.onUpdateRecord)),w(e=>{var t=Cs,i=xs,o=Is;return t!==e.e&&b(n,e.e=t),i!==e.t&&b(r,e.t=i),o!==e.a&&b(a,e.a=o),e},{e:void 0,t:void 0,a:void 0}),w(()=>a.value=Oa(i,t.name)),n;var n,r,o,a}})),w(()=>b(o,$s)),o)];var o,a,s}})})),w(e=>{var t=_s,n=fs,r=ms,i=ws,c=bs;return t!==e.e&&b(o,e.e=t),n!==e.t&&b(a,e.t=n),r!==e.a&&b(s,e.a=r),i!==e.o&&b(l,e.o=i),c!==e.i&&b(d,e.i=c),e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),o;var o,a,s,l,d}})),w(()=>b(o,vs)),o}})),w(()=>b(o,gs)),o;var o}_(["keydown"]);const Ns="_container_vg1zp_3",Ps="_tabs_vg1zp_7",As="_tab_vg1zp_7",Os="_active_vg1zp_35",js="_icon_vg1zp_41",zs="_name_vg1zp_52",Ws="_defaultBadge_vg1zp_58",Ms="_addWrapper_vg1zp_67",Vs="_addButton_vg1zp_71",Us="_dropdown_vg1zp_93",Bs="_overlay_vg1zp_125",Hs="_contextMenu_vg1zp_131",Fs="_deleteAction_vg1zp_158";var qs=k("<div data-testid=view-type-menu><button data-testid=view-type-table><span></span></button><button data-testid=view-type-list><span></span></button><button data-testid=view-type-gallery><span></span></button><button data-testid=view-type-board><span>"),Gs=k("<div>"),Ks=k("<div><div><div><button data-testid=add-view-button>"),Js=k("<span>"),Xs=k("<button><span></span><span>"),Ys=k("<div><button>");const Zs={table:te,board:ee,gallery:Q,list:Z,calendar:Y};function Qs(){const{t:e}=he(),{views:n,activeViewId:i,setActiveViewId:o,createView:a,deleteView:s}=rt(),[l,d]=t(!1),[c,u]=t(null),[p,g]=t(null),h=t=>{const n=e("table.newView")||"New View";a(n,t),d(!1)},v=()=>{const e=c();e&&s(e.id),u(null),g(null)},_=()=>{d(!1),u(null),g(null)};return f=Ks(),k=f.firstChild,$=k.firstChild,C=$.firstChild,m(k,r(S,{get each(){return n()},children:t=>{const n=Zs[t.type]||te;return a=Xs(),s=a.firstChild,l=s.nextSibling,a.$$contextmenu=e=>((e,t)=>{e.preventDefault(),u(t),g({x:e.clientX,y:e.clientY})})(e,t),a.$$click=()=>{return e=t.id,void o(e);var e},m(s,r(n,{})),m(l,()=>t.name),m(a,r(y,{get when(){return t.default},get children(){var t=Js();return m(t,()=>e("table.defaultView")||"Default"),w(()=>b(t,Ws)),t}}),null),w(e=>{var n=As,r={[`${Os}`]:t.id===i()},o=t.name,d=js,c=zs;return n!==e.e&&b(a,e.e=n),e.t=M(a,r,e.t),o!==e.a&&I(a,"title",e.a=o),d!==e.o&&b(s,e.o=d),c!==e.i&&b(l,e.i=c),e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),a;var a,s,l}}),$),C.$$click=()=>d(!l()),m(C,r(H,{})),m($,r(y,{get when(){return l()},get children(){var t=qs(),n=t.firstChild,i=n.firstChild,o=n.nextSibling,a=o.firstChild,s=o.nextSibling,l=s.firstChild,d=s.nextSibling,c=d.firstChild;return n.$$click=()=>h("table"),m(i,r(te,{})),m(n,()=>e("table.table"),null),o.$$click=()=>h("list"),m(a,r(Z,{})),m(o,()=>e("table.list"),null),s.$$click=()=>h("gallery"),m(l,r(Q,{})),m(s,()=>e("table.gallery"),null),d.$$click=()=>h("board"),m(c,r(ee,{})),m(d,()=>e("table.board"),null),w(e=>{var n=Us,r=js,o=js,s=js,d=js;return n!==e.e&&b(t,e.e=n),r!==e.t&&b(i,e.t=r),o!==e.a&&b(a,e.a=o),s!==e.o&&b(l,e.o=s),d!==e.i&&b(c,e.i=d),e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),t}}),null),m(f,r(y,{get when(){return p()},children:t=>r(y,{get when(){return c()},get children(){return[(i=Gs(),i.$$click=_,w(()=>b(i,Bs)),i),(n=Ys(),r=n.firstChild,r.$$click=v,m(r,()=>e("common.delete")),w(e=>{var i=Hs,o=`${t().x}px`,a=`${t().y}px`,s=Fs;return i!==e.e&&b(n,e.e=i),o!==e.t&&D(n,"left",e.t=o),a!==e.a&&D(n,"top",e.a=a),s!==e.o&&b(r,e.o=s),e},{e:void 0,t:void 0,a:void 0,o:void 0}),n)];var n,r,i}})}),null),m(f,r(y,{get when(){return l()},get children(){var e=Gs();return e.$$click=_,w(()=>b(e,Bs)),e}}),null),w(t=>{var n=Ns,r=Ps,i=Ms,o=Vs,a=e("table.newView")||"New View";return n!==t.e&&b(f,t.e=n),r!==t.t&&b(k,t.t=r),i!==t.a&&b($,t.a=i),o!==t.o&&b(C,t.o=o),a!==t.i&&I(C,"title",t.i=a),t},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),f;var f,k,$,C}_(["click","contextmenu"]);const el="_preview_1ozpw_1";var tl=k('<div role=region aria-label="Markdown preview">');const nl=new le({html:!0,linkify:!0,typographer:!0});nl.core.ruler.after("inline","task_list",e=>{const t=e.tokens;for(let n=0;n<t.length;n++){const r=t[n];if(r&&"list_item_open"===r.type){const i=t[n+2];if(i&&"inline"===i.type&&i.children){const t=i.children[0];if(t&&"text"===t.type&&t.content){const n=t.content.match(/^\[([ xX])\]\s*/);if(n&&n[1]){r.attrSet("class","task-list-item"),r.attrSet("data-checked","x"===n[1].toLowerCase()?"true":"false"),t.content=t.content.slice(n[0].length);const o=new e.Token("checkbox","",0);o.attrSet("checked","x"===n[1].toLowerCase()?"true":"false"),i.children.unshift(o)}}}}}return!0}),nl.renderer.rules.checkbox=(e,t)=>{const n=e[t];if(!n)return"";return`<input type="checkbox" class="task-checkbox" disabled${"true"===n.attrGet("checked")?" checked":""}> `};const rl=nl.renderer.rules.image||function(e,t,n,r,i){return i.renderToken(e,t,n)};function il(e){return t=tl(),w(n=>{var r=el,i=(()=>{const t=nl.render(e.content,{assetUrls:e.assetUrls});return ne.sanitize(t)})();return r!==n.e&&b(t,n.e=r),i!==n.t&&(t.innerHTML=n.t=i),n},{e:void 0,t:void 0}),t;var t}nl.renderer.rules.image=(e,t,n,r,i)=>{const o=e[t];if(!o)return rl(e,t,n,r,i);const a=o.attrIndex("src"),s=o.attrs,l=r?.assetUrls,d=s?.[a];if(d&&l){const e=d[1];if(!e.includes("://")&&!e.startsWith("/")){const t=l[e];t&&(d[1]=t)}}return rl(e,t,n,r,i)};var ol=k("<span>â— "),al=k("<span>âŸ³ "),sl=k("<span>âœ“ "),ll=k("<div><input type=text><div>"),dl=k("<li>"),cl=k("<div><h3></h3><ul>"),ul=k("<div>"),pl=k("<div><div><div><h4></h4><span> â€¢ </span></div><button></button></div><div>"),gl=k("<li><div><span></span><span></span></div><div> &lt;<!>&gt;");const hl=P(()=>ce(()=>import("./Editor-5YHlmngp.js"),__vite__mapDeps([12,1,2,13])));function vl(){const{t:e}=he(),n=E(),i=N(),{user:o,token:a,wsApi:s}=Te(),{selectedNodeId:d,selectedNodeData:u,setLoading:p,setError:g,loadNode:h}=We(),{title:v,content:_,hasUnsavedChanges:f,autoSaveStatus:k,assetUrls:C,showHistory:x,history:D,flushAutoSave:T,handleTitleChange:R,handleContentChange:P,linkedNodeTitles:A}=et(),{records:O,hasMore:j,loadMoreRecords:z,addRecord:W,updateRecord:V,deleteRecord:U,views:B,activeViewId:H}=rt(),[F,q]=t(null),[G,K]=t(null),J=l(()=>B().find(e=>e.id===H())),X=l(()=>J()?.type||"table");async function Y(t){const n=d(),r=u(),i=s();if(n&&r&&i)try{p(!0);const e=[...r.properties||[],t];await i.nodes.table.updateTable(n,{title:r.title,properties:e}),await h(n),g(null)}catch(o){g(`${e("errors.failedToSave")}: ${o}`)}finally{p(!1)}}async function Z(t,n){const r=s();if(r)try{p(!0);const e=await r.nodes.history.getNodeVersion(t,n.hash);q(e.content||""),K(n)}catch(i){g(`${e("errors.failedToLoad")}: ${i}`)}finally{p(!1)}}c(()=>{const e=Me(i.nodeId);e&&e!==d()&&(T(),h(e),q(null),K(null))}),c(()=>{if(x()){if(D().length>0&&!G()){const e=d(),t=D()[0];e&&t&&Z(e,t)}}else q(null),K(null)});const Q=e=>{T();const t=o(),r=t?.workspace_id,i=t?.workspace_name;r&&n(Be(r,i,e))};return r(y,{get when(){return d()},get children(){var t=ul();return m(t,r(y,{get when(){return!G()},get children(){var t=ll(),n=t.firstChild,i=n.nextSibling;return n.$$input=e=>R(e.target.value),m(i,r(y,{get when(){return $(()=>!!f())()&&"idle"===k()},get children(){var t=ol();return t.firstChild,m(t,()=>e("editor.unsaved"),null),w(()=>b(t,Ai)),t}}),null),m(i,r(y,{get when(){return"saving"===k()},get children(){var t=al();return t.firstChild,m(t,()=>e("common.saving"),null),w(()=>b(t,Oi)),t}}),null),m(i,r(y,{get when(){return"saved"===k()},get children(){var t=sl();return t.firstChild,m(t,()=>e("common.saved"),null),w(()=>b(t,ji)),t}}),null),w(r=>{var o=Ni,a=e("editor.titlePlaceholder")||"Title",s=zi,l=Pi;return o!==r.e&&b(t,r.e=o),a!==r.t&&I(n,"placeholder",r.t=a),s!==r.a&&b(n,r.a=s),l!==r.o&&b(i,r.o=l),r},{e:void 0,t:void 0,a:void 0,o:void 0}),w(()=>n.value=v()),t}}),null),m(t,r(y,{get when(){return x()},get children(){var t=cl(),n=t.firstChild,i=n.nextSibling;return m(n,()=>e("editor.versionHistory")),m(i,r(S,{get each(){return D()},children:e=>{return t=gl(),n=t.firstChild,r=n.firstChild,i=r.nextSibling,o=n.nextSibling,a=o.firstChild,(s=a.nextSibling).nextSibling,t.$$click=()=>{const t=d();t&&Z(t,e)},m(r,()=>new Date(e.timestamp).toLocaleString()),m(i,()=>e.hash.substring(0,7)),m(o,()=>e.author_name,a),m(o,()=>e.author_email,s),w(a=>{var s=qi,l={[Gi]:G()?.hash===e.hash},d=Ki,c=Ji,u=Xi,p=Yi;return s!==a.e&&b(t,a.e=s),a.t=M(t,l,a.t),d!==a.a&&b(n,a.a=d),c!==a.o&&b(r,a.o=c),u!==a.i&&b(i,a.i=u),p!==a.n&&b(o,a.n=p),a},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0}),t;var t,n,r,i,o,a,s}}),null),m(i,r(y,{get when(){return 0===D().length},get children(){var t=dl();return m(t,()=>e("editor.noHistory")),w(()=>b(t,qi)),t}}),null),w(e=>{var n=Hi,r=Fi;return n!==e.e&&b(t,e.e=n),r!==e.t&&b(i,e.t=r),e},{e:void 0,t:void 0}),t}}),null),m(t,r(y,{get when(){return!G()},get children(){var t=ul();return m(t,r(y,{get when(){return u()?.has_page},get children(){return r(L,{get fallback(){return t=ul(),m(t,()=>e("common.loading")),w(()=>b(t,Li)),t;var t},get children(){return r(hl,{get content(){return _()},get nodeId(){return d()??void 0},get assetUrls(){return C()},get linkedNodeTitles(){return A()},onChange:P,get wsId(){return o()?.workspace_id},getToken:()=>a(),onAssetUploaded:()=>{const e=d();e&&h(e)},onError:g,onNavigateToNode:Q})}})}}),null),m(t,r(y,{get when(){return u()?.has_table},get children(){var e=ul();return m(e,r(Qs,{}),null),m(e,r(y,{get when(){return"table"===X()},get children(){return r(Na,{get tableId(){return d()||""},get columns(){return u()?.properties||[]},get records(){return O()},onAddRecord:W,onUpdateRecord:V,onDeleteRecord:U,onAddColumn:Y,onLoadMore:z,get hasMore(){return j()}})}}),null),m(e,r(y,{get when(){return"list"===X()},get children(){return r(Ja,{get records(){return O()},get columns(){return u()?.properties||[]},onUpdateRecord:V,onDeleteRecord:U})}}),null),m(e,r(y,{get when(){return"gallery"===X()},get children(){return r(ps,{get records(){return O()},get columns(){return u()?.properties||[]},onUpdateRecord:V,onDeleteRecord:U})}}),null),m(e,r(y,{get when(){return"board"===X()},get children(){return r(Ls,{get records(){return O()},get columns(){return u()?.properties||[]},onUpdateRecord:V,onDeleteRecord:U})}}),null),w(()=>b(e,Mi)),e}}),null),w(()=>b(t,Wi)),t}}),null),m(t,r(y,{get when(){return $(()=>null!==F())()&&G()},get children(){var t=pl(),n=t.firstChild,i=n.firstChild,o=i.firstChild,a=o.nextSibling,s=a.firstChild,l=i.nextSibling,d=n.nextSibling;return m(o,()=>e("editor.versionPreview")),m(a,()=>G()?.author_name,s),m(a,()=>new Date(G()?.timestamp||0).toLocaleString(),null),l.$$click=()=>{q(null),K(null)},m(l,()=>e("editor.closePreview")),m(d,r(il,{get content(){return F()||""},get assetUrls(){return C()}})),w(e=>{var r=eo,o=to,s=no,c=ro,u=io,p=oo;return r!==e.e&&b(t,e.e=r),o!==e.t&&b(n,e.t=o),s!==e.a&&b(i,e.a=s),c!==e.o&&b(a,e.o=c),u!==e.i&&b(l,e.i=u),p!==e.n&&b(d,e.n=p),e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0}),t}}),null),w(()=>b(t,Ri)),t}})}_(["input","click"]);const _l=e=>r(ze,{get children(){return r(Qe,{get children(){return r(nt,{get children(){return e.children}})}})}});var fl=k("<div style=padding:2rem;text-align:center>Loading...");const ml=P(()=>ce(()=>import("./Auth-Bun_a15f.js"),__vite__mapDeps([14,1,2,15]))),wl=P(()=>ce(()=>import("./Privacy-Djsm_YTW.js"),__vite__mapDeps([16,1,17]))),bl=P(()=>ce(()=>import("./Terms-DVvdE5sJ.js"),__vite__mapDeps([18,1,17]))),kl=P(()=>ce(()=>import("./Onboarding-Cro45Wch.js"),__vite__mapDeps([19,1,2])));function yl(){return fl()}const $l=e=>{const{user:t,ready:n}=Te();return r(y,{get when(){return n()},get fallback(){return r(yl,{})},get children(){return r(y,{get when(){return t()},get fallback(){return r(R,{href:"/login"})},get children(){return e.children}})}})};function Cl(){const{user:e,login:t,ready:n}=Te();return r(y,{get when(){return n()},get fallback(){return r(yl,{})},get children(){return r(y,{get when(){return!e()||!e()?.workspace_id},get fallback(){return r(R,{get href(){return`/w/${e()?.workspace_id}`}})},get children(){return r(L,{get fallback(){return r(yl,{})},get children(){return r(ml,{onLogin:t})}})}})}})}function xl(){const{user:e,ready:t}=Te();return r(ae,{get fallback(){return r(yl,{})},get children(){return[r(oe,{get when(){return $(()=>!!t())()&&e()?.workspace_id},get children(){return r(R,{get href(){return`/w/${e()?.workspace_id}`}})}}),r(oe,{get when(){return $(()=>!(!t()||!e()))()&&!e()?.workspace_id},get children(){return r(R,{href:"/onboarding"})}}),r(oe,{get when(){return $(()=>!!t())()&&!e()},get children(){return r(R,{href:"/login"})}})]}})}const Sl=e=>r($l,{get children(){return r(L,{get fallback(){return r(yl,{})},get children(){return r(cn,{get children(){return e.children}})}})}}),Il=e=>r($l,{get children(){return r(L,{get fallback(){return r(yl,{})},get children(){return r(_l,{get children(){return e.children}})}})}});function Dl(){return r(ie,{get children(){return[r(re,{path:"/login",component:Cl}),r(re,{path:"/onboarding",component:()=>r($l,{get children(){return r(L,{get fallback(){return r(yl,{})},get children(){return r(kl,{})}})}})}),r(re,{path:"/privacy",component:()=>r(L,{get fallback(){return r(yl,{})},get children(){return r(wl,{})}})}),r(re,{path:"/terms",component:()=>r(L,{get fallback(){return r(yl,{})},get children(){return r(bl,{})}})}),r(re,{path:"/settings",component:Sl,get children(){return[r(re,{path:"/",component:dn}),r(re,{path:"/user",component:ln}),r(re,{path:"/server",component:on}),r(re,{path:"/workspace/:wsId",component:an}),r(re,{path:"/org/:orgId",component:sn})]}}),r(re,{path:"/w/:wsId",component:Il,get children(){return r(re,{path:"/",component:po,get children(){return[r(re,{path:"/",component:go}),r(re,{path:"/:nodeId",component:vl})]}})}}),r(re,{path:"/",component:xl}),r(re,{path:"*",component:()=>r(R,{href:"/login"})})]}})}function Tl(){return r(ct,{get children(){return r(De,{get children(){return[r(Dl,{}),r(bt,{})]}})}})}const El=localStorage.getItem("mddb_locale"),Rl=El&&["en","fr","de","es"].includes(El)?El:"en",Ll=document.getElementById("app");Ll&&se(()=>r(ge,{initialLocale:Rl,get children(){return r(Tl,{})}}),Ll);export{ve as A,Pe as O,qo as R,Ne as W,Oe as a,Ae as b,me as c,Te as d,Le as e,Re as f,aa as g,We as h,et as i,un as j,Ye as k,Je as l,Be as n,qe as r,He as s,he as u,Ue as w};
