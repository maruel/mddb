{"version":3,"mappings":"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","names":["async","fetchDictionary","locale","module","__variableDynamicImportRuntimeHelper","i18n","dict","I18nContext","createContext","I18nProvider","props","setLocale","createSignal","initialLocale","createResource","rawTranslator","t","key","args","value","translateError","code","translated","ready","state","_$createComponent","Provider","children","useI18n","context","useContext","Error","APIError","constructor","status","response","super","error","message","this","name","get","fetchFn","url","res","ok","json","post","body","init","method","headers","JSON","stringify","createAPIClient","admin","getServerDetail","auth","email","changeEmail","options","sendVerificationEmail","invitations","acceptOrgInvitation","acceptWSInvitation","sessions","listSessions","revokeAllSessions","revokeSession","getMe","listProviders","login","logout","register","setPassword","switchWorkspace","updateUserSettings","organizations","createOrganization","server","getConfig","updateConfig","getHealth","org","orgID","createOrgInvitation","listOrgInvitations","notion","getStatus","importWsID","startImport","getOrganization","updateOrganization","settings","updateOrgPreferences","users","listUsers","updateOrgMemberRole","workspaces","createWorkspace","ws","wsID","createWSInvitation","listWSInvitations","nodes","assets","deleteNodeAsset","id","listNodeAssets","history","getNodeVersion","hash","listNodeVersions","params","URLSearchParams","Limit","set","String","toString","page","createPage","deletePage","getPage","updatePage","table","records","createRecord","deleteRecord","rid","getRecord","listRecords","ViewID","Filters","Sorts","Offset","updateRecord","createTable","deleteTable","getTable","updateTable","views","createView","deleteView","viewID","updateView","deleteNode","getNode","getNodeTitles","IDs","listNodeChildren","moveNode","cancelImport","git","deleteGitRemote","getGitRemote","pushGit","updateGitRemote","updateWSMembershipSettings","updateWSMemberRole","getWorkspace","updateWorkspace","search","RETRY_CONFIG","isRetryableStatus","parseRetryAfter","header","seconds","parseInt","isNaN","date","Date","parse","Math","max","now","getRetryDelay","attempt","retryAfterMs","min","delay","pow","createAuthFetch","getToken","onUnauthorized","token","fetch","Promise","resolve","setTimeout","createApi","AuthContext","AuthProvider","user","setUser","setToken","localStorage","getItem","setReady","currentToken","logoutApi","removeItem","api","createMemo","wsApi","workspace_id","orgApi","organization_id","onMount","urlToken","window","location","setItem","replaceState","document","title","pathname","data","err","console","createEffect","on","tok","u","defer","newToken","userData","refreshUser","useAuth","PropertyTypeSelect","OrgRoleOwner","OrgRoleAdmin","WSRoleAdmin","OAuthProviderGoogle","OAuthProviderMicrosoft","OAuthProviderGitHub","stripSlug","idWithSlug","s","startsWith","substring","plusIndex","indexOf","slugify","text","toLowerCase","trim","replace","workspaceUrl","wsId","wsName","nodeUrl","nodeId","nodeTitle","wsSlug","nodeSlug","settingsUrl","type","WorkspaceContext","WorkspaceProvider","i18nReady","navigate","useNavigate","setNodesStore","createStore","selectedNodeId","setSelectedNodeId","selectedNodeData","setSelectedNodeData","breadcrumbPath","setBreadcrumbPath","loadingNodes","setLoadingNodes","loadingNodeId","setLoadingNodeId","switchingWorkspace","setSwitchingWorkspace","savingNodeId","setSavingNodeId","deletingNodeId","setDeletingNodeId","creatingNode","setCreatingNode","loadError","setLoadError","saveError","setSaveError","loading","firstLoginCheckDone","setFirstLoginCheckDone","firstLoginInProgress","setFirstLoginInProgress","loadedForWorkspace","setLoadedForWorkspace","loadedNodeId","setLoadedNodeId","getUserFirstName","split","updatedUser","ws_id","batch","loadNodes","workspace_name","force","length","resp","loadedNodes","newPageId","workspace_role","newPage","content","createWelcomePageIfNeeded","resp2","reconcile","orgs","firstName","orgName","autoCreateOrganization","finally","firstOrg","filter","role","autoCreateWorkspace","setNodes","fn","produce","loadNode","nodeData","path","currentNode","parent_id","parentNode","unshift","fetchNodeChildren","Boolean","list","updateChildren","nodeList","node","has_children","removeNode","removeFromList","index","findIndex","n","splice","updateNodeTitle","newTitle","update","map","newParentId","new_parent_id","movedNode","nodeToMove","push","addToParent","clearErrors","useWorkspace","debounce","delayMs","timeoutId","lastArgs","debounced","clearTimeout","flush","cancel","pending","RELATIVE_LINK_PATTERN","relativeLinksToSpaUrls","includes","match","href","lastSlash","lastIndexOf","dir","secondLastSlash","test","SPA_LINK_PATTERN","EditorContext","EditorProvider","setTitle","setContent","hasUnsavedChanges","setHasUnsavedChanges","autoSaveStatus","setAutoSaveStatus","linkedNodeTitles","setLinkedNodeTitles","showHistory","setShowHistory","setHistory","debouncedAutoSave","diskContent","RegExp","source","linkWsId","spaUrlsToRelativeLinks","currentPath","newPath","fetchLinkedNodeTitles","nodeContent","linkedIds","markdown","currentWsId","seen","Set","pattern","exec","has","add","Array","from","extractLinkedNodeIds","join","titles","resetEditor","onCleanup","spaContent","_loadingHistory","setLoadingHistory","assetUrls","asset_urls","loadHistory","triggerAutoSave","flushAutoSave","handleTitleChange","handleContentChange","newContent","useEditor","RecordsContext","RecordsProvider","setRecords","hasMore","setHasMore","allRecords","setAllRecords","setViews","activeViewId","setActiveViewIdSignal","activeFilters","setActiveFilters","activeSorts","setActiveSorts","loadingRecords","setLoadingRecords","savingRecordId","setSavingRecordId","deletingRecordId","setDeletingRecordId","savingView","setSavingView","DEFAULT_VIEW_ID","matchesFilter","record","and","every","f","or","some","property","fieldValue","filterValue","operator","endsWith","applyFiltersClientSide","recs","filters","debouncedServerReload","loadRecordsFromServer","clearRecords","undefined","setActiveViewId","view","find","v","sorts","applyFiltersAndSorts","viewId","serverViewId","loadedRecords","more","loadRecords","cached","filtered","sorted","sort","a","b","aVal","bVal","cmp","localeCompare","direction","has_table","nodeViews","defaultView","default","virtualDefault","columns","groups","loadMoreRecords","offset","newRecords","allRecs","addRecord","recordId","confirm","setFilters","setSorts","newView","updates","newViews","firstView","useRecords","ErrorFallback","_el$","_tmpl$","_el$3","firstChild","nextSibling","_el$4","_el$6","_el$7","_$insert","stack","$$click","reset","_$effect","_p$","_v$","styles","_v$2","_v$3","_v$4","e","_$className","o","AppErrorBoundary","SolidErrorBoundary","fallback","_$delegateEvents","STORAGE_KEY","PWAInstallBanner","deferredPrompt","setDeferredPrompt","showBanner","setShowBanner","dismissed","dismissedDate","getTime","isDismissed","handleBeforeInstall","preventDefault","handleAppInstalled","addEventListener","removeEventListener","handleInstall","prompt","outcome","userChoice","handleDismiss","toISOString","Show","when","_$memo","_el$2","_el$5","_v$5","_v$6","_v$7","i","SettingsNavItem","hasChildren","item","shouldAutoExpand","route","currentRoute","checkActive","items","isActive","isExpanded","setIsExpanded","untrack","depth","handleClick","onNavigate","toggleExpand","stopPropagation","_tmpl$3","ChevronRightIcon","expandIconClass","classes","label","_tmpl$2","For","each","child","navItemClass","separator","_$setAttribute","_$setStyleProperty","SettingsSidebar","useLocation","derivedRoute","slice","wsMatch","section","orgMatch","handleNavigate","urlHash","navItems","wsChildren","isAdmin","orgChildren","orgId","organization_name","is_global_admin","isOpen","SettingsLayout","showMobileSidebar","setShowMobileSidebar","handleKeyDown","handleBack","navigateToWorkspace","_el$8","_el$0","_el$9","_v$8","h","ProfileSettings","lazy","__vitePreload","import","__VITE_PRELOAD__","WorkspaceSettingsPanel","OrgSettingsPanel","ServerSettingsPanel","SettingsLoading","ServerSettingsGuard","Navigate","Suspense","WorkspaceSettingsRoute","useParams","handleNavigateToOrgSettings","hasAccess","onNavigateToOrgSettings","OrgSettingsRoute","ProfileSettingsRoute","SettingsRedirect","SettingsSection","RowHandle","handleDragStart","onDragStart","rowId","handleContextMenu","onContextMenu","onClick","$$contextmenu","class","ContextMenu","menuRef","focusedIndex","setFocusedIndex","adjustedPosition","setAdjustedPosition","x","y","rect","getBoundingClientRect","viewportWidth","innerWidth","viewportHeight","innerHeight","position","width","height","handleClickOutside","contains","target","onClose","enabledIndices","actions","action","disabled","currentPos","nextIndex","prevIndex","onAction","focus","Portal","_$use","_tmpl$4","handleAction","icon","shortcut","getItemClassList","idx","styles$g_item","styles$g_danger","danger","styles$g_disabled","styles$g_focused","_$classList","dragState","SidebarNode","initialExpanded","ancestorIds","showContextMenu","setShowContextMenu","contextMenuPos","setContextMenuPos","isLoadingChildren","setIsLoadingChildren","mightHaveChildren","selectedId","nodeChildren","hasAutoExpanded","setHasAutoExpanded","prevLength","onFetchChildren","clientX","clientY","liRef","isDragging","setIsDragging","isDropTarget","setIsDropTarget","expandTimer","dataTransfer","effectAllowed","setData","element","handleDragEnd","handleDragOver","currentTarget","dropEffect","handleDragLeave","related","relatedTarget","handleDrop","onMoveNode","onSelect","_c$","has_page","TableChartIcon","DescriptionIcon","_c$2","onDeleteNode","DeleteIcon","HistoryIcon","actionId","onCreateChildPage","onCreateChildTable","onShowHistory","_v$9","_v$0","_v$1","_v$10","_v$11","_v$12","r","d","l","c","w","Sidebar","showOtherWorkspaces","setShowOtherWorkspaces","isEditingName","setIsEditingName","editNameValue","setEditNameValue","isSaving","setIsSaving","currentWsName","current","startEditingName","cancelEditingName","saveWorkspaceName","newName","handleNameKeyDown","groupedWorkspaces","orgMap","Map","values","otherWorkspaces","flatMap","hasMultipleOrgs","isRootDropTarget","setIsRootDropTarget","handleRootDragOver","handleRootDragLeave","handleRootDrop","getData","_tmpl$5","_el$10","_el$11","_el$12","_el$13","_el$14","_el$15","_tmpl$6","_v$17","_v$18","$$keydown","$$input","el","onOpenSettings","SettingsIcon","onCloseMobileSidebar","LeftPanelCloseIcon","onSelectNode","_el$1","_el$16","_el$17","_tmpl$7","handleSwitchWorkspace","onCreateWorkspace","AddIcon","onImportFromNotion","DownloadIcon","_v$13","_v$14","_v$15","_v$16","useClickOutside","getRef","UserMenu","setIsOpen","getInitials","parts","toUpperCase","userName","userEmail","workspaceRole","handleLogout","handleProfile","onProfile","getAvatarUrl","identities","oauth_identities","identity","avatar_url","NotionImportBanner","statusMessage","isTerminal","_tmpl$0","_el$28","progress","total","pages","databases","_el$18","_el$19","_el$21","_el$22","errors","_el$24","_el$25","_el$27","_tmpl$8","_el$29","_tmpl$9","onCancel","_el$30","onDismiss","bannerClass","CreateWorkspaceModal","setName","setLoading","setError","handleSubmit","onCreate","handleOverlayClick","isFirstWorkspace","_c$3","_c$4","flex","_$style","NotionImportModal","notionToken","setNotionToken","onImport","_el$20","_el$23","_el$26","_el$31","m","WorkspaceLayout","showCreateWorkspace","setShowCreateWorkspace","showNotionImport","setShowNotionImport","notionImportStatus","setNotionImportStatus","notionImportWsId","setNotionImportWsId","nodeCreationParentId","setNodeCreationParentId","importPollInterval","handleNotionImport","result","notion_token","startNotionImportPolling","setInterval","clearInterval","handleCancelNotionImport","prev","dismissNotionImportBanner","findNodeContext","parent","siblings","createNode","parentId","newNodeId","defaultTitle","properties","required","handleNodeClick","handleDeleteNode","nextNode","ctx","handleMoveNode","keyed","MenuIcon","crumb","onCreatePage","onCreateTable","WorkspaceRoot","firstNode","TABLE_RECORD_MIME","TableRow","menuState","setMenuState","_rowId","onOpen","onDuplicate","onDelete","showDropIndicator","Dynamic","component","as","onDragOver","onDrop","getActions","TableCell","editValue","setEditValue","editCancelled","setEditCancelled","inputRef","getCellValue","column","isEditing","onStartEdit","renderCellContent","toLocaleDateString","handleCellSave","onSave","getCurrentValue","HTMLInputElement","checked","syncAndSave","syncAndBlur","onKeyDown","shiftKey","focusRef","select","renderCellInput","initialValue","option","COLUMN_TYPES","labelKey","AddColumnDropdown","showDropdown","setShowDropdown","newColumnName","setNewColumnName","newColumnType","setNewColumnType","handleAddColumn","newColumn","onAddColumn","ct","TableTable","editingCell","setEditingCell","handleAddRow","onAddRecord","handleRowDragStart","handleRowDragOver","handleRowContextMenu","handleRowAction","onOpenRecord","onDuplicateRecord","onDeleteRecord","columnId","columnName","onUpdateRecord","updatedData","onLoadMore","getRowActions","updateRecordField","fieldName","newValue","onUpdate","newData","fieldName2","handleEnterBlur","blur","getFieldValue","getRecordTitle","firstCol","TableGrid","_$addEventListener","col","TableGallery","imgCol","TableBoard","groupColumn","fromOptions","grouped","forEach","opt","val","Object","g","group","VIEW_ICONS","TableRowsIcon","board","GridGoldenratioIcon","gallery","GridViewIcon","ViewStreamIcon","calendar","CalendarMonthIcon","ViewTabs","showNewViewMenu","setShowNewViewMenu","contextMenuView","setContextMenuView","handleNewView","handleDeleteView","Icon","handleTabClick","pos","md","MarkdownIt","html","linkify","typographer","core","ruler","after","tokens","inlineToken","attrSet","checkboxToken","Token","renderer","rules","checkbox","attrGet","originalImageRenderer","image","_env","self","renderToken","MarkdownPreview","anchor","closest","getAttribute","isInternalLink","open","rawHtml","render","DOMPurify","sanitize","innerHTML","env","srcIndex","attrIndex","attrs","srcAttr","src","signedUrl","Editor","NodeView","previewContent","setPreviewContent","previewCommit","setPreviewCommit","activeView","viewType","first","loadPreview","_loadingPreview","setLoadingPreview","updatedProperties","commit","handleNavigateToNode","timestamp","toLocaleString","author_name","author_email","styles$9_activeHistoryItem","onChange","onAssetUploaded","onError","onNavigateToNode","tableId","WorkspaceSection","Auth","Privacy","Terms","Onboarding","RouteLoading","NotFound","A","RequireAuth","AuthRoute","Switch","Match","onLogin","RootRedirect","SettingsSectionWithAuth","WorkspaceSectionWithAuth","AppRoutes","Router","explicitLinks","Route","App","storedLocale","root","getElementById"],"ignoreList":[],"sources":["../../../../frontend/src/i18n/index.tsx","../../../../sdk/api.gen.ts","../../../../frontend/src/useApi.ts","../../../../frontend/src/contexts/AuthContext.tsx","../../../../sdk/types.gen.ts","../../../../frontend/src/utils/urls.ts","../../../../frontend/src/contexts/WorkspaceContext.tsx","../../../../frontend/src/utils/debounce.ts","../../../../frontend/src/utils/markdown-utils.ts","../../../../frontend/src/contexts/EditorContext.tsx","../../../../frontend/src/contexts/RecordsContext.tsx","../../../../frontend/src/components/ErrorBoundary.tsx","../../../../frontend/src/components/PWAInstallBanner.tsx","../../../../frontend/src/components/settings/SettingsNavItem.tsx","../../../../frontend/src/components/settings/SettingsSidebar.tsx","../../../../frontend/src/sections/SettingsLayout.tsx","../../../../frontend/src/sections/SettingsSection.tsx","../../../../frontend/src/components/shared/RowHandle.tsx","../../../../frontend/src/components/shared/ContextMenu.tsx","../../../../frontend/src/components/SidebarNode.tsx","../../../../frontend/src/components/Sidebar.tsx","../../../../frontend/src/composables/useClickOutside.ts","../../../../frontend/src/components/UserMenu.tsx","../../../../frontend/src/components/NotionImportBanner.tsx","../../../../frontend/src/components/CreateWorkspaceModal.tsx","../../../../frontend/src/components/NotionImportModal.tsx","../../../../frontend/src/sections/WorkspaceLayout.tsx","../../../../frontend/src/sections/WorkspaceRoot.tsx","../../../../frontend/src/components/table/TableRow.tsx","../../../../frontend/src/components/table/TableCell.tsx","../../../../frontend/src/components/table/AddColumnDropdown.tsx","../../../../frontend/src/components/TableTable.tsx","../../../../frontend/src/components/table/tableUtils.ts","../../../../frontend/src/components/TableGrid.tsx","../../../../frontend/src/components/TableGallery.tsx","../../../../frontend/src/components/TableBoard.tsx","../../../../frontend/src/components/table/ViewTabs.tsx","../../../../frontend/src/components/MarkdownPreview.tsx","../../../../frontend/src/sections/NodeView.tsx","../../../../frontend/src/sections/WorkspaceSection.tsx","../../../../frontend/src/App.tsx","../../../../frontend/src/index.tsx"],"sourcesContent":["// Internationalization provider and context hooks.\n\nimport { createContext, useContext, createSignal, createResource, type ParentComponent, type Accessor } from 'solid-js';\nimport * as i18n from '@solid-primitives/i18n';\nimport type { Dictionary, Locale } from './types';\nimport type { ErrorCode } from '@sdk/types.gen';\n\n// Flatten the dictionary for dot-notation access\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\ntype FlatDict = i18n.Flatten<Dictionary & Record<string, any>>;\n\n// Dynamic import for dictionaries\nasync function fetchDictionary(locale: Locale): Promise<FlatDict> {\n  const module = await import(`./dictionaries/${locale}.ts`);\n  return i18n.flatten(module.dict) as FlatDict;\n}\n\ninterface I18nContextValue {\n  locale: Accessor<Locale>;\n  setLocale: (locale: Locale) => void;\n  t: i18n.NullableTranslator<FlatDict>;\n  translateError: (code: ErrorCode | string) => string;\n  ready: Accessor<boolean>;\n}\n\nconst I18nContext = createContext<I18nContextValue>();\n\nexport const I18nProvider: ParentComponent<{ initialLocale?: Locale }> = (props) => {\n  const [locale, setLocale] = createSignal<Locale>(props.initialLocale || 'en');\n  const [dict] = createResource(locale, fetchDictionary);\n\n  const rawTranslator = i18n.translator(dict, i18n.resolveTemplate);\n\n  // Wrap translator to ensure dict() is accessed on each call for proper reactivity.\n  // This ensures Solid tracks dependencies correctly when locale changes.\n  const t: typeof rawTranslator = (key, ...args) => {\n    // Force dict access for reactivity tracking - this makes components\n    // that call t() re-render when the dictionary changes\n    dict();\n    return rawTranslator(key, ...args);\n  };\n\n  // Expose whether translations are loaded\n  const ready = () => dict.state === 'ready';\n\n  const translateError = (code: ErrorCode | string): string => {\n    // Try to find error message by code\n    const key = `errors.${code}` as keyof FlatDict;\n    const translated = t(key);\n    if (translated && translated !== key) {\n      return translated as string;\n    }\n    // Fallback to unknown error\n    return (t('errors.unknown') as string) || 'An error occurred';\n  };\n\n  const value: I18nContextValue = {\n    locale,\n    setLocale,\n    t,\n    translateError,\n    ready,\n  };\n\n  return <I18nContext.Provider value={value}>{props.children}</I18nContext.Provider>;\n};\n\nexport function useI18n(): I18nContextValue {\n  const context = useContext(I18nContext);\n  if (!context) {\n    throw new Error('useI18n must be used within I18nProvider');\n  }\n  return context;\n}\n\nexport type { Locale, Dictionary };\n","// Code generated by apiclient. DO NOT EDIT.\n\nimport type {\n  AcceptInvitationRequest,\n  AdminServerDetail,\n  AuthResponse,\n  ChangeEmailRequest,\n  ChangeEmailResponse,\n  CreateOrgInvitationRequest,\n  CreateOrganizationRequest,\n  CreatePageRequest,\n  CreatePageResponse,\n  CreateRecordRequest,\n  CreateRecordResponse,\n  CreateTableRequest,\n  CreateTableUnderParentResponse,\n  CreateViewRequest,\n  CreateViewResponse,\n  CreateWSInvitationRequest,\n  CreateWorkspaceRequest,\n  DeleteNodeAssetResponse,\n  DeleteNodeResponse,\n  DeletePageResponse,\n  DeleteRecordResponse,\n  DeleteTableResponse,\n  DeleteViewResponse,\n  ErrorResponse,\n  GetNodeTitlesRequest,\n  GetNodeTitlesResponse,\n  GetNodeVersionResponse,\n  GetPageResponse,\n  GetRecordResponse,\n  GetTableSchemaResponse,\n  GitRemoteResponse,\n  HealthResponse,\n  ListNodeAssetsResponse,\n  ListNodeChildrenResponse,\n  ListNodeVersionsRequest,\n  ListNodeVersionsResponse,\n  ListOrgInvitationsResponse,\n  ListRecordsRequest,\n  ListRecordsResponse,\n  ListSessionsResponse,\n  ListUsersResponse,\n  ListWSInvitationsResponse,\n  LoginRequest,\n  LogoutResponse,\n  MoveNodeRequest,\n  MoveNodeResponse,\n  NodeResponse,\n  NotionImportCancelResponse,\n  NotionImportRequest,\n  NotionImportResponse,\n  NotionImportStatusResponse,\n  OkResponse,\n  OrgInvitationResponse,\n  OrganizationResponse,\n  ProvidersResponse,\n  RegisterRequest,\n  RevokeAllSessionsResponse,\n  RevokeSessionRequest,\n  RevokeSessionResponse,\n  SearchRequest,\n  SearchResponse,\n  SendVerificationEmailResponse,\n  ServerConfigResponse,\n  SetPasswordRequest,\n  SwitchWorkspaceRequest,\n  SwitchWorkspaceResponse,\n  UpdateGitRemoteRequest,\n  UpdateOrgMemberRoleRequest,\n  UpdateOrgPreferencesRequest,\n  UpdateOrganizationRequest,\n  UpdatePageRequest,\n  UpdatePageResponse,\n  UpdateRecordRequest,\n  UpdateRecordResponse,\n  UpdateServerConfigRequest,\n  UpdateServerConfigResponse,\n  UpdateTableRequest,\n  UpdateTableResponse,\n  UpdateUserSettingsRequest,\n  UpdateViewRequest,\n  UpdateViewResponse,\n  UpdateWSMemberRoleRequest,\n  UpdateWSMembershipSettingsRequest,\n  UpdateWorkspaceRequest,\n  UserResponse,\n  WSInvitationResponse,\n  WSMembershipResponse,\n  WorkspaceResponse,\n} from './types.gen';\n\n/** Fetch function type - implement to add auth headers */\nexport type FetchFn = (url: string, init?: RequestInit) => Promise<Response>;\n\n/** API error with parsed error response */\nexport class APIError extends Error {\n  constructor(\n    public status: number,\n    public response: ErrorResponse\n  ) {\n    super(response.error.message);\n    this.name = 'APIError';\n  }\n}\n\nasync function get<T>(fetchFn: FetchFn, url: string): Promise<T> {\n  const res = await fetchFn(url);\n  if (!res.ok) {\n    const error = (await res.json()) as ErrorResponse;\n    throw new APIError(res.status, error);\n  }\n  return res.json() as Promise<T>;\n}\n\nasync function post<T>(fetchFn: FetchFn, url: string, body?: object): Promise<T> {\n  const init: RequestInit = { method: 'POST' };\n  if (body) {\n    init.headers = { 'Content-Type': 'application/json' };\n    init.body = JSON.stringify(body);\n  }\n  const res = await fetchFn(url, init);\n  if (!res.ok) {\n    const error = (await res.json()) as ErrorResponse;\n    throw new APIError(res.status, error);\n  }\n  return res.json() as Promise<T>;\n}\n\n/** Creates a typed API client */\nexport function createAPIClient(fetchFn: FetchFn) {\n  return {\n    admin: {\n      getServerDetail: () => get<AdminServerDetail>(fetchFn, `/api/v1/admin/server`),\n    },\n    auth: {\n      email: {\n        changeEmail: (options: ChangeEmailRequest) => post<ChangeEmailResponse>(fetchFn, `/api/v1/auth/email`, options),\n        sendVerificationEmail: () => post<SendVerificationEmailResponse>(fetchFn, `/api/v1/auth/email/send-verification`),\n      },\n      invitations: {\n        acceptOrgInvitation: (options: AcceptInvitationRequest) => post<AuthResponse>(fetchFn, `/api/v1/auth/invitations/org/accept`, options),\n        acceptWSInvitation: (options: AcceptInvitationRequest) => post<AuthResponse>(fetchFn, `/api/v1/auth/invitations/ws/accept`, options),\n      },\n      sessions: {\n        listSessions: () => get<ListSessionsResponse>(fetchFn, `/api/v1/auth/sessions`),\n        revokeAllSessions: () => post<RevokeAllSessionsResponse>(fetchFn, `/api/v1/auth/sessions/revoke-all`),\n        revokeSession: (options: RevokeSessionRequest) => post<RevokeSessionResponse>(fetchFn, `/api/v1/auth/sessions/revoke`, options),\n      },\n      getMe: () => get<UserResponse>(fetchFn, `/api/v1/auth/me`),\n      listProviders: () => get<ProvidersResponse>(fetchFn, `/api/v1/auth/providers`),\n      login: (options: LoginRequest) => post<AuthResponse>(fetchFn, `/api/v1/auth/login`, options),\n      logout: () => post<LogoutResponse>(fetchFn, `/api/v1/auth/logout`),\n      register: (options: RegisterRequest) => post<AuthResponse>(fetchFn, `/api/v1/auth/register`, options),\n      setPassword: (options: SetPasswordRequest) => post<OkResponse>(fetchFn, `/api/v1/auth/password`, options),\n      switchWorkspace: (options: SwitchWorkspaceRequest) => post<SwitchWorkspaceResponse>(fetchFn, `/api/v1/auth/switch-workspace`, options),\n      updateUserSettings: (options: UpdateUserSettingsRequest) => post<UserResponse>(fetchFn, `/api/v1/auth/settings`, options),\n    },\n    organizations: {\n      createOrganization: (options: CreateOrganizationRequest) => post<OrganizationResponse>(fetchFn, `/api/v1/organizations`, options),\n    },\n    server: {\n      getConfig: () => get<ServerConfigResponse>(fetchFn, `/api/v1/server/config`),\n      updateConfig: (options: UpdateServerConfigRequest) => post<UpdateServerConfigResponse>(fetchFn, `/api/v1/server/config`, options),\n    },\n    getHealth: () => get<HealthResponse>(fetchFn, `/api/v1/health`),\n\n    /** Returns an org-scoped API client */\n    org(orgID: string) {\n      return {\n        invitations: {\n          createOrgInvitation: (options: CreateOrgInvitationRequest) => post<OrgInvitationResponse>(fetchFn, `/api/v1/organizations/${orgID}/invitations`, options),\n          listOrgInvitations: () => get<ListOrgInvitationsResponse>(fetchFn, `/api/v1/organizations/${orgID}/invitations`),\n        },\n        notion: {\n          getStatus: (importWsID: string) => get<NotionImportStatusResponse>(fetchFn, `/api/v1/organizations/${orgID}/notion/import/${importWsID}/status`),\n          startImport: (options: NotionImportRequest) => post<NotionImportResponse>(fetchFn, `/api/v1/organizations/${orgID}/notion/import`, options),\n        },\n        organizations: {\n          getOrganization: () => get<OrganizationResponse>(fetchFn, `/api/v1/organizations/${orgID}`),\n          updateOrganization: (options: UpdateOrganizationRequest) => post<OrganizationResponse>(fetchFn, `/api/v1/organizations/${orgID}`, options),\n        },\n        settings: {\n          updateOrgPreferences: (options: UpdateOrgPreferencesRequest) => post<OrganizationResponse>(fetchFn, `/api/v1/organizations/${orgID}/settings`, options),\n        },\n        users: {\n          listUsers: () => get<ListUsersResponse>(fetchFn, `/api/v1/organizations/${orgID}/users`),\n          updateOrgMemberRole: (options: UpdateOrgMemberRoleRequest) => post<UserResponse>(fetchFn, `/api/v1/organizations/${orgID}/users/role`, options),\n        },\n        workspaces: {\n          createWorkspace: (options: CreateWorkspaceRequest) => post<WorkspaceResponse>(fetchFn, `/api/v1/organizations/${orgID}/workspaces`, options),\n        },\n      };\n    },\n\n    /** Returns a workspace-scoped API client */\n    ws(wsID: string) {\n      return {\n        invitations: {\n          createWSInvitation: (options: CreateWSInvitationRequest) => post<WSInvitationResponse>(fetchFn, `/api/v1/workspaces/${wsID}/invitations`, options),\n          listWSInvitations: () => get<ListWSInvitationsResponse>(fetchFn, `/api/v1/workspaces/${wsID}/invitations`),\n        },\n        nodes: {\n          assets: {\n            deleteNodeAsset: (id: string, name: string) => post<DeleteNodeAssetResponse>(fetchFn, `/api/v1/workspaces/${wsID}/nodes/${id}/assets/${name}/delete`),\n            listNodeAssets: (id: string) => get<ListNodeAssetsResponse>(fetchFn, `/api/v1/workspaces/${wsID}/nodes/${id}/assets`),\n          },\n          history: {\n            getNodeVersion: (id: string, hash: string) => get<GetNodeVersionResponse>(fetchFn, `/api/v1/workspaces/${wsID}/nodes/${id}/history/${hash}`),\n            async listNodeVersions(id: string, options: ListNodeVersionsRequest): Promise<ListNodeVersionsResponse> {\n              const params = new URLSearchParams();\n              if (options.Limit) params.set('limit', String(options.Limit));\n              const url = `/api/v1/workspaces/${wsID}/nodes/${id}/history` + (params.toString() ? `?${params}` : '');\n              return get<ListNodeVersionsResponse>(fetchFn, url);\n            },\n          },\n          page: {\n            createPage: (id: string, options: CreatePageRequest) => post<CreatePageResponse>(fetchFn, `/api/v1/workspaces/${wsID}/nodes/${id}/page/create`, options),\n            deletePage: (id: string) => post<DeletePageResponse>(fetchFn, `/api/v1/workspaces/${wsID}/nodes/${id}/page/delete`),\n            getPage: (id: string) => get<GetPageResponse>(fetchFn, `/api/v1/workspaces/${wsID}/nodes/${id}/page`),\n            updatePage: (id: string, options: UpdatePageRequest) => post<UpdatePageResponse>(fetchFn, `/api/v1/workspaces/${wsID}/nodes/${id}/page`, options),\n          },\n          table: {\n            records: {\n              createRecord: (id: string, options: CreateRecordRequest) => post<CreateRecordResponse>(fetchFn, `/api/v1/workspaces/${wsID}/nodes/${id}/table/records/create`, options),\n              deleteRecord: (id: string, rid: string) => post<DeleteRecordResponse>(fetchFn, `/api/v1/workspaces/${wsID}/nodes/${id}/table/records/${rid}/delete`),\n              getRecord: (id: string, rid: string) => get<GetRecordResponse>(fetchFn, `/api/v1/workspaces/${wsID}/nodes/${id}/table/records/${rid}`),\n              async listRecords(id: string, options: ListRecordsRequest): Promise<ListRecordsResponse> {\n                const params = new URLSearchParams();\n                if (options.ViewID) params.set('view_id', options.ViewID);\n                if (options.Filters) params.set('filters', options.Filters);\n                if (options.Sorts) params.set('sorts', options.Sorts);\n                if (options.Offset) params.set('offset', String(options.Offset));\n                if (options.Limit) params.set('limit', String(options.Limit));\n                const url = `/api/v1/workspaces/${wsID}/nodes/${id}/table/records` + (params.toString() ? `?${params}` : '');\n                return get<ListRecordsResponse>(fetchFn, url);\n              },\n              updateRecord: (id: string, rid: string, options: UpdateRecordRequest) => post<UpdateRecordResponse>(fetchFn, `/api/v1/workspaces/${wsID}/nodes/${id}/table/records/${rid}`, options),\n            },\n            createTable: (id: string, options: CreateTableRequest) => post<CreateTableUnderParentResponse>(fetchFn, `/api/v1/workspaces/${wsID}/nodes/${id}/table/create`, options),\n            deleteTable: (id: string) => post<DeleteTableResponse>(fetchFn, `/api/v1/workspaces/${wsID}/nodes/${id}/table/delete`),\n            getTable: (id: string) => get<GetTableSchemaResponse>(fetchFn, `/api/v1/workspaces/${wsID}/nodes/${id}/table`),\n            updateTable: (id: string, options: UpdateTableRequest) => post<UpdateTableResponse>(fetchFn, `/api/v1/workspaces/${wsID}/nodes/${id}/table`, options),\n          },\n          views: {\n            createView: (id: string, options: CreateViewRequest) => post<CreateViewResponse>(fetchFn, `/api/v1/workspaces/${wsID}/nodes/${id}/views/create`, options),\n            deleteView: (id: string, viewID: string) => post<DeleteViewResponse>(fetchFn, `/api/v1/workspaces/${wsID}/nodes/${id}/views/${viewID}/delete`),\n            updateView: (id: string, viewID: string, options: UpdateViewRequest) => post<UpdateViewResponse>(fetchFn, `/api/v1/workspaces/${wsID}/nodes/${id}/views/${viewID}`, options),\n          },\n          deleteNode: (id: string) => post<DeleteNodeResponse>(fetchFn, `/api/v1/workspaces/${wsID}/nodes/${id}/delete`),\n          getNode: (id: string) => get<NodeResponse>(fetchFn, `/api/v1/workspaces/${wsID}/nodes/${id}`),\n          async getNodeTitles(options: GetNodeTitlesRequest): Promise<GetNodeTitlesResponse> {\n            const params = new URLSearchParams();\n            if (options.IDs) params.set('ids', options.IDs);\n            const url = `/api/v1/workspaces/${wsID}/nodes/titles` + (params.toString() ? `?${params}` : '');\n            return get<GetNodeTitlesResponse>(fetchFn, url);\n          },\n          listNodeChildren: (id: string) => get<ListNodeChildrenResponse>(fetchFn, `/api/v1/workspaces/${wsID}/nodes/${id}/children`),\n          moveNode: (id: string, options: MoveNodeRequest) => post<MoveNodeResponse>(fetchFn, `/api/v1/workspaces/${wsID}/nodes/${id}/move`, options),\n        },\n        notion: {\n          cancelImport: () => post<NotionImportCancelResponse>(fetchFn, `/api/v1/workspaces/${wsID}/notion/import/cancel`),\n        },\n        settings: {\n          git: {\n            deleteGitRemote: () => post<OkResponse>(fetchFn, `/api/v1/workspaces/${wsID}/settings/git/delete`),\n            getGitRemote: () => get<GitRemoteResponse>(fetchFn, `/api/v1/workspaces/${wsID}/settings/git`),\n            pushGit: () => post<OkResponse>(fetchFn, `/api/v1/workspaces/${wsID}/settings/git/push`),\n            updateGitRemote: (options: UpdateGitRemoteRequest) => post<GitRemoteResponse>(fetchFn, `/api/v1/workspaces/${wsID}/settings/git`, options),\n          },\n          updateWSMembershipSettings: (options: UpdateWSMembershipSettingsRequest) => post<WSMembershipResponse>(fetchFn, `/api/v1/workspaces/${wsID}/settings/membership`, options),\n        },\n        users: {\n          updateWSMemberRole: (options: UpdateWSMemberRoleRequest) => post<UserResponse>(fetchFn, `/api/v1/workspaces/${wsID}/users/role`, options),\n        },\n        workspaces: {\n          getWorkspace: () => get<WorkspaceResponse>(fetchFn, `/api/v1/workspaces/${wsID}`),\n          updateWorkspace: (options: UpdateWorkspaceRequest) => post<WorkspaceResponse>(fetchFn, `/api/v1/workspaces/${wsID}`, options),\n        },\n        search: (options: SearchRequest) => post<SearchResponse>(fetchFn, `/api/v1/workspaces/${wsID}/search`, options),\n      };\n    },\n  };\n}\n\nexport type APIClient = ReturnType<typeof createAPIClient>;\nexport type OrgAPIClient = ReturnType<APIClient['org']>;\nexport type WSAPIClient = ReturnType<APIClient['ws']>;\n","// Utilities for creating authenticated and retry-enabled API clients.\n\nimport { createAPIClient, APIError, type FetchFn } from '@sdk/api.gen';\n\nexport { APIError };\n\n/** Type alias for the API client returned by createApi */\nexport type Api = ReturnType<typeof createApi>;\n\n/** Default retry configuration */\nconst RETRY_CONFIG = {\n  maxRetries: 3,\n  baseDelayMs: 1000,\n  maxDelayMs: 30000,\n};\n\n/** Checks if the status code should trigger a retry */\nfunction isRetryableStatus(status: number): boolean {\n  return status === 429 || (status >= 500 && status < 600);\n}\n\n/** Parses Retry-After header value (seconds or HTTP date) */\nfunction parseRetryAfter(header: string | null): number | null {\n  if (!header) return null;\n  // Try parsing as seconds\n  const seconds = parseInt(header, 10);\n  if (!isNaN(seconds)) {\n    return seconds * 1000;\n  }\n  // Try parsing as HTTP date\n  const date = Date.parse(header);\n  if (!isNaN(date)) {\n    return Math.max(0, date - Date.now());\n  }\n  return null;\n}\n\n/** Calculates delay for next retry with exponential backoff */\nfunction getRetryDelay(attempt: number, retryAfterMs: number | null): number {\n  if (retryAfterMs !== null) {\n    return Math.min(retryAfterMs, RETRY_CONFIG.maxDelayMs);\n  }\n  // Exponential backoff: 1s, 2s, 4s...\n  const delay = RETRY_CONFIG.baseDelayMs * Math.pow(2, attempt);\n  return Math.min(delay, RETRY_CONFIG.maxDelayMs);\n}\n\n/** Wraps a fetch function with retry logic for 429 and 5xx errors */\nfunction withRetry(fetchFn: FetchFn): FetchFn {\n  return async (url: string, init?: RequestInit): Promise<Response> => {\n    let attempt = 0;\n    for (;;) {\n      const response = await fetchFn(url, init);\n      if (!isRetryableStatus(response.status) || attempt >= RETRY_CONFIG.maxRetries) {\n        return response;\n      }\n      const retryAfterMs = parseRetryAfter(response.headers.get('Retry-After'));\n      const delay = getRetryDelay(attempt, retryAfterMs);\n      await new Promise((resolve) => setTimeout(resolve, delay));\n      attempt++;\n    }\n  };\n}\n\n/**\n * Creates an authenticated fetch function for use with the API client.\n * @param getToken - Function that returns the current auth token\n * @param onUnauthorized - Callback when a 401 response is received\n */\nexport function createAuthFetch(getToken: () => string | null, onUnauthorized?: () => void): FetchFn {\n  const baseFetch: FetchFn = async (url: string, init?: RequestInit) => {\n    const token = getToken();\n    const headers: HeadersInit = {\n      ...init?.headers,\n    };\n    if (token) {\n      (headers as Record<string, string>)['Authorization'] = `Bearer ${token}`;\n    }\n    const res = await fetch(url, { ...init, headers });\n    if (res.status === 401 && onUnauthorized) {\n      onUnauthorized();\n    }\n    return res;\n  };\n  return withRetry(baseFetch);\n}\n\n/**\n * Creates an API client with authentication.\n * @param getToken - Function that returns the current auth token\n * @param onUnauthorized - Callback when a 401 response is received\n */\nexport function createApi(getToken: () => string | null, onUnauthorized?: () => void) {\n  return createAPIClient(createAuthFetch(getToken, onUnauthorized));\n}\n","// Authentication context providing user state, token management, and API clients.\n\nimport {\n  createContext,\n  useContext,\n  createSignal,\n  createMemo,\n  createEffect,\n  on,\n  onMount,\n  type ParentComponent,\n  type Accessor,\n} from 'solid-js';\nimport { createApi, APIError, type Api } from '../useApi';\nimport type { UserResponse } from '@sdk/types.gen';\n\ninterface AuthContextValue {\n  user: Accessor<UserResponse | null>;\n  token: Accessor<string | null>;\n  /** True once initial auth check is complete (token validated or no token present) */\n  ready: Accessor<boolean>;\n  api: Accessor<Api>;\n  wsApi: Accessor<ReturnType<Api['ws']> | null>;\n  orgApi: Accessor<ReturnType<Api['org']> | null>;\n  login: (token: string, user: UserResponse) => void;\n  logout: () => Promise<void>;\n  setUser: (user: UserResponse | null) => void;\n  refreshUser: () => Promise<void>;\n}\n\nconst AuthContext = createContext<AuthContextValue>();\n\nexport const AuthProvider: ParentComponent = (props) => {\n  const [user, setUser] = createSignal<UserResponse | null>(null);\n  const [token, setToken] = createSignal<string | null>(localStorage.getItem('mddb_token'));\n  const [ready, setReady] = createSignal(false);\n\n  const logout = async () => {\n    const currentToken = token();\n    if (currentToken) {\n      try {\n        const logoutApi = createApi(\n          () => currentToken,\n          () => {}\n        );\n        await logoutApi.auth.logout();\n      } catch {\n        // Ignore errors - proceed with local logout even if server call fails\n      }\n    }\n    localStorage.removeItem('mddb_token');\n    setToken(null);\n    setUser(null);\n    // Note: Navigation after logout is handled by calling components\n  };\n\n  // Create API client with auth\n  const api = createMemo(() => createApi(() => token(), logout));\n\n  // Get workspace-scoped API client\n  const wsApi = createMemo(() => {\n    const wsID = user()?.workspace_id;\n    return wsID ? api().ws(wsID) : null;\n  });\n\n  // Get organization-scoped API client\n  const orgApi = createMemo(() => {\n    const orgID = user()?.organization_id;\n    return orgID ? api().org(orgID) : null;\n  });\n\n  const login = (newToken: string, userData: UserResponse) => {\n    localStorage.setItem('mddb_token', newToken);\n    setToken(newToken);\n    setUser(userData);\n  };\n\n  const refreshUser = async () => {\n    try {\n      const data = await api().auth.getMe();\n      setUser(data);\n    } catch (err) {\n      console.error('Failed to refresh user', err);\n      if (err instanceof APIError && err.status === 401) {\n        localStorage.removeItem('mddb_token');\n        setToken(null);\n        setUser(null);\n      }\n    }\n  };\n\n  // Handle OAuth token from URL on mount and fetch user data\n  onMount(async () => {\n    const urlParams = new URLSearchParams(window.location.search);\n    const urlToken = urlParams.get('token');\n    if (urlToken) {\n      localStorage.setItem('mddb_token', urlToken);\n      setToken(urlToken);\n      window.history.replaceState({}, document.title, window.location.pathname);\n    }\n\n    // Determine which token to use - URL token takes priority over localStorage\n    // Note: We read the token directly from the sources, not from the signal,\n    // because the signal update might not be visible in this synchronous context\n    const effectiveToken = urlToken || localStorage.getItem('mddb_token');\n    if (effectiveToken) {\n      try {\n        const data = await api().auth.getMe();\n        setUser(data);\n      } catch (err) {\n        console.error('Failed to load user', err);\n        if (err instanceof APIError && err.status === 401) {\n          localStorage.removeItem('mddb_token');\n          setToken(null);\n        }\n      }\n    }\n\n    // Auth check complete - mark as ready\n    setReady(true);\n  });\n\n  // Fetch user when token changes after mount (e.g., login)\n  // Using on() with defer: true to skip initial execution (handled in onMount)\n  createEffect(\n    on(\n      () => [token(), user()] as const,\n      ([tok, u]) => {\n        if (tok && !u) {\n          (async () => {\n            try {\n              const data = await api().auth.getMe();\n              setUser(data);\n            } catch (err) {\n              console.error('Failed to load user', err);\n              if (err instanceof APIError && err.status === 401) {\n                localStorage.removeItem('mddb_token');\n                setToken(null);\n              }\n            }\n          })();\n        }\n      },\n      { defer: true }\n    )\n  );\n\n  const value: AuthContextValue = {\n    user,\n    token,\n    ready,\n    api,\n    wsApi,\n    orgApi,\n    login,\n    logout,\n    setUser,\n    refreshUser,\n  };\n\n  return <AuthContext.Provider value={value}>{props.children}</AuthContext.Provider>;\n};\n\nexport function useAuth(): AuthContextValue {\n  const context = useContext(AuthContext);\n  if (!context) {\n    throw new Error('useAuth must be used within an AuthProvider');\n  }\n  return context;\n}\n","// Code generated by tygo. DO NOT EDIT.\n\n//////////\n// source: errors.go\n/*\nPackage dto defines API request/response types and error handling.\n\nThis package contains all types used for HTTP API communication via goty:\n  - Request types with path/query/json struct tags for parameter binding\n  - Response types with string IDs and RFC3339 timestamps for JSON serialization\n  - Structured error types with HTTP status codes and error codes\n  - API-specific types (Property, UserRole, NodeType, Settings, etc.)\n\nThe dto package is the API contract layer, fully self-contained with no\ndependency on the entity package. This ensures that changes to internal\ndomain models (entity) do not accidentally affect the API contract.\n\nConversion between dto and entity types is handled by the handlers package\n(in convert.go), which imports both packages.\n\nError handling follows a structured pattern:\n  - ErrorCode provides machine-readable error classification\n  - APIError wraps errors with HTTP status codes and details\n  - Constructor functions (NotFound, BadRequest, etc.) create common errors\n*/\n\n/**\n * ErrorCode defines specific error types for the API.\n */\n/**\n * ErrorCodeValidationFailed is returned when input data fails validation.\n */\nexport const ErrorCodeValidationFailed = \"VALIDATION_FAILED\";\n/**\n * ErrorCodeMissingField is returned when a required field is missing.\n */\nexport const ErrorCodeMissingField = \"MISSING_FIELD\";\n/**\n * ErrorCodeInvalidFormat is returned when a field has an invalid format.\n */\nexport const ErrorCodeInvalidFormat = \"INVALID_FORMAT\";\n/**\n * ErrorCodeNotFound is returned when a resource is not found.\n */\nexport const ErrorCodeNotFound = \"NOT_FOUND\";\n/**\n * ErrorCodeNodeNotFound is returned when a node is not found.\n */\nexport const ErrorCodeNodeNotFound = \"NODE_NOT_FOUND\";\n/**\n * ErrorCodeTableNotFound is returned when a table is not found.\n */\nexport const ErrorCodeTableNotFound = \"TABLE_NOT_FOUND\";\n/**\n * ErrorCodeFileNotFound is returned when a file is not found.\n */\nexport const ErrorCodeFileNotFound = \"FILE_NOT_FOUND\";\n/**\n * ErrorCodeStorageError is returned when a storage operation fails.\n */\nexport const ErrorCodeStorageError = \"STORAGE_ERROR\";\n/**\n * ErrorCodeInternal is returned when an unexpected server error occurs.\n */\nexport const ErrorCodeInternal = \"INTERNAL_ERROR\";\n/**\n * ErrorCodeNotImplemented is returned when a feature is not implemented.\n */\nexport const ErrorCodeNotImplemented = \"NOT_IMPLEMENTED\";\n/**\n * ErrorCodeConflict is returned when there is a resource conflict.\n */\nexport const ErrorCodeConflict = \"CONFLICT\";\n/**\n * ErrorCodeUnauthorized is returned when authentication is missing or invalid.\n */\nexport const ErrorCodeUnauthorized = \"UNAUTHORIZED\";\n/**\n * ErrorCodeForbidden is returned when a user has insufficient permissions.\n */\nexport const ErrorCodeForbidden = \"FORBIDDEN\";\n/**\n * ErrorCodeInvalidProvider is returned when an OAuth provider is unknown.\n */\nexport const ErrorCodeInvalidProvider = \"INVALID_PROVIDER\";\n/**\n * ErrorCodeOAuthError is returned when an OAuth operation fails.\n */\nexport const ErrorCodeOAuthError = \"OAUTH_ERROR\";\n/**\n * ErrorCodeExpired is returned when a resource has expired.\n */\nexport const ErrorCodeExpired = \"EXPIRED\";\n/**\n * ErrorCodeRateLimitExceeded is returned when rate limit is exceeded.\n */\nexport const ErrorCodeRateLimitExceeded = \"RATE_LIMIT_EXCEEDED\";\n/**\n * ErrorCodeCannotUnlinkOnlyAuth is returned when trying to unlink the only authentication method.\n */\nexport const ErrorCodeCannotUnlinkOnlyAuth = \"CANNOT_UNLINK_ONLY_AUTH\";\n/**\n * ErrorCodeProviderAlreadyLinked is returned when trying to link an already linked provider.\n */\nexport const ErrorCodeProviderAlreadyLinked = \"PROVIDER_ALREADY_LINKED\";\n/**\n * ErrorCodeProviderNotLinked is returned when trying to unlink a provider that is not linked.\n */\nexport const ErrorCodeProviderNotLinked = \"PROVIDER_NOT_LINKED\";\n/**\n * ErrorCodeEmailInUse is returned when an email is already in use by another account.\n */\nexport const ErrorCodeEmailInUse = \"EMAIL_IN_USE\";\n/**\n * ErrorCodeQuotaExceeded is returned when a server-wide quota is exceeded.\n */\nexport const ErrorCodeQuotaExceeded = \"QUOTA_EXCEEDED\";\n/**\n * ErrorCodePayloadTooLarge is returned when the request body exceeds the size limit.\n */\nexport const ErrorCodePayloadTooLarge = \"PAYLOAD_TOO_LARGE\";\nexport type ErrorCode = typeof ErrorCodeValidationFailed | typeof ErrorCodeMissingField | typeof ErrorCodeInvalidFormat | typeof ErrorCodeNotFound | typeof ErrorCodeNodeNotFound | typeof ErrorCodeTableNotFound | typeof ErrorCodeFileNotFound | typeof ErrorCodeStorageError | typeof ErrorCodeInternal | typeof ErrorCodeNotImplemented | typeof ErrorCodeConflict | typeof ErrorCodeUnauthorized | typeof ErrorCodeForbidden | typeof ErrorCodeInvalidProvider | typeof ErrorCodeOAuthError | typeof ErrorCodeExpired | typeof ErrorCodeRateLimitExceeded | typeof ErrorCodeCannotUnlinkOnlyAuth | typeof ErrorCodeProviderAlreadyLinked | typeof ErrorCodeProviderNotLinked | typeof ErrorCodeEmailInUse | typeof ErrorCodeQuotaExceeded | typeof ErrorCodePayloadTooLarge;\n/**\n * ErrorDetails defines the structured error information in a response.\n */\nexport interface ErrorDetails {\n  code: ErrorCode;\n  message: string;\n}\n/**\n * ErrorResponse is the standard API error response.\n */\nexport interface ErrorResponse {\n  error: ErrorDetails;\n  details?: { [key: string]: any};\n}\n/**\n * ErrorWithStatus is an error that includes an HTTP status code and error code.\n */\nexport type ErrorWithStatus = any;\n/**\n * APIError is a concrete error type with status code and optional details.\n */\nexport interface APIError {\n}\n\n//////////\n// source: request.go\n\n/**\n * LoginRequest is a request to log in.\n */\nexport interface LoginRequest {\n  email: string;\n  password: string;\n}\n/**\n * RegisterRequest is a request to register a new user.\n */\nexport interface RegisterRequest {\n  email: string;\n  password: string;\n  name: string;\n}\n/**\n * GetMeRequest is a request to get current user info.\n */\nexport interface GetMeRequest {\n}\n/**\n * CreatePageRequest is a request to create a page under a parent node.\n * The parent ID is in the path ({id}); use \"0\" for root.\n */\nexport interface CreatePageRequest {\n  title: string;\n  content?: string;\n}\n/**\n * GetPageRequest is a request to get a page's content.\n */\nexport interface GetPageRequest {\n}\n/**\n * UpdatePageRequest is a request to update a page's content.\n */\nexport interface UpdatePageRequest {\n  title: string;\n  content: string;\n}\n/**\n * DeletePageRequest is a request to delete a page from a node.\n * This removes the index.md but keeps the node directory if table data exists.\n */\nexport interface DeletePageRequest {\n}\n/**\n * DeleteNodeRequest is a request to delete a node.\n */\nexport interface DeleteNodeRequest {\n}\n/**\n * ListNodeVersionsRequest is a request to list node version history.\n */\nexport interface ListNodeVersionsRequest {\n  Limit: number /* int */; // Max commits to return (1-1000, default 1000).\n}\n/**\n * GetNodeVersionRequest is a request to get a specific node version.\n */\nexport interface GetNodeVersionRequest {\n}\n/**\n * GetTableRequest is a request to get a table.\n * Now used for /nodes/{id}/table endpoint.\n */\nexport interface GetTableRequest {\n}\n/**\n * CreateTableRequest is a request to create a table under a parent node.\n * The parent ID is in the path ({id}); use \"0\" for root.\n */\nexport interface CreateTableRequest {\n  title: string;\n  properties: Property[];\n}\n/**\n * UpdateTableRequest is a request to update a table.\n * Now used for /nodes/{id}/table endpoint.\n */\nexport interface UpdateTableRequest {\n  title: string;\n  properties: Property[];\n}\n/**\n * DeleteTableRequest is a request to delete a table from a node.\n * This removes the metadata.json and data.jsonl but keeps the node directory if page exists.\n */\nexport interface DeleteTableRequest {\n}\n/**\n * CreateViewRequest is a request to create a new view for a table.\n */\nexport interface CreateViewRequest {\n  name: string;\n  type: ViewType;\n}\n/**\n * UpdateViewRequest is a request to update an existing view.\n */\nexport interface UpdateViewRequest {\n  name?: string;\n  type?: ViewType;\n  columns?: ViewColumn[];\n  filters?: Filter[];\n  sorts?: Sort[];\n  groups?: Group[];\n}\n/**\n * DeleteViewRequest is a request to delete a view.\n */\nexport interface DeleteViewRequest {\n}\n/**\n * ListRecordsRequest is a request to list records in a table.\n * Now used for /nodes/{id}/table/records endpoint.\n */\nexport interface ListRecordsRequest {\n  ViewID: string; // Optional: apply saved view configuration\n  Filters: string; // Optional: JSON-encoded ad-hoc filters\n  Sorts: string; // Optional: JSON-encoded ad-hoc sorts\n  Offset: number /* int */;\n  Limit: number /* int */;\n}\n/**\n * CreateRecordRequest is a request to create a record.\n * Now used for /nodes/{id}/table/records/create endpoint.\n */\nexport interface CreateRecordRequest {\n  data: { [key: string]: any};\n}\n/**\n * UpdateRecordRequest is a request to update a record.\n * Now used for /nodes/{id}/table/records/{rid} endpoint.\n */\nexport interface UpdateRecordRequest {\n  data: { [key: string]: any};\n}\n/**\n * GetRecordRequest is a request to get a record.\n * Now used for /nodes/{id}/table/records/{rid} endpoint.\n */\nexport interface GetRecordRequest {\n}\n/**\n * DeleteRecordRequest is a request to delete a record.\n * Now used for /nodes/{id}/table/records/{rid}/delete endpoint.\n */\nexport interface DeleteRecordRequest {\n}\n/**\n * ListNodesRequest is a request to list nodes.\n */\nexport interface ListNodesRequest {\n}\n/**\n * GetNodeTitlesRequest is a request to get titles for multiple nodes.\n */\nexport interface GetNodeTitlesRequest {\n  IDs: string; // Comma-separated node IDs\n}\n/**\n * GetNodeRequest is a request to get a node.\n */\nexport interface GetNodeRequest {\n}\n/**\n * ListNodeChildrenRequest is a request to list children of a node.\n */\nexport interface ListNodeChildrenRequest {\n}\n/**\n * MoveNodeRequest is a request to move a node to a new parent.\n */\nexport interface MoveNodeRequest {\n  new_parent_id: string; // New parent node ID; 0 = root\n}\n/**\n * ListNodeAssetsRequest is a request to list assets in a node.\n */\nexport interface ListNodeAssetsRequest {\n}\n/**\n * UploadNodeAssetRequest is a request to upload an asset to a node.\n */\nexport interface UploadNodeAssetRequest {\n}\n/**\n * DeleteNodeAssetRequest is a request to delete an asset from a node.\n */\nexport interface DeleteNodeAssetRequest {\n}\n/**\n * ServeAssetRequest is a request to serve an asset file directly.\n */\nexport interface ServeAssetRequest {\n}\n/**\n * SearchRequest is a request to search pages and tables.\n */\nexport interface SearchRequest {\n  query: string;\n  limit?: number /* int */;\n  match_title?: boolean;\n  match_body?: boolean;\n  match_fields?: boolean;\n}\n/**\n * CreateOrgInvitationRequest is a request to create an organization invitation.\n */\nexport interface CreateOrgInvitationRequest {\n  email: string;\n  role: OrganizationRole;\n  locale?: string; // Optional: language for invitation email (en, fr, de, es)\n}\n/**\n * CreateWSInvitationRequest is a request to create a workspace invitation.\n */\nexport interface CreateWSInvitationRequest {\n  email: string;\n  role: WorkspaceRole;\n  locale?: string; // Optional: language for invitation email (en, fr, de, es)\n}\n/**\n * ListOrgInvitationsRequest is a request to list invitations for an organization.\n */\nexport interface ListOrgInvitationsRequest {\n}\n/**\n * ListWSInvitationsRequest is a request to list invitations for a workspace.\n */\nexport interface ListWSInvitationsRequest {\n}\n/**\n * AcceptInvitationRequest is a request to accept an invitation.\n */\nexport interface AcceptInvitationRequest {\n  token: string;\n  password: string;\n  name: string;\n}\n/**\n * SwitchWorkspaceRequest is a request to switch active workspace.\n */\nexport interface SwitchWorkspaceRequest {\n  ws_id: string;\n}\n/**\n * UpdateWSMembershipSettingsRequest is a request to update user preferences within a workspace.\n */\nexport interface UpdateWSMembershipSettingsRequest {\n  settings: WorkspaceMembershipSettings;\n}\n/**\n * UpdateOrgPreferencesRequest is a request to update organization-wide preferences.\n */\nexport interface UpdateOrgPreferencesRequest {\n  settings?: OrganizationSettings;\n  quotas?: OrganizationQuotas;\n}\n/**\n * GetOrganizationRequest is a request to get organization details.\n */\nexport interface GetOrganizationRequest {\n}\n/**\n * UpdateOrganizationRequest is a request to update organization details.\n */\nexport interface UpdateOrganizationRequest {\n  name?: string;\n}\n/**\n * CreateOrganizationRequest is a request to create a new organization.\n */\nexport interface CreateOrganizationRequest {\n  name: string;\n}\n/**\n * CreateWorkspaceRequest is a request to create a new workspace within an organization.\n */\nexport interface CreateWorkspaceRequest {\n  name: string;\n}\n/**\n * GetWorkspaceRequest is a request to get workspace details.\n */\nexport interface GetWorkspaceRequest {\n}\n/**\n * UpdateWorkspaceRequest is a request to update workspace details.\n */\nexport interface UpdateWorkspaceRequest {\n  name?: string;\n  quotas?: WorkspaceQuotas;\n}\n/**\n * GetGitRemoteRequest is a request to get the git remote for a workspace.\n */\nexport interface GetGitRemoteRequest {\n}\n/**\n * UpdateGitRemoteRequest is a request to set (create or update) the git remote for a workspace.\n */\nexport interface UpdateGitRemoteRequest {\n  url: string;\n  type: string; // github, gitlab, custom\n  auth_type: string; // token, ssh\n  token?: string;\n}\n/**\n * DeleteGitRequest is a request to delete the git remote for a workspace.\n */\nexport interface DeleteGitRequest {\n}\n/**\n * PushGitRequest is a request to push to the git remote.\n */\nexport interface PushGitRequest {\n}\n/**\n * ChangeEmailRequest is a request to change the user's email address.\n */\nexport interface ChangeEmailRequest {\n  new_email: string;\n  password: string; // Required for security verification\n}\n/**\n * SendVerificationEmailRequest is a request to send a verification email.\n */\nexport interface SendVerificationEmailRequest {\n}\n/**\n * VerifyEmailRequest is a request to verify an email via magic link token.\n */\nexport interface VerifyEmailRequest {\n}\n/**\n * LinkOAuthAccountRequest is a request to initiate linking an OAuth provider.\n */\nexport interface LinkOAuthAccountRequest {\n  provider: OAuthProvider;\n}\n/**\n * UnlinkOAuthAccountRequest is a request to unlink an OAuth provider.\n */\nexport interface UnlinkOAuthAccountRequest {\n  provider: OAuthProvider;\n}\n/**\n * SetPasswordRequest is a request to set or change the user's password.\n */\nexport interface SetPasswordRequest {\n  current_password?: string; // Required if user has a password\n  new_password: string;\n}\n/**\n * HealthRequest is a request to check system health.\n */\nexport interface HealthRequest {\n}\n/**\n * ProvidersRequest is a request to list configured OAuth providers.\n */\nexport interface ProvidersRequest {\n}\n/**\n * LogoutRequest is a request to logout (revoke current session).\n */\nexport interface LogoutRequest {\n}\n/**\n * ListSessionsRequest is a request to list user's active sessions.\n */\nexport interface ListSessionsRequest {\n}\n/**\n * RevokeSessionRequest is a request to revoke a specific session.\n */\nexport interface RevokeSessionRequest {\n  session_id: string;\n}\n/**\n * RevokeAllSessionsRequest is a request to revoke all sessions (logout everywhere).\n */\nexport interface RevokeAllSessionsRequest {\n}\n/**\n * ListUsersRequest is a request to list users.\n */\nexport interface ListUsersRequest {\n}\n/**\n * UpdateOrgMemberRoleRequest is a request to update a user's organization role.\n */\nexport interface UpdateOrgMemberRoleRequest {\n  user_id: string;\n  role: OrganizationRole;\n}\n/**\n * UpdateWSMemberRoleRequest is a request to update a user's workspace role.\n */\nexport interface UpdateWSMemberRoleRequest {\n  user_id: string;\n  role: WorkspaceRole;\n}\n/**\n * UpdateUserSettingsRequest is a request to update user global settings.\n */\nexport interface UpdateUserSettingsRequest {\n  settings: UserSettings;\n}\n/**\n * AdminServerDetailRequest is a request to get admin dashboard data.\n */\nexport interface AdminServerDetailRequest {\n}\n/**\n * ServerConfigRequest is a request to get server configuration.\n */\nexport interface ServerConfigRequest {\n}\n/**\n * SMTPConfigUpdate contains SMTP configuration fields for updates.\n */\nexport interface SMTPConfigUpdate {\n  host: string;\n  port: number /* int32 */;\n  username: string;\n  password: string; // Empty preserves existing\n  from: string;\n}\n/**\n * QuotasConfigUpdate contains quota configuration fields for updates.\n */\nexport interface QuotasConfigUpdate extends ResourceQuotas {\n  max_request_body_bytes: number /* int64 */;\n  max_sessions_per_user: number /* int */;\n  max_organizations: number /* int */;\n  max_workspaces: number /* int */;\n  max_users: number /* int */;\n  max_total_storage_bytes: number /* int64 */;\n  max_egress_bandwidth_bps: number /* int64 */;\n}\n/**\n * RateLimitsConfigUpdate contains rate limit configuration fields for updates.\n */\nexport interface RateLimitsConfigUpdate {\n  auth_rate_per_min: number /* int */;\n  write_rate_per_min: number /* int */;\n  read_auth_rate_per_min: number /* int */;\n  read_unauth_rate_per_min: number /* int */;\n}\n/**\n * UpdateServerConfigRequest is a request to update server configuration.\n */\nexport interface UpdateServerConfigRequest {\n  smtp?: SMTPConfigUpdate;\n  quotas?: QuotasConfigUpdate;\n  rate_limits?: RateLimitsConfigUpdate;\n}\n/**\n * NotionImportRequest is a request to start a Notion import into a new workspace.\n */\nexport interface NotionImportRequest {\n  notion_token: string;\n}\n/**\n * NotionImportStatusRequest is a request to get the status of a Notion import.\n */\nexport interface NotionImportStatusRequest {\n}\n/**\n * NotionImportCancelRequest is a request to cancel a running Notion import.\n */\nexport interface NotionImportCancelRequest {\n}\n\n//////////\n// source: response.go\n\n/**\n * OkResponse is a simple success response.\n */\nexport interface OkResponse {\n  ok: boolean;\n}\n/**\n * AuthResponse is a response containing authentication token and user info.\n * Used by login, register, and invitation acceptance endpoints.\n */\nexport interface AuthResponse {\n  token: string;\n  user?: UserResponse;\n}\n/**\n * ProvidersResponse is a response containing the list of configured OAuth providers.\n */\nexport interface ProvidersResponse {\n  providers: OAuthProvider[];\n}\n/**\n * SessionResponse is the API representation of a session.\n */\nexport interface SessionResponse {\n  id: string;\n  device_info: string;\n  ip_address: string;\n  country_code?: string;\n  created: Time;\n  last_used: Time;\n  is_current: boolean;\n}\n/**\n * ListSessionsResponse is a response containing user's sessions.\n */\nexport interface ListSessionsResponse {\n  sessions: SessionResponse[];\n}\n/**\n * LogoutResponse is a response from logout.\n */\nexport type LogoutResponse = OkResponse;\n/**\n * RevokeSessionResponse is a response from revoking a session.\n */\nexport type RevokeSessionResponse = OkResponse;\n/**\n * RevokeAllSessionsResponse is a response from revoking all sessions.\n */\nexport interface RevokeAllSessionsResponse {\n  revoked_count: number /* int */;\n}\n/**\n * UpdateNodeResponse is a response from updating a node.\n */\nexport interface UpdateNodeResponse {\n  id: string;\n}\n/**\n * DeleteNodeResponse is a response from deleting a node.\n */\nexport type DeleteNodeResponse = OkResponse;\n/**\n * ListNodeVersionsResponse is a response containing node version history.\n */\nexport interface ListNodeVersionsResponse {\n  history: (Commit | undefined)[];\n}\n/**\n * GetNodeVersionResponse is a response containing node content at a version.\n */\nexport interface GetNodeVersionResponse {\n  content: string;\n}\n/**\n * ListTablesResponse is a response containing a list of tables.\n */\nexport interface ListTablesResponse {\n  tables: TableSummary[];\n}\n/**\n * TableSummary is a brief representation of a table for list responses.\n */\nexport interface TableSummary {\n  id: string;\n  title: string;\n  created: Time;\n  modified: Time;\n}\n/**\n * GetTableResponse is a response containing a table.\n */\nexport interface GetTableResponse {\n  id: string;\n  title: string;\n  properties: Property[];\n  created: Time;\n  modified: Time;\n}\n/**\n * CreateTableResponse is a response from creating a table.\n */\nexport interface CreateTableResponse {\n  id: string;\n}\n/**\n * UpdateTableResponse is a response from updating a table.\n */\nexport interface UpdateTableResponse {\n  id: string;\n}\n/**\n * DeleteTableResponse is a response from deleting a table.\n */\nexport type DeleteTableResponse = OkResponse;\n/**\n * CreateViewResponse is a response from creating a view.\n */\nexport interface CreateViewResponse {\n  id: string;\n}\n/**\n * UpdateViewResponse is a response from updating a view.\n */\nexport interface UpdateViewResponse {\n  id: string;\n}\n/**\n * DeleteViewResponse is a response from deleting a view.\n */\nexport type DeleteViewResponse = OkResponse;\n/**\n * ListRecordsResponse is a response containing a list of records.\n */\nexport interface ListRecordsResponse {\n  records: DataRecordResponse[];\n}\n/**\n * CreateRecordResponse is a response from creating a record.\n */\nexport interface CreateRecordResponse {\n  id: string;\n}\n/**\n * UpdateRecordResponse is a response from updating a record.\n */\nexport interface UpdateRecordResponse {\n  id: string;\n}\n/**\n * GetRecordResponse is a response containing a record.\n */\nexport interface GetRecordResponse {\n  id: string;\n  data: { [key: string]: any};\n  created: Time;\n  modified: Time;\n}\n/**\n * DeleteRecordResponse is a response from deleting a record.\n */\nexport type DeleteRecordResponse = OkResponse;\n/**\n * ListNodesResponse is a response containing a list of nodes.\n */\nexport interface ListNodesResponse {\n  nodes: NodeResponse[];\n}\n/**\n * MoveNodeResponse is a response from moving a node.\n */\nexport type MoveNodeResponse = OkResponse;\n/**\n * ListNodeAssetsResponse is a response containing a list of assets.\n */\nexport interface ListNodeAssetsResponse {\n  assets: AssetSummary[];\n}\n/**\n * AssetSummary is a brief representation of an asset for list responses.\n */\nexport interface AssetSummary {\n  id: string;\n  name: string;\n  size: number /* int64 */;\n  mime_type: string;\n  created: Time;\n  url: string;\n}\n/**\n * UploadNodeAssetResponse is a response from uploading an asset.\n */\nexport interface UploadNodeAssetResponse {\n  id: string;\n  name: string;\n  size: number /* int64 */;\n  mime_type: string;\n  url: string;\n}\n/**\n * DeleteNodeAssetResponse is a response from deleting an asset.\n */\nexport type DeleteNodeAssetResponse = OkResponse;\n/**\n * ServeAssetResponse wraps the binary asset data.\n */\nexport interface ServeAssetResponse {\n  data: string;\n  mime_type: string;\n}\n/**\n * SearchResponse is the response to a search request.\n */\nexport interface SearchResponse {\n  results: SearchResult[];\n}\n/**\n * ListOrgInvitationsResponse is a response containing a list of organization invitations.\n */\nexport interface ListOrgInvitationsResponse {\n  invitations: OrgInvitationResponse[];\n}\n/**\n * ListWSInvitationsResponse is a response containing a list of workspace invitations.\n */\nexport interface ListWSInvitationsResponse {\n  invitations: WSInvitationResponse[];\n}\n/**\n * SwitchWorkspaceResponse is a response from switching workspace.\n */\nexport interface SwitchWorkspaceResponse {\n  token: string;\n  user?: UserResponse;\n}\n/**\n * ChangeEmailResponse is a response from changing email.\n */\nexport interface ChangeEmailResponse {\n  ok: boolean;\n  email_verified: boolean;\n  message?: string;\n}\n/**\n * SendVerificationEmailResponse is a response from sending a verification email.\n */\nexport interface SendVerificationEmailResponse {\n  ok: boolean;\n  message?: string;\n}\n/**\n * LinkOAuthAccountResponse is a response from initiating OAuth linking.\n */\nexport interface LinkOAuthAccountResponse {\n  redirect_url: string;\n}\n/**\n * UnlinkOAuthAccountResponse is a response from unlinking an OAuth provider.\n */\nexport type UnlinkOAuthAccountResponse = OkResponse;\n/**\n * HealthResponse is a response from a health check.\n */\nexport interface HealthResponse {\n  status: string;\n  version: string;\n  go_version: string;\n  revision: string;\n  dirty: boolean;\n}\n/**\n * ListUsersResponse is a response containing a list of users.\n */\nexport interface ListUsersResponse {\n  users: UserResponse[];\n}\n/**\n * UserResponse is the API representation of a user.\n */\nexport interface UserResponse {\n  id: string;\n  email: string;\n  email_verified?: boolean;\n  name: string;\n  is_global_admin?: boolean;\n  has_password?: boolean;\n  oauth_identities?: OAuthIdentity[];\n  settings: UserSettings;\n  created: Time;\n  modified: Time;\n  /**\n   * Current context\n   */\n  organization_id?: string;\n  org_role?: OrganizationRole;\n  workspace_id?: string;\n  workspace_name?: string;\n  workspace_role?: WorkspaceRole;\n  /**\n   * All memberships\n   */\n  organizations?: OrgMembershipResponse[];\n  workspaces?: WSMembershipResponse[];\n}\n/**\n * OrgMembershipResponse is the API representation of an organization membership.\n */\nexport interface OrgMembershipResponse {\n  id: string;\n  user_id: string;\n  organization_id: string;\n  organization_name?: string;\n  role: OrganizationRole;\n  created: Time;\n}\n/**\n * WSMembershipResponse is the API representation of a workspace membership.\n */\nexport interface WSMembershipResponse {\n  id: string;\n  user_id: string;\n  workspace_id: string;\n  workspace_name?: string;\n  organization_id: string;\n  role: WorkspaceRole;\n  settings: WorkspaceMembershipSettings;\n  created: Time;\n}\n/**\n * OrgInvitationResponse is the API representation of an organization invitation (excludes Token).\n */\nexport interface OrgInvitationResponse {\n  id: string;\n  email: string;\n  organization_id: string;\n  role: OrganizationRole;\n  invited_by: string;\n  expires_at: Time;\n  created: Time;\n}\n/**\n * WSInvitationResponse is the API representation of a workspace invitation (excludes Token).\n */\nexport interface WSInvitationResponse {\n  id: string;\n  email: string;\n  workspace_id: string;\n  role: WorkspaceRole;\n  invited_by: string;\n  expires_at: Time;\n  created: Time;\n}\n/**\n * OrganizationResponse is the API representation of an organization.\n */\nexport interface OrganizationResponse {\n  id: string;\n  name: string;\n  billing_email?: string;\n  quotas: OrganizationQuotas;\n  settings: OrganizationSettings;\n  member_count: number /* int */;\n  workspace_count: number /* int */;\n  created: Time;\n}\n/**\n * WorkspaceResponse is the API representation of a workspace.\n */\nexport interface WorkspaceResponse {\n  id: string;\n  organization_id: string;\n  name: string;\n  quotas: WorkspaceQuotas;\n  settings: WorkspaceSettings;\n  git_remote?: GitRemoteResponse;\n  member_count: number /* int */;\n  created: Time;\n}\n/**\n * GitRemoteResponse is the API representation of a git remote.\n */\nexport interface GitRemoteResponse {\n  workspace_id: string;\n  url: string;\n  type: string;\n  auth_type: string;\n  created: Time;\n  last_sync?: Time;\n}\n/**\n * NodeResponse is the API representation of a node.\n */\nexport interface NodeResponse {\n  id: string;\n  parent_id?: string;\n  title: string;\n  content?: string;\n  properties?: Property[];\n  views?: View[];\n  created: Time;\n  modified: Time;\n  tags?: string[];\n  favicon_url?: string;\n  has_page: boolean;\n  has_table: boolean;\n  has_children?: boolean;\n  children?: NodeResponse[];\n  asset_urls?: { [key: string]: string};\n  backlinks?: BacklinkInfo[];\n}\n/**\n * GetPageResponse is a response containing page content.\n */\nexport interface GetPageResponse {\n  id: string;\n  title: string;\n  content: string;\n  created: Time;\n  modified: Time;\n}\n/**\n * CreatePageResponse is a response from creating a page.\n */\nexport interface CreatePageResponse {\n  id: string;\n}\n/**\n * UpdatePageResponse is a response from updating a page.\n */\nexport interface UpdatePageResponse {\n  id: string;\n}\n/**\n * DeletePageResponse is a response from deleting a page.\n */\nexport type DeletePageResponse = OkResponse;\n/**\n * GetTableSchemaResponse is a response containing table schema.\n */\nexport interface GetTableSchemaResponse {\n  id: string;\n  title: string;\n  properties: Property[];\n  views?: View[];\n  created: Time;\n  modified: Time;\n}\n/**\n * CreateTableUnderParentResponse is a response from creating a table under a parent.\n */\nexport interface CreateTableUnderParentResponse {\n  id: string;\n}\n/**\n * ListNodeChildrenResponse is a response containing children of a node.\n */\nexport interface ListNodeChildrenResponse {\n  nodes: NodeResponse[];\n}\n/**\n * GetNodeTitlesResponse is a response containing a map of node IDs to titles.\n */\nexport interface GetNodeTitlesResponse {\n  titles: { [key: string]: string};\n}\n/**\n * BacklinkInfo represents a page that links to this page.\n */\nexport interface BacklinkInfo {\n  node_id: string;\n  title: string;\n}\n/**\n * DataRecordResponse is the API representation of a data record.\n */\nexport interface DataRecordResponse {\n  id: string;\n  data: { [key: string]: any};\n  created: Time;\n  modified: Time;\n}\n/**\n * AdminServerDetail contains server-wide dashboard data.\n */\nexport interface AdminServerDetail {\n  user_count: number /* int */;\n  org_count: number /* int */;\n  workspace_count: number /* int */;\n  total_storage: number /* int64 */;\n  active_sessions: number /* int */;\n  organizations: AdminOrgDetail[];\n  request_metrics: AdminRequestMetrics;\n}\n/**\n * AdminOrgDetail contains organization details for the admin dashboard.\n */\nexport interface AdminOrgDetail {\n  id: string;\n  name: string;\n  member_count: number /* int */;\n  workspace_count: number /* int */;\n  created: Time;\n  workspaces: AdminWorkspaceDetail[];\n}\n/**\n * AdminWorkspaceDetail contains workspace details for the admin dashboard.\n */\nexport interface AdminWorkspaceDetail {\n  id: string;\n  org_id: string;\n  name: string;\n  member_count: number /* int */;\n  page_count: number /* int */;\n  storage_bytes: number /* int64 */;\n  git_commits: number /* int */;\n  created: Time;\n}\n/**\n * AdminRequestMetrics contains request throughput metrics.\n */\nexport interface AdminRequestMetrics {\n  server_start_time: number /* float64 */;\n  uptime_seconds: number /* float64 */;\n  auth_count: number /* int64 */;\n  write_count: number /* int64 */;\n  read_auth_count: number /* int64 */;\n  read_unauth_count: number /* int64 */;\n}\n/**\n * ListWorkspacesResponse is a response containing a list of workspaces.\n */\nexport interface ListWorkspacesResponse {\n  workspaces: WorkspaceResponse[];\n}\n/**\n * NotionImportResponse is a response from starting a Notion import.\n */\nexport interface NotionImportResponse {\n  workspace_id: string;\n  workspace_name: string;\n  status: string;\n}\n/**\n * NotionImportStatusResponse is a response containing import status.\n */\nexport interface NotionImportStatusResponse {\n  status: string;\n  progress: number /* int */;\n  total: number /* int */;\n  message?: string;\n  pages?: number /* int */;\n  databases?: number /* int */;\n  records?: number /* int */;\n  assets?: number /* int */;\n  errors?: number /* int */;\n  duration_ms?: number /* int64 */;\n}\n/**\n * NotionImportCancelResponse is a response from cancelling a Notion import.\n */\nexport type NotionImportCancelResponse = OkResponse;\n/**\n * SMTPConfigResponse contains SMTP configuration for the response (password masked).\n */\nexport interface SMTPConfigResponse {\n  host: string;\n  port: number /* int32 */;\n  username: string;\n  from: string;\n}\n/**\n * QuotasConfigResponse contains quota configuration for the response.\n */\nexport interface QuotasConfigResponse extends ResourceQuotas {\n  max_request_body_bytes: number /* int64 */;\n  max_sessions_per_user: number /* int */;\n  max_organizations: number /* int */;\n  max_workspaces: number /* int */;\n  max_users: number /* int */;\n  max_total_storage_bytes: number /* int64 */;\n  max_egress_bandwidth_bps: number /* int64 */;\n}\n/**\n * RateLimitsConfigResponse contains rate limit configuration for the response.\n */\nexport interface RateLimitsConfigResponse {\n  auth_rate_per_min: number /* int */;\n  write_rate_per_min: number /* int */;\n  read_auth_rate_per_min: number /* int */;\n  read_unauth_rate_per_min: number /* int */;\n}\n/**\n * ServerConfigResponse is a response containing server configuration.\n */\nexport interface ServerConfigResponse {\n  smtp: SMTPConfigResponse;\n  quotas: QuotasConfigResponse;\n  rate_limits: RateLimitsConfigResponse;\n}\n/**\n * UpdateServerConfigResponse is a response from updating server configuration.\n */\nexport type UpdateServerConfigResponse = OkResponse;\n\n//////////\n// source: types.go\n\n/**\n * Time is a type alias for storage.Time to ensure it generates as 'number' in TypeScript.\n */\nexport type Time = number;\n/**\n * PropertyType represents the type of a table property.\n */\n/**\n * PropertyTypeText stores plain text values.\n */\nexport const PropertyTypeText = \"text\";\n/**\n * PropertyTypeNumber stores numeric values (integer or float).\n */\nexport const PropertyTypeNumber = \"number\";\n/**\n * PropertyTypeCheckbox stores boolean values.\n */\nexport const PropertyTypeCheckbox = \"checkbox\";\n/**\n * PropertyTypeDate stores ISO8601 date strings.\n */\nexport const PropertyTypeDate = \"date\";\n/**\n * PropertyTypeSelect stores a single selection from predefined options.\n */\nexport const PropertyTypeSelect = \"select\";\n/**\n * PropertyTypeMultiSelect stores multiple selections from predefined options.\n */\nexport const PropertyTypeMultiSelect = \"multi_select\";\n/**\n * PropertyTypeURL stores URLs with validation.\n */\nexport const PropertyTypeURL = \"url\";\n/**\n * PropertyTypeEmail stores email addresses with validation.\n */\nexport const PropertyTypeEmail = \"email\";\n/**\n * PropertyTypePhone stores phone numbers with validation.\n */\nexport const PropertyTypePhone = \"phone\";\nexport type PropertyType = typeof PropertyTypeText | typeof PropertyTypeNumber | typeof PropertyTypeCheckbox | typeof PropertyTypeDate | typeof PropertyTypeSelect | typeof PropertyTypeMultiSelect | typeof PropertyTypeURL | typeof PropertyTypeEmail | typeof PropertyTypePhone;\n/**\n * SelectOption represents an option for select/multi_select properties.\n */\nexport interface SelectOption {\n  id: string;\n  name: string;\n  color?: string;\n}\n/**\n * Property represents a table column with its configuration.\n */\nexport interface Property {\n  name: string;\n  type: PropertyType;\n  required?: boolean;\n  /**\n   * Options contains the allowed values for select and multi_select properties.\n   * Each option has an ID (used in storage), name (display), and optional color.\n   */\n  options?: SelectOption[];\n}\n/**\n * OrganizationRole defines the role of a user within an organization.\n */\nexport type OrganizationRole = string;\n/**\n * OrgRoleOwner has full control including billing.\n */\nexport const OrgRoleOwner: OrganizationRole = \"org:owner\";\n/**\n * OrgRoleAdmin can manage workspaces and members.\n */\nexport const OrgRoleAdmin: OrganizationRole = \"org:admin\";\n/**\n * OrgRoleMember can only access granted workspaces.\n */\nexport const OrgRoleMember: OrganizationRole = \"org:member\";\n/**\n * WorkspaceRole defines the permissions for a user within a workspace.\n */\nexport type WorkspaceRole = string;\n/**\n * WSRoleAdmin has full workspace control.\n */\nexport const WSRoleAdmin: WorkspaceRole = \"ws:admin\";\n/**\n * WSRoleEditor can create and modify content.\n */\nexport const WSRoleEditor: WorkspaceRole = \"ws:editor\";\n/**\n * WSRoleViewer can only read content.\n */\nexport const WSRoleViewer: WorkspaceRole = \"ws:viewer\";\n/**\n * UserSettings represents global user preferences.\n */\nexport interface UserSettings {\n  theme: string;\n  language: string;\n  last_active_workspaces?: string[];\n}\n/**\n * OAuthProvider represents a supported OAuth2 provider.\n */\n/**\n * OAuthProviderGoogle represents Google OAuth.\n */\nexport const OAuthProviderGoogle = \"google\";\n/**\n * OAuthProviderMicrosoft represents Microsoft OAuth.\n */\nexport const OAuthProviderMicrosoft = \"microsoft\";\n/**\n * OAuthProviderGitHub represents GitHub OAuth.\n */\nexport const OAuthProviderGitHub = \"github\";\nexport type OAuthProvider = typeof OAuthProviderGoogle | typeof OAuthProviderMicrosoft | typeof OAuthProviderGitHub;\n/**\n * OAuthIdentity represents a link between a local user and an OAuth2 provider.\n */\nexport interface OAuthIdentity {\n  provider: OAuthProvider;\n  provider_id: string;\n  email: string;\n  avatar_url?: string;\n  last_login: Time;\n}\n/**\n * WorkspaceMembershipSettings represents user preferences within a specific workspace.\n */\nexport interface WorkspaceMembershipSettings {\n  notifications: boolean;\n}\n/**\n * ResourceQuotas defines per-workspace content limits shared by server, org, and workspace layers.\n * A zero value means \"no limit at this layer\" (inherit from other layers).\n */\nexport interface ResourceQuotas {\n  max_pages: number /* int */;\n  max_storage_bytes: number /* int64 */;\n  max_records_per_table: number /* int */;\n  max_asset_size_bytes: number /* int64 */;\n  max_tables_per_workspace: number /* int */;\n  max_columns_per_table: number /* int */;\n}\n/**\n * OrganizationQuotas defines limits for an organization.\n */\nexport interface OrganizationQuotas extends ResourceQuotas {\n  max_workspaces_per_org: number /* int */;\n  max_members_per_org: number /* int */;\n  max_members_per_workspace: number /* int */;\n  max_total_storage_bytes: number /* int64 */;\n}\n/**\n * WorkspaceQuotas is a type alias for ResourceQuotas.\n * Zero values mean \"inherit from server/org layer\".\n */\nexport type WorkspaceQuotas = ResourceQuotas;\n/**\n * UserQuota defines limits for a user.\n */\nexport interface UserQuota {\n  max_organizations: number /* int */;\n}\n/**\n * OrganizationSettings represents organization-wide settings.\n */\nexport interface OrganizationSettings {\n  default_workspace_quotas: WorkspaceQuotas;\n}\n/**\n * WorkspaceSettings represents workspace-wide settings.\n */\nexport interface WorkspaceSettings {\n  allowed_domains?: string[];\n  public_access: boolean;\n  git_auto_push: boolean;\n}\n/**\n * Commit represents a commit in git history.\n */\nexport interface Commit {\n  hash: string;\n  message: string;\n  author_name: string;\n  author_email: string;\n  timestamp: Time;\n}\n/**\n * SearchResult represents a single search result.\n */\nexport interface SearchResult {\n  type: string; // \"page\" or \"record\"\n  node_id: string;\n  record_id?: string;\n  title: string;\n  snippet: string;\n  score: number /* float64 */;\n  matches: { [key: string]: string};\n  modified: Time;\n}\n/**\n * View represents a saved table view configuration.\n */\nexport interface View {\n  id: string;\n  name: string;\n  type: ViewType;\n  default?: boolean;\n  columns?: ViewColumn[];\n  filters?: Filter[];\n  sorts?: Sort[];\n  groups?: Group[];\n}\n/**\n * ViewType defines the layout type for a view.\n */\n/**\n * ViewTypeTable displays records in a spreadsheet-like table.\n */\nexport const ViewTypeTable = \"table\";\n/**\n * ViewTypeBoard displays records in a kanban board grouped by a property.\n */\nexport const ViewTypeBoard = \"board\";\n/**\n * ViewTypeGallery displays records as cards in a grid.\n */\nexport const ViewTypeGallery = \"gallery\";\n/**\n * ViewTypeList displays records in a simple list.\n */\nexport const ViewTypeList = \"list\";\n/**\n * ViewTypeCalendar displays records on a calendar by date property.\n */\nexport const ViewTypeCalendar = \"calendar\";\nexport type ViewType = typeof ViewTypeTable | typeof ViewTypeBoard | typeof ViewTypeGallery | typeof ViewTypeList | typeof ViewTypeCalendar;\n/**\n * ViewColumn defines the visibility and width of a property column.\n */\nexport interface ViewColumn {\n  property: string;\n  width?: number /* int */;\n  visible: boolean;\n}\n/**\n * Filter defines a condition for filtering records.\n */\nexport interface Filter {\n  property?: string;\n  operator?: FilterOp;\n  value?: any;\n  and?: Filter[];\n  or?: Filter[];\n}\n/**\n * FilterOp defines the comparison operator for a filter.\n */\n/**\n * FilterOpEquals matches if value equals the filter value.\n */\nexport const FilterOpEquals = \"equals\";\n/**\n * FilterOpNotEquals matches if value does not equal the filter value.\n */\nexport const FilterOpNotEquals = \"not_equals\";\n/**\n * FilterOpContains matches if value contains the filter value (text).\n */\nexport const FilterOpContains = \"contains\";\n/**\n * FilterOpNotContains matches if value does not contain the filter value.\n */\nexport const FilterOpNotContains = \"not_contains\";\n/**\n * FilterOpStartsWith matches if value starts with the filter value.\n */\nexport const FilterOpStartsWith = \"starts_with\";\n/**\n * FilterOpEndsWith matches if value ends with the filter value.\n */\nexport const FilterOpEndsWith = \"ends_with\";\n/**\n * FilterOpGreaterThan matches if value is greater than the filter value.\n */\nexport const FilterOpGreaterThan = \"gt\";\n/**\n * FilterOpLessThan matches if value is less than the filter value.\n */\nexport const FilterOpLessThan = \"lt\";\n/**\n * FilterOpGreaterEqual matches if value is greater than or equal to the filter value.\n */\nexport const FilterOpGreaterEqual = \"gte\";\n/**\n * FilterOpLessEqual matches if value is less than or equal to the filter value.\n */\nexport const FilterOpLessEqual = \"lte\";\n/**\n * FilterOpIsEmpty matches if value is empty/null.\n */\nexport const FilterOpIsEmpty = \"is_empty\";\n/**\n * FilterOpIsNotEmpty matches if value is not empty/null.\n */\nexport const FilterOpIsNotEmpty = \"is_not_empty\";\nexport type FilterOp = typeof FilterOpEquals | typeof FilterOpNotEquals | typeof FilterOpContains | typeof FilterOpNotContains | typeof FilterOpStartsWith | typeof FilterOpEndsWith | typeof FilterOpGreaterThan | typeof FilterOpLessThan | typeof FilterOpGreaterEqual | typeof FilterOpLessEqual | typeof FilterOpIsEmpty | typeof FilterOpIsNotEmpty;\n/**\n * Sort defines the sort order for a property.\n */\nexport interface Sort {\n  property: string;\n  direction: SortDir;\n}\n/**\n * SortDir defines the sort direction.\n */\nexport type SortDir = string;\n/**\n * SortAsc sorts in ascending order (A-Z, 0-9, oldest-newest).\n */\nexport const SortAsc: SortDir = \"asc\";\n/**\n * SortDesc sorts in descending order (Z-A, 9-0, newest-oldest).\n */\nexport const SortDesc: SortDir = \"desc\";\n/**\n * Group defines how to group records by a property.\n */\nexport interface Group {\n  property: string;\n  hidden?: any[];\n}\n","// URL construction utilities for consistent routing.\n\n/**\n * Strips the slug suffix from an ID parameter (e.g., \"abc123+my-page\" -> \"abc123\").\n * Use this when extracting IDs from route params that may include slugs.\n */\nexport function stripSlug(idWithSlug: string): string {\n  let s = idWithSlug;\n  if (s.startsWith('@')) s = s.substring(1);\n  const plusIndex = s.indexOf('+');\n  return plusIndex >= 0 ? s.substring(0, plusIndex) : s;\n}\n\n/**\n * Converts text to a URL-friendly slug.\n */\nexport function slugify(text: string): string {\n  return text\n    .toString()\n    .toLowerCase()\n    .trim()\n    .replace(/\\s+/g, '-')\n    .replace(/[^\\w-]+/g, '')\n    .replace(/--+/g, '-');\n}\n\n/**\n * Builds a workspace root URL.\n */\nexport function workspaceUrl(wsId: string, wsName?: string): string {\n  const wsSlug = slugify(wsName || 'workspace');\n  return `/w/@${wsId}+${wsSlug}/`;\n}\n\n/**\n * Builds a node (page/table) URL within a workspace.\n */\nexport function nodeUrl(wsId: string, wsName: string | undefined, nodeId: string, nodeTitle?: string): string {\n  const wsSlug = slugify(wsName || 'workspace');\n  const nodeSlug = nodeTitle ? slugify(nodeTitle) : '';\n  return `/w/@${wsId}+${wsSlug}/@${nodeId}${nodeSlug ? '+' + nodeSlug : ''}`;\n}\n\n/**\n * Builds a workspace settings URL.\n */\nexport function workspaceSettingsUrl(wsId: string, wsName?: string): string {\n  const wsSlug = slugify(wsName || 'workspace');\n  return `/w/@${wsId}+${wsSlug}/settings`;\n}\n\n/**\n * Builds an organization settings URL.\n */\nexport function orgSettingsUrl(orgId: string, orgName?: string): string {\n  const orgSlug = slugify(orgName || 'organization');\n  return `/o/@${orgId}+${orgSlug}/settings`;\n}\n\n/** URL pattern matchers */\n\nexport interface WorkspaceMatch {\n  wsId: string;\n}\n\nexport interface NodeMatch {\n  wsId: string;\n  nodeId: string;\n}\n\nexport interface SettingsMatch {\n  id: string;\n}\n\n/**\n * Parses workspace root URL. Returns null if no match.\n */\nexport function parseWorkspaceRoot(path: string): WorkspaceMatch | null {\n  const match = path.match(/^\\/w\\/@([^+/]+)(?:\\+[^/]*)?\\/?$/);\n  if (match && match[1]) {\n    return { wsId: match[1] };\n  }\n  return null;\n}\n\n/**\n * Parses workspace node URL. Returns null if no match.\n */\nexport function parseNodeUrl(path: string): NodeMatch | null {\n  const match = path.match(/^\\/w\\/@([^+/]+)(?:\\+[^/]*)?\\/@([a-zA-Z0-9_-]+)(?:\\+.*)?$/);\n  if (match && match[1] && match[2]) {\n    return { wsId: match[1], nodeId: match[2] };\n  }\n  return null;\n}\n\n/**\n * Parses workspace settings URL. Returns null if no match.\n */\nexport function parseWorkspaceSettings(path: string): SettingsMatch | null {\n  const match = path.match(/^\\/w\\/@([^+/]+)(?:\\+[^/]*)?\\/settings\\/?$/);\n  if (match && match[1]) {\n    return { id: match[1] };\n  }\n  return null;\n}\n\n/**\n * Parses organization settings URL. Returns null if no match.\n */\nexport function parseOrgSettings(path: string): SettingsMatch | null {\n  const match = path.match(/^\\/o\\/@([^+/]+)(?:\\+[^/]*)?\\/settings\\/?$/);\n  if (match && match[1]) {\n    return { id: match[1] };\n  }\n  return null;\n}\n\n/**\n * Checks if path is a static route.\n */\nexport function isStaticRoute(path: string): 'privacy' | 'terms' | 'profile' | 'settings' | null {\n  if (path === '/privacy') return 'privacy';\n  if (path === '/terms') return 'terms';\n  if (path === '/profile') return 'profile';\n  if (path.startsWith('/settings')) return 'settings';\n  return null;\n}\n\n/** Unified Settings URL types */\n\nexport interface UnifiedSettingsMatch {\n  type: 'profile' | 'workspace' | 'org' | 'server' | 'redirect';\n  id?: string;\n  section?: string;\n}\n\n/**\n * Builds a unified settings URL.\n */\nexport function settingsUrl(type?: 'user' | 'workspace' | 'org' | 'server', id?: string, name?: string): string {\n  if (!type || type === 'user') return '/settings/user';\n  if (type === 'server') return '/settings/server';\n  const slug = slugify(name || type);\n  return `/settings/${type}/@${id}+${slug}`;\n}\n","// Workspace context providing node tree, navigation, and workspace switching.\n\nimport {\n  createContext,\n  useContext,\n  createSignal,\n  createEffect,\n  createMemo,\n  batch,\n  type ParentComponent,\n  type Accessor,\n} from 'solid-js';\nimport { createStore, produce, reconcile } from 'solid-js/store';\nimport { useNavigate } from '@solidjs/router';\nimport { useAuth } from './AuthContext';\nimport { useI18n } from '../i18n';\nimport { OrgRoleAdmin, OrgRoleOwner, WSRoleAdmin, WSRoleEditor, type NodeResponse } from '@sdk/types.gen';\nimport { workspaceUrl } from '../utils/urls';\n\ninterface WorkspaceContextValue {\n  // Node tree\n  nodes: NodeResponse[];\n  setNodes: (fn: (nodes: NodeResponse[]) => void) => void;\n\n  // Selected node\n  selectedNodeId: Accessor<string | null>;\n  setSelectedNodeId: (id: string | null) => void;\n  selectedNodeData: Accessor<NodeResponse | null>;\n  setSelectedNodeData: (node: NodeResponse | null) => void;\n\n  // Breadcrumbs\n  breadcrumbPath: Accessor<NodeResponse[]>;\n  setBreadcrumbPath: (path: NodeResponse[] | ((prev: NodeResponse[]) => NodeResponse[])) => void;\n\n  // Operation-specific loading states\n  loadingNodes: Accessor<boolean>;\n  loadingNodeId: Accessor<string | null>; // ID of node being loaded\n  switchingWorkspace: Accessor<boolean>;\n  savingNodeId: Accessor<string | null>; // ID of node being saved (for column updates, etc.)\n  setSavingNodeId: (id: string | null) => void;\n  deletingNodeId: Accessor<string | null>; // ID of node being deleted\n  setDeletingNodeId: (id: string | null) => void;\n  creatingNode: Accessor<boolean>;\n  setCreatingNode: (creating: boolean) => void;\n\n  // Operation-specific error states\n  loadError: Accessor<string | null>;\n  setLoadError: (error: string | null) => void;\n  saveError: Accessor<string | null>;\n  setSaveError: (error: string | null) => void;\n\n  // Combined loading (any operation in progress) - for backward compatibility\n  loading: Accessor<boolean>;\n\n  // First login state\n  firstLoginCheckDone: Accessor<boolean>;\n  setFirstLoginCheckDone: (done: boolean) => void;\n\n  // Operations\n  switchWorkspace: (wsId: string) => Promise<void>;\n  createOrganization: (data: { name: string }) => Promise<void>;\n  createWorkspace: (data: { name: string }) => Promise<void>;\n  loadNodes: (force?: boolean) => Promise<void>;\n  loadNode: (id: string) => Promise<NodeResponse | undefined>;\n  fetchNodeChildren: (nodeId: string) => Promise<void>;\n  removeNode: (nodeId: string) => void;\n  updateNodeTitle: (nodeId: string, newTitle: string) => void;\n  moveNode: (nodeId: string, newParentId: string) => Promise<void>;\n\n  // Clear errors\n  clearErrors: () => void;\n}\n\nconst WorkspaceContext = createContext<WorkspaceContextValue>();\n\nexport const WorkspaceProvider: ParentComponent = (props) => {\n  const { t, ready: i18nReady } = useI18n();\n  const navigate = useNavigate();\n  const { user, setUser, api, wsApi, login } = useAuth();\n\n  // Node state\n  const [nodes, setNodesStore] = createStore<NodeResponse[]>([]);\n  const [selectedNodeId, setSelectedNodeId] = createSignal<string | null>(null);\n  const [selectedNodeData, setSelectedNodeData] = createSignal<NodeResponse | null>(null);\n  const [breadcrumbPath, setBreadcrumbPath] = createSignal<NodeResponse[]>([]);\n\n  // Operation-specific loading states\n  const [loadingNodes, setLoadingNodes] = createSignal(false);\n  const [loadingNodeId, setLoadingNodeId] = createSignal<string | null>(null);\n  const [switchingWorkspace, setSwitchingWorkspace] = createSignal(false);\n  const [savingNodeId, setSavingNodeId] = createSignal<string | null>(null);\n  const [deletingNodeId, setDeletingNodeId] = createSignal<string | null>(null);\n  const [creatingNode, setCreatingNode] = createSignal(false);\n\n  // Operation-specific error states\n  const [loadError, setLoadError] = createSignal<string | null>(null);\n  const [saveError, setSaveError] = createSignal<string | null>(null);\n\n  // Combined loading (any operation in progress) - derived for backward compatibility\n  const loading = createMemo(\n    () =>\n      loadingNodes() ||\n      loadingNodeId() !== null ||\n      switchingWorkspace() ||\n      savingNodeId() !== null ||\n      deletingNodeId() !== null ||\n      creatingNode()\n  );\n\n  // First login state\n  const [firstLoginCheckDone, setFirstLoginCheckDone] = createSignal(false);\n  const [firstLoginInProgress, setFirstLoginInProgress] = createSignal(false);\n\n  // Track loaded state to prevent duplicate calls\n  const [loadedForWorkspace, setLoadedForWorkspace] = createSignal<string | null>(null);\n  const [loadedNodeId, setLoadedNodeId] = createSignal<string | null>(null);\n\n  // Clear all errors\n  const clearErrors = () => {\n    setLoadError(null);\n    setSaveError(null);\n  };\n\n  // Wrapper for setNodes using produce\n  const setNodes = (fn: (nodes: NodeResponse[]) => void) => {\n    setNodesStore(produce(fn));\n  };\n\n  // Helper to update node title in local state (sidebar and breadcrumbs)\n  const updateNodeTitle = (nodeId: string, newTitle: string) => {\n    setNodesStore(\n      produce((list) => {\n        const update = (nodeList: NodeResponse[]): boolean => {\n          for (const node of nodeList) {\n            if (node.id === nodeId) {\n              node.title = newTitle;\n              return true;\n            }\n            if (node.children) {\n              if (update(node.children)) return true;\n            }\n          }\n          return false;\n        };\n        update(list);\n      })\n    );\n    setBreadcrumbPath((path) => path.map((node) => (node.id === nodeId ? { ...node, title: newTitle } : node)));\n  };\n\n  // Remove a node from the store (used after deletion)\n  const removeNode = (nodeId: string) => {\n    setNodesStore(\n      produce((list) => {\n        const removeFromList = (nodeList: NodeResponse[]): boolean => {\n          const index = nodeList.findIndex((n) => n.id === nodeId);\n          if (index !== -1) {\n            nodeList.splice(index, 1);\n            return true;\n          }\n          for (const node of nodeList) {\n            if (node.children && removeFromList(node.children)) {\n              // Update has_children if parent now has no children\n              if (node.children.length === 0) {\n                node.has_children = false;\n              }\n              return true;\n            }\n          }\n          return false;\n        };\n        removeFromList(list);\n      })\n    );\n  };\n\n  // Get user's first name for default naming\n  function getUserFirstName(): string {\n    const u = user();\n    if (!u?.name) return '';\n    const firstName = u.name.split(' ')[0];\n    return firstName || u.name;\n  }\n\n  async function createOrganization(data: { name: string }) {\n    await api().organizations.createOrganization({ name: data.name });\n    const updatedUser = await api().auth.getMe();\n    setUser(updatedUser);\n  }\n\n  async function createWorkspace(data: { name: string }) {\n    const u = user();\n    if (!u || !u.organization_id) {\n      throw new Error('No organization selected');\n    }\n    const ws = await api().org(u.organization_id).workspaces.createWorkspace({ name: data.name });\n    const updatedUser = await api().auth.getMe();\n    setUser(updatedUser);\n    await switchWorkspace(ws.id);\n  }\n\n  // Auto-create organization for first-time users\n  async function autoCreateOrganization() {\n    try {\n      setCreatingNode(true);\n      const firstName = getUserFirstName();\n      const orgName = firstName\n        ? t('onboarding.defaultOrgName', { name: firstName })\n        : t('onboarding.defaultOrgNameFallback');\n      await createOrganization({ name: orgName as string });\n    } catch (err) {\n      setSaveError(`${t('errors.failedToCreate')}: ${err}`);\n    } finally {\n      setCreatingNode(false);\n    }\n  }\n\n  // Auto-create workspace for users with org but no workspace\n  async function autoCreateWorkspace() {\n    try {\n      setCreatingNode(true);\n      const firstName = getUserFirstName();\n      const wsName = firstName\n        ? t('onboarding.defaultWorkspaceName', { name: firstName })\n        : t('onboarding.defaultWorkspaceNameFallback');\n      await createWorkspace({ name: wsName as string });\n    } catch (err) {\n      setSaveError(`${t('errors.failedToCreate')}: ${err}`);\n    } finally {\n      setCreatingNode(false);\n    }\n  }\n\n  // Auto-create welcome page if no root page exists\n  async function createWelcomePageIfNeeded(): Promise<string | null> {\n    const ws = wsApi();\n    const u = user();\n    if (!ws || !u) return null;\n    if (u.workspace_role !== WSRoleAdmin && u.workspace_role !== WSRoleEditor) {\n      return null;\n    }\n    try {\n      const newPage = await ws.nodes.page.createPage('0', {\n        title: t('welcome.welcomePageTitle'),\n        content: t('welcome.welcomePageContent'),\n      });\n      return newPage?.id ? String(newPage.id) : null;\n    } catch (err) {\n      setSaveError(`${t('errors.failedToCreate')}: ${err}`);\n      return null;\n    }\n  }\n\n  async function switchWorkspace(wsId: string) {\n    try {\n      setSwitchingWorkspace(true);\n      const data = await api().auth.switchWorkspace({ ws_id: wsId });\n      if (!data.user) {\n        throw new Error('No user data returned');\n      }\n      login(data.token, data.user);\n      batch(() => {\n        setSelectedNodeId(null);\n        setSelectedNodeData(null);\n        setBreadcrumbPath([]);\n      });\n      setLoadedNodeId(null);\n      setLoadedForWorkspace(null);\n      await loadNodes();\n      // Navigate to the new workspace root to clear any stale node ID from the URL.\n      const u = user();\n      if (u?.workspace_id) {\n        navigate(workspaceUrl(u.workspace_id, u.workspace_name));\n      }\n    } catch (err) {\n      setLoadError(`${t('errors.failedToSwitch')}: ${err}`);\n    } finally {\n      setSwitchingWorkspace(false);\n    }\n  }\n\n  async function loadNodes(force = false) {\n    const ws = wsApi();\n    const wsId = user()?.workspace_id;\n    if (!ws || loadingNodes()) return;\n    if (!force && wsId && loadedForWorkspace() === wsId && nodes.length > 0) return;\n\n    try {\n      setLoadingNodes(true);\n      const resp = await ws.nodes.listNodeChildren('0');\n      let loadedNodes = resp?.nodes || [];\n\n      if (loadedNodes.length === 0 && firstLoginCheckDone()) {\n        const newPageId = await createWelcomePageIfNeeded();\n        if (newPageId) {\n          const resp2 = await ws.nodes.listNodeChildren('0');\n          loadedNodes = resp2?.nodes || [];\n        }\n      }\n\n      setNodesStore(reconcile(loadedNodes));\n      setLoadedForWorkspace(wsId || null);\n      setLoadError(null);\n      // Navigation to first node is handled by WorkspaceRoot component\n    } catch (err) {\n      setLoadError(`${t('errors.failedToLoad')}: ${err}`);\n    } finally {\n      setLoadingNodes(false);\n    }\n  }\n\n  async function loadNode(id: string): Promise<NodeResponse | undefined> {\n    const ws = wsApi();\n    if (!ws) return undefined;\n    if (loadingNodeId() === id || loadedNodeId() === id) return undefined;\n\n    try {\n      setLoadingNodeId(id);\n      const nodeData = await ws.nodes.getNode(id);\n\n      batch(() => {\n        setSelectedNodeId(nodeData.id);\n        setSelectedNodeData(nodeData);\n      });\n      setLoadedNodeId(nodeData.id);\n      setLoadError(null);\n\n      // Build breadcrumb path\n      const path: NodeResponse[] = [nodeData];\n      let currentNode = nodeData;\n      while (currentNode.parent_id && currentNode.parent_id !== '0') {\n        try {\n          const parentNode = await ws.nodes.getNode(currentNode.parent_id);\n          path.unshift(parentNode);\n          currentNode = parentNode;\n        } catch {\n          break;\n        }\n      }\n      setBreadcrumbPath(path);\n\n      return nodeData;\n    } catch (err) {\n      setLoadError(`${t('errors.failedToLoad')}: ${err}`);\n      return undefined;\n    } finally {\n      setLoadingNodeId(null);\n    }\n  }\n\n  async function fetchNodeChildren(nodeId: string): Promise<void> {\n    const ws = wsApi();\n    if (!ws) return;\n\n    try {\n      const data = await ws.nodes.listNodeChildren(nodeId);\n      const children = (data.nodes?.filter(Boolean) as NodeResponse[]) || [];\n\n      setNodesStore(\n        produce((list) => {\n          const updateChildren = (nodeList: NodeResponse[]): boolean => {\n            for (const node of nodeList) {\n              if (node.id === nodeId) {\n                node.children = children;\n                node.has_children = children.length > 0;\n                return true;\n              }\n              if (node.children && updateChildren(node.children)) {\n                return true;\n              }\n            }\n            return false;\n          };\n          updateChildren(list);\n        })\n      );\n    } catch (err) {\n      console.error('Failed to fetch children:', err);\n    }\n  }\n\n  // First-time login check (wait for translations to be ready)\n  // Navigation to workspace is handled by App.tsx RootRedirect component\n  createEffect(() => {\n    const u = user();\n    if (!u || !i18nReady() || firstLoginCheckDone() || firstLoginInProgress()) return;\n\n    const orgs = u.organizations || [];\n    if (orgs.length === 0) {\n      setFirstLoginInProgress(true);\n      autoCreateOrganization().finally(() => setFirstLoginInProgress(false));\n      return;\n    }\n\n    const firstOrg = orgs[0];\n    if (firstOrg) {\n      const orgWorkspaces = u.workspaces?.filter((ws) => ws.organization_id === firstOrg.organization_id) || [];\n      if (orgWorkspaces.length === 0) {\n        if (firstOrg.role === OrgRoleAdmin || firstOrg.role === OrgRoleOwner) {\n          setFirstLoginInProgress(true);\n          autoCreateWorkspace().finally(() => setFirstLoginInProgress(false));\n          return;\n        }\n      }\n    }\n\n    const wsId = u.workspace_id;\n    if (!wsId) return;\n\n    setFirstLoginCheckDone(true);\n  });\n\n  // Load nodes when user changes\n  createEffect(() => {\n    if (user()) {\n      loadNodes();\n    }\n  });\n\n  // Reset loadedNodeId when workspace changes\n  createEffect(() => {\n    const wsId = user()?.workspace_id;\n    if (wsId && loadedForWorkspace() !== wsId) {\n      setLoadedNodeId(null);\n    }\n  });\n\n  // Move a node to a new parent (or root if newParentId === \"0\")\n  async function moveNode(nodeId: string, newParentId: string): Promise<void> {\n    const ws = wsApi();\n    if (!ws) return;\n\n    try {\n      await ws.nodes.moveNode(nodeId, { new_parent_id: newParentId });\n\n      setNodesStore(\n        produce((list) => {\n          // Find and remove node from old location\n          let movedNode: NodeResponse | null = null;\n\n          const removeFromList = (nodeList: NodeResponse[]): boolean => {\n            const index = nodeList.findIndex((n) => n.id === nodeId);\n            if (index !== -1) {\n              movedNode = { ...nodeList[index] } as NodeResponse;\n              nodeList.splice(index, 1);\n              return true;\n            }\n            for (const node of nodeList) {\n              if (node.children && removeFromList(node.children)) {\n                if (node.children.length === 0) {\n                  node.has_children = false;\n                }\n                return true;\n              }\n            }\n            return false;\n          };\n          removeFromList(list);\n\n          if (!movedNode) return;\n          const nodeToMove: NodeResponse = movedNode;\n\n          // Add to new parent\n          if (newParentId === '0') {\n            list.push(nodeToMove);\n          } else {\n            const addToParent = (nodeList: NodeResponse[]): boolean => {\n              for (const node of nodeList) {\n                if (node.id === newParentId) {\n                  if (!node.children) node.children = [];\n                  node.children.push(nodeToMove);\n                  node.has_children = true;\n                  return true;\n                }\n                if (node.children && addToParent(node.children)) return true;\n              }\n              return false;\n            };\n            addToParent(list);\n          }\n        })\n      );\n      setSaveError(null);\n    } catch (err) {\n      setSaveError(`${t('errors.failedToMove')}: ${err}`);\n    }\n  }\n\n  const value: WorkspaceContextValue = {\n    nodes,\n    setNodes,\n    selectedNodeId,\n    setSelectedNodeId,\n    selectedNodeData,\n    setSelectedNodeData,\n    breadcrumbPath,\n    setBreadcrumbPath,\n    loadingNodes,\n    loadingNodeId,\n    switchingWorkspace,\n    savingNodeId,\n    setSavingNodeId,\n    deletingNodeId,\n    setDeletingNodeId,\n    creatingNode,\n    setCreatingNode,\n    loadError,\n    setLoadError,\n    saveError,\n    setSaveError,\n    loading,\n    firstLoginCheckDone,\n    setFirstLoginCheckDone,\n    switchWorkspace,\n    createOrganization,\n    createWorkspace,\n    loadNodes,\n    loadNode,\n    fetchNodeChildren,\n    removeNode,\n    updateNodeTitle,\n    moveNode,\n    clearErrors,\n  };\n\n  return <WorkspaceContext.Provider value={value}>{props.children}</WorkspaceContext.Provider>;\n};\n\nexport function useWorkspace(): WorkspaceContextValue {\n  const context = useContext(WorkspaceContext);\n  if (!context) {\n    throw new Error('useWorkspace must be used within a WorkspaceProvider');\n  }\n  return context;\n}\n","// Utility function for debouncing function calls.\n\nexport interface DebouncedFunction<T extends (...args: unknown[]) => unknown> {\n  (...args: Parameters<T>): void;\n  /** Immediately execute the pending function if one is scheduled. */\n  flush(): void;\n  /** Cancel any pending execution without calling the function. */\n  cancel(): void;\n  /** Returns true if there's a pending execution. */\n  pending(): boolean;\n}\n\n/**\n * Creates a debounced version of a function that only calls it after\n * the specified delay has elapsed since the last call.\n *\n * The returned function has additional methods:\n * - flush(): Immediately execute the pending function\n * - cancel(): Cancel the pending execution\n * - pending(): Check if there's a pending execution\n */\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport function debounce<T extends (...args: any[]) => any>(fn: T, delayMs: number): DebouncedFunction<T> {\n  let timeoutId: ReturnType<typeof setTimeout> | null = null;\n  let lastArgs: Parameters<T> | null = null;\n\n  const debounced = (...args: Parameters<T>) => {\n    lastArgs = args;\n    if (timeoutId !== null) {\n      clearTimeout(timeoutId);\n    }\n    timeoutId = setTimeout(() => {\n      timeoutId = null;\n      lastArgs = null;\n      fn(...args);\n    }, delayMs);\n  };\n\n  debounced.flush = () => {\n    if (timeoutId !== null && lastArgs !== null) {\n      clearTimeout(timeoutId);\n      const args = lastArgs;\n      timeoutId = null;\n      lastArgs = null;\n      fn(...args);\n    }\n  };\n\n  debounced.cancel = () => {\n    if (timeoutId !== null) {\n      clearTimeout(timeoutId);\n      timeoutId = null;\n      lastArgs = null;\n    }\n  };\n\n  debounced.pending = () => timeoutId !== null;\n\n  return debounced;\n}\n","// Utility functions for extracting information from markdown content.\n\n/** Map of node ID to title for resolving internal page links */\nexport type NodeTitleMap = Record<string, string>;\n\n// --- Internal Page Link Utilities ---\n\n/**\n * Pattern to match relative file path links: [text](../nodeId/index.md) or [text](nodeId/index.md)\n * Captures: group 1 = text, group 2 = relative href ending in /index.md\n */\nconst RELATIVE_LINK_PATTERN = /\\[([^\\]]*)\\]\\(([^)]+\\/index\\.md)\\)/g;\n\n/**\n * Convert relative file path links to SPA URLs.\n * Called on the read path: API content (disk format) -> frontend SPA URLs.\n *\n * Extracts node IDs from directory names in paths like ../nodeId/index.md\n * and constructs /w/@wsId/@nodeId URLs.\n *\n * @param content Markdown content with relative file path links\n * @param wsId Current workspace ID\n * @returns Content with relative paths replaced by SPA URLs\n */\nexport function relativeLinksToSpaUrls(content: string, wsId: string): string {\n  if (!content || !wsId || !content.includes('/index.md)')) return content;\n\n  return content.replace(RELATIVE_LINK_PATTERN, (match, text, href) => {\n    // Skip absolute or external links.\n    if (href.startsWith('/') || href.startsWith('http')) return match;\n\n    // Extract nodeId from directory name: \"../nodeId/index.md\" -> \"nodeId\"\n    const lastSlash = href.lastIndexOf('/');\n    if (lastSlash < 0) return match;\n    const dir = href.substring(0, lastSlash);\n    const secondLastSlash = dir.lastIndexOf('/');\n    const nodeId = secondLastSlash >= 0 ? dir.substring(secondLastSlash + 1) : dir;\n\n    // Validate: node IDs are uppercase alphanumeric (base32)\n    if (!nodeId || !/^[A-Z0-9]+$/.test(nodeId)) return match;\n\n    return `[${text}](/w/@${wsId}/@${nodeId})`;\n  });\n}\n\n/**\n * Pattern to match SPA URL links: [text](/w/@wsId+slug/@nodeId+slug)\n * Captures: group 1 = text, group 2 = wsId, group 3 = nodeId\n */\nconst SPA_LINK_PATTERN = /\\[([^\\]]*)\\]\\(\\/w\\/@([^/+]+)(?:\\+[^/]*)?\\/@([A-Za-z0-9]+)(?:\\+[^)]*)?\\)/g;\n\n/**\n * Convert SPA URL links to relative file path links.\n * Called on the write path: frontend SPA URLs -> API (disk format).\n *\n * Converts /w/@wsId/@nodeId links to ../nodeId/index.md format.\n * Cross-workspace links (different wsId) are left unchanged.\n *\n * @param content Markdown content with SPA URL links\n * @param wsId Current workspace ID\n * @returns Content with SPA URLs replaced by relative file paths\n */\nexport function spaUrlsToRelativeLinks(content: string, wsId: string): string {\n  if (!content || !wsId || !content.includes('/w/@')) return content;\n\n  return content.replace(new RegExp(SPA_LINK_PATTERN.source, 'g'), (match, text, linkWsId, nodeId) => {\n    // Skip cross-workspace links.\n    if (linkWsId !== wsId) return match;\n    return `[${text}](../${nodeId}/index.md)`;\n  });\n}\n\n/**\n * Extract all linked node IDs from internal page links in markdown content.\n * Only extracts links that belong to the current workspace.\n *\n * @param markdown The markdown content to parse\n * @param currentWsId The current workspace ID to filter links by\n * @returns Array of unique node IDs referenced in the content\n */\nexport function extractLinkedNodeIds(markdown: string, currentWsId: string): string[] {\n  if (!markdown || !currentWsId) return [];\n\n  const seen = new Set<string>();\n  const pattern = new RegExp(SPA_LINK_PATTERN.source, 'g');\n  let match;\n\n  while ((match = pattern.exec(markdown)) !== null) {\n    const wsId = match[2];\n    const nodeId = match[3];\n    // Only include links to the current workspace\n    if (wsId === currentWsId && nodeId && !seen.has(nodeId)) {\n      seen.add(nodeId);\n    }\n  }\n\n  return Array.from(seen);\n}\n","// Editor context providing title, content, auto-save, and history management.\n\nimport {\n  createContext,\n  useContext,\n  createSignal,\n  createEffect,\n  onCleanup,\n  type ParentComponent,\n  type Accessor,\n} from 'solid-js';\nimport { useAuth } from './AuthContext';\nimport { useWorkspace } from './WorkspaceContext';\nimport { useI18n } from '../i18n';\nimport { debounce } from '../utils/debounce';\nimport { nodeUrl } from '../utils/urls';\nimport { extractLinkedNodeIds, relativeLinksToSpaUrls, spaUrlsToRelativeLinks } from '../utils/markdown-utils';\nimport type { Commit } from '@sdk/types.gen';\n\n/** Map of asset filename to signed URL */\nexport type AssetUrlMap = Record<string, string>;\n\n/** Map of node ID to title for resolving internal page links */\nexport type NodeTitleMap = Record<string, string>;\n\ninterface EditorContextValue {\n  // Editor state\n  title: Accessor<string>;\n  setTitle: (title: string) => void;\n  content: Accessor<string>;\n  setContent: (content: string) => void;\n  hasUnsavedChanges: Accessor<boolean>;\n  setHasUnsavedChanges: (has: boolean) => void;\n  autoSaveStatus: Accessor<'idle' | 'saving' | 'saved'>;\n\n  // Asset URLs (filename -> signed URL)\n  assetUrls: Accessor<AssetUrlMap>;\n\n  // Linked node titles (for resolving page link display text)\n  linkedNodeTitles: Accessor<NodeTitleMap>;\n\n  // History\n  showHistory: Accessor<boolean>;\n  setShowHistory: (show: boolean) => void;\n  history: Accessor<Commit[]>;\n  loadHistory: (nodeId: string) => Promise<void>;\n\n  // Actions\n  triggerAutoSave: () => void;\n  flushAutoSave: () => void;\n  resetEditor: () => void;\n  handleTitleChange: (newTitle: string) => void;\n  handleContentChange: (newContent: string) => void;\n}\n\nconst EditorContext = createContext<EditorContextValue>();\n\nexport const EditorProvider: ParentComponent = (props) => {\n  const { t } = useI18n();\n  const { user, wsApi } = useAuth();\n  const { selectedNodeId, selectedNodeData, updateNodeTitle, setLoadError, setSaveError } = useWorkspace();\n\n  // Editor state\n  const [title, setTitle] = createSignal('');\n  const [content, setContent] = createSignal('');\n  const [hasUnsavedChanges, setHasUnsavedChanges] = createSignal(false);\n  const [autoSaveStatus, setAutoSaveStatus] = createSignal<'idle' | 'saving' | 'saved'>('idle');\n\n  // Asset URLs accessor - derived from selectedNodeData\n  const assetUrls = (): AssetUrlMap => selectedNodeData()?.asset_urls || {};\n\n  // Linked node titles for resolving page link display text\n  const [linkedNodeTitles, setLinkedNodeTitles] = createSignal<NodeTitleMap>({});\n\n  // History state\n  const [showHistory, setShowHistory] = createSignal(false);\n  const [history, setHistory] = createSignal<Commit[]>([]);\n\n  // Debounced auto-save\n  // eslint-disable-next-line solid/reactivity -- intentionally reads current signal values when debounced function executes\n  const debouncedAutoSave = debounce(async () => {\n    const nodeId = selectedNodeId();\n    const ws = wsApi();\n    if (!nodeId || !hasUnsavedChanges() || !ws) return;\n\n    try {\n      setAutoSaveStatus('saving');\n      const wsId = user()?.workspace_id || '';\n      const diskContent = spaUrlsToRelativeLinks(content(), wsId);\n      await ws.nodes.page.updatePage(nodeId, { title: title(), content: diskContent });\n      setHasUnsavedChanges(false);\n      setAutoSaveStatus('saved');\n\n      // Update URL if title changed\n      const wsName = user()?.workspace_name;\n      if (wsId) {\n        const currentPath = window.location.pathname;\n        const newPath = nodeUrl(wsId, wsName, nodeId, title());\n        if (currentPath !== newPath) {\n          window.history.replaceState(null, '', newPath);\n        }\n      }\n\n      setTimeout(() => {\n        if (autoSaveStatus() === 'saved') {\n          setAutoSaveStatus('idle');\n        }\n      }, 2000);\n    } catch (err) {\n      setSaveError(`${t('errors.autoSaveFailed')}: ${err}`);\n      setAutoSaveStatus('idle');\n    }\n  }, 2000);\n\n  // Cleanup debounce on unmount\n  onCleanup(() => {\n    debouncedAutoSave.flush();\n  });\n\n  // Fetch linked node titles when content has internal links\n  async function fetchLinkedNodeTitles(nodeContent: string) {\n    const ws = wsApi();\n    const wsId = user()?.workspace_id;\n    if (!ws || !wsId || !nodeContent) {\n      setLinkedNodeTitles({});\n      return;\n    }\n\n    // Extract node IDs from internal links\n    const linkedIds = extractLinkedNodeIds(nodeContent, wsId);\n    if (linkedIds.length === 0) {\n      setLinkedNodeTitles({});\n      return;\n    }\n\n    try {\n      const resp = await ws.nodes.getNodeTitles({ IDs: linkedIds.join(',') });\n      setLinkedNodeTitles(resp.titles || {});\n    } catch {\n      // Silent failure - just use stored titles in links\n      setLinkedNodeTitles({});\n    }\n  }\n\n  // Sync editor state when selected node changes\n  createEffect(() => {\n    const node = selectedNodeData();\n    if (node) {\n      setTitle(node.title);\n      // Convert relative file path links from API to SPA URLs for the editor.\n      const wsId = user()?.workspace_id || '';\n      const spaContent = relativeLinksToSpaUrls(node.content || '', wsId);\n      setContent(spaContent);\n      setHasUnsavedChanges(false);\n      setAutoSaveStatus('idle');\n      setShowHistory(false);\n      // Fetch linked node titles in the background\n      fetchLinkedNodeTitles(spaContent);\n    } else {\n      resetEditor();\n    }\n  });\n\n  function resetEditor() {\n    setTitle('');\n    setContent('');\n    setHasUnsavedChanges(false);\n    setAutoSaveStatus('idle');\n    setShowHistory(false);\n    setHistory([]);\n    setLinkedNodeTitles({});\n  }\n\n  function handleTitleChange(newTitle: string) {\n    setTitle(newTitle);\n    const id = selectedNodeId();\n    if (id) {\n      updateNodeTitle(id, newTitle);\n    }\n    setHasUnsavedChanges(true);\n    debouncedAutoSave();\n  }\n\n  function handleContentChange(newContent: string) {\n    setContent(newContent);\n    setHasUnsavedChanges(true);\n    debouncedAutoSave();\n  }\n\n  // Local loading state for history - can be exposed later for UI feedback\n  const [_loadingHistory, setLoadingHistory] = createSignal(false);\n\n  async function loadHistory(nodeId: string) {\n    if (showHistory()) {\n      setShowHistory(false);\n      return;\n    }\n    const ws = wsApi();\n    if (!ws) return;\n\n    try {\n      setLoadingHistory(true);\n      const data = await ws.nodes.history.listNodeVersions(nodeId, { Limit: 100 });\n      setHistory((data.history?.filter(Boolean) as Commit[]) || []);\n      setShowHistory(true);\n    } catch (err) {\n      setLoadError(`${t('errors.failedToLoad')}: ${err}`);\n    } finally {\n      setLoadingHistory(false);\n    }\n  }\n\n  const value: EditorContextValue = {\n    title,\n    setTitle,\n    content,\n    setContent,\n    hasUnsavedChanges,\n    setHasUnsavedChanges,\n    autoSaveStatus,\n    assetUrls,\n    linkedNodeTitles,\n    showHistory,\n    setShowHistory,\n    history,\n    loadHistory,\n    triggerAutoSave: debouncedAutoSave,\n    flushAutoSave: debouncedAutoSave.flush,\n    resetEditor,\n    handleTitleChange,\n    handleContentChange,\n  };\n\n  return <EditorContext.Provider value={value}>{props.children}</EditorContext.Provider>;\n};\n\nexport function useEditor(): EditorContextValue {\n  const context = useContext(EditorContext);\n  if (!context) {\n    throw new Error('useEditor must be used within an EditorProvider');\n  }\n  return context;\n}\n","// Records context providing table records CRUD and pagination.\n\nimport {\n  createContext,\n  useContext,\n  createSignal,\n  createEffect,\n  createMemo,\n  type ParentComponent,\n  type Accessor,\n  batch,\n  onCleanup,\n} from 'solid-js';\nimport { useAuth } from './AuthContext';\nimport { useWorkspace } from './WorkspaceContext';\nimport { useI18n } from '../i18n';\nimport { debounce } from '../utils/debounce';\nimport type { DataRecordResponse, View, Filter, Sort, ViewType } from '@sdk/types.gen';\n\nconst PAGE_SIZE = 50;\nconst FILTER_DEBOUNCE_MS = 300;\n\ninterface RecordsContextValue {\n  records: Accessor<DataRecordResponse[]>;\n  hasMore: Accessor<boolean>;\n  views: Accessor<View[]>;\n  activeViewId: Accessor<string | undefined>;\n  activeFilters: Accessor<Filter[]>;\n  activeSorts: Accessor<Sort[]>;\n\n  // Operation-specific loading states\n  loadingRecords: Accessor<boolean>;\n  savingRecordId: Accessor<string | null>; // ID of record being saved/created (null for create)\n  deletingRecordId: Accessor<string | null>; // ID of record being deleted\n  savingView: Accessor<boolean>;\n\n  // Operation-specific error states\n  loadError: Accessor<string | null>;\n  setLoadError: (error: string | null) => void;\n  saveError: Accessor<string | null>;\n  setSaveError: (error: string | null) => void;\n\n  // Combined loading (any operation in progress) - for backward compatibility\n  loading: Accessor<boolean>;\n\n  loadRecords: (nodeId: string) => Promise<void>;\n  loadMoreRecords: () => Promise<void>;\n  addRecord: (data: Record<string, unknown>) => Promise<void>;\n  updateRecord: (recordId: string, data: Record<string, unknown>) => Promise<void>;\n  deleteRecord: (recordId: string) => Promise<void>;\n  clearRecords: () => void;\n\n  // View management\n  setActiveViewId: (id: string | undefined) => void;\n  setFilters: (filters: Filter[]) => void;\n  setSorts: (sorts: Sort[]) => void;\n  createView: (name: string, type: ViewType) => Promise<void>;\n  updateView: (viewId: string, updates: Partial<View>) => Promise<void>;\n  deleteView: (viewId: string) => Promise<void>;\n\n  // Clear errors\n  clearErrors: () => void;\n}\n\nconst RecordsContext = createContext<RecordsContextValue>();\n\nexport const RecordsProvider: ParentComponent = (props) => {\n  const { t } = useI18n();\n  const { wsApi } = useAuth();\n  const { selectedNodeId, selectedNodeData } = useWorkspace();\n\n  const [records, setRecords] = createSignal<DataRecordResponse[]>([]);\n  const [hasMore, setHasMore] = createSignal(false);\n\n  // Full dataset cache for client-side filtering when all records are loaded\n  // allRecords stores the unfiltered dataset when hasMore is false\n  const [allRecords, setAllRecords] = createSignal<DataRecordResponse[] | null>(null);\n\n  // View state\n  const [views, setViews] = createSignal<View[]>([]);\n  const [activeViewId, setActiveViewIdSignal] = createSignal<string | undefined>();\n  const [activeFilters, setActiveFilters] = createSignal<Filter[]>([]);\n  const [activeSorts, setActiveSorts] = createSignal<Sort[]>([]);\n\n  // Operation-specific loading states\n  const [loadingRecords, setLoadingRecords] = createSignal(false);\n  const [savingRecordId, setSavingRecordId] = createSignal<string | null>(null);\n  const [deletingRecordId, setDeletingRecordId] = createSignal<string | null>(null);\n  const [savingView, setSavingView] = createSignal(false);\n\n  // Operation-specific error states\n  const [loadError, setLoadError] = createSignal<string | null>(null);\n  const [saveError, setSaveError] = createSignal<string | null>(null);\n\n  // Combined loading (any operation in progress) - derived for backward compatibility\n  const loading = createMemo(\n    () => loadingRecords() || savingRecordId() !== null || deletingRecordId() !== null || savingView()\n  );\n\n  // Clear all errors\n  const clearErrors = () => {\n    setLoadError(null);\n    setSaveError(null);\n  };\n\n  // Virtual default view used when no views exist\n  const DEFAULT_VIEW_ID = '__default__';\n\n  // Client-side filter matching\n  function matchesFilter(record: DataRecordResponse, filter: Filter): boolean {\n    // Handle compound filters (and/or)\n    if (filter.and && filter.and.length > 0) {\n      return filter.and.every((f) => matchesFilter(record, f));\n    }\n    if (filter.or && filter.or.length > 0) {\n      return filter.or.some((f) => matchesFilter(record, f));\n    }\n\n    // Simple filter\n    if (!filter.property) return true;\n    const fieldValue = record.data?.[filter.property];\n    const filterValue = filter.value;\n\n    switch (filter.operator) {\n      case 'equals':\n        return fieldValue === filterValue;\n      case 'not_equals':\n        return fieldValue !== filterValue;\n      case 'contains':\n        return (\n          typeof fieldValue === 'string' &&\n          typeof filterValue === 'string' &&\n          fieldValue.toLowerCase().includes(filterValue.toLowerCase())\n        );\n      case 'not_contains':\n        return (\n          typeof fieldValue === 'string' &&\n          typeof filterValue === 'string' &&\n          !fieldValue.toLowerCase().includes(filterValue.toLowerCase())\n        );\n      case 'starts_with':\n        return (\n          typeof fieldValue === 'string' &&\n          typeof filterValue === 'string' &&\n          fieldValue.toLowerCase().startsWith(filterValue.toLowerCase())\n        );\n      case 'ends_with':\n        return (\n          typeof fieldValue === 'string' &&\n          typeof filterValue === 'string' &&\n          fieldValue.toLowerCase().endsWith(filterValue.toLowerCase())\n        );\n      case 'is_empty':\n        return fieldValue === null || fieldValue === undefined || fieldValue === '';\n      case 'is_not_empty':\n        return fieldValue !== null && fieldValue !== undefined && fieldValue !== '';\n      case 'gt':\n        return typeof fieldValue === 'number' && typeof filterValue === 'number' && fieldValue > filterValue;\n      case 'gte':\n        return typeof fieldValue === 'number' && typeof filterValue === 'number' && fieldValue >= filterValue;\n      case 'lt':\n        return typeof fieldValue === 'number' && typeof filterValue === 'number' && fieldValue < filterValue;\n      case 'lte':\n        return typeof fieldValue === 'number' && typeof filterValue === 'number' && fieldValue <= filterValue;\n      default:\n        return true;\n    }\n  }\n\n  // Apply filters to records client-side\n  function applyFiltersClientSide(recs: DataRecordResponse[], filters: Filter[]): DataRecordResponse[] {\n    if (filters.length === 0) return recs;\n    return recs.filter((record) => filters.every((filter) => matchesFilter(record, filter)));\n  }\n\n  // Apply sorts to records client-side\n  function applySortsClientSide(recs: DataRecordResponse[], sorts: Sort[]): DataRecordResponse[] {\n    if (sorts.length === 0) return recs;\n\n    return [...recs].sort((a, b) => {\n      for (const sort of sorts) {\n        const aVal = a.data?.[sort.property];\n        const bVal = b.data?.[sort.property];\n\n        let cmp = 0;\n        if (aVal === bVal) {\n          cmp = 0;\n        } else if (aVal === null || aVal === undefined) {\n          cmp = 1; // nulls last\n        } else if (bVal === null || bVal === undefined) {\n          cmp = -1;\n        } else if (typeof aVal === 'string' && typeof bVal === 'string') {\n          cmp = aVal.localeCompare(bVal);\n        } else if (typeof aVal === 'number' && typeof bVal === 'number') {\n          cmp = aVal - bVal;\n        } else {\n          cmp = String(aVal).localeCompare(String(bVal));\n        }\n\n        if (cmp !== 0) {\n          return sort.direction === 'desc' ? -cmp : cmp;\n        }\n      }\n      return 0;\n    });\n  }\n\n  // Debounced server reload function\n  const debouncedServerReload = debounce((nodeId: string) => {\n    loadRecordsFromServer(nodeId);\n  }, FILTER_DEBOUNCE_MS);\n\n  // Cleanup debounced function on unmount\n  onCleanup(() => {\n    debouncedServerReload.cancel();\n  });\n\n  // Load records when selected node changes and has table content\n  createEffect(() => {\n    const node = selectedNodeData();\n    if (node?.has_table) {\n      batch(() => {\n        const nodeViews = node.views || [];\n\n        if (nodeViews.length > 0) {\n          setViews(nodeViews);\n          // Default to first view or the one marked default\n          const defaultView = nodeViews.find((v) => v.default) || nodeViews[0];\n          if (defaultView) {\n            setActiveViewIdSignal(defaultView.id);\n            setActiveFilters(defaultView.filters || []);\n            setActiveSorts(defaultView.sorts || []);\n          }\n        } else {\n          // Create a virtual default view when no views exist\n          const virtualDefault: View = {\n            id: DEFAULT_VIEW_ID,\n            name: t('table.all') || 'All',\n            type: 'table',\n            default: true,\n            filters: [],\n            sorts: [],\n            columns: [],\n            groups: [],\n          };\n          setViews([virtualDefault]);\n          setActiveViewIdSignal(DEFAULT_VIEW_ID);\n          setActiveFilters([]);\n          setActiveSorts([]);\n        }\n      });\n      loadRecords(node.id);\n    } else {\n      clearRecords();\n    }\n  });\n\n  function clearRecords() {\n    debouncedServerReload.cancel();\n    setRecords([]);\n    setHasMore(false);\n    setAllRecords(null);\n    setViews([]);\n    setActiveViewIdSignal(undefined);\n    setActiveFilters([]);\n    setActiveSorts([]);\n  }\n\n  function setActiveViewId(id: string | undefined) {\n    if (id === activeViewId()) return;\n\n    const view = views().find((v) => v.id === id);\n    batch(() => {\n      setActiveViewIdSignal(id);\n      if (view) {\n        setActiveFilters(view.filters || []);\n        setActiveSorts(view.sorts || []);\n      } else {\n        setActiveFilters([]);\n        setActiveSorts([]);\n      }\n    });\n\n    // Use optimized filtering (client-side if all records cached)\n    applyFiltersAndSorts();\n  }\n\n  function setFilters(filters: Filter[]) {\n    setActiveFilters(filters);\n    applyFiltersAndSorts();\n  }\n\n  function setSorts(sorts: Sort[]) {\n    setActiveSorts(sorts);\n    applyFiltersAndSorts();\n  }\n\n  // Internal function to load records from server (always reloads)\n  async function loadRecordsFromServer(nodeId: string) {\n    const ws = wsApi();\n    if (!ws) return;\n\n    try {\n      setLoadingRecords(true);\n\n      const filters = activeFilters().length > 0 ? JSON.stringify(activeFilters()) : undefined;\n      const sorts = activeSorts().length > 0 ? JSON.stringify(activeSorts()) : undefined;\n\n      // Don't send virtual default view ID to server\n      const viewId = activeViewId();\n      const serverViewId = viewId === DEFAULT_VIEW_ID ? '' : viewId || '';\n\n      const data = await ws.nodes.table.records.listRecords(nodeId, {\n        Offset: 0,\n        Limit: PAGE_SIZE,\n        ViewID: serverViewId,\n        Filters: filters || '',\n        Sorts: sorts || '',\n      });\n\n      const loadedRecords = (data.records || []) as DataRecordResponse[];\n      setRecords(loadedRecords);\n      const more = loadedRecords.length === PAGE_SIZE;\n      setHasMore(more);\n\n      // If we have all records and no filters/sorts, cache them for client-side filtering\n      if (!more && activeFilters().length === 0 && activeSorts().length === 0) {\n        setAllRecords(loadedRecords);\n      } else {\n        // Clear cache if filters/sorts are active or not all records loaded\n        setAllRecords(null);\n      }\n      setLoadError(null);\n    } catch (err) {\n      setLoadError(`${t('errors.failedToLoad')}: ${err}`);\n    } finally {\n      setLoadingRecords(false);\n    }\n  }\n\n  // Public function that may use client-side filtering when possible\n  async function loadRecords(nodeId: string) {\n    debouncedServerReload.cancel();\n    await loadRecordsFromServer(nodeId);\n  }\n\n  // Apply filters/sorts, using client-side when all data is cached\n  function applyFiltersAndSorts() {\n    const cached = allRecords();\n    if (cached !== null) {\n      // Client-side filtering: we have all records cached\n      const filtered = applyFiltersClientSide(cached, activeFilters());\n      const sorted = applySortsClientSide(filtered, activeSorts());\n      setRecords(sorted);\n      setHasMore(false);\n    } else {\n      // Need server reload (debounced)\n      const nodeId = selectedNodeId();\n      if (nodeId) {\n        debouncedServerReload(nodeId);\n      }\n    }\n  }\n\n  async function loadMoreRecords() {\n    const nodeId = selectedNodeId();\n    const ws = wsApi();\n    if (!nodeId || loadingRecords() || !ws) return;\n\n    try {\n      setLoadingRecords(true);\n      const offset = records().length;\n\n      const filters = activeFilters().length > 0 ? JSON.stringify(activeFilters()) : undefined;\n      const sorts = activeSorts().length > 0 ? JSON.stringify(activeSorts()) : undefined;\n\n      // Don't send virtual default view ID to server\n      const viewId = activeViewId();\n      const serverViewId = viewId === DEFAULT_VIEW_ID ? '' : viewId || '';\n\n      const data = await ws.nodes.table.records.listRecords(nodeId, {\n        Offset: offset,\n        Limit: PAGE_SIZE,\n        ViewID: serverViewId,\n        Filters: filters || '',\n        Sorts: sorts || '',\n      });\n\n      const newRecords = (data.records || []) as DataRecordResponse[];\n      const allRecs = [...records(), ...newRecords];\n      setRecords(allRecs);\n      const more = newRecords.length === PAGE_SIZE;\n      setHasMore(more);\n\n      // Update cache if we now have all records and no filters/sorts active\n      if (!more && activeFilters().length === 0 && activeSorts().length === 0) {\n        setAllRecords(allRecs);\n      }\n      setLoadError(null);\n    } catch (err) {\n      setLoadError(`${t('errors.failedToLoad')}: ${err}`);\n    } finally {\n      setLoadingRecords(false);\n    }\n  }\n\n  async function addRecord(data: Record<string, unknown>) {\n    const nodeId = selectedNodeId();\n    const ws = wsApi();\n    if (!nodeId || !ws) return;\n\n    try {\n      setSavingRecordId('__new__'); // Special marker for creating new record\n      // Invalidate cache since data is changing\n      setAllRecords(null);\n      await ws.nodes.table.records.createRecord(nodeId, { data });\n      await loadRecords(nodeId);\n      setSaveError(null);\n    } catch (err) {\n      setSaveError(`${t('errors.failedToCreate')}: ${err}`);\n    } finally {\n      setSavingRecordId(null);\n    }\n  }\n\n  async function updateRecord(recordId: string, data: Record<string, unknown>) {\n    const nodeId = selectedNodeId();\n    const ws = wsApi();\n    if (!nodeId || !ws) return;\n\n    try {\n      setSavingRecordId(recordId);\n      // Invalidate cache since data is changing\n      setAllRecords(null);\n      await ws.nodes.table.records.updateRecord(nodeId, recordId, { data });\n      await loadRecords(nodeId);\n      setSaveError(null);\n    } catch (err) {\n      setSaveError(`${t('errors.failedToSave')}: ${err}`);\n    } finally {\n      setSavingRecordId(null);\n    }\n  }\n\n  async function deleteRecord(recordId: string) {\n    const nodeId = selectedNodeId();\n    const ws = wsApi();\n    if (!nodeId || !ws) return;\n    if (!confirm(t('table.confirmDeleteRecord') || 'Delete this record?')) return;\n\n    try {\n      setDeletingRecordId(recordId);\n      // Invalidate cache since data is changing\n      setAllRecords(null);\n      await ws.nodes.table.records.deleteRecord(nodeId, recordId);\n      await loadRecords(nodeId);\n      setSaveError(null);\n    } catch (err) {\n      setSaveError(`${t('errors.failedToDelete')}: ${err}`);\n    } finally {\n      setDeletingRecordId(null);\n    }\n  }\n\n  async function createView(name: string, type: ViewType) {\n    const nodeId = selectedNodeId();\n    const ws = wsApi();\n    if (!nodeId || !ws) return;\n\n    try {\n      setSavingView(true);\n      const res = await ws.nodes.views.createView(nodeId, { name, type });\n\n      // Ideally reload node to get updated views list, but we can also optimistically update\n      // Since we need the full View object which CreateViewResponse doesn't return (only ID),\n      // we probably should reload the node.\n      // But we can construct a placeholder view.\n      const newView: View = {\n        id: res.id,\n        name,\n        type,\n        default: false,\n        filters: [],\n        sorts: [],\n        columns: [], // Defaults\n        groups: [],\n      };\n\n      batch(() => {\n        setViews([...views(), newView]);\n        setActiveViewIdSignal(res.id);\n        setActiveFilters([]);\n        setActiveSorts([]);\n      });\n      setSaveError(null);\n      // No need to reload records as filters are empty\n    } catch (err) {\n      setSaveError(`${t('errors.failedToCreate')}: ${err}`);\n    } finally {\n      setSavingView(false);\n    }\n  }\n\n  async function updateView(viewId: string, updates: Partial<View>) {\n    const nodeId = selectedNodeId();\n    const ws = wsApi();\n    if (!nodeId || !ws) return;\n\n    try {\n      setSavingView(true);\n      // We only send the fields that are updated.\n      // The API expects UpdateViewRequest which matches Partial<View> structure mostly.\n      // But we need to map View properties to UpdateViewRequest properties if they differ.\n      // They are identical in our DTOs.\n      await ws.nodes.views.updateView(nodeId, viewId, updates);\n\n      setViews(views().map((v) => (v.id === viewId ? { ...v, ...updates } : v)));\n\n      // If updating active view's filters/sorts, update local state and apply\n      if (viewId === activeViewId()) {\n        if (updates.filters) setActiveFilters(updates.filters);\n        if (updates.sorts) setActiveSorts(updates.sorts);\n        // Apply filters/sorts (use client-side if cached)\n        if (updates.filters || updates.sorts) {\n          applyFiltersAndSorts();\n        }\n      }\n      setSaveError(null);\n    } catch (err) {\n      setSaveError(`${t('errors.failedToSave')}: ${err}`);\n    } finally {\n      setSavingView(false);\n    }\n  }\n\n  async function deleteView(viewId: string) {\n    const nodeId = selectedNodeId();\n    const ws = wsApi();\n    if (!nodeId || !ws) return;\n\n    if (!confirm(t('table.confirmDeleteView') || 'Delete this view?')) return;\n\n    try {\n      setSavingView(true);\n      await ws.nodes.views.deleteView(nodeId, viewId);\n\n      const newViews = views().filter((v) => v.id !== viewId);\n      setViews(newViews);\n\n      if (activeViewId() === viewId) {\n        // Switch to another view or clear\n        const firstView = newViews[0];\n        if (firstView) {\n          setActiveViewId(firstView.id);\n        } else {\n          setActiveViewId(undefined);\n        }\n      }\n      setSaveError(null);\n    } catch (err) {\n      setSaveError(`${t('errors.failedToDelete')}: ${err}`);\n    } finally {\n      setSavingView(false);\n    }\n  }\n\n  const value: RecordsContextValue = {\n    records,\n    hasMore,\n    views,\n    activeViewId,\n    activeFilters,\n    activeSorts,\n    loadingRecords,\n    savingRecordId,\n    deletingRecordId,\n    savingView,\n    loadError,\n    setLoadError,\n    saveError,\n    setSaveError,\n    loading,\n    loadRecords,\n    loadMoreRecords,\n    addRecord,\n    updateRecord,\n    deleteRecord,\n    clearRecords,\n    setActiveViewId,\n    setFilters,\n    setSorts,\n    createView,\n    updateView,\n    deleteView,\n    clearErrors,\n  };\n\n  return <RecordsContext.Provider value={value}>{props.children}</RecordsContext.Provider>;\n};\n\nexport function useRecords(): RecordsContextValue {\n  const context = useContext(RecordsContext);\n  if (!context) {\n    throw new Error('useRecords must be used within a RecordsProvider');\n  }\n  return context;\n}\n","// Error boundary component to prevent full app crashes.\n\nimport { ErrorBoundary as SolidErrorBoundary, type ParentComponent } from 'solid-js';\nimport styles from './ErrorBoundary.module.css';\n\ninterface ErrorFallbackProps {\n  error: Error;\n  reset: () => void;\n}\n\nfunction ErrorFallback(props: ErrorFallbackProps) {\n  return (\n    <div class={styles.errorBoundary} role=\"alert\">\n      <h2>Something went wrong</h2>\n      <p class={styles.errorMessage}>{props.error.message}</p>\n      <details class={styles.errorDetails}>\n        <summary>Technical details</summary>\n        <pre>{props.error.stack}</pre>\n      </details>\n      <button class={styles.retryButton} onClick={() => props.reset()}>\n        Try again\n      </button>\n    </div>\n  );\n}\n\nexport const AppErrorBoundary: ParentComponent = (props) => {\n  return (\n    <SolidErrorBoundary fallback={(err, reset) => <ErrorFallback error={err} reset={reset} />}>\n      {props.children}\n    </SolidErrorBoundary>\n  );\n};\n\nexport default AppErrorBoundary;\n","// Banner component prompting users to install the app as a PWA.\n\nimport { createSignal, onMount, onCleanup, Show } from 'solid-js';\nimport { useI18n } from '../i18n';\nimport styles from './PWAInstallBanner.module.css';\n\ninterface BeforeInstallPromptEvent extends Event {\n  prompt(): Promise<void>;\n  userChoice: Promise<{ outcome: 'accepted' | 'dismissed' }>;\n}\n\nconst STORAGE_KEY = 'mddb_pwa_dismissed';\nconst DISMISS_DURATION_DAYS = 30;\n\nfunction isDismissed(): boolean {\n  const dismissed = localStorage.getItem(STORAGE_KEY);\n  if (!dismissed) return false;\n\n  const dismissedDate = new Date(dismissed);\n  const now = new Date();\n  const daysDiff = (now.getTime() - dismissedDate.getTime()) / (1000 * 60 * 60 * 24);\n\n  return daysDiff < DISMISS_DURATION_DAYS;\n}\n\nexport default function PWAInstallBanner() {\n  const { t } = useI18n();\n  const [deferredPrompt, setDeferredPrompt] = createSignal<BeforeInstallPromptEvent | null>(null);\n  const [showBanner, setShowBanner] = createSignal(false);\n\n  onMount(() => {\n    if (isDismissed()) return;\n\n    const handleBeforeInstall = (e: Event) => {\n      e.preventDefault();\n      setDeferredPrompt(e as BeforeInstallPromptEvent);\n      setShowBanner(true);\n    };\n\n    const handleAppInstalled = () => {\n      setShowBanner(false);\n      setDeferredPrompt(null);\n    };\n\n    window.addEventListener('beforeinstallprompt', handleBeforeInstall);\n    window.addEventListener('appinstalled', handleAppInstalled);\n\n    onCleanup(() => {\n      window.removeEventListener('beforeinstallprompt', handleBeforeInstall);\n      window.removeEventListener('appinstalled', handleAppInstalled);\n    });\n  });\n\n  const handleInstall = async () => {\n    const prompt = deferredPrompt();\n    if (!prompt) return;\n\n    await prompt.prompt();\n    const { outcome } = await prompt.userChoice;\n\n    if (outcome === 'accepted') {\n      setShowBanner(false);\n    }\n    setDeferredPrompt(null);\n  };\n\n  const handleDismiss = () => {\n    localStorage.setItem(STORAGE_KEY, new Date().toISOString());\n    setShowBanner(false);\n  };\n\n  return (\n    <Show when={showBanner() && deferredPrompt()}>\n      <div class={styles.banner}>\n        <div class={styles.content}>\n          <div class={styles.title}>{t('pwa.installTitle')}</div>\n          <div class={styles.message}>{t('pwa.installMessage')}</div>\n        </div>\n        <div class={styles.actions}>\n          <button class={styles.dismissButton} onClick={handleDismiss}>\n            {t('pwa.dismissButton')}\n          </button>\n          <button class={styles.installButton} onClick={handleInstall}>\n            {t('pwa.installButton')}\n          </button>\n        </div>\n      </div>\n    </Show>\n  );\n}\n","// Expandable navigation item for settings sidebar.\n\nimport { createSignal, For, Show, createEffect, untrack } from 'solid-js';\nimport type { UnifiedSettingsMatch } from '../../utils/urls';\nimport type { NavItem } from './SettingsSidebar';\nimport styles from './SettingsNavItem.module.css';\n\nimport ChevronRightIcon from '@material-symbols/svg-400/outlined/chevron_right.svg?solid';\n\ninterface SettingsNavItemProps {\n  item: NavItem;\n  depth: number;\n  isActive: (url: string, route: UnifiedSettingsMatch) => boolean;\n  onNavigate: (url: string) => void;\n  currentRoute: UnifiedSettingsMatch;\n}\n\nexport default function SettingsNavItem(props: SettingsNavItemProps) {\n  const hasChildren = () => props.item.children && props.item.children.length > 0;\n\n  // Auto-expand if any child is active\n  const shouldAutoExpand = (): boolean => {\n    if (!hasChildren()) return false;\n    const route = props.currentRoute;\n    const checkActive = (items: NavItem[]): boolean => {\n      for (const item of items) {\n        if (props.isActive(item.url, route)) return true;\n        if (item.children && checkActive(item.children)) return true;\n      }\n      return false;\n    };\n    return checkActive(props.item.children || []);\n  };\n\n  // Use untrack for initial value - we handle reactive updates in createEffect below\n  const [isExpanded, setIsExpanded] = createSignal(untrack(() => props.depth === 0 || shouldAutoExpand()));\n\n  // Update expansion when route changes\n  createEffect(() => {\n    // Access currentRoute to track changes (triggers reactivity)\n    const route = props.currentRoute;\n    if (route && shouldAutoExpand()) {\n      setIsExpanded(true);\n    }\n  });\n\n  const handleClick = (e: MouseEvent) => {\n    e.preventDefault();\n    if (hasChildren() && !props.item.url) {\n      // Section header - just toggle expansion\n      setIsExpanded(!isExpanded());\n    } else if (props.item.url) {\n      // Navigate and expand children if any\n      if (hasChildren()) {\n        setIsExpanded(true);\n      }\n      props.onNavigate(props.item.url);\n    }\n  };\n\n  const toggleExpand = (e: MouseEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n    setIsExpanded(!isExpanded());\n  };\n\n  const paddingLeft = () => `${props.depth * 12 + 16}px`;\n\n  const navItemClass = () => {\n    let classes = styles.navItem;\n    if (props.isActive(props.item.url, props.currentRoute)) classes += ' ' + styles.active;\n    if (props.depth === 0 && hasChildren()) classes += ' ' + styles.section;\n    if (props.item.separator) classes += ' ' + styles.separator;\n    return classes;\n  };\n\n  const expandIconClass = () => {\n    let classes = styles.expandIcon;\n    if (isExpanded()) classes += ' ' + styles.expanded;\n    return classes;\n  };\n\n  return (\n    <div class={styles.navItemWrapper}>\n      <a\n        href={props.item.url || '#'}\n        class={navItemClass()}\n        style={{ 'padding-left': paddingLeft() }}\n        onClick={handleClick}\n      >\n        <Show when={hasChildren()} fallback={<span class={styles.expandSpacer} />}>\n          <span class={expandIconClass()} onClick={toggleExpand}>\n            <ChevronRightIcon />\n          </span>\n        </Show>\n        <span class={styles.label}>{props.item.label}</span>\n      </a>\n\n      <Show when={isExpanded() && hasChildren()}>\n        <div class={styles.children}>\n          <For each={props.item.children}>\n            {(child) => (\n              <SettingsNavItem\n                item={child}\n                depth={props.depth + 1}\n                isActive={props.isActive}\n                onNavigate={props.onNavigate}\n                currentRoute={props.currentRoute}\n              />\n            )}\n          </For>\n        </div>\n      </Show>\n    </div>\n  );\n}\n","// Settings sidebar navigation with expandable workspace and organization items.\n\nimport { For } from 'solid-js';\nimport { useLocation, useNavigate } from '@solidjs/router';\nimport { useAuth } from '../../contexts';\nimport { useI18n } from '../../i18n';\nimport { settingsUrl, type UnifiedSettingsMatch } from '../../utils/urls';\nimport { OrgRoleAdmin, OrgRoleOwner, WSRoleAdmin } from '@sdk/types.gen';\nimport SettingsNavItem from './SettingsNavItem';\nimport styles from './SettingsSidebar.module.css';\n\ninterface SettingsSidebarProps {\n  isOpen: boolean;\n  // Optional props for backward compatibility - if not provided, uses router\n  currentRoute?: UnifiedSettingsMatch;\n  onNavigate?: (url: string) => void;\n}\n\nexport interface NavItem {\n  id: string;\n  label: string;\n  url: string;\n  children?: NavItem[];\n  separator?: boolean;\n}\n\nexport default function SettingsSidebar(props: SettingsSidebarProps) {\n  const { t } = useI18n();\n  const { user } = useAuth();\n  const location = useLocation();\n  const navigate = useNavigate();\n\n  // Derive route from location if not provided via props\n  const derivedRoute = (): UnifiedSettingsMatch => {\n    const path = location.pathname;\n    const hash = location.hash?.slice(1) || undefined;\n\n    if (path === '/settings/user' || path === '/settings/user/') {\n      return { type: 'profile' };\n    }\n    if (path === '/settings/server' || path === '/settings/server/') {\n      return { type: 'server' };\n    }\n\n    const wsMatch = path.match(/^\\/settings\\/workspace\\/([^+/]+)/);\n    if (wsMatch) {\n      return { type: 'workspace', id: wsMatch[1], section: hash };\n    }\n\n    const orgMatch = path.match(/^\\/settings\\/org\\/([^+/]+)/);\n    if (orgMatch) {\n      return { type: 'org', id: orgMatch[1], section: hash };\n    }\n\n    return { type: 'profile' };\n  };\n\n  // Use provided props or fall back to router-based values\n  const currentRoute = () => props.currentRoute ?? derivedRoute();\n  const handleNavigate = (url: string) => {\n    if (props.onNavigate) {\n      props.onNavigate(url);\n    } else {\n      navigate(url);\n    }\n  };\n\n  // Build navigation tree\n  const navItems = (): NavItem[] => {\n    const items: NavItem[] = [];\n    const u = user();\n    if (!u) return items;\n\n    // User profile\n    items.push({\n      id: 'user',\n      label: t('settings.personal'),\n      url: settingsUrl('user'),\n    });\n\n    // Workspaces\n    const workspaces = u.workspaces || [];\n    if (workspaces.length > 0) {\n      const wsChildren: NavItem[] = workspaces.map((ws) => {\n        const wsId = ws.workspace_id;\n        const wsName = ws.workspace_name || wsId;\n        const isAdmin = ws.role === WSRoleAdmin;\n        const children: NavItem[] = [\n          {\n            id: `ws-${wsId}-members`,\n            label: t('settings.members'),\n            url: settingsUrl('workspace', wsId, wsName) + '#members',\n          },\n          {\n            id: `ws-${wsId}-settings`,\n            label: t('settings.settings'),\n            url: settingsUrl('workspace', wsId, wsName) + '#settings',\n          },\n        ];\n        if (isAdmin) {\n          children.push({\n            id: `ws-${wsId}-sync`,\n            label: t('settings.gitSync'),\n            url: settingsUrl('workspace', wsId, wsName) + '#sync',\n          });\n        }\n        return {\n          id: `ws-${wsId}`,\n          label: wsName,\n          url: settingsUrl('workspace', wsId, wsName),\n          children,\n        };\n      });\n\n      items.push({\n        id: 'workspaces',\n        label: t('settings.workspaces'),\n        url: '',\n        children: wsChildren,\n      });\n    }\n\n    // Organizations (only admin/owner)\n    const orgs = (u.organizations || []).filter((o) => o.role === OrgRoleAdmin || o.role === OrgRoleOwner);\n    if (orgs.length > 0) {\n      const orgChildren: NavItem[] = orgs.map((org) => {\n        const orgId = org.organization_id;\n        const orgName = org.organization_name || orgId;\n        return {\n          id: `org-${orgId}`,\n          label: orgName,\n          url: settingsUrl('org', orgId, orgName),\n          children: [\n            {\n              id: `org-${orgId}-members`,\n              label: t('settings.members'),\n              url: settingsUrl('org', orgId, orgName) + '#members',\n            },\n            {\n              id: `org-${orgId}-settings`,\n              label: t('settings.settings'),\n              url: settingsUrl('org', orgId, orgName) + '#settings',\n            },\n          ],\n        };\n      });\n\n      items.push({\n        id: 'organizations',\n        label: t('settings.organizations'),\n        url: '',\n        children: orgChildren,\n      });\n    }\n\n    // Server settings (only for global admins)\n    if (u.is_global_admin) {\n      items.push({\n        id: 'server',\n        label: t('server.serverSettings'),\n        url: settingsUrl('server'),\n      });\n    }\n\n    // Privacy and Terms links\n    items.push({\n      id: 'privacy',\n      label: t('app.privacyPolicy'),\n      url: '/privacy',\n      separator: true,\n    });\n    items.push({\n      id: 'terms',\n      label: t('app.terms'),\n      url: '/terms',\n    });\n\n    return items;\n  };\n\n  // Note: route is passed as parameter (not accessed from closure) so SolidJS\n  // tracks the dependency in the component that calls this function.\n  const isActive = (url: string, route: UnifiedSettingsMatch): boolean => {\n    if (!url) return false;\n\n    // Match based on route type and URL\n    if (url === '/settings/user' && route.type === 'profile') return true;\n    if (url === '/settings/server' && route.type === 'server') return true;\n\n    // For workspace/org URLs, check if the ID matches\n    if (route.type === 'workspace' && route.id) {\n      const wsMatch = url.match(/^\\/settings\\/workspace\\/([^+/]+)/);\n      if (wsMatch && wsMatch[1] === route.id) {\n        // Check section/hash match\n        const [, urlHash] = url.split('#');\n        if (urlHash) {\n          return route.section === urlHash;\n        }\n        return !route.section; // Active if no hash in URL and no section in route\n      }\n    }\n\n    if (route.type === 'org' && route.id) {\n      const orgMatch = url.match(/^\\/settings\\/org\\/([^+/]+)/);\n      if (orgMatch && orgMatch[1] === route.id) {\n        // Check section/hash match\n        const [, urlHash] = url.split('#');\n        if (urlHash) {\n          return route.section === urlHash;\n        }\n        return !route.section;\n      }\n    }\n\n    return false;\n  };\n\n  return (\n    <aside class={`${styles.sidebar} ${props.isOpen ? styles.mobileOpen : ''}`}>\n      <nav class={styles.nav}>\n        <For each={navItems()}>\n          {(item) => (\n            <SettingsNavItem\n              item={item}\n              depth={0}\n              isActive={isActive}\n              onNavigate={handleNavigate}\n              currentRoute={currentRoute()}\n            />\n          )}\n        </For>\n      </nav>\n    </aside>\n  );\n}\n","// Settings layout with sidebar navigation and content outlet.\n\nimport { createSignal, Show, onMount, onCleanup, type JSX } from 'solid-js';\nimport { useNavigate, useLocation } from '@solidjs/router';\nimport { useAuth } from '../contexts';\nimport { useI18n } from '../i18n';\nimport { workspaceUrl } from '../utils/urls';\nimport SettingsSidebar from '../components/settings/SettingsSidebar';\nimport styles from './SettingsSection.module.css';\n\ninterface SettingsLayoutProps {\n  children?: JSX.Element;\n}\n\nexport default function SettingsLayout(props: SettingsLayoutProps) {\n  const { t } = useI18n();\n  const { user } = useAuth();\n  const navigate = useNavigate();\n  const location = useLocation();\n  const [showMobileSidebar, setShowMobileSidebar] = createSignal(false);\n\n  // Handle Escape key to close mobile sidebar\n  const handleKeyDown = (e: KeyboardEvent) => {\n    if (e.key === 'Escape' && showMobileSidebar()) {\n      setShowMobileSidebar(false);\n    }\n  };\n\n  onMount(() => {\n    window.addEventListener('keydown', handleKeyDown);\n    onCleanup(() => window.removeEventListener('keydown', handleKeyDown));\n  });\n\n  const handleBack = () => {\n    navigate(-1);\n  };\n\n  const navigateToWorkspace = () => {\n    const wsId = user()?.workspace_id;\n    const wsName = user()?.workspace_name;\n    if (wsId) {\n      navigate(workspaceUrl(wsId, wsName));\n    }\n  };\n\n  const handleNavigate = (url: string) => {\n    setShowMobileSidebar(false);\n    navigate(url);\n  };\n\n  // Derive current route info from location for sidebar highlighting\n  const currentRoute = () => {\n    const path = location.pathname;\n    const hash = location.hash?.slice(1) || undefined;\n\n    if (path === '/settings/user' || path === '/settings/user/') {\n      return { type: 'profile' as const };\n    }\n    if (path === '/settings/server' || path === '/settings/server/') {\n      return { type: 'server' as const };\n    }\n\n    const wsMatch = path.match(/^\\/settings\\/workspace\\/([^+/]+)/);\n    if (wsMatch) {\n      return { type: 'workspace' as const, id: wsMatch[1], section: hash };\n    }\n\n    const orgMatch = path.match(/^\\/settings\\/org\\/([^+/]+)/);\n    if (orgMatch) {\n      return { type: 'org' as const, id: orgMatch[1], section: hash };\n    }\n\n    return { type: 'profile' as const };\n  };\n\n  return (\n    <div class={styles.settingsPage}>\n      <header class={styles.header}>\n        <div class={styles.headerLeft}>\n          <button\n            class={styles.hamburger}\n            onClick={() => setShowMobileSidebar(!showMobileSidebar())}\n            aria-label=\"Toggle settings menu\"\n          >\n            &#9776;\n          </button>\n          <button onClick={handleBack} class={styles.backButton}>\n            &larr; {t('common.back')}\n          </button>\n          <h1 class={styles.title} onClick={navigateToWorkspace}>\n            {t('settings.title')}\n          </h1>\n        </div>\n      </header>\n\n      <div class={styles.layout}>\n        <Show when={showMobileSidebar()}>\n          <div class={styles.mobileBackdrop} onClick={() => setShowMobileSidebar(false)} />\n        </Show>\n\n        <SettingsSidebar isOpen={showMobileSidebar()} currentRoute={currentRoute()} onNavigate={handleNavigate} />\n\n        <main class={styles.content}>{props.children}</main>\n      </div>\n    </div>\n  );\n}\n","// Settings section with nested routes for user, workspace, org, and server settings.\n\nimport { lazy, Show, Suspense, type JSX } from 'solid-js';\nimport { Navigate, useParams, useLocation, useNavigate } from '@solidjs/router';\nimport { useAuth } from '../contexts';\nimport { useI18n } from '../i18n';\nimport { settingsUrl, stripSlug } from '../utils/urls';\nimport SettingsLayout from './SettingsLayout';\n\nconst ProfileSettings = lazy(() => import('../components/settings/ProfileSettings'));\nconst WorkspaceSettingsPanel = lazy(() => import('../components/settings/WorkspaceSettingsPanel'));\nconst OrgSettingsPanel = lazy(() => import('../components/settings/OrgSettingsPanel'));\nconst ServerSettingsPanel = lazy(() => import('../components/settings/ServerSettingsPanel'));\n\n// Loading fallback\nfunction SettingsLoading() {\n  const { t } = useI18n();\n  return <div style={{ padding: '2rem', color: 'var(--c-text-light)' }}>{t('common.loading')}</div>;\n}\n\n// Guard component for server settings (global admin only)\nexport function ServerSettingsGuard() {\n  const { user } = useAuth();\n\n  return (\n    <Show when={user()?.is_global_admin} fallback={<Navigate href=\"/settings/user\" />}>\n      <Suspense fallback={<SettingsLoading />}>\n        <ServerSettingsPanel />\n      </Suspense>\n    </Show>\n  );\n}\n\n// Wrapper for WorkspaceSettingsPanel that extracts route params\nexport function WorkspaceSettingsRoute() {\n  const params = useParams<{ wsId: string }>();\n  const location = useLocation();\n  const navigate = useNavigate();\n  const { user } = useAuth();\n\n  // Extract section from hash (e.g., #members, #settings, #sync)\n  const section = () => location.hash?.slice(1) || undefined;\n\n  // Extract wsId - handle \"@id+slug\" format\n  const wsId = () => stripSlug(params.wsId || '');\n\n  // Verify user has access to this workspace\n  const hasAccess = () => {\n    const u = user();\n    return u?.workspaces?.some((ws) => ws.workspace_id === wsId());\n  };\n\n  const handleNavigateToOrgSettings = (orgId: string, orgName: string) => {\n    navigate(settingsUrl('org', orgId, orgName));\n  };\n\n  return (\n    <Show when={hasAccess()} fallback={<Navigate href=\"/settings/user\" />}>\n      <Suspense fallback={<SettingsLoading />}>\n        <WorkspaceSettingsPanel\n          wsId={wsId()}\n          section={section()}\n          onNavigateToOrgSettings={handleNavigateToOrgSettings}\n        />\n      </Suspense>\n    </Show>\n  );\n}\n\n// Wrapper for OrgSettingsPanel that extracts route params\nexport function OrgSettingsRoute() {\n  const params = useParams<{ orgId: string }>();\n  const location = useLocation();\n  const { user } = useAuth();\n\n  // Extract section from hash\n  const section = () => location.hash?.slice(1) || undefined;\n\n  // Extract orgId - handle \"@id+slug\" format\n  const orgId = () => stripSlug(params.orgId || '');\n\n  // Verify user has access to this organization\n  const hasAccess = () => {\n    const u = user();\n    return u?.organizations?.some((org) => org.organization_id === orgId());\n  };\n\n  return (\n    <Show when={hasAccess()} fallback={<Navigate href=\"/settings/user\" />}>\n      <Suspense fallback={<SettingsLoading />}>\n        <OrgSettingsPanel orgId={orgId()} section={section()} />\n      </Suspense>\n    </Show>\n  );\n}\n\n// Profile settings with Suspense wrapper\nexport function ProfileSettingsRoute() {\n  return (\n    <Suspense fallback={<SettingsLoading />}>\n      <ProfileSettings />\n    </Suspense>\n  );\n}\n\n// Redirect component for base /settings path\nexport function SettingsRedirect() {\n  return <Navigate href=\"/settings/user\" />;\n}\n\ninterface SettingsSectionProps {\n  children?: JSX.Element;\n}\n\n// Main settings section component - wraps children in layout\nexport default function SettingsSection(props: SettingsSectionProps) {\n  return <SettingsLayout>{props.children}</SettingsLayout>;\n}\n","import styles from './RowHandle.module.css';\n\nexport interface RowHandleProps {\n  /** Unique identifier for the row (block position, record ID, etc.) */\n  rowId: string;\n  /** Called when drag starts - consumer sets up drag data */\n  onDragStart: (e: DragEvent, rowId: string) => void;\n  /** Called on right-click - consumer shows context menu */\n  onContextMenu: (e: MouseEvent, rowId: string) => void;\n  /** Optional: called on handle click (e.g., to select row) */\n  onClick?: (e: MouseEvent, rowId: string) => void;\n  /** Optional: additional CSS class */\n  class?: string;\n}\n\n/**\n * A shared drag handle component used for table rows.\n * Inspired by Notion's 6-dot drag handle.\n */\nexport function RowHandle(props: RowHandleProps) {\n  const handleDragStart = (e: DragEvent) => {\n    props.onDragStart(e, props.rowId);\n  };\n\n  const handleContextMenu = (e: MouseEvent) => {\n    e.preventDefault();\n    props.onContextMenu(e, props.rowId);\n  };\n\n  const handleClick = (e: MouseEvent) => {\n    props.onClick?.(e, props.rowId);\n  };\n\n  return (\n    <div\n      class={`${styles.handle} ${props.class || ''}`}\n      draggable=\"true\"\n      onDragStart={handleDragStart}\n      onContextMenu={handleContextMenu}\n      onClick={handleClick}\n      aria-label=\"Drag handle\"\n      data-testid=\"row-handle\"\n    >\n      <svg viewBox=\"0 0 12 16\" class={styles.icon} fill=\"currentColor\" xmlns=\"http://www.w3.org/2000/svg\">\n        <circle cx=\"3\" cy=\"3\" r=\"1.5\" />\n        <circle cx=\"3\" cy=\"8\" r=\"1.5\" />\n        <circle cx=\"3\" cy=\"13\" r=\"1.5\" />\n        <circle cx=\"9\" cy=\"3\" r=\"1.5\" />\n        <circle cx=\"9\" cy=\"8\" r=\"1.5\" />\n        <circle cx=\"9\" cy=\"13\" r=\"1.5\" />\n      </svg>\n    </div>\n  );\n}\n","// Shared context menu component with keyboard navigation and viewport boundary detection.\n\nimport { createEffect, createSignal, For, Show, type JSX, onCleanup } from 'solid-js';\nimport { Portal } from 'solid-js/web';\nimport styles from './ContextMenu.module.css';\n\nexport interface ContextMenuAction {\n  id: string;\n  label: string;\n  icon?: JSX.Element;\n  shortcut?: string;\n  disabled?: boolean;\n  danger?: boolean; // Red text for destructive actions\n  separator?: boolean; // Render separator before this item\n}\n\nexport interface ContextMenuProps {\n  position: { x: number; y: number };\n  actions: ContextMenuAction[];\n  onAction: (actionId: string) => void;\n  onClose: () => void;\n}\n\n/**\n * A shared context menu component for editor blocks, table rows, and sidebar nodes.\n * Supports keyboard navigation, click-outside to close, and viewport boundary detection.\n */\nexport function ContextMenu(props: ContextMenuProps) {\n  let menuRef: HTMLDivElement | undefined;\n  const [focusedIndex, setFocusedIndex] = createSignal(0);\n  const [adjustedPosition, setAdjustedPosition] = createSignal({ x: 0, y: 0 });\n\n  // Get non-disabled action indices for keyboard navigation\n  const getEnabledIndices = () =>\n    props.actions\n      .map((action, i) => ({ action, i }))\n      .filter(({ action }) => !action.disabled)\n      .map(({ i }) => i);\n\n  // Adjust position to stay within viewport\n  createEffect(() => {\n    if (!menuRef) return;\n\n    const rect = menuRef.getBoundingClientRect();\n    const viewportWidth = window.innerWidth;\n    const viewportHeight = window.innerHeight;\n    const padding = 8;\n\n    let x = props.position.x;\n    let y = props.position.y;\n\n    // Adjust horizontal position if menu would overflow right edge\n    if (x + rect.width > viewportWidth - padding) {\n      x = Math.max(padding, viewportWidth - rect.width - padding);\n    }\n\n    // Adjust vertical position if menu would overflow bottom edge\n    if (y + rect.height > viewportHeight - padding) {\n      y = Math.max(padding, viewportHeight - rect.height - padding);\n    }\n\n    setAdjustedPosition({ x, y });\n  });\n\n  // Handle click outside to close\n  createEffect(() => {\n    const handleClickOutside = (e: MouseEvent) => {\n      if (menuRef && !menuRef.contains(e.target as Node)) {\n        props.onClose();\n      }\n    };\n\n    // Use setTimeout to avoid immediately closing from the triggering right-click\n    const timeoutId = setTimeout(() => {\n      document.addEventListener('click', handleClickOutside);\n      document.addEventListener('contextmenu', handleClickOutside);\n    }, 0);\n\n    onCleanup(() => {\n      clearTimeout(timeoutId);\n      document.removeEventListener('click', handleClickOutside);\n      document.removeEventListener('contextmenu', handleClickOutside);\n    });\n  });\n\n  // Handle keyboard navigation\n  createEffect(() => {\n    const handleKeyDown = (e: KeyboardEvent) => {\n      const enabledIndices = getEnabledIndices();\n      if (enabledIndices.length === 0) return;\n\n      switch (e.key) {\n        case 'Escape':\n          e.preventDefault();\n          props.onClose();\n          break;\n\n        case 'ArrowDown': {\n          e.preventDefault();\n          const currentPos = enabledIndices.indexOf(focusedIndex());\n          const nextPos = currentPos >= 0 ? (currentPos + 1) % enabledIndices.length : 0;\n          const nextIndex = enabledIndices[nextPos];\n          if (nextIndex !== undefined) {\n            setFocusedIndex(nextIndex);\n          }\n          break;\n        }\n\n        case 'ArrowUp': {\n          e.preventDefault();\n          const currentPos = enabledIndices.indexOf(focusedIndex());\n          const prevPos =\n            currentPos >= 0\n              ? (currentPos - 1 + enabledIndices.length) % enabledIndices.length\n              : enabledIndices.length - 1;\n          const prevIndex = enabledIndices[prevPos];\n          if (prevIndex !== undefined) {\n            setFocusedIndex(prevIndex);\n          }\n          break;\n        }\n\n        case 'Enter':\n        case ' ':\n          e.preventDefault();\n          {\n            const action = props.actions[focusedIndex()];\n            if (action && !action.disabled) {\n              props.onAction(action.id);\n              props.onClose();\n            }\n          }\n          break;\n\n        case 'Tab':\n          // Prevent tabbing out of menu\n          e.preventDefault();\n          break;\n      }\n    };\n\n    document.addEventListener('keydown', handleKeyDown);\n    onCleanup(() => document.removeEventListener('keydown', handleKeyDown));\n  });\n\n  // Focus menu on mount for keyboard accessibility\n  createEffect(() => {\n    menuRef?.focus();\n  });\n\n  const handleAction = (action: ContextMenuAction) => {\n    if (action.disabled) return;\n    props.onAction(action.id);\n    props.onClose();\n  };\n\n  // Build classList object for each button (reactive in SolidJS)\n  const getItemClassList = (action: ContextMenuAction, idx: () => number): Record<string, boolean | undefined> => ({\n    [styles.item as string]: true,\n    [styles.danger as string]: action.danger,\n    [styles.disabled as string]: action.disabled,\n    [styles.focused as string]: focusedIndex() === idx(),\n  });\n\n  return (\n    <Portal>\n      <div\n        ref={menuRef}\n        class={styles.menu}\n        style={{\n          left: `${adjustedPosition().x}px`,\n          top: `${adjustedPosition().y}px`,\n        }}\n        role=\"menu\"\n        tabIndex={-1}\n        aria-label=\"Context menu\"\n      >\n        <For each={props.actions}>\n          {(action, index) => (\n            <>\n              <Show when={action.separator}>\n                <div class={styles.separator} role=\"separator\" />\n              </Show>\n              <button\n                classList={getItemClassList(action, index)}\n                onClick={() => handleAction(action)}\n                onMouseEnter={() => setFocusedIndex(index())}\n                role=\"menuitem\"\n                disabled={action.disabled}\n                tabIndex={-1}\n                aria-disabled={action.disabled}\n                data-testid={`context-menu-${action.id}`}\n              >\n                <Show when={action.icon}>\n                  <span class={styles.icon}>{action.icon}</span>\n                </Show>\n                <span class={styles.label}>{action.label}</span>\n                <Show when={action.shortcut}>\n                  <span class={styles.shortcut}>{action.shortcut}</span>\n                </Show>\n              </button>\n            </>\n          )}\n        </For>\n      </div>\n    </Portal>\n  );\n}\n","// Recursive component for rendering navigation tree nodes in the sidebar.\n\nimport { createSignal, createEffect, For, Show, on, untrack } from 'solid-js';\nimport { useI18n } from '../i18n';\nimport type { NodeResponse } from '@sdk/types.gen';\nimport { ContextMenu, type ContextMenuAction } from './shared';\nimport styles from './SidebarNode.module.css';\n\nimport DescriptionIcon from '@material-symbols/svg-400/outlined/description.svg?solid';\nimport TableChartIcon from '@material-symbols/svg-400/outlined/table_chart.svg?solid';\nimport ChevronRightIcon from '@material-symbols/svg-400/outlined/chevron_right.svg?solid';\nimport DeleteIcon from '@material-symbols/svg-400/outlined/delete.svg?solid';\nimport HistoryIcon from '@material-symbols/svg-400/outlined/history.svg?solid';\n\n// Module-level drag state (imperative, not reactive)\nlet dragState: { nodeId: string; element: HTMLElement } | null = null;\n\ninterface SidebarNodeProps {\n  node: NodeResponse;\n  selectedId: string | null;\n  ancestorIds: string[];\n  onSelect: (node: NodeResponse) => void;\n  onCreateChildPage: (parentId: string) => void;\n  onCreateChildTable: (parentId: string) => void;\n  onFetchChildren?: (nodeId: string) => Promise<void>;\n  onDeleteNode?: (nodeId: string) => void;\n  onShowHistory?: (nodeId: string) => void;\n  onMoveNode?: (nodeId: string, newParentId: string) => void;\n  depth: number;\n}\n\nexport default function SidebarNode(props: SidebarNodeProps) {\n  const { t } = useI18n();\n  // Start expanded if depth 0 OR if already an ancestor at mount time\n  const initialExpanded = untrack(() => props.depth === 0 || props.ancestorIds.includes(props.node.id));\n  const [isExpanded, setIsExpanded] = createSignal(initialExpanded);\n  const [showContextMenu, setShowContextMenu] = createSignal(false);\n  const [contextMenuPos, setContextMenuPos] = createSignal({ x: 0, y: 0 });\n  const [isLoadingChildren, setIsLoadingChildren] = createSignal(false);\n\n  // Children come directly from the store via props.node.children\n  const children = () => props.node.children ?? [];\n\n  // Check if this node might have children\n  const mightHaveChildren = () => {\n    if (props.node.children && props.node.children.length > 0) return true;\n    return props.node.has_children === true;\n  };\n\n  // Auto-expand when the selected node is a direct child of this node\n  createEffect(() => {\n    const selectedId = props.selectedId;\n    const nodeChildren = children();\n    if (selectedId && nodeChildren.some((child) => child.id === selectedId)) {\n      setIsExpanded(true);\n    }\n  });\n\n  // Auto-expand for direct URL navigation when ancestorIds becomes available\n  // Track whether we've auto-expanded to prevent re-expanding after user collapses\n  const [hasAutoExpanded, setHasAutoExpanded] = createSignal(false);\n  createEffect(\n    on(\n      () => props.ancestorIds.length,\n      (length, prevLength) => {\n        const wasEmpty = prevLength === undefined || prevLength === 0;\n        if (wasEmpty && length > 0 && !hasAutoExpanded() && props.ancestorIds.includes(props.node.id)) {\n          setHasAutoExpanded(true);\n          setIsExpanded(true);\n        }\n      }\n    )\n  );\n\n  // Fetch children when expanded and not yet loaded\n  createEffect(() => {\n    if (isExpanded() && mightHaveChildren() && !props.node.children && props.onFetchChildren) {\n      setIsLoadingChildren(true);\n      props.onFetchChildren(props.node.id).finally(() => setIsLoadingChildren(false));\n    }\n  });\n\n  const toggleExpand = (e: MouseEvent) => {\n    e.stopPropagation();\n    setIsExpanded(!isExpanded());\n  };\n\n  const handleContextMenu = (e: MouseEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n    setContextMenuPos({ x: e.clientX, y: e.clientY });\n    setShowContextMenu(true);\n  };\n\n  // Drag-and-drop state\n  let liRef!: HTMLLIElement;\n  const [isDragging, setIsDragging] = createSignal(false);\n  const [isDropTarget, setIsDropTarget] = createSignal(false);\n  let expandTimer: ReturnType<typeof setTimeout> | undefined;\n\n  const handleDragStart = (e: DragEvent) => {\n    if (!e.dataTransfer) return;\n    e.dataTransfer.effectAllowed = 'move';\n    e.dataTransfer.setData('text/plain', props.node.id);\n    dragState = { nodeId: props.node.id, element: liRef };\n    setIsDragging(true);\n  };\n\n  const handleDragEnd = () => {\n    dragState = null;\n    setIsDragging(false);\n    setIsDropTarget(false);\n    clearTimeout(expandTimer);\n  };\n\n  const handleDragOver = (e: DragEvent) => {\n    if (!dragState) return;\n    // Reject: dropping on self\n    if (dragState.nodeId === props.node.id) return;\n    // Reject: dropping on a visible descendant (DOM containment check)\n    if (dragState.element.contains(e.currentTarget as Node)) return;\n\n    e.preventDefault();\n    e.stopPropagation();\n    if (e.dataTransfer) e.dataTransfer.dropEffect = 'move';\n    setIsDropTarget(true);\n\n    // Auto-expand collapsed nodes with children after 600ms hover\n    if (!expandTimer && mightHaveChildren() && !isExpanded()) {\n      expandTimer = setTimeout(() => {\n        setIsExpanded(true);\n        if (!props.node.children && props.onFetchChildren) {\n          setIsLoadingChildren(true);\n          props.onFetchChildren(props.node.id).finally(() => setIsLoadingChildren(false));\n        }\n      }, 600);\n    }\n  };\n\n  const handleDragLeave = (e: DragEvent) => {\n    // Only clear if we're actually leaving this element, not entering a child\n    const related = e.relatedTarget as Node | null;\n    if (related && (e.currentTarget as Node).contains(related)) return;\n    setIsDropTarget(false);\n    clearTimeout(expandTimer);\n    expandTimer = undefined;\n  };\n\n  const handleDrop = (e: DragEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n    setIsDropTarget(false);\n    clearTimeout(expandTimer);\n    expandTimer = undefined;\n    if (dragState && dragState.nodeId !== props.node.id) {\n      props.onMoveNode?.(dragState.nodeId, props.node.id);\n    }\n  };\n\n  return (\n    <li ref={liRef} class={styles.sidebarNodeWrapper} data-testid={`sidebar-node-${props.node.id}`}>\n      <div\n        class={styles.pageItem}\n        classList={{\n          [`${styles.active}`]: props.selectedId === props.node.id,\n          [`${styles.dragging}`]: isDragging(),\n          [`${styles.dropTarget}`]: isDropTarget(),\n        }}\n        style={{ 'padding-left': `${props.depth * 12 + 8}px` }}\n        draggable=\"true\"\n        onClick={() => props.onSelect(props.node)}\n        onContextMenu={handleContextMenu}\n        onDragStart={handleDragStart}\n        onDragEnd={handleDragEnd}\n        onDragOver={handleDragOver}\n        onDragLeave={handleDragLeave}\n        onDrop={handleDrop}\n      >\n        <span\n          class={styles.iconSlot}\n          classList={{ [`${styles.hasChildren}`]: mightHaveChildren() }}\n          onClick={(e) => mightHaveChildren() && toggleExpand(e)}\n          data-testid={`expand-icon-${props.node.id}`}\n        >\n          <span class={styles.nodeIcon}>\n            {props.node.has_table && !props.node.has_page ? <TableChartIcon /> : <DescriptionIcon />}\n          </span>\n          <span\n            class={styles.expandIcon}\n            classList={{\n              [`${styles.expanded}`]: isExpanded(),\n              [`${styles.loading}`]: isLoadingChildren(),\n            }}\n          >\n            {isLoadingChildren() ? '' : <ChevronRightIcon />}\n          </span>\n        </span>\n        <span class={styles.pageTitleText}>{props.node.title}</span>\n        <button\n          class={styles.hoverDeleteButton}\n          data-testid=\"delete-node-button\"\n          onClick={(e) => {\n            e.stopPropagation();\n            props.onDeleteNode?.(props.node.id);\n          }}\n          title={t('common.delete') || 'Delete'}\n        >\n          <DeleteIcon />\n        </button>\n      </div>\n\n      <Show when={showContextMenu()}>\n        <ContextMenu\n          position={contextMenuPos()}\n          actions={\n            [\n              {\n                id: 'create-subpage',\n                label: t('app.createSubPage') || 'Create sub-page',\n                icon: <DescriptionIcon />,\n              },\n              {\n                id: 'create-subtable',\n                label: t('app.createSubTable') || 'Create sub-table',\n                icon: <TableChartIcon />,\n              },\n              {\n                id: 'history',\n                label: t('editor.history') || 'History',\n                icon: <HistoryIcon />,\n                separator: true,\n              },\n            ] as ContextMenuAction[]\n          }\n          onAction={(actionId) => {\n            switch (actionId) {\n              case 'create-subpage':\n                props.onCreateChildPage(props.node.id);\n                break;\n              case 'create-subtable':\n                props.onCreateChildTable(props.node.id);\n                break;\n              case 'history':\n                props.onShowHistory?.(props.node.id);\n                break;\n            }\n          }}\n          onClose={() => setShowContextMenu(false)}\n        />\n      </Show>\n\n      <Show when={isExpanded() && children().length > 0}>\n        <ul class={styles.childList}>\n          <For each={children()}>\n            {(child) => (\n              <SidebarNode\n                node={child}\n                selectedId={props.selectedId}\n                ancestorIds={props.ancestorIds}\n                onSelect={props.onSelect}\n                onCreateChildPage={props.onCreateChildPage}\n                onCreateChildTable={props.onCreateChildTable}\n                onFetchChildren={props.onFetchChildren}\n                onDeleteNode={props.onDeleteNode}\n                onShowHistory={props.onShowHistory}\n                onMoveNode={props.onMoveNode}\n                depth={props.depth + 1}\n              />\n            )}\n          </For>\n        </ul>\n      </Show>\n    </li>\n  );\n}\n","// Sidebar navigation component containing workspace selection and page tree.\n\nimport { createSignal, For, Show, createMemo } from 'solid-js';\nimport SidebarNode from './SidebarNode';\nimport { useI18n } from '../i18n';\nimport { useAuth } from '../contexts';\nimport { useWorkspace } from '../contexts';\nimport type { NodeResponse, WSMembershipResponse } from '@sdk/types.gen';\nimport { WSRoleAdmin } from '@sdk/types.gen';\nimport styles from './Sidebar.module.css';\n\nimport SettingsIcon from '@material-symbols/svg-400/outlined/settings.svg?solid';\nimport LeftPanelCloseIcon from '@material-symbols/svg-400/outlined/left_panel_close.svg?solid';\nimport ChevronRightIcon from '@material-symbols/svg-400/outlined/chevron_right.svg?solid';\nimport AddIcon from '@material-symbols/svg-400/outlined/add.svg?solid';\nimport DownloadIcon from '@material-symbols/svg-400/outlined/download.svg?solid';\n\ninterface OrgWithWorkspaces {\n  orgId: string;\n  orgName: string;\n  workspaces: WSMembershipResponse[];\n}\n\ninterface SidebarProps {\n  isOpen: boolean;\n  loading: boolean;\n  nodes: NodeResponse[];\n  selectedNodeId: string | null;\n  ancestorIds: string[];\n  onCreatePage: () => void;\n  onCreateTable: () => void;\n  onCreateChildPage: (parentId: string) => void;\n  onCreateChildTable: (parentId: string) => void;\n  onSelectNode: (node: NodeResponse) => void;\n  onCloseMobileSidebar: () => void;\n  onFetchChildren?: (nodeId: string) => Promise<void>;\n  onDeleteNode?: (nodeId: string) => void;\n  onShowHistory?: (nodeId: string) => void;\n  onOpenSettings: () => void;\n  onCreateWorkspace: () => void;\n  onImportFromNotion: () => void;\n  onMoveNode?: (nodeId: string, newParentId: string) => void;\n}\n\nexport default function Sidebar(props: SidebarProps) {\n  const { t } = useI18n();\n  const { user, wsApi, refreshUser } = useAuth();\n  const { switchWorkspace } = useWorkspace();\n  const [showOtherWorkspaces, setShowOtherWorkspaces] = createSignal(false);\n  const [isEditingName, setIsEditingName] = createSignal(false);\n  const [editNameValue, setEditNameValue] = createSignal('');\n  const [isSaving, setIsSaving] = createSignal(false);\n\n  const currentWsId = () => user()?.workspace_id || '';\n  const currentWsName = () => {\n    const u = user();\n    if (!u) return t('app.workspace');\n    const current = u.workspaces?.find((ws) => ws.workspace_id === u.workspace_id);\n    return current?.workspace_name || t('app.workspace');\n  };\n  const isAdmin = () => user()?.workspace_role === WSRoleAdmin;\n\n  const startEditingName = () => {\n    if (!isAdmin()) return;\n    setEditNameValue(currentWsName());\n    setIsEditingName(true);\n  };\n\n  const cancelEditingName = () => {\n    setIsEditingName(false);\n    setEditNameValue('');\n  };\n\n  const saveWorkspaceName = async () => {\n    const ws = wsApi();\n    const newName = editNameValue().trim();\n    if (!ws || !newName || newName === currentWsName()) {\n      cancelEditingName();\n      return;\n    }\n\n    try {\n      setIsSaving(true);\n      await ws.workspaces.updateWorkspace({ name: newName });\n      await refreshUser();\n      setIsEditingName(false);\n    } catch (err) {\n      console.error('Failed to update workspace name:', err);\n      // Keep edit mode open on error so user can retry or cancel\n    } finally {\n      setIsSaving(false);\n    }\n  };\n\n  const handleNameKeyDown = (e: KeyboardEvent) => {\n    if (e.key === 'Enter') {\n      e.preventDefault();\n      saveWorkspaceName();\n    } else if (e.key === 'Escape') {\n      e.preventDefault();\n      cancelEditingName();\n    }\n  };\n\n  // Group workspaces by organization\n  const groupedWorkspaces = createMemo((): OrgWithWorkspaces[] => {\n    const u = user();\n    if (!u) return [];\n\n    const orgMap = new Map<string, OrgWithWorkspaces>();\n    const organizations = u.organizations || [];\n    const workspaces = u.workspaces || [];\n\n    for (const org of organizations) {\n      orgMap.set(org.organization_id, {\n        orgId: org.organization_id,\n        orgName: org.organization_name || org.organization_id,\n        workspaces: [],\n      });\n    }\n\n    for (const ws of workspaces) {\n      const org = orgMap.get(ws.organization_id);\n      if (org) {\n        org.workspaces.push(ws);\n      }\n    }\n\n    return Array.from(orgMap.values()).filter((o) => o.workspaces.length > 0);\n  });\n\n  // Other workspaces (excluding current)\n  const otherWorkspaces = createMemo(() => {\n    const wsId = currentWsId();\n    return groupedWorkspaces().flatMap((org) => org.workspaces.filter((ws) => ws.workspace_id !== wsId));\n  });\n\n  const hasMultipleOrgs = createMemo(() => groupedWorkspaces().length > 1);\n\n  const handleSwitchWorkspace = (wsId: string) => {\n    if (wsId !== currentWsId()) {\n      switchWorkspace(wsId);\n    }\n  };\n\n  // Root drop zone for moving nodes to top level\n  const [isRootDropTarget, setIsRootDropTarget] = createSignal(false);\n\n  const handleRootDragOver = (e: DragEvent) => {\n    // Only accept when dragging directly over the <ul>, not bubbled from children\n    if (e.target !== e.currentTarget) return;\n    e.preventDefault();\n    if (e.dataTransfer) e.dataTransfer.dropEffect = 'move';\n    setIsRootDropTarget(true);\n  };\n\n  const handleRootDragLeave = (e: DragEvent) => {\n    if (e.target !== e.currentTarget) return;\n    setIsRootDropTarget(false);\n  };\n\n  const handleRootDrop = (e: DragEvent) => {\n    if (e.target !== e.currentTarget) return;\n    e.preventDefault();\n    setIsRootDropTarget(false);\n    const nodeId = e.dataTransfer?.getData('text/plain');\n    if (nodeId) {\n      props.onMoveNode?.(nodeId, '0');\n    }\n  };\n\n  return (\n    <aside class={`${styles.sidebar} ${props.isOpen ? styles.open : ''}`}>\n      {/* Current workspace header */}\n      <div class={styles.workspaceHeader}>\n        <Show\n          when={isEditingName()}\n          fallback={\n            <span\n              class={`${styles.workspaceName} ${isAdmin() ? styles.editable : ''}`}\n              onClick={startEditingName}\n              title={isAdmin() ? t('settings.clickToEditName') || 'Click to edit name' : undefined}\n            >\n              {currentWsName()}\n            </span>\n          }\n        >\n          <input\n            ref={(el) => setTimeout(() => el.focus(), 0)}\n            type=\"text\"\n            class={styles.workspaceNameInput}\n            value={editNameValue()}\n            onInput={(e) => setEditNameValue(e.target.value)}\n            onKeyDown={handleNameKeyDown}\n            onBlur={saveWorkspaceName}\n            disabled={isSaving()}\n          />\n        </Show>\n        <button\n          class={styles.settingsButton}\n          onClick={() => props.onOpenSettings()}\n          title={t('app.settings') || 'Settings'}\n          data-testid=\"workspace-settings-button\"\n        >\n          <SettingsIcon />\n        </button>\n        <button\n          class={styles.collapseButton}\n          onClick={() => props.onCloseMobileSidebar()}\n          title={t('app.collapseSidebar') || 'Collapse sidebar'}\n        >\n          <LeftPanelCloseIcon />\n        </button>\n      </div>\n\n      <Show when={props.loading && props.nodes.length === 0}>\n        <p class={styles.loading}>{t('common.loading')}</p>\n      </Show>\n\n      {/* Current workspace pages */}\n      <ul\n        class={styles.pageList}\n        classList={{ [`${styles.rootDropTarget}`]: isRootDropTarget() }}\n        onDragOver={handleRootDragOver}\n        onDragLeave={handleRootDragLeave}\n        onDrop={handleRootDrop}\n      >\n        <For each={props.nodes}>\n          {(node) => (\n            <SidebarNode\n              node={node}\n              selectedId={props.selectedNodeId}\n              ancestorIds={props.ancestorIds}\n              onSelect={props.onSelectNode}\n              onCreateChildPage={props.onCreateChildPage}\n              onCreateChildTable={props.onCreateChildTable}\n              onFetchChildren={props.onFetchChildren}\n              onDeleteNode={props.onDeleteNode}\n              onShowHistory={props.onShowHistory}\n              onMoveNode={props.onMoveNode}\n              depth={0}\n            />\n          )}\n        </For>\n      </ul>\n\n      {/* Other workspaces section */}\n      <div class={styles.otherWorkspaces}>\n        <Show when={otherWorkspaces().length > 0}>\n          <button class={styles.otherWorkspacesToggle} onClick={() => setShowOtherWorkspaces(!showOtherWorkspaces())}>\n            <span class={`${styles.toggleChevron} ${showOtherWorkspaces() ? styles.expanded : ''}`}>\n              <ChevronRightIcon />\n            </span>\n            {t('app.otherWorkspaces') || 'Other workspaces'}\n          </button>\n\n          <Show when={showOtherWorkspaces()}>\n            <div class={styles.otherWorkspacesList}>\n              <For each={groupedWorkspaces()}>\n                {(org) => (\n                  <>\n                    <Show when={hasMultipleOrgs()}>\n                      <div class={styles.orgLabel}>{org.orgName}</div>\n                    </Show>\n                    <For each={org.workspaces.filter((ws) => ws.workspace_id !== currentWsId())}>\n                      {(ws) => (\n                        <button\n                          class={styles.otherWorkspaceItem}\n                          onClick={() => handleSwitchWorkspace(ws.workspace_id)}\n                        >\n                          {ws.workspace_name || ws.workspace_id}\n                        </button>\n                      )}\n                    </For>\n                  </>\n                )}\n              </For>\n            </div>\n          </Show>\n        </Show>\n\n        {/* Actions */}\n        <div class={styles.sidebarActions}>\n          <button\n            class={styles.actionButton}\n            onClick={() => props.onCreateWorkspace()}\n            data-testid=\"create-workspace-button\"\n          >\n            <span class={styles.actionIcon}>\n              <AddIcon />\n            </span>\n            {t('createWorkspace.title') || 'Create workspace'}\n          </button>\n          <button\n            class={styles.actionButton}\n            onClick={() => props.onImportFromNotion()}\n            data-testid=\"import-notion-button\"\n          >\n            <span class={styles.actionIcon}>\n              <DownloadIcon />\n            </span>\n            {t('notionImport.title') || 'Import from Notion'}\n          </button>\n        </div>\n      </div>\n    </aside>\n  );\n}\n","// Composable for detecting clicks outside an element.\n\nimport { onMount, onCleanup } from 'solid-js';\n\n/**\n * Calls onClose when a click occurs outside the referenced element.\n *\n * @param getRef - Function returning the element to watch (or undefined if not mounted)\n * @param onClose - Callback to invoke when clicking outside\n *\n * @example\n * let menuRef: HTMLDivElement | undefined;\n * useClickOutside(() => menuRef, () => setIsOpen(false));\n * // ...\n * <div ref={menuRef}>...</div>\n */\nexport function useClickOutside(getRef: () => HTMLElement | undefined, onClose: () => void): void {\n  onMount(() => {\n    const handleClickOutside = (e: MouseEvent) => {\n      const el = getRef();\n      if (el && !el.contains(e.target as Node)) {\n        onClose();\n      }\n    };\n\n    document.addEventListener('mousedown', handleClickOutside);\n    onCleanup(() => {\n      document.removeEventListener('mousedown', handleClickOutside);\n    });\n  });\n}\n","// Dropdown menu for user profile and logout.\n\nimport { createSignal, Show } from 'solid-js';\nimport { useNavigate } from '@solidjs/router';\nimport { useI18n } from '../i18n';\nimport { useAuth } from '../contexts';\nimport { useClickOutside } from '../composables/useClickOutside';\nimport styles from './UserMenu.module.css';\n\ninterface UserMenuProps {\n  onProfile: () => void;\n}\n\nexport default function UserMenu(props: UserMenuProps) {\n  const navigate = useNavigate();\n  const { t } = useI18n();\n  const { user, logout } = useAuth();\n  const [isOpen, setIsOpen] = createSignal(false);\n  let menuRef: HTMLDivElement | undefined;\n\n  // Get avatar URL from OAuth identities (prefer first one with avatar)\n  const getAvatarUrl = () => {\n    const u = user();\n    if (!u) return null;\n    const identities = u.oauth_identities;\n    if (!identities) return null;\n    for (const identity of identities) {\n      if (identity.avatar_url) {\n        return identity.avatar_url;\n      }\n    }\n    return null;\n  };\n\n  // Get initials from user name\n  const getInitials = () => {\n    const u = user();\n    if (!u) return '';\n    const name = u.name || u.email || '';\n    const parts = name.split(/[\\s@]+/);\n    if (parts.length >= 2 && parts[0] && parts[1]) {\n      return ((parts[0][0] || '') + (parts[1][0] || '')).toUpperCase();\n    }\n    return name.slice(0, 2).toUpperCase();\n  };\n\n  const userName = () => user()?.name || '';\n  const userEmail = () => user()?.email || '';\n  const workspaceRole = () => user()?.workspace_role;\n\n  useClickOutside(\n    () => menuRef,\n    () => setIsOpen(false)\n  );\n\n  const handleLogout = async () => {\n    setIsOpen(false);\n    await logout();\n    navigate('/');\n  };\n\n  const handleProfile = () => {\n    setIsOpen(false);\n    props.onProfile();\n  };\n\n  return (\n    <div class={styles.userMenu} ref={menuRef}>\n      <button\n        class={styles.avatarButton}\n        onClick={() => setIsOpen(!isOpen())}\n        title={userName() || userEmail()}\n        aria-label={t('userMenu.profile') || 'User menu'}\n        aria-expanded={isOpen()}\n        aria-haspopup=\"menu\"\n        data-testid=\"user-menu-button\"\n      >\n        <Show when={getAvatarUrl()} fallback={<span class={styles.initials}>{getInitials()}</span>}>\n          {(url) => (\n            <img src={url()} alt={userName() || 'User'} class={styles.avatarImage} referrerPolicy=\"no-referrer\" />\n          )}\n        </Show>\n      </button>\n\n      <Show when={isOpen()}>\n        <div class={styles.dropdown} role=\"menu\">\n          <div class={styles.userInfo}>\n            <span class={styles.userName}>{userName()}</span>\n            <span class={styles.userEmail}>{userEmail()}</span>\n            <Show when={workspaceRole()}>\n              <span class={styles.userRole}>{workspaceRole()}</span>\n            </Show>\n          </div>\n          <div class={styles.divider} />\n          <button class={styles.menuItem} onClick={handleProfile} role=\"menuitem\">\n            {t('userMenu.profile')}\n          </button>\n          <button class={styles.menuItem} onClick={handleLogout} role=\"menuitem\">\n            {t('userMenu.logout')}\n          </button>\n        </div>\n      </Show>\n    </div>\n  );\n}\n","// Banner showing Notion import progress and completion status.\n\nimport { Show } from 'solid-js';\nimport { useI18n } from '../i18n';\nimport type { NotionImportStatusResponse } from '@sdk/types.gen';\nimport styles from './NotionImportBanner.module.css';\n\ninterface NotionImportBannerProps {\n  status: NotionImportStatusResponse;\n  onCancel: () => void;\n  onDismiss: () => void;\n}\n\nexport default function NotionImportBanner(props: NotionImportBannerProps) {\n  const { t } = useI18n();\n  const s = () => props.status;\n\n  const bannerClass = () => {\n    switch (s().status) {\n      case 'completed':\n        return `${styles.banner} ${styles.success}`;\n      case 'failed':\n        return `${styles.banner} ${styles.error}`;\n      case 'cancelled':\n        return `${styles.banner} ${styles.cancelled}`;\n      default:\n        return styles.banner;\n    }\n  };\n\n  const statusMessage = () => {\n    switch (s().status) {\n      case 'running':\n        return t('notionImport.importInProgress');\n      case 'completed':\n        return t('notionImport.importCompleted');\n      case 'failed':\n        return t('notionImport.importFailed');\n      case 'cancelled':\n        return t('notionImport.importCancelled');\n      default:\n        return '';\n    }\n  };\n\n  const icon = () => {\n    switch (s().status) {\n      case 'running':\n        return <span class={styles.spinner}>&#x21BB;</span>;\n      case 'completed':\n        return <span>&#x2713;</span>;\n      case 'failed':\n        return <span>&#x2717;</span>;\n      case 'cancelled':\n        return <span>&#x26A0;</span>;\n      default:\n        return null;\n    }\n  };\n\n  const isTerminal = () => ['completed', 'failed', 'cancelled'].includes(s().status);\n\n  return (\n    <div class={bannerClass()}>\n      <span class={styles.icon}>{icon()}</span>\n\n      <div class={styles.content}>\n        <span class={styles.message}>{statusMessage()}</span>\n\n        <Show when={s().status === 'running' && s().message}>\n          <span class={styles.progress}>\n            {s().progress}/{s().total}: {s().message}\n          </span>\n        </Show>\n\n        <Show when={isTerminal() && (s().pages || s().databases || s().records)}>\n          <div class={styles.stats}>\n            <Show when={s().pages}>\n              <span class={styles.stat}>\n                <span class={styles.statValue}>{s().pages}</span> {t('notionImport.pagesImported')}\n              </span>\n            </Show>\n            <Show when={s().databases}>\n              <span class={styles.stat}>\n                <span class={styles.statValue}>{s().databases}</span> {t('notionImport.databasesImported')}\n              </span>\n            </Show>\n            <Show when={s().records}>\n              <span class={styles.stat}>\n                <span class={styles.statValue}>{s().records}</span> {t('notionImport.recordsImported')}\n              </span>\n            </Show>\n            <Show when={s().assets}>\n              <span class={styles.stat}>\n                <span class={styles.statValue}>{s().assets}</span> {t('notionImport.assetsImported')}\n              </span>\n            </Show>\n            <Show when={s().errors}>\n              <span class={styles.stat}>\n                <span class={styles.statValue}>{s().errors}</span> {t('notionImport.errorsEncountered')}\n              </span>\n            </Show>\n          </div>\n        </Show>\n\n        <Show when={s().status === 'failed' && s().message}>\n          <span class={styles.progress}>{s().message}</span>\n        </Show>\n      </div>\n\n      <div class={styles.actions}>\n        <Show when={s().status === 'running'}>\n          <button class={styles.cancelButton} onClick={() => props.onCancel()}>\n            {t('notionImport.cancel')}\n          </button>\n        </Show>\n        <Show when={isTerminal()}>\n          <button class={styles.dismissButton} onClick={() => props.onDismiss()}>\n            {t('notionImport.dismiss')}\n          </button>\n        </Show>\n      </div>\n    </div>\n  );\n}\n","// Modal component for creating a new workspace.\n\nimport { createSignal, Show } from 'solid-js';\nimport { useI18n } from '../i18n';\nimport styles from './Onboarding.module.css';\n\ninterface CreateWorkspaceData {\n  name: string;\n}\n\ninterface CreateWorkspaceModalProps {\n  onClose: () => void;\n  onCreate: (data: CreateWorkspaceData) => Promise<void>;\n  isFirstWorkspace?: boolean;\n}\n\nexport default function CreateWorkspaceModal(props: CreateWorkspaceModalProps) {\n  const { t } = useI18n();\n  const [name, setName] = createSignal('');\n  const [loading, setLoading] = createSignal(false);\n  const [error, setError] = createSignal<string | null>(null);\n\n  const handleSubmit = async (e: Event) => {\n    e.preventDefault();\n    if (!name().trim()) return;\n\n    try {\n      setLoading(true);\n      setError(null);\n      await props.onCreate({\n        name: name().trim(),\n      });\n      props.onClose();\n    } catch (err) {\n      setError(String(err));\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleOverlayClick = (e: MouseEvent) => {\n    // Only allow closing by clicking overlay if not first workspace\n    if (!props.isFirstWorkspace && e.target === e.currentTarget) {\n      props.onClose();\n    }\n  };\n\n  return (\n    <div class={styles.overlay} onClick={handleOverlayClick}>\n      <div class={styles.modal}>\n        <header class={styles.header}>\n          <h2>{props.isFirstWorkspace ? t('createWorkspace.firstWorkspaceTitle') : t('createWorkspace.title')}</h2>\n          <p>\n            {props.isFirstWorkspace ? t('createWorkspace.firstWorkspaceDescription') : t('createWorkspace.description')}\n          </p>\n        </header>\n\n        {error() && <div class={styles.error}>{error()}</div>}\n\n        <form onSubmit={handleSubmit}>\n          <div class={styles.formGroup}>\n            <label>{t('createWorkspace.nameLabel')}</label>\n            <input\n              type=\"text\"\n              value={name()}\n              onInput={(e) => setName(e.target.value)}\n              placeholder={t('createWorkspace.namePlaceholder') || ''}\n              autofocus\n            />\n          </div>\n\n          <div class={styles.actions}>\n            <Show when={!props.isFirstWorkspace}>\n              <button type=\"button\" class={styles.secondaryButton} onClick={() => props.onClose()}>\n                {t('common.cancel')}\n              </button>\n            </Show>\n            <button\n              type=\"submit\"\n              class={styles.primaryButton}\n              disabled={!name().trim() || loading()}\n              style={props.isFirstWorkspace ? { flex: 1 } : undefined}\n            >\n              {loading() ? t('common.creating') : t('createWorkspace.create')}\n            </button>\n          </div>\n        </form>\n      </div>\n    </div>\n  );\n}\n","// Modal for importing a workspace from Notion.\n\nimport { createSignal, onCleanup, onMount } from 'solid-js';\nimport { useI18n } from '../i18n';\nimport styles from './NotionImportModal.module.css';\n\nexport interface NotionImportData {\n  notionToken: string;\n}\n\ninterface NotionImportModalProps {\n  onClose: () => void;\n  onImport: (data: NotionImportData) => Promise<void>;\n}\n\nconst NOTION_INTEGRATION_URL = 'https://www.notion.so/profile/integrations/form/new-integration';\n\nexport default function NotionImportModal(props: NotionImportModalProps) {\n  const { t } = useI18n();\n  const [notionToken, setNotionToken] = createSignal('');\n  const [loading, setLoading] = createSignal(false);\n  const [error, setError] = createSignal<string | null>(null);\n\n  const handleKeyDown = (e: KeyboardEvent) => {\n    if (e.key === 'Escape' && !loading()) {\n      props.onClose();\n    }\n  };\n\n  onMount(() => {\n    document.addEventListener('keydown', handleKeyDown);\n  });\n\n  onCleanup(() => {\n    document.removeEventListener('keydown', handleKeyDown);\n  });\n\n  const handleSubmit = async (e: Event) => {\n    e.preventDefault();\n    if (!notionToken().trim()) return;\n\n    try {\n      setLoading(true);\n      setError(null);\n      await props.onImport({\n        notionToken: notionToken().trim(),\n      });\n      props.onClose();\n    } catch (err) {\n      setError(String(err));\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleOverlayClick = (e: MouseEvent) => {\n    if (e.target === e.currentTarget) {\n      props.onClose();\n    }\n  };\n\n  return (\n    <div class={styles.overlay} onClick={handleOverlayClick}>\n      <div class={styles.modal}>\n        <header class={styles.header}>\n          <h2>{t('notionImport.title')}</h2>\n          <p>{t('notionImport.description')}</p>\n        </header>\n\n        {error() && <div class={styles.error}>{error()}</div>}\n\n        <div class={styles.setupBox}>\n          <div class={styles.setupHeader}>\n            <span class={styles.setupTitle}>{t('notionImport.setupTitle')}</span>\n            <a href={NOTION_INTEGRATION_URL} target=\"_blank\" rel=\"noopener noreferrer\" class={styles.createLink}>\n              {t('notionImport.createIntegration')} &#x2197;\n            </a>\n          </div>\n          <ol class={styles.setupSteps}>\n            <li>\n              {t('notionImport.step1Header')}\n              <ol class={styles.subSteps}>\n                <li>{t('notionImport.step1a')}</li>\n                <li>{t('notionImport.step1b')}</li>\n                <li>{t('notionImport.step1c')}</li>\n                <li>{t('notionImport.step1d')}</li>\n              </ol>\n            </li>\n            <li>\n              {t('notionImport.step2Header')}\n              <ol class={styles.subSteps}>\n                <li>{t('notionImport.step2a')}</li>\n                <li>{t('notionImport.step2b')}</li>\n              </ol>\n            </li>\n            <li>\n              {t('notionImport.step3Header')}\n              <ol class={styles.subSteps}>\n                <li>{t('notionImport.step3a')}</li>\n                <li>{t('notionImport.step3b')}</li>\n              </ol>\n            </li>\n          </ol>\n        </div>\n\n        <form onSubmit={handleSubmit}>\n          <div class={styles.formGroup}>\n            <label>{t('notionImport.notionToken')}</label>\n            <input\n              type=\"password\"\n              value={notionToken()}\n              onInput={(e) => setNotionToken(e.target.value)}\n              placeholder={t('notionImport.notionTokenPlaceholder') || ''}\n              autofocus\n            />\n          </div>\n\n          <div class={styles.actions}>\n            <button type=\"button\" class={styles.secondaryButton} onClick={() => props.onClose()}>\n              {t('common.cancel')}\n            </button>\n            <button type=\"submit\" class={styles.primaryButton} disabled={!notionToken().trim() || loading()}>\n              {loading() ? t('notionImport.importing') : t('notionImport.startImport')}\n            </button>\n          </div>\n        </form>\n      </div>\n    </div>\n  );\n}\n","// Workspace layout with header, sidebar, and content outlet.\n\nimport { createSignal, Show, For, onCleanup, type ParentComponent } from 'solid-js';\nimport { useNavigate } from '@solidjs/router';\nimport Sidebar from '../components/Sidebar';\nimport UserMenu from '../components/UserMenu';\nimport NotionImportBanner from '../components/NotionImportBanner';\nimport CreateWorkspaceModal from '../components/CreateWorkspaceModal';\nimport NotionImportModal, { type NotionImportData } from '../components/NotionImportModal';\nimport { useAuth, useWorkspace, useEditor } from '../contexts';\nimport { useI18n } from '../i18n';\nimport { settingsUrl, nodeUrl } from '../utils/urls';\nimport type { NodeResponse, NotionImportStatusResponse } from '@sdk/types.gen';\nimport styles from './WorkspaceSection.module.css';\n\nimport MenuIcon from '@material-symbols/svg-400/outlined/menu.svg?solid';\n\nconst WorkspaceLayout: ParentComponent = (props) => {\n  const { t } = useI18n();\n  const navigate = useNavigate();\n  const { user, wsApi, orgApi } = useAuth();\n  const {\n    nodes,\n    selectedNodeId,\n    breadcrumbPath,\n    loading,\n    setCreatingNode,\n    setDeletingNodeId,\n    loadError,\n    saveError,\n    setSaveError,\n    switchWorkspace,\n    createWorkspace,\n    loadNodes,\n    fetchNodeChildren,\n    removeNode,\n    moveNode,\n  } = useWorkspace();\n  const { flushAutoSave, loadHistory } = useEditor();\n\n  // UI state - sidebar open by default on desktop, closed on mobile\n  const [showMobileSidebar, setShowMobileSidebar] = createSignal(window.innerWidth > 768);\n  const [showCreateWorkspace, setShowCreateWorkspace] = createSignal(false);\n  const [showNotionImport, setShowNotionImport] = createSignal(false);\n  const [notionImportStatus, setNotionImportStatus] = createSignal<NotionImportStatusResponse | null>(null);\n  const [notionImportWsId, setNotionImportWsId] = createSignal<string | null>(null);\n  const [nodeCreationParentId, setNodeCreationParentId] = createSignal<string | null>(null);\n\n  // Notion import polling\n  let importPollInterval: number | undefined;\n\n  const startNotionImportPolling = (wsId: string) => {\n    setNotionImportWsId(wsId);\n    importPollInterval = window.setInterval(async () => {\n      const org = orgApi();\n      if (!org) return;\n      try {\n        const status = await org.notion.getStatus(wsId);\n        setNotionImportStatus(status);\n        if (['completed', 'failed', 'cancelled'].includes(status.status)) {\n          window.clearInterval(importPollInterval);\n          importPollInterval = undefined;\n          // Reload nodes if import completed\n          if (status.status === 'completed') {\n            loadNodes(true);\n          }\n        }\n      } catch {\n        window.clearInterval(importPollInterval);\n        importPollInterval = undefined;\n      }\n    }, 2000);\n  };\n\n  const handleNotionImport = async (data: NotionImportData) => {\n    const org = orgApi();\n    if (!org) return;\n    const result = await org.notion.startImport({\n      notion_token: data.notionToken,\n    });\n    // Switch to the new workspace (switchWorkspace navigates automatically)\n    await switchWorkspace(result.workspace_id);\n    // Start polling for import status\n    startNotionImportPolling(result.workspace_id);\n    setNotionImportStatus({ status: 'running', progress: 0, total: 0 });\n  };\n\n  const handleCancelNotionImport = async () => {\n    const ws = wsApi();\n    const wsId = notionImportWsId();\n    if (!ws || !wsId) return;\n    try {\n      await ws.notion.cancelImport();\n      setNotionImportStatus((prev) => (prev ? { ...prev, status: 'cancelled' } : null));\n    } catch {\n      // Ignore\n    }\n  };\n\n  const dismissNotionImportBanner = () => {\n    if (importPollInterval) {\n      window.clearInterval(importPollInterval);\n      importPollInterval = undefined;\n    }\n    setNotionImportStatus(null);\n    setNotionImportWsId(null);\n  };\n\n  onCleanup(() => {\n    if (importPollInterval) {\n      window.clearInterval(importPollInterval);\n    }\n  });\n\n  // Find a node's parent and siblings in the tree\n  function findNodeContext(\n    nodeId: string,\n    nodeList: NodeResponse[] = nodes,\n    parent: NodeResponse | null = null\n  ): { parent: NodeResponse | null; siblings: NodeResponse[]; index: number } | null {\n    const index = nodeList.findIndex((n) => n.id === nodeId);\n    if (index !== -1) {\n      return { parent, siblings: nodeList, index };\n    }\n    for (const node of nodeList) {\n      if (node.children) {\n        const result = findNodeContext(nodeId, node.children, node);\n        if (result) return result;\n      }\n    }\n    return null;\n  }\n\n  // Create node helper\n  async function createNode(type: 'document' | 'table' = 'document', parentId?: string) {\n    const ws = wsApi();\n    if (!ws) return;\n\n    try {\n      setCreatingNode(true);\n      const parent = parentId || nodeCreationParentId() || '0';\n      let newNodeId: string | number;\n      const defaultTitle =\n        type === 'table'\n          ? t('welcome.untitledTable') || 'Untitled Table'\n          : t('welcome.untitledPage') || 'Untitled Page';\n      if (type === 'table') {\n        const result = await ws.nodes.table.createTable(parent, {\n          title: defaultTitle,\n          properties: [{ name: 'Name', type: 'text', required: false }],\n        });\n        newNodeId = result.id;\n      } else {\n        const result = await ws.nodes.page.createPage(parent, { title: defaultTitle });\n        newNodeId = result.id;\n      }\n      await loadNodes(true);\n      const u = user();\n      const wsId = u?.workspace_id;\n      const wsName = u?.workspace_name;\n      if (wsId) {\n        navigate(nodeUrl(wsId, wsName, String(newNodeId), defaultTitle));\n      }\n      setSaveError(null);\n      setNodeCreationParentId(null);\n    } catch (err) {\n      setSaveError(`${t('errors.failedToCreate')}: ${err}`);\n    } finally {\n      setCreatingNode(false);\n    }\n  }\n\n  const handleNodeClick = (node: NodeResponse) => {\n    flushAutoSave();\n    const u = user();\n    const wsId = u?.workspace_id;\n    const wsName = u?.workspace_name;\n    if (wsId) {\n      navigate(nodeUrl(wsId, wsName, node.id, node.title));\n    }\n    // Only close sidebar on mobile\n    if (window.innerWidth <= 768) {\n      setShowMobileSidebar(false);\n    }\n  };\n\n  async function handleDeleteNode(nodeId: string) {\n    const ws = wsApi();\n    if (!ws) return;\n    if (!confirm(t('table.confirmDeleteRecord') || 'Delete this item?')) return;\n\n    // Find navigation target BEFORE deleting (if this is the selected node)\n    let nextNode: NodeResponse | null = null;\n    if (nodeId === selectedNodeId()) {\n      const ctx = findNodeContext(nodeId);\n      if (ctx) {\n        const { parent, siblings, index } = ctx;\n        if (parent && parent.id !== '0') {\n          nextNode = parent;\n        } else {\n          if (index > 0) {\n            nextNode = siblings[index - 1] ?? null;\n          } else if (siblings.length > 1) {\n            nextNode = siblings[1] ?? null;\n          }\n        }\n      }\n    }\n\n    try {\n      setDeletingNodeId(nodeId);\n      await ws.nodes.deleteNode(nodeId);\n      removeNode(nodeId);\n\n      if (nodeId === selectedNodeId()) {\n        const u = user();\n        const wsId = u?.workspace_id;\n        const wsName = u?.workspace_name;\n        if (nextNode && wsId) {\n          navigate(nodeUrl(wsId, wsName, nextNode.id, nextNode.title));\n        } else if (wsId) {\n          await loadNodes(true);\n          // Navigate to workspace root, let WorkspaceRoot handle redirect\n          navigate(`/w/@${wsId}+${wsName || 'workspace'}/`);\n        }\n      }\n      setSaveError(null);\n    } catch (err) {\n      setSaveError(`${t('errors.failedToDelete')}: ${err}`);\n    } finally {\n      setDeletingNodeId(null);\n    }\n  }\n\n  async function handleMoveNode(nodeId: string, newParentId: string) {\n    await moveNode(nodeId, newParentId);\n  }\n\n  return (\n    <div class={`${styles.app} ${showMobileSidebar() ? styles.sidebarOpen : ''}`}>\n      <Show when={notionImportStatus()} keyed>\n        {(status) => (\n          <NotionImportBanner\n            status={status}\n            onCancel={handleCancelNotionImport}\n            onDismiss={dismissNotionImportBanner}\n          />\n        )}\n      </Show>\n      <header class={styles.header}>\n        <div class={styles.headerLeft}>\n          <button\n            class={styles.hamburger}\n            onClick={() => setShowMobileSidebar(!showMobileSidebar())}\n            aria-label=\"Toggle menu\"\n          >\n            <MenuIcon />\n          </button>\n          <Show when={selectedNodeId()}>\n            <nav class={styles.breadcrumbs}>\n              <For each={breadcrumbPath()}>\n                {(crumb, i) => (\n                  <>\n                    <Show when={i() > 0}>\n                      <span class={styles.breadcrumbSeparator}>/</span>\n                    </Show>\n                    <span class={styles.breadcrumbItem} onClick={() => handleNodeClick(crumb)}>\n                      {crumb.title}\n                    </span>\n                  </>\n                )}\n              </For>\n            </nav>\n          </Show>\n        </div>\n        <div class={styles.userInfo}>\n          <UserMenu\n            onProfile={() => {\n              navigate(settingsUrl('user'));\n            }}\n          />\n        </div>\n      </header>\n\n      <div class={styles.container}>\n        <div\n          class={`${styles.mobileBackdrop} ${showMobileSidebar() ? styles.mobileBackdropVisible : ''}`}\n          onClick={() => setShowMobileSidebar(false)}\n        />\n        <Sidebar\n          isOpen={showMobileSidebar()}\n          loading={loading()}\n          nodes={nodes}\n          selectedNodeId={selectedNodeId()}\n          ancestorIds={breadcrumbPath().map((n) => n.id)}\n          onCreatePage={() => {\n            setNodeCreationParentId(null);\n            createNode('document');\n            setShowMobileSidebar(false);\n          }}\n          onCreateTable={() => {\n            setNodeCreationParentId(null);\n            createNode('table');\n            setShowMobileSidebar(false);\n          }}\n          onCreateChildPage={(parentId: string) => {\n            setNodeCreationParentId(parentId);\n            createNode('document', parentId);\n            setShowMobileSidebar(false);\n          }}\n          onCreateChildTable={(parentId: string) => {\n            setNodeCreationParentId(parentId);\n            createNode('table', parentId);\n            setShowMobileSidebar(false);\n          }}\n          onSelectNode={handleNodeClick}\n          onCloseMobileSidebar={() => setShowMobileSidebar(false)}\n          onFetchChildren={fetchNodeChildren}\n          onDeleteNode={handleDeleteNode}\n          onShowHistory={(nodeId: string) => {\n            const u = user();\n            const wsId = u?.workspace_id;\n            const wsName = u?.workspace_name;\n            if (nodeId !== selectedNodeId() && wsId) {\n              navigate(nodeUrl(wsId, wsName, nodeId));\n              // Load history after navigation settles\n              setTimeout(() => loadHistory(nodeId), 100);\n            } else {\n              loadHistory(nodeId);\n            }\n          }}\n          onOpenSettings={() => {\n            const wsId = user()?.workspace_id;\n            const wsName = user()?.workspace_name;\n            if (wsId) {\n              setShowMobileSidebar(false);\n              navigate(settingsUrl('workspace', wsId, wsName));\n            }\n          }}\n          onCreateWorkspace={() => setShowCreateWorkspace(true)}\n          onImportFromNotion={() => setShowNotionImport(true)}\n          onMoveNode={handleMoveNode}\n        />\n\n        <main class={styles.main}>\n          <Show when={loadError() || saveError()}>\n            <div class={styles.error} role=\"alert\" aria-live=\"polite\">\n              {loadError() || saveError()}\n            </div>\n          </Show>\n          {props.children}\n        </main>\n      </div>\n\n      <Show when={showCreateWorkspace()}>\n        <CreateWorkspaceModal\n          onClose={() => setShowCreateWorkspace(false)}\n          onCreate={createWorkspace}\n          isFirstWorkspace={true}\n        />\n      </Show>\n      <Show when={showNotionImport()}>\n        <NotionImportModal onClose={() => setShowNotionImport(false)} onImport={handleNotionImport} />\n      </Show>\n    </div>\n  );\n};\n\nexport default WorkspaceLayout;\n","// Workspace root component that redirects to the first node.\n\nimport { createEffect } from 'solid-js';\nimport { useNavigate, useParams } from '@solidjs/router';\nimport { useAuth, useWorkspace } from '../contexts';\nimport { nodeUrl, stripSlug } from '../utils/urls';\n\n/**\n * WorkspaceRoot handles the /w/:wsId/ route.\n * It redirects to the first node in the workspace or shows an empty state.\n */\nexport default function WorkspaceRoot() {\n  const navigate = useNavigate();\n  const params = useParams<{ wsId: string }>();\n  const { user } = useAuth();\n  const { nodes, loading } = useWorkspace();\n\n  // Redirect to first node when nodes are loaded\n  createEffect(() => {\n    if (loading()) return;\n\n    const nodeList = nodes;\n    if (nodeList.length > 0 && nodeList[0]) {\n      const firstNode = nodeList[0];\n      const u = user();\n      const wsId = u?.workspace_id || stripSlug(params.wsId);\n      const wsName = u?.workspace_name;\n      if (wsId) {\n        navigate(nodeUrl(wsId, wsName, firstNode.id, firstNode.title), { replace: true });\n      }\n    }\n  });\n\n  // Return null as we're just handling the redirect\n  return null;\n}\n","// Shared table row wrapper with drag handle and context menu.\n// Used across TableTable, TableGrid, TableGallery, and TableBoard views.\n\nimport { createSignal, Show, type ParentProps } from 'solid-js';\nimport { Dynamic } from 'solid-js/web';\nimport { RowHandle, ContextMenu, type ContextMenuAction } from '../shared';\nimport { useI18n } from '../../i18n';\nimport styles from './TableRow.module.css';\n\n/** MIME type for table record drag data */\nexport const TABLE_RECORD_MIME = 'application/x-table-record';\n\nexport interface TableRowProps extends ParentProps {\n  /** The record ID */\n  recordId: string;\n  /** Callback when record should be deleted */\n  onDelete?: (recordId: string) => void;\n  /** Callback when record should be duplicated */\n  onDuplicate?: (recordId: string) => void;\n  /** Callback when record should be opened */\n  onOpen?: (recordId: string) => void;\n  /** Callback when drag starts (for reordering) */\n  onDragStart?: (recordId: string, e: DragEvent) => void;\n  /** Callback when dragging over this row */\n  onDragOver?: (recordId: string, e: DragEvent) => void;\n  /** Callback when dropping on this row */\n  onDrop?: (recordId: string, e: DragEvent) => void;\n  /** Whether this row is currently being dragged */\n  isDragging?: boolean;\n  /** Whether to show the drop indicator above this row */\n  showDropIndicator?: boolean;\n  /** Additional CSS class for the row container */\n  class?: string;\n  /** Element type: 'div' for card views, 'tr' for table view */\n  as?: 'div' | 'tr';\n}\n\n/**\n * Table row wrapper component with integrated drag handle and context menu.\n * Provides consistent drag-and-drop behavior across all table views.\n */\nexport function TableRow(props: TableRowProps) {\n  const { t } = useI18n();\n  const [menuState, setMenuState] = createSignal<{ x: number; y: number } | null>(null);\n\n  // Build context menu actions based on available callbacks\n  const getActions = (): ContextMenuAction[] => {\n    const actions: ContextMenuAction[] = [];\n\n    if (props.onOpen) {\n      actions.push({\n        id: 'open',\n        label: t('table.openRecord') || 'Open',\n      });\n    }\n\n    if (props.onDuplicate) {\n      actions.push({\n        id: 'duplicate',\n        label: t('table.duplicateRecord') || 'Duplicate',\n        shortcut: 'D',\n      });\n    }\n\n    if (props.onDelete) {\n      actions.push({\n        id: 'delete',\n        label: t('table.deleteRecord') || 'Delete',\n        shortcut: '',\n        danger: true,\n        separator: actions.length > 0,\n      });\n    }\n\n    return actions;\n  };\n\n  const handleDragStart = (e: DragEvent, _rowId: string) => {\n    e.dataTransfer?.setData(TABLE_RECORD_MIME, props.recordId);\n    if (e.dataTransfer) {\n      e.dataTransfer.effectAllowed = 'move';\n    }\n    props.onDragStart?.(props.recordId, e);\n  };\n\n  const handleContextMenu = (e: MouseEvent, _rowId: string) => {\n    setMenuState({ x: e.clientX, y: e.clientY });\n  };\n\n  const handleAction = (actionId: string) => {\n    switch (actionId) {\n      case 'open':\n        props.onOpen?.(props.recordId);\n        break;\n      case 'duplicate':\n        props.onDuplicate?.(props.recordId);\n        break;\n      case 'delete':\n        props.onDelete?.(props.recordId);\n        break;\n    }\n    setMenuState(null);\n  };\n\n  const handleDragOver = (e: DragEvent) => {\n    e.preventDefault();\n    if (e.dataTransfer) {\n      e.dataTransfer.dropEffect = 'move';\n    }\n    props.onDragOver?.(props.recordId, e);\n  };\n\n  const handleDrop = (e: DragEvent) => {\n    e.preventDefault();\n    props.onDrop?.(props.recordId, e);\n  };\n\n  const containerClass = () =>\n    `${styles.row} row-with-handle ${props.isDragging ? styles.dragging : ''} ${props.class || ''}`.trim();\n\n  return (\n    <>\n      <Show when={props.showDropIndicator}>\n        <div class={styles.dropIndicator} />\n      </Show>\n      <Dynamic\n        component={props.as === 'tr' ? 'tr' : 'div'}\n        class={containerClass()}\n        onDragOver={handleDragOver}\n        onDrop={handleDrop}\n      >\n        <div class={styles.handleWrapper}>\n          <RowHandle rowId={props.recordId} onDragStart={handleDragStart} onContextMenu={handleContextMenu} />\n        </div>\n        {props.children}\n      </Dynamic>\n\n      <Show when={menuState()}>\n        {(state) => (\n          <ContextMenu\n            position={state()}\n            actions={getActions()}\n            onAction={handleAction}\n            onClose={() => setMenuState(null)}\n          />\n        )}\n      </Show>\n    </>\n  );\n}\n","// Table cell component with inline editing for different property types.\n\nimport { createSignal, Show, type Accessor } from 'solid-js';\nimport { For } from 'solid-js';\nimport {\n  type DataRecordResponse,\n  type Property,\n  PropertyTypeCheckbox,\n  PropertyTypeSelect,\n  PropertyTypeNumber,\n  PropertyTypeDate,\n} from '@sdk/types.gen';\nimport styles from './TableCell.module.css';\n\nexport interface TableCellProps {\n  record: DataRecordResponse;\n  column: Property;\n  isEditing: Accessor<boolean>;\n  onStartEdit: () => void;\n  onSave: (value: string) => void;\n  onCancel: () => void;\n}\n\n/**\n * Table cell with inline editing support.\n * Renders appropriate input based on column type when editing.\n */\nexport function TableCell(props: TableCellProps) {\n  const [editValue, setEditValue] = createSignal('');\n  const [editCancelled, setEditCancelled] = createSignal(false);\n  let inputRef: HTMLInputElement | HTMLSelectElement | undefined;\n\n  const getCellValue = () => {\n    return props.record.data[props.column.name] ?? '';\n  };\n\n  const handleClick = () => {\n    if (!props.isEditing()) {\n      setEditValue(String(getCellValue()));\n      setEditCancelled(false);\n      props.onStartEdit();\n    }\n  };\n\n  const renderCellContent = () => {\n    const value = getCellValue();\n\n    switch (props.column.type) {\n      case 'checkbox':\n        return value ? '\\u2713' : '';\n      case 'select':\n      case 'multi_select':\n        return String(value);\n      case 'date':\n        return value ? new Date(value as string).toLocaleDateString() : '';\n      case 'number':\n        return String(value);\n      default:\n        return String(value);\n    }\n  };\n\n  // Save on blur or Enter, cancel on Escape\n  const handleCellBlur = () => {\n    if (editCancelled()) {\n      setEditCancelled(false);\n      return;\n    }\n    handleCellSave();\n  };\n\n  const handleKeyDown = (e: KeyboardEvent) => {\n    if (e.key === 'Enter' && !e.shiftKey) {\n      e.preventDefault();\n      handleCellSave();\n    } else if (e.key === 'Escape') {\n      e.preventDefault();\n      setEditCancelled(true);\n      props.onCancel();\n    } else if (e.key === 'Tab') {\n      // Save current and let browser handle focus movement\n      handleCellSave();\n    }\n  };\n\n  const handleCellSave = () => {\n    if (editCancelled() || !props.isEditing()) {\n      return;\n    }\n    props.onSave(editValue());\n  };\n\n  // Read current value from input ref for saving\n  const getCurrentValue = () => {\n    if (!inputRef) return editValue();\n    if (inputRef instanceof HTMLInputElement && inputRef.type === 'checkbox') {\n      return String(inputRef.checked);\n    }\n    return inputRef.value;\n  };\n\n  const syncAndSave = () => {\n    setEditValue(getCurrentValue());\n    handleCellSave();\n  };\n\n  const syncAndBlur = () => {\n    setEditValue(getCurrentValue());\n    handleCellBlur();\n  };\n\n  const onKeyDown = (e: KeyboardEvent) => {\n    // Sync current value from input before handling key press\n    if (e.key === 'Enter' || e.key === 'Tab') {\n      setEditValue(getCurrentValue());\n    }\n    handleKeyDown(e);\n  };\n\n  const focusRef = (el: HTMLInputElement | HTMLSelectElement) => {\n    inputRef = el;\n    setTimeout(() => {\n      el.focus();\n      if (el instanceof HTMLInputElement && el.type === 'text') el.select();\n    }, 0);\n  };\n\n  const renderCellInput = () => {\n    const initialValue = editValue();\n\n    switch (props.column.type) {\n      case PropertyTypeCheckbox:\n        return (\n          <input\n            ref={focusRef}\n            type=\"checkbox\"\n            checked={initialValue === 'true'}\n            onChange={syncAndSave}\n            onKeyDown={onKeyDown}\n            class={styles.input}\n          />\n        );\n      case PropertyTypeSelect:\n        if (props.column.options && props.column.options.length > 0) {\n          return (\n            <select\n              ref={focusRef}\n              value={initialValue}\n              onChange={syncAndSave}\n              onBlur={syncAndBlur}\n              onKeyDown={onKeyDown}\n              class={styles.input}\n            >\n              <option value=\"\">--</option>\n              <For each={props.column.options}>{(option) => <option value={option.id}>{option.name}</option>}</For>\n            </select>\n          );\n        }\n        return (\n          <input\n            ref={focusRef}\n            type=\"text\"\n            value={initialValue}\n            onBlur={syncAndBlur}\n            onKeyDown={onKeyDown}\n            class={styles.input}\n          />\n        );\n      case PropertyTypeNumber:\n        return (\n          <input\n            ref={focusRef}\n            type=\"number\"\n            value={initialValue}\n            onBlur={syncAndBlur}\n            onKeyDown={onKeyDown}\n            class={styles.input}\n          />\n        );\n      case PropertyTypeDate:\n        return (\n          <input\n            ref={focusRef}\n            type=\"date\"\n            value={initialValue}\n            onBlur={syncAndBlur}\n            onKeyDown={onKeyDown}\n            class={styles.input}\n          />\n        );\n      default:\n        return (\n          <input\n            ref={focusRef}\n            type=\"text\"\n            value={initialValue}\n            onBlur={syncAndBlur}\n            onKeyDown={onKeyDown}\n            class={styles.input}\n          />\n        );\n    }\n  };\n\n  return (\n    <td class={`${styles.cell}${props.isEditing() ? ` ${styles.editing}` : ''}`} onClick={handleClick}>\n      <Show when={props.isEditing()} fallback={<div class={styles.cellContent}>{renderCellContent()}</div>}>\n        {renderCellInput()}\n      </Show>\n    </td>\n  );\n}\n","// Dropdown UI for adding a new column to a table.\n\nimport { createSignal, Show, For } from 'solid-js';\nimport type { Property, PropertyType } from '@sdk/types.gen';\nimport { useI18n } from '../../i18n';\nimport styles from './AddColumnDropdown.module.css';\n\n// Column types available for adding\nconst COLUMN_TYPES: { type: PropertyType; labelKey: string }[] = [\n  { type: 'text', labelKey: 'table.typeText' },\n  { type: 'number', labelKey: 'table.typeNumber' },\n  { type: 'checkbox', labelKey: 'table.typeCheckbox' },\n  { type: 'date', labelKey: 'table.typeDate' },\n  { type: 'select', labelKey: 'table.typeSelect' },\n  { type: 'url', labelKey: 'table.typeUrl' },\n  { type: 'email', labelKey: 'table.typeEmail' },\n];\n\nexport interface AddColumnDropdownProps {\n  onAddColumn: (column: Property) => void;\n}\n\n/**\n * Dropdown component for adding a new column to a table.\n * Shows a + button that expands into a form for column name and type.\n */\nexport function AddColumnDropdown(props: AddColumnDropdownProps) {\n  const { t } = useI18n();\n  const [showDropdown, setShowDropdown] = createSignal(false);\n  const [newColumnName, setNewColumnName] = createSignal('');\n  const [newColumnType, setNewColumnType] = createSignal<PropertyType>('text');\n\n  const handleAddColumn = () => {\n    const name = newColumnName().trim();\n    if (!name) return;\n\n    const newColumn: Property = {\n      name,\n      type: newColumnType(),\n      required: false,\n    };\n\n    props.onAddColumn(newColumn);\n    setNewColumnName('');\n    setNewColumnType('text');\n    setShowDropdown(false);\n  };\n\n  return (\n    <th class={styles.addColumnCell}>\n      <div class={styles.addColumnWrapper}>\n        <button\n          class={styles.addColumnBtn}\n          onClick={() => setShowDropdown(!showDropdown())}\n          title={t('table.addColumn') || 'Add Column'}\n        >\n          +\n        </button>\n        <Show when={showDropdown()}>\n          <div class={styles.addColumnDropdown}>\n            <input\n              type=\"text\"\n              placeholder={t('table.columnName') || 'Column Name'}\n              value={newColumnName()}\n              onInput={(e) => setNewColumnName(e.target.value)}\n              class={styles.columnNameInput}\n              autofocus\n            />\n            <select\n              value={newColumnType()}\n              onChange={(e) => setNewColumnType(e.target.value as PropertyType)}\n              class={styles.columnTypeSelect}\n            >\n              <For each={COLUMN_TYPES}>{(ct) => <option value={ct.type}>{t(ct.labelKey) || ct.type}</option>}</For>\n            </select>\n            <div class={styles.addColumnActions}>\n              <button class={styles.addColumnConfirm} onClick={handleAddColumn}>\n                {t('common.confirm') || 'Add'}\n              </button>\n              <button class={styles.addColumnCancel} onClick={() => setShowDropdown(false)}>\n                {t('common.cancel') || 'Cancel'}\n              </button>\n            </div>\n          </div>\n        </Show>\n      </div>\n    </th>\n  );\n}\n","// Notion-like table view with inline editing.\n\nimport { createSignal, For, Show } from 'solid-js';\nimport { type DataRecordResponse, type Property } from '@sdk/types.gen';\nimport styles from './TableTable.module.css';\nimport { RowHandle, ContextMenu, type ContextMenuAction } from './shared';\nimport { TABLE_RECORD_MIME } from './table/TableRow';\nimport { TableCell } from './table/TableCell';\nimport { AddColumnDropdown } from './table/AddColumnDropdown';\nimport { useI18n } from '../i18n';\n\ninterface TableTableProps {\n  tableId: string;\n  columns: Property[];\n  records: DataRecordResponse[];\n  onAddRecord?: (data: Record<string, unknown>) => void;\n  onUpdateRecord?: (recordId: string, data: Record<string, unknown>) => void;\n  onDeleteRecord?: (recordId: string) => void;\n  onDuplicateRecord?: (recordId: string) => void;\n  onOpenRecord?: (recordId: string) => void;\n  onAddColumn?: (column: Property) => void;\n  onLoadMore?: () => void;\n  hasMore?: boolean;\n}\n\nexport default function TableTable(props: TableTableProps) {\n  const { t } = useI18n();\n  const [editingCell, setEditingCell] = createSignal<{\n    recordId: string;\n    columnId: string;\n  } | null>(null);\n\n  // Row context menu state\n  const [menuState, setMenuState] = createSignal<{\n    recordId: string;\n    x: number;\n    y: number;\n  } | null>(null);\n\n  // Add a new empty row\n  const handleAddRow = () => {\n    if (props.onAddRecord && props.columns.length > 0) {\n      props.onAddRecord({});\n    }\n  };\n\n  // Row handle handlers\n  const handleRowDragStart = (e: DragEvent, recordId: string) => {\n    e.dataTransfer?.setData(TABLE_RECORD_MIME, recordId);\n    if (e.dataTransfer) {\n      e.dataTransfer.effectAllowed = 'move';\n    }\n  };\n\n  const handleRowDragOver = (e: DragEvent) => {\n    e.preventDefault();\n    if (e.dataTransfer) {\n      e.dataTransfer.dropEffect = 'move';\n    }\n  };\n\n  const handleRowContextMenu = (e: MouseEvent, recordId: string) => {\n    setMenuState({ recordId, x: e.clientX, y: e.clientY });\n  };\n\n  const getRowActions = (): ContextMenuAction[] => {\n    const actions: ContextMenuAction[] = [];\n\n    if (props.onOpenRecord) {\n      actions.push({\n        id: 'open',\n        label: t('table.openRecord') || 'Open',\n      });\n    }\n\n    if (props.onDuplicateRecord) {\n      actions.push({\n        id: 'duplicate',\n        label: t('table.duplicateRecord') || 'Duplicate',\n        shortcut: '\\u2318D',\n      });\n    }\n\n    if (props.onDeleteRecord) {\n      actions.push({\n        id: 'delete',\n        label: t('table.deleteRecord') || 'Delete',\n        shortcut: '\\u232B',\n        danger: true,\n        separator: actions.length > 0,\n      });\n    }\n\n    return actions;\n  };\n\n  const handleRowAction = (actionId: string) => {\n    const state = menuState();\n    if (!state) return;\n\n    switch (actionId) {\n      case 'open':\n        props.onOpenRecord?.(state.recordId);\n        break;\n      case 'duplicate':\n        props.onDuplicateRecord?.(state.recordId);\n        break;\n      case 'delete':\n        props.onDeleteRecord?.(state.recordId);\n        break;\n    }\n    setMenuState(null);\n  };\n\n  const handleCellSave = (recordId: string, columnName: string, value: string) => {\n    const column = props.columns.find((c) => c.name === columnName);\n    if (!column || !props.onUpdateRecord) {\n      setEditingCell(null);\n      return;\n    }\n\n    const record = props.records.find((r) => r.id === recordId);\n    if (!record) {\n      setEditingCell(null);\n      return;\n    }\n\n    const updatedData = { ...record.data };\n    updatedData[column.name] = value;\n\n    props.onUpdateRecord(recordId, updatedData);\n    setEditingCell(null);\n  };\n\n  return (\n    <div class={styles.container}>\n      <div class={styles.tableWrapper}>\n        <table class={styles.table}>\n          <thead>\n            <tr class={styles.headerRow}>\n              {/* Handle column header */}\n              <th class={styles.handleHeader} />\n              <Show when={props.onDeleteRecord}>\n                <th class={styles.actionsHeader} />\n              </Show>\n              <For each={props.columns}>\n                {(column) => (\n                  <th class={styles.headerCell}>\n                    {column.name}\n                    <Show when={column.required}>\n                      <span class={styles.required}>*</span>\n                    </Show>\n                  </th>\n                )}\n              </For>\n              <Show when={props.onAddColumn}>{(onAddColumn) => <AddColumnDropdown onAddColumn={onAddColumn()} />}</Show>\n            </tr>\n          </thead>\n          <tbody>\n            <For each={props.records}>\n              {(record) => (\n                <tr class={styles.row} onDragOver={handleRowDragOver}>\n                  {/* Handle cell */}\n                  <td class={styles.handleCell}>\n                    <RowHandle\n                      rowId={record.id}\n                      onDragStart={handleRowDragStart}\n                      onContextMenu={handleRowContextMenu}\n                    />\n                  </td>\n                  <Show when={props.onDeleteRecord}>\n                    <td class={styles.actionsCell}>\n                      <button\n                        class={styles.deleteBtn}\n                        onClick={() => props.onDeleteRecord?.(record.id)}\n                        title={t('table.deleteRecord') || 'Delete'}\n                      >\n                        {'\\u2715'}\n                      </button>\n                    </td>\n                  </Show>\n                  <For each={props.columns}>\n                    {(column) => {\n                      const isEditing = () =>\n                        editingCell()?.recordId === record.id && editingCell()?.columnId === column.name;\n\n                      return (\n                        <TableCell\n                          record={record}\n                          column={column}\n                          isEditing={isEditing}\n                          onStartEdit={() => setEditingCell({ recordId: record.id, columnId: column.name })}\n                          onSave={(value) => handleCellSave(record.id, column.name, value)}\n                          onCancel={() => setEditingCell(null)}\n                        />\n                      );\n                    }}\n                  </For>\n                </tr>\n              )}\n            </For>\n            {/* Add new row - click to add */}\n            <Show when={props.onAddRecord && props.columns.length > 0}>\n              <tr class={styles.newRow}>\n                <td\n                  class={styles.newRowPlaceholder}\n                  colSpan={props.columns.length + 1 + (props.onDeleteRecord ? 1 : 0) + (props.onAddColumn ? 1 : 0)}\n                  onClick={handleAddRow}\n                >\n                  + {t('table.addRecord') || 'New'}\n                </td>\n              </tr>\n            </Show>\n          </tbody>\n        </table>\n      </div>\n\n      <Show when={props.columns.length === 0}>\n        <div class={styles.empty}>\n          {t('table.noColumns')}\n          <Show when={props.onAddColumn}>\n            <span> {t('table.addColumnFirst') || 'Click + to add a column.'}</span>\n          </Show>\n        </div>\n      </Show>\n\n      <Show when={props.hasMore}>\n        <div class={styles.loadMore}>\n          <button onClick={() => props.onLoadMore?.()}>{t('table.loadMore')}</button>\n        </div>\n      </Show>\n\n      {/* Row context menu */}\n      <Show when={menuState()}>\n        {(state) => (\n          <ContextMenu\n            position={{ x: state().x, y: state().y }}\n            actions={getRowActions()}\n            onAction={handleRowAction}\n            onClose={() => setMenuState(null)}\n          />\n        )}\n      </Show>\n    </div>\n  );\n}\n","// Shared utilities for table views.\n\nimport type { DataRecordResponse } from '@sdk/types.gen';\n\n/**\n * Updates a single field in a record's data and calls the update callback.\n * No-op if value unchanged or callback not provided.\n */\nexport function updateRecordField(\n  record: DataRecordResponse,\n  fieldName: string,\n  newValue: string,\n  onUpdate?: (id: string, data: Record<string, unknown>) => void\n): void {\n  if (record.data[fieldName] === newValue || !onUpdate) return;\n  const newData = { ...record.data, [fieldName]: newValue };\n  onUpdate(record.id, newData);\n}\n\n/**\n * Handles Enter key to blur input (submit on Enter).\n */\nexport function handleEnterBlur(e: KeyboardEvent): void {\n  if (e.key === 'Enter') {\n    (e.currentTarget as HTMLInputElement).blur();\n  }\n}\n\n/**\n * Gets the display value for a record field, returning empty string if not found.\n */\nexport function getFieldValue(record: DataRecordResponse, fieldName: string | undefined): string {\n  if (!fieldName) return '';\n  const value = record.data[fieldName];\n  return value !== null && value !== undefined ? String(value) : '';\n}\n\n/**\n * Gets the title (first column) value for a record.\n */\nexport function getRecordTitle(record: DataRecordResponse, columns: { name: string }[]): string {\n  const firstCol = columns[0];\n  return firstCol ? getFieldValue(record, firstCol.name) : '';\n}\n","// Grid view for table records, displaying data in cards.\n\nimport { For } from 'solid-js';\nimport type { DataRecordResponse, Property } from '@sdk/types.gen';\nimport { updateRecordField, handleEnterBlur, getRecordTitle, getFieldValue } from './table/tableUtils';\nimport { TableRow } from './table/TableRow';\nimport { useI18n } from '../i18n';\nimport styles from './TableGrid.module.css';\n\ninterface TableGridProps {\n  records: DataRecordResponse[];\n  columns: Property[];\n  onUpdateRecord?: (id: string, data: Record<string, unknown>) => void;\n  onDeleteRecord: (id: string) => void;\n  onDuplicateRecord?: (id: string) => void;\n  onOpenRecord?: (id: string) => void;\n}\n\nexport default function TableGrid(props: TableGridProps) {\n  const { t } = useI18n();\n\n  return (\n    <div class={styles.grid}>\n      <For each={props.records}>\n        {(record) => (\n          <TableRow\n            recordId={record.id}\n            onDelete={props.onDeleteRecord}\n            onDuplicate={props.onDuplicateRecord}\n            onOpen={props.onOpenRecord}\n            class={styles.card}\n          >\n            <div class={styles.cardHeader}>\n              <strong>\n                <input\n                  type=\"text\"\n                  value={getRecordTitle(record, props.columns)}\n                  placeholder={t('table.untitled') || 'Untitled'}\n                  onBlur={(e) =>\n                    props.columns[0] &&\n                    updateRecordField(record, props.columns[0].name, e.target.value, props.onUpdateRecord)\n                  }\n                  onKeyDown={handleEnterBlur}\n                  class={styles.titleInput}\n                />\n              </strong>\n            </div>\n            <div class={styles.cardBody}>\n              <For each={props.columns.slice(1, 4)}>\n                {(col) => (\n                  <div class={styles.field}>\n                    <span class={styles.fieldName}>{col.name}:</span>\n                    <input\n                      type=\"text\"\n                      value={getFieldValue(record, col.name)}\n                      onBlur={(e) => updateRecordField(record, col.name, e.target.value, props.onUpdateRecord)}\n                      onKeyDown={handleEnterBlur}\n                      class={styles.fieldValueInput}\n                    />\n                  </div>\n                )}\n              </For>\n            </div>\n          </TableRow>\n        )}\n      </For>\n    </div>\n  );\n}\n","// Gallery view for table records, emphasizing images.\n\nimport { For, Show } from 'solid-js';\nimport type { DataRecordResponse, Property } from '@sdk/types.gen';\nimport { updateRecordField, handleEnterBlur, getRecordTitle, getFieldValue } from './table/tableUtils';\nimport { TableRow } from './table/TableRow';\nimport { useI18n } from '../i18n';\nimport styles from './TableGallery.module.css';\n\ninterface TableGalleryProps {\n  records: DataRecordResponse[];\n  columns: Property[];\n  onUpdateRecord?: (id: string, data: Record<string, unknown>) => void;\n  onDeleteRecord: (id: string) => void;\n  onDuplicateRecord?: (id: string) => void;\n  onOpenRecord?: (id: string) => void;\n}\n\nexport default function TableGallery(props: TableGalleryProps) {\n  const { t } = useI18n();\n\n  // Try to find an image column\n  const imageColumn = () =>\n    props.columns.find(\n      (c) =>\n        c.name.toLowerCase().includes('image') ||\n        c.name.toLowerCase().includes('cover') ||\n        c.name.toLowerCase().includes('url')\n    );\n\n  return (\n    <div class={styles.gallery}>\n      <For each={props.records}>\n        {(record) => {\n          const imgCol = imageColumn();\n          return (\n            <TableRow\n              recordId={record.id}\n              onDelete={props.onDeleteRecord}\n              onDuplicate={props.onDuplicateRecord}\n              onOpen={props.onOpenRecord}\n              class={styles.card}\n            >\n              <Show when={imgCol}>\n                {(col) => (\n                  <div class={styles.imageContainer}>\n                    <Show\n                      when={record.data[col().name]}\n                      fallback={<div class={styles.imagePlaceholder}>{t('table.noImage')}</div>}\n                    >\n                      <img\n                        src={String(record.data[col().name])}\n                        alt={getRecordTitle(record, props.columns) || 'Record'}\n                        class={styles.image}\n                      />\n                    </Show>\n                  </div>\n                )}\n              </Show>\n              <div class={styles.cardContent}>\n                <div class={styles.cardHeader}>\n                  <strong>\n                    <input\n                      type=\"text\"\n                      value={getRecordTitle(record, props.columns)}\n                      placeholder={t('table.untitled') || 'Untitled'}\n                      onBlur={(e) =>\n                        props.columns[0] &&\n                        updateRecordField(record, props.columns[0].name, e.target.value, props.onUpdateRecord)\n                      }\n                      onKeyDown={handleEnterBlur}\n                      class={styles.titleInput}\n                    />\n                  </strong>\n                </div>\n                <div class={styles.cardBody}>\n                  <For each={props.columns.slice(1, 3)}>\n                    {(col) => (\n                      <div class={styles.field}>\n                        <span class={styles.fieldName}>{col.name}:</span>\n                        <input\n                          type=\"text\"\n                          value={getFieldValue(record, col.name)}\n                          onBlur={(e) => updateRecordField(record, col.name, e.target.value, props.onUpdateRecord)}\n                          onKeyDown={handleEnterBlur}\n                          class={styles.fieldValueInput}\n                        />\n                      </div>\n                    )}\n                  </For>\n                </div>\n              </div>\n            </TableRow>\n          );\n        }}\n      </For>\n    </div>\n  );\n}\n","// Kanban board view for table records, grouped by select/multi-select columns.\n\nimport { For, Show, createMemo } from 'solid-js';\nimport { type DataRecordResponse, type Property, PropertyTypeSelect, PropertyTypeMultiSelect } from '@sdk/types.gen';\nimport { updateRecordField, handleEnterBlur, getRecordTitle, getFieldValue } from './table/tableUtils';\nimport { TableRow } from './table/TableRow';\nimport { useI18n } from '../i18n';\nimport styles from './TableBoard.module.css';\n\ninterface TableBoardProps {\n  records: DataRecordResponse[];\n  columns: Property[];\n  onUpdateRecord?: (id: string, data: Record<string, unknown>) => void;\n  onDeleteRecord: (id: string) => void;\n  onDuplicateRecord?: (id: string) => void;\n  onOpenRecord?: (id: string) => void;\n}\n\nexport default function TableBoard(props: TableBoardProps) {\n  const { t } = useI18n();\n\n  // Find the first select column to group by (memoized for performance)\n  const groupColumn = createMemo(() =>\n    props.columns.find((c) => c.type === PropertyTypeSelect || c.type === PropertyTypeMultiSelect)\n  );\n\n  const groups = createMemo(() => {\n    const col = groupColumn();\n    if (!col) return [{ name: 'All Records', records: props.records, fromOptions: true }];\n\n    const grouped: Record<string, { name: string; records: DataRecordResponse[]; fromOptions?: boolean }> = {};\n\n    // Initialize groups from column options if available\n    if (col.options) {\n      col.options.forEach((opt) => {\n        grouped[opt.id] = { name: opt.name, records: [], fromOptions: true };\n      });\n    }\n\n    // Add \"No Group\" for records without a value\n    grouped['__none__'] = { name: t('table.noGroup') || 'No Group', records: [], fromOptions: true };\n\n    props.records.forEach((record) => {\n      const val = record.data[col.name];\n      if (val && typeof val === 'string') {\n        if (!grouped[val]) {\n          grouped[val] = { name: val, records: [] };\n        }\n        grouped[val].records.push(record);\n      } else {\n        grouped['__none__']?.records.push(record);\n      }\n    });\n\n    // Filter to show groups with records, plus empty groups from options\n    return Object.values(grouped).filter((g) => g.records.length > 0 || g.fromOptions);\n  });\n\n  return (\n    <div class={styles.board}>\n      <Show when={groupColumn()} fallback={<div class={styles.noGroup}>{t('table.addSelectColumn')}</div>}>\n        <div class={styles.columns}>\n          <For each={groups()}>\n            {(group) => (\n              <div class={styles.column}>\n                <div class={styles.columnHeader}>\n                  <span class={styles.columnName}>{group.name}</span>\n                  <span class={styles.columnCount}>{group.records.length}</span>\n                </div>\n                <div class={styles.cards}>\n                  <For each={group.records}>\n                    {(record) => (\n                      <TableRow\n                        recordId={record.id}\n                        onDelete={props.onDeleteRecord}\n                        onDuplicate={props.onDuplicateRecord}\n                        onOpen={props.onOpenRecord}\n                        class={styles.card}\n                      >\n                        <div class={styles.cardHeader}>\n                          <strong>\n                            <input\n                              type=\"text\"\n                              value={getRecordTitle(record, props.columns)}\n                              placeholder={t('table.untitled') || 'Untitled'}\n                              onBlur={(e) =>\n                                props.columns[0] &&\n                                updateRecordField(record, props.columns[0].name, e.target.value, props.onUpdateRecord)\n                              }\n                              onKeyDown={handleEnterBlur}\n                              class={styles.titleInput}\n                            />\n                          </strong>\n                        </div>\n                        <div class={styles.cardBody}>\n                          <For each={props.columns.slice(1, 4).filter((c) => c.name !== groupColumn()?.name)}>\n                            {(col) => (\n                              <div class={styles.field}>\n                                <span class={styles.fieldName}>{col.name}:</span>\n                                <input\n                                  type=\"text\"\n                                  value={getFieldValue(record, col.name)}\n                                  onBlur={(e) =>\n                                    updateRecordField(record, col.name, e.target.value, props.onUpdateRecord)\n                                  }\n                                  onKeyDown={handleEnterBlur}\n                                  class={styles.fieldValueInput}\n                                />\n                              </div>\n                            )}\n                          </For>\n                        </div>\n                      </TableRow>\n                    )}\n                  </For>\n                </div>\n              </div>\n            )}\n          </For>\n        </div>\n      </Show>\n    </div>\n  );\n}\n","// Horizontal tabs for switching between saved table views.\n\nimport { createSignal, For, Show } from 'solid-js';\nimport { useRecords } from '../../contexts';\nimport { useI18n } from '../../i18n';\nimport type { View, ViewType } from '@sdk/types.gen';\nimport styles from './ViewTabs.module.css';\n\nimport TableRowsIcon from '@material-symbols/svg-400/outlined/table_rows.svg?solid';\nimport GridGoldenratioIcon from '@material-symbols/svg-400/outlined/grid_goldenratio.svg?solid';\nimport GridViewIcon from '@material-symbols/svg-400/outlined/grid_view.svg?solid';\nimport ViewStreamIcon from '@material-symbols/svg-400/outlined/view_stream.svg?solid';\nimport CalendarMonthIcon from '@material-symbols/svg-400/outlined/calendar_month.svg?solid';\nimport AddIcon from '@material-symbols/svg-400/outlined/add.svg?solid';\n\n// Icons for each view type\nconst VIEW_ICONS: Record<ViewType, SolidSVG> = {\n  table: TableRowsIcon,\n  board: GridGoldenratioIcon,\n  gallery: GridViewIcon,\n  list: ViewStreamIcon,\n  calendar: CalendarMonthIcon,\n};\n\nexport default function ViewTabs() {\n  const { t } = useI18n();\n  const { views, activeViewId, setActiveViewId, createView, deleteView } = useRecords();\n\n  const [showNewViewMenu, setShowNewViewMenu] = createSignal(false);\n  const [contextMenuView, setContextMenuView] = createSignal<View | null>(null);\n  const [contextMenuPos, setContextMenuPos] = createSignal<{ x: number; y: number } | null>(null);\n\n  const handleTabClick = (viewId: string) => {\n    setActiveViewId(viewId);\n  };\n\n  const handleNewView = (type: ViewType) => {\n    const name = t('table.newView') || 'New View';\n    createView(name, type);\n    setShowNewViewMenu(false);\n  };\n\n  const handleContextMenu = (e: MouseEvent, view: View) => {\n    e.preventDefault();\n    setContextMenuView(view);\n    setContextMenuPos({ x: e.clientX, y: e.clientY });\n  };\n\n  const handleDeleteView = () => {\n    const view = contextMenuView();\n    if (view) {\n      deleteView(view.id);\n    }\n    setContextMenuView(null);\n    setContextMenuPos(null);\n  };\n\n  const closeContextMenu = () => {\n    setContextMenuView(null);\n    setContextMenuPos(null);\n  };\n\n  // Close menus when clicking outside\n  const handleClickOutside = () => {\n    setShowNewViewMenu(false);\n    closeContextMenu();\n  };\n\n  return (\n    <div class={styles.container}>\n      <div class={styles.tabs}>\n        <For each={views()}>\n          {(view) => {\n            const Icon = VIEW_ICONS[view.type] || TableRowsIcon;\n            return (\n              <button\n                class={styles.tab}\n                classList={{ [`${styles.active}`]: view.id === activeViewId() }}\n                onClick={() => handleTabClick(view.id)}\n                onContextMenu={(e) => handleContextMenu(e, view)}\n                title={view.name}\n              >\n                <span class={styles.icon}>\n                  <Icon />\n                </span>\n                <span class={styles.name}>{view.name}</span>\n                <Show when={view.default}>\n                  <span class={styles.defaultBadge}>{t('table.defaultView') || 'Default'}</span>\n                </Show>\n              </button>\n            );\n          }}\n        </For>\n\n        <div class={styles.addWrapper}>\n          <button\n            class={styles.addButton}\n            onClick={() => setShowNewViewMenu(!showNewViewMenu())}\n            title={t('table.newView') || 'New View'}\n            data-testid=\"add-view-button\"\n          >\n            <AddIcon />\n          </button>\n\n          <Show when={showNewViewMenu()}>\n            <div class={styles.dropdown} data-testid=\"view-type-menu\">\n              <button onClick={() => handleNewView('table')} data-testid=\"view-type-table\">\n                <span class={styles.icon}>\n                  <TableRowsIcon />\n                </span>\n                {t('table.table')}\n              </button>\n              <button onClick={() => handleNewView('list')} data-testid=\"view-type-list\">\n                <span class={styles.icon}>\n                  <ViewStreamIcon />\n                </span>\n                {t('table.list')}\n              </button>\n              <button onClick={() => handleNewView('gallery')} data-testid=\"view-type-gallery\">\n                <span class={styles.icon}>\n                  <GridViewIcon />\n                </span>\n                {t('table.gallery')}\n              </button>\n              <button onClick={() => handleNewView('board')} data-testid=\"view-type-board\">\n                <span class={styles.icon}>\n                  <GridGoldenratioIcon />\n                </span>\n                {t('table.board')}\n              </button>\n            </div>\n          </Show>\n        </div>\n      </div>\n\n      {/* Context menu for view actions */}\n      <Show when={contextMenuPos()}>\n        {(pos) => (\n          <Show when={contextMenuView()}>\n            <div class={styles.overlay} onClick={handleClickOutside} />\n            <div class={styles.contextMenu} style={{ left: `${pos().x}px`, top: `${pos().y}px` }}>\n              <button class={styles.deleteAction} onClick={handleDeleteView}>\n                {t('common.delete')}\n              </button>\n            </div>\n          </Show>\n        )}\n      </Show>\n\n      {/* Overlay for dropdown */}\n      <Show when={showNewViewMenu()}>\n        <div class={styles.overlay} onClick={handleClickOutside} />\n      </Show>\n    </div>\n  );\n}\n","// Component for rendering Markdown content with custom plugins.\n\nimport MarkdownIt from 'markdown-it';\nimport DOMPurify from 'dompurify';\nimport type { AssetUrlMap } from '../contexts/EditorContext';\nimport styles from './MarkdownPreview.module.css';\n\n// Internal links start with \"/\" but not \"/api/\" (which are backend endpoints)\nconst isInternalLink = (href: string) => href.startsWith('/') && !href.startsWith('/api/');\n\ninterface MarkdownPreviewProps {\n  content: string;\n  assetUrls?: AssetUrlMap;\n  onNavigate?: (href: string) => void;\n}\n\nconst md = new MarkdownIt({\n  html: true,\n  linkify: true,\n  typographer: true,\n});\n\n// Add core rule to detect checkbox syntax in list items\nmd.core.ruler.after('inline', 'task_list', (state) => {\n  const tokens = state.tokens;\n  for (let i = 0; i < tokens.length; i++) {\n    const token = tokens[i];\n    if (!token) continue;\n    if (token.type === 'list_item_open') {\n      // Look for inline content in this list item\n      const inlineToken = tokens[i + 2];\n      if (inlineToken && inlineToken.type === 'inline' && inlineToken.children) {\n        const firstChild = inlineToken.children[0];\n        if (firstChild && firstChild.type === 'text' && firstChild.content) {\n          const match = firstChild.content.match(/^\\[([ xX])\\]\\s*/);\n          if (match && match[1]) {\n            // Set attributes on list_item_open token\n            token.attrSet('class', 'task-list-item');\n            token.attrSet('data-checked', match[1].toLowerCase() === 'x' ? 'true' : 'false');\n            // Remove checkbox syntax from text and add checkbox input\n            firstChild.content = firstChild.content.slice(match[0].length);\n            // Insert checkbox token at the beginning of inline children\n            const checkboxToken = new state.Token('checkbox', '', 0);\n            checkboxToken.attrSet('checked', match[1].toLowerCase() === 'x' ? 'true' : 'false');\n            inlineToken.children.unshift(checkboxToken);\n          }\n        }\n      }\n    }\n  }\n  return true;\n});\n\n// Custom renderer for checkbox token\nmd.renderer.rules.checkbox = (tokens, idx) => {\n  const token = tokens[idx];\n  if (!token) return '';\n  const isChecked = token.attrGet('checked') === 'true';\n  return `<input type=\"checkbox\" class=\"task-checkbox\" disabled${isChecked ? ' checked' : ''}> `;\n};\n\n// Custom renderer for images to support signed asset URLs\nconst originalImageRenderer =\n  md.renderer.rules.image ||\n  function (tokens, idx, options, _env, self) {\n    return self.renderToken(tokens, idx, options);\n  };\n\nmd.renderer.rules.image = (tokens, idx, options, env, self) => {\n  const token = tokens[idx];\n  if (!token) {\n    return originalImageRenderer(tokens, idx, options, env, self);\n  }\n  const srcIndex = token.attrIndex('src');\n  const attrs = token.attrs;\n  const assetUrls = env?.assetUrls as AssetUrlMap | undefined;\n  const srcAttr = attrs?.[srcIndex];\n  if (srcAttr && assetUrls) {\n    const src = srcAttr[1];\n    // If it's a local filename (not a URL or absolute path), look up signed URL\n    if (!src.includes('://') && !src.startsWith('/')) {\n      const signedUrl = assetUrls[src];\n      if (signedUrl) {\n        srcAttr[1] = signedUrl;\n      }\n    }\n  }\n  return originalImageRenderer(tokens, idx, options, env, self);\n};\n\nexport default function MarkdownPreview(props: MarkdownPreviewProps) {\n  const html = () => {\n    const rawHtml = md.render(props.content, { assetUrls: props.assetUrls });\n    return DOMPurify.sanitize(rawHtml);\n  };\n\n  // Handle link clicks: internal links use client-side navigation, external links open in new tab\n  const handleClick = (e: MouseEvent) => {\n    const target = e.target as HTMLElement;\n    const anchor = target.closest('a');\n    if (!anchor) return;\n\n    const href = anchor.getAttribute('href');\n    if (!href) return;\n\n    // Internal links - use client-side navigation if handler provided\n    if (isInternalLink(href) && props.onNavigate) {\n      e.preventDefault();\n      props.onNavigate(href);\n      return;\n    }\n\n    // External links - open in new tab\n    if (href.startsWith('http://') || href.startsWith('https://')) {\n      e.preventDefault();\n      window.open(href, '_blank', 'noopener,noreferrer');\n    }\n  };\n\n  return (\n    // eslint-disable-next-line solid/no-innerhtml -- sanitized via DOMPurify\n    <div class={styles.preview} innerHTML={html()} onClick={handleClick} role=\"region\" aria-label=\"Markdown preview\" />\n  );\n}\n","// Node view component displaying editor or table based on node type.\n\nimport { createEffect, createMemo, Show, For, Suspense, lazy, createSignal } from 'solid-js';\nimport { useParams, useNavigate } from '@solidjs/router';\nimport TableTable from '../components/TableTable';\nimport TableGrid from '../components/TableGrid';\nimport TableGallery from '../components/TableGallery';\nimport TableBoard from '../components/TableBoard';\nimport ViewTabs from '../components/table/ViewTabs';\nimport MarkdownPreview from '../components/MarkdownPreview';\nimport { useAuth, useWorkspace, useEditor, useRecords } from '../contexts';\nimport { useI18n } from '../i18n';\nimport { nodeUrl, stripSlug } from '../utils/urls';\nimport { relativeLinksToSpaUrls } from '../utils/markdown-utils';\nimport type { Property, Commit } from '@sdk/types.gen';\nimport styles from './WorkspaceSection.module.css';\n\nconst Editor = lazy(() => import('../components/editor/Editor'));\n\nexport default function NodeView() {\n  const { t } = useI18n();\n  const navigate = useNavigate();\n  const params = useParams<{ wsId: string; nodeId: string }>();\n  const { user, token, wsApi } = useAuth();\n  const { selectedNodeId, selectedNodeData, setSavingNodeId, setLoadError, setSaveError, loadNode } = useWorkspace();\n  const {\n    title,\n    content,\n    hasUnsavedChanges,\n    autoSaveStatus,\n    assetUrls,\n    showHistory,\n    history,\n    flushAutoSave,\n    handleTitleChange,\n    handleContentChange,\n    linkedNodeTitles,\n  } = useEditor();\n  const { records, hasMore, loadMoreRecords, addRecord, updateRecord, deleteRecord, views, activeViewId } =\n    useRecords();\n\n  const [previewContent, setPreviewContent] = createSignal<string | null>(null);\n  const [previewCommit, setPreviewCommit] = createSignal<Commit | null>(null);\n\n  // Derive view type from active view in RecordsContext\n  const activeView = createMemo(() => views().find((v) => v.id === activeViewId()));\n  const viewType = createMemo(() => activeView()?.type || 'table');\n\n  // Load node when nodeId param changes\n  createEffect(() => {\n    const nodeId = stripSlug(params.nodeId);\n    if (nodeId && nodeId !== selectedNodeId()) {\n      flushAutoSave();\n      loadNode(nodeId);\n      setPreviewContent(null);\n      setPreviewCommit(null);\n    }\n  });\n\n  // Clear preview when history is hidden, and auto-load first item when shown\n  createEffect(() => {\n    if (!showHistory()) {\n      setPreviewContent(null);\n      setPreviewCommit(null);\n    } else if (history().length > 0 && !previewCommit()) {\n      const id = selectedNodeId();\n      const first = history()[0];\n      if (id && first) {\n        loadPreview(id, first);\n      }\n    }\n  });\n\n  // Local loading state for preview (operation-specific) - can be used for UI feedback\n  const [_loadingPreview, setLoadingPreview] = createSignal(false);\n\n  // Handle adding a column to table\n  async function handleAddColumn(column: Property) {\n    const nodeId = selectedNodeId();\n    const nodeData = selectedNodeData();\n    const ws = wsApi();\n    if (!nodeId || !nodeData || !ws) return;\n\n    try {\n      setSavingNodeId(nodeId);\n      const currentProperties: Property[] = nodeData.properties || [];\n      const updatedProperties: Property[] = [...currentProperties, column];\n\n      await ws.nodes.table.updateTable(nodeId, {\n        title: nodeData.title,\n        properties: updatedProperties,\n      });\n\n      // Reload node to get updated schema\n      await loadNode(nodeId);\n      setSaveError(null);\n    } catch (err) {\n      setSaveError(`${t('errors.failedToSave')}: ${err}`);\n    } finally {\n      setSavingNodeId(null);\n    }\n  }\n\n  async function loadPreview(nodeId: string, commit: Commit) {\n    const ws = wsApi();\n    if (!ws) return;\n    try {\n      setLoadingPreview(true);\n      const data = await ws.nodes.history.getNodeVersion(nodeId, commit.hash);\n      const wsId = user()?.workspace_id || '';\n      setPreviewContent(relativeLinksToSpaUrls(data.content || '', wsId));\n      setPreviewCommit(commit);\n    } catch (err) {\n      setLoadError(`${t('errors.failedToLoad')}: ${err}`);\n    } finally {\n      setLoadingPreview(false);\n    }\n  }\n\n  // Handle navigation to another node from editor links\n  const handleNavigateToNode = (nodeId: string) => {\n    flushAutoSave();\n    const u = user();\n    const wsId = u?.workspace_id;\n    const wsName = u?.workspace_name;\n    if (wsId) {\n      navigate(nodeUrl(wsId, wsName, nodeId));\n    }\n  };\n\n  return (\n    <>\n      <Show when={selectedNodeId()}>\n        <div class={styles.editor}>\n          <Show when={!previewCommit()}>\n            <div class={styles.editorHeader}>\n              <input\n                type=\"text\"\n                placeholder={t('editor.titlePlaceholder') || 'Title'}\n                value={title()}\n                onInput={(e) => handleTitleChange(e.target.value)}\n                class={styles.titleInput}\n              />\n              <div class={styles.editorStatus}>\n                <Show when={hasUnsavedChanges() && autoSaveStatus() === 'idle'}>\n                  <span class={styles.unsavedIndicator}> {t('editor.unsaved')}</span>\n                </Show>\n                <Show when={autoSaveStatus() === 'saving'}>\n                  <span class={styles.savingIndicator}> {t('common.saving')}</span>\n                </Show>\n                <Show when={autoSaveStatus() === 'saved'}>\n                  <span class={styles.savedIndicator}> {t('common.saved')}</span>\n                </Show>\n              </div>\n            </div>\n          </Show>\n\n          <Show when={showHistory()}>\n            <div class={styles.historyPanel}>\n              <h3>{t('editor.versionHistory')}</h3>\n              <ul class={styles.historyList}>\n                <For each={history()}>\n                  {(commit) => (\n                    <li\n                      class={styles.historyItem}\n                      classList={{ [styles.activeHistoryItem as string]: previewCommit()?.hash === commit.hash }}\n                      onClick={() => {\n                        const id = selectedNodeId();\n                        if (id) loadPreview(id, commit);\n                      }}\n                    >\n                      <div class={styles.historyMeta}>\n                        <span class={styles.historyDate}>{new Date(commit.timestamp).toLocaleString()}</span>\n                        <span class={styles.historyHash}>{commit.hash.substring(0, 7)}</span>\n                      </div>\n                      <div class={styles.historyMessage}>\n                        {commit.author_name} &lt;{commit.author_email}&gt;\n                      </div>\n                    </li>\n                  )}\n                </For>\n                <Show when={history().length === 0}>\n                  <li class={styles.historyItem}>{t('editor.noHistory')}</li>\n                </Show>\n              </ul>\n            </div>\n          </Show>\n\n          <Show when={!previewCommit()}>\n            <div class={styles.nodeContent}>\n              <Show when={selectedNodeData()?.has_page}>\n                <Suspense fallback={<div class={styles.editorLoading}>{t('common.loading')}</div>}>\n                  <Editor\n                    content={content()}\n                    nodeId={selectedNodeId() ?? undefined}\n                    assetUrls={assetUrls()}\n                    linkedNodeTitles={linkedNodeTitles()}\n                    onChange={handleContentChange}\n                    wsId={user()?.workspace_id}\n                    getToken={() => token()}\n                    onAssetUploaded={() => {\n                      const nodeId = selectedNodeId();\n                      if (nodeId) loadNode(nodeId);\n                    }}\n                    onError={setSaveError}\n                    onNavigateToNode={handleNavigateToNode}\n                  />\n                </Suspense>\n              </Show>\n\n              <Show when={selectedNodeData()?.has_table}>\n                <div class={styles.tableView}>\n                  <ViewTabs />\n                  <Show when={viewType() === 'table'}>\n                    <TableTable\n                      tableId={selectedNodeId() || ''}\n                      columns={selectedNodeData()?.properties || []}\n                      records={records()}\n                      onAddRecord={addRecord}\n                      onUpdateRecord={updateRecord}\n                      onDeleteRecord={deleteRecord}\n                      onAddColumn={handleAddColumn}\n                      onLoadMore={loadMoreRecords}\n                      hasMore={hasMore()}\n                    />\n                  </Show>\n                  <Show when={viewType() === 'list'}>\n                    <TableGrid\n                      records={records()}\n                      columns={selectedNodeData()?.properties || []}\n                      onUpdateRecord={updateRecord}\n                      onDeleteRecord={deleteRecord}\n                    />\n                  </Show>\n                  <Show when={viewType() === 'gallery'}>\n                    <TableGallery\n                      records={records()}\n                      columns={selectedNodeData()?.properties || []}\n                      onUpdateRecord={updateRecord}\n                      onDeleteRecord={deleteRecord}\n                    />\n                  </Show>\n                  <Show when={viewType() === 'board'}>\n                    <TableBoard\n                      records={records()}\n                      columns={selectedNodeData()?.properties || []}\n                      onUpdateRecord={updateRecord}\n                      onDeleteRecord={deleteRecord}\n                    />\n                  </Show>\n                </div>\n              </Show>\n            </div>\n          </Show>\n\n          <Show when={previewContent() !== null && previewCommit()}>\n            <div class={styles.previewPane}>\n              <div class={styles.previewHeader}>\n                <div class={styles.previewInfo}>\n                  <h4>{t('editor.versionPreview')}</h4>\n                  <span class={styles.previewMeta}>\n                    {previewCommit()?.author_name}  {new Date(previewCommit()?.timestamp || 0).toLocaleString()}\n                  </span>\n                </div>\n                <button\n                  onClick={() => {\n                    setPreviewContent(null);\n                    setPreviewCommit(null);\n                  }}\n                  class={styles.closePreviewButton}\n                >\n                  {t('editor.closePreview')}\n                </button>\n              </div>\n              <div class={styles.previewContent}>\n                <MarkdownPreview content={previewContent() || ''} assetUrls={assetUrls()} onNavigate={navigate} />\n              </div>\n            </div>\n          </Show>\n        </div>\n      </Show>\n    </>\n  );\n}\n","// Workspace section module wrapping providers and nested routes.\n\nimport { type ParentComponent } from 'solid-js';\nimport { WorkspaceProvider, EditorProvider, RecordsProvider } from '../contexts';\n\n/**\n * WorkspaceSection is the self-contained module for workspace functionality.\n * It wraps children with the necessary providers (WorkspaceProvider, EditorProvider, RecordsProvider).\n *\n * Usage in App.tsx route definitions:\n *   <Route path=\"/w/:wsId\" component={WorkspaceSection}>\n *     <Route path=\"/\" component={WorkspaceLayout}>\n *       <Route path=\"/\" component={WorkspaceRoot} />\n *       <Route path=\"/:nodeId\" component={NodeView} />\n *     </Route>\n *   </Route>\n *\n * Route structure:\n *   /w/:wsId/          -> WorkspaceRoot (redirects to first node)\n *   /w/:wsId/:nodeId   -> NodeView (editor or table)\n */\nconst WorkspaceSection: ParentComponent = (props) => {\n  return (\n    <WorkspaceProvider>\n      <EditorProvider>\n        <RecordsProvider>{props.children}</RecordsProvider>\n      </EditorProvider>\n    </WorkspaceProvider>\n  );\n};\n\nexport default WorkspaceSection;\n\n// Re-export components for use in route definitions\nexport { default as WorkspaceLayout } from './WorkspaceLayout';\nexport { default as WorkspaceRoot } from './WorkspaceRoot';\nexport { default as NodeView } from './NodeView';\n","// Main application component with router setup.\n\nimport { lazy, Show, Switch, Match, Suspense, type ParentComponent } from 'solid-js';\nimport { Router, Route, Navigate, A } from '@solidjs/router';\nimport { AuthProvider, useAuth } from './contexts';\nimport AppErrorBoundary from './components/ErrorBoundary';\nimport PWAInstallBanner from './components/PWAInstallBanner';\n\n// Lazy-loaded route components\nconst Auth = lazy(() => import('./components/Auth'));\nconst Privacy = lazy(() => import('./components/Privacy'));\nconst Terms = lazy(() => import('./components/Terms'));\nconst Onboarding = lazy(() => import('./sections/Onboarding'));\n\n// Import settings section and route components (not lazy - needed for nested routes)\nimport SettingsSection, {\n  ProfileSettingsRoute,\n  WorkspaceSettingsRoute,\n  OrgSettingsRoute,\n  ServerSettingsGuard,\n  SettingsRedirect,\n} from './sections/SettingsSection';\n\n// Import workspace section and route components (not lazy - needed for nested routes)\nimport WorkspaceSection, { WorkspaceLayout, WorkspaceRoot, NodeView } from './sections/WorkspaceSection';\n\n// Loading fallback for lazy-loaded routes\nfunction RouteLoading() {\n  return <div style={{ padding: '2rem', 'text-align': 'center' }}>Loading...</div>;\n}\n\n// 404 page for unmatched routes - shows explicit error instead of silent redirect\nfunction NotFound() {\n  const path = window.location.pathname;\n  console.error('404: Route not found:', path);\n  return (\n    <div style={{ padding: '2rem', 'text-align': 'center' }}>\n      <h1>Page Not Found</h1>\n      <p>\n        The path <code>{path}</code> doesn't exist.\n      </p>\n      <A href=\"/login\">Go to login</A>\n    </div>\n  );\n}\n\n// Route guard that redirects unauthenticated users to /login\nconst RequireAuth: ParentComponent = (props) => {\n  const { user, ready } = useAuth();\n\n  // Wait for auth check to complete before making decisions\n  return (\n    <Show when={ready()} fallback={<RouteLoading />}>\n      <Show when={user()} fallback={<Navigate href=\"/login\" />}>\n        {props.children}\n      </Show>\n    </Show>\n  );\n};\n\n// Auth route that redirects authenticated users away from login\nfunction AuthRoute() {\n  const { user, login, ready } = useAuth();\n\n  // Wait for auth check to complete before making decisions\n  return (\n    <Switch fallback={<RouteLoading />}>\n      <Match when={ready() && user()?.workspace_id}>\n        <Navigate href={`/w/@${user()?.workspace_id}`} />\n      </Match>\n      <Match when={ready() && user() && !user()?.workspace_id}>\n        <Navigate href=\"/onboarding\" />\n      </Match>\n      <Match when={ready() && !user()}>\n        <Suspense fallback={<RouteLoading />}>\n          <Auth onLogin={login} />\n        </Suspense>\n      </Match>\n    </Switch>\n  );\n}\n\n// Root redirect - send to login or workspace based on auth state\nfunction RootRedirect() {\n  const { user, ready } = useAuth();\n\n  // Wait for auth check to complete before making decisions\n  // Use Switch/Match for more explicit control over which Navigate renders\n  return (\n    <Switch fallback={<RouteLoading />}>\n      <Match when={ready() && user()?.workspace_id}>\n        <Navigate href={`/w/@${user()?.workspace_id}`} />\n      </Match>\n      <Match when={ready() && user() && !user()?.workspace_id}>\n        {/* User is authenticated but has no workspace - send to onboarding */}\n        <Navigate href=\"/onboarding\" />\n      </Match>\n      <Match when={ready() && !user()}>\n        <Navigate href=\"/login\" />\n      </Match>\n    </Switch>\n  );\n}\n\n// Settings section wrapper with auth guard\nconst SettingsSectionWithAuth: ParentComponent = (props) => {\n  return (\n    <RequireAuth>\n      <Suspense fallback={<RouteLoading />}>\n        <SettingsSection>{props.children}</SettingsSection>\n      </Suspense>\n    </RequireAuth>\n  );\n};\n\n// Workspace section wrapper with auth guard\nconst WorkspaceSectionWithAuth: ParentComponent = (props) => {\n  return (\n    <RequireAuth>\n      <Suspense fallback={<RouteLoading />}>\n        <WorkspaceSection>{props.children}</WorkspaceSection>\n      </Suspense>\n    </RequireAuth>\n  );\n};\n\n// App routes wrapped in router\nfunction AppRoutes() {\n  return (\n    <Router explicitLinks>\n      {/* Public routes */}\n      <Route path=\"/login\" component={AuthRoute} />\n      <Route\n        path=\"/onboarding\"\n        component={() => (\n          <RequireAuth>\n            <Suspense fallback={<RouteLoading />}>\n              <Onboarding />\n            </Suspense>\n          </RequireAuth>\n        )}\n      />\n      <Route\n        path=\"/privacy\"\n        component={() => (\n          <Suspense fallback={<RouteLoading />}>\n            <Privacy />\n          </Suspense>\n        )}\n      />\n      <Route\n        path=\"/terms\"\n        component={() => (\n          <Suspense fallback={<RouteLoading />}>\n            <Terms />\n          </Suspense>\n        )}\n      />\n\n      {/* Protected settings routes with nested routing */}\n      <Route path=\"/settings\" component={SettingsSectionWithAuth}>\n        <Route path=\"/\" component={SettingsRedirect} />\n        <Route path=\"/user\" component={ProfileSettingsRoute} />\n        <Route path=\"/server\" component={ServerSettingsGuard} />\n        <Route path=\"/workspace/:wsId\" component={WorkspaceSettingsRoute} />\n        <Route path=\"/org/:orgId\" component={OrgSettingsRoute} />\n      </Route>\n\n      {/* Protected workspace routes with nested routing */}\n      <Route path=\"/w/:wsId\" component={WorkspaceSectionWithAuth}>\n        <Route path=\"/\" component={WorkspaceLayout}>\n          <Route path=\"/\" component={WorkspaceRoot} />\n          <Route path=\"/:nodeId\" component={NodeView} />\n        </Route>\n      </Route>\n\n      {/* Root redirect */}\n      <Route path=\"/\" component={RootRedirect} />\n\n      {/* Catch-all 404 - shows explicit error instead of silent redirect */}\n      <Route path=\"*\" component={NotFound} />\n    </Router>\n  );\n}\n\n// Root component that provides global context\nexport default function App() {\n  return (\n    <AppErrorBoundary>\n      <AuthProvider>\n        <AppRoutes />\n        <PWAInstallBanner />\n      </AuthProvider>\n    </AppErrorBoundary>\n  );\n}\n","// Application entry point rendering the root component.\n\nimport { render } from 'solid-js/web';\nimport { I18nProvider, type Locale } from './i18n';\nimport './variables.css';\nimport App from './App';\n\n// Get initial locale from localStorage or default to 'en'\nconst storedLocale = localStorage.getItem('mddb_locale') as Locale | null;\nconst initialLocale: Locale = storedLocale && ['en', 'fr', 'de', 'es'].includes(storedLocale) ? storedLocale : 'en';\n\nconst root = document.getElementById('app');\nif (root) {\n  render(\n    () => (\n      <I18nProvider initialLocale={initialLocale}>\n        <App />\n      </I18nProvider>\n    ),\n    root\n  );\n}\n"],"file":"index-Bq5QvdoG.js"}