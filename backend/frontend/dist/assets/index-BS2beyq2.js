const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ProfileSettings-DDDQL9M5.js","assets/vendor-CcKkUxsI.js","assets/ProfileSettings-DnikkUU_.css","assets/WorkspaceSettingsPanel-Dj1ipeJE.js","assets/InviteForm-BQP8oAf4.js","assets/InviteForm-Bmuo23QD.css","assets/WorkspaceSettingsPanel-CefhRi2L.css","assets/OrgSettingsPanel-ZFYoeN2n.js","assets/OrgSettingsPanel-DAbswSRk.css","assets/ServerSettingsPanel-DxCo2cSb.js","assets/ServerSettingsPanel-CwAILPxT.css","assets/Editor-Bjt_A5UT.js","assets/editor-vendor-I-6wWwrP.js","assets/Editor-fgnFqH3q.css","assets/Auth-WEGKTAWU.js","assets/Auth-RtG5ezM2.css","assets/Privacy-CMfhCaSi.js","assets/Privacy-COJkLvXG.css","assets/Terms-D02UdGWT.js","assets/Onboarding-BkH41v_l.js"])))=>i.map(i=>d[i]);
import{u as e,c as t,a as n,d as r,e as i,t as o,r as a,f as s,g as l,o as d,h as c,i as u,j as p,p as g,l as h,m as _,n as v,E as f,q as m,s as w,v as b,w as k,S as y,x as $,y as C,F as S,z as x,A as I,B as N,C as T,N as z,D as E,G as L,H as R,I as P,J as D,K as j,L as A,M as O,P as V,Q as W,T as M,U,V as B}from"./vendor-CcKkUxsI.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const F={},H=function(e,t,n){let r=Promise.resolve();if(t&&t.length>0){let e=function(e){return Promise.all(e.map(e=>Promise.resolve(e).then(e=>({status:"fulfilled",value:e}),e=>({status:"rejected",reason:e}))))};document.getElementsByTagName("link");const n=document.querySelector("meta[property=csp-nonce]"),i=n?.nonce||n?.getAttribute("nonce");r=e(t.map(e=>{if((e=function(e){return"/"+e}(e))in F)return;F[e]=!0;const t=e.endsWith(".css"),n=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${n}`))return;const r=document.createElement("link");return r.rel=t?"stylesheet":"modulepreload",t||(r.as="script"),r.crossOrigin="",r.href=e,i&&r.setAttribute("nonce",i),document.head.appendChild(r),t?new Promise((t,n)=>{r.addEventListener("load",t),r.addEventListener("error",()=>n(new Error(`Unable to preload CSS for ${e}`)))}):void 0}))}function i(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return r.then(t=>{for(const e of t||[])"rejected"===e.status&&i(e.reason);return e().catch(i)})};async function q(e){const t=await((e,t,n)=>{const r=e[t];return r?"function"==typeof r?r():Promise.resolve(r):new Promise((e,r)=>{("function"==typeof queueMicrotask?queueMicrotask:setTimeout)(r.bind(null,new Error("Unknown variable dynamic import: "+t+(t.split("/").length!==n?". Note that variables only represent file names one level deep.":""))))})})(Object.assign({"./dictionaries/de.ts":()=>H(()=>import("./de-DGmAH22l.js"),[]),"./dictionaries/en.ts":()=>H(()=>import("./en-C7OrP84A.js"),[]),"./dictionaries/es.ts":()=>H(()=>import("./es-C2rUlHrj.js"),[]),"./dictionaries/fr.ts":()=>H(()=>import("./fr-CGSCT9Yk.js"),[])}),`./dictionaries/${e}.ts`,3);return s(t.dict)}const K=i(),G=e=>{const[i,s]=t(e.initialLocale||"en"),[l]=n(i,q),d=o(l,a),c=(e,...t)=>(l(),d(e,...t)),u={locale:i,setLocale:s,t:c,translateError:e=>{const t=`errors.${e}`,n=c(t);return n&&n!==t?n:c("errors.unknown")||"An error occurred"},ready:()=>"ready"===l.state};return r(K.Provider,{value:u,get children(){return e.children}})};function J(){const t=e(K);if(!t)throw new Error("useI18n must be used within I18nProvider");return t}class X extends Error{constructor(e,t){super(t.error.message),this.status=e,this.response=t,this.name="APIError"}}async function Y(e,t){const n=await e(t);if(!n.ok){const e=await n.json();throw new X(n.status,e)}return n.json()}async function Z(e,t,n){const r={method:"POST"};n&&(r.headers={"Content-Type":"application/json"},r.body=JSON.stringify(n));const i=await e(t,r);if(!i.ok){const e=await i.json();throw new X(i.status,e)}return i.json()}function Q(e){return{admin:{organizations:{listAllOrgs:()=>Y(e,"/api/admin/organizations")},getAdminStats:()=>Y(e,"/api/admin/stats"),listAllUsers:()=>Y(e,"/api/admin/users")},auth:{email:{changeEmail:t=>Z(e,"/api/auth/email",t),sendVerificationEmail:()=>Z(e,"/api/auth/email/send-verification")},invitations:{acceptOrgInvitation:t=>Z(e,"/api/auth/invitations/org/accept",t),acceptWSInvitation:t=>Z(e,"/api/auth/invitations/ws/accept",t)},sessions:{listSessions:()=>Y(e,"/api/auth/sessions"),revokeAllSessions:()=>Z(e,"/api/auth/sessions/revoke-all"),revokeSession:t=>Z(e,"/api/auth/sessions/revoke",t)},getMe:()=>Y(e,"/api/auth/me"),listProviders:()=>Y(e,"/api/auth/providers"),login:t=>Z(e,"/api/auth/login",t),logout:()=>Z(e,"/api/auth/logout"),register:t=>Z(e,"/api/auth/register",t),switchWorkspace:t=>Z(e,"/api/auth/switch-workspace",t),updateUserSettings:t=>Z(e,"/api/auth/settings",t)},organizations:{createOrganization:t=>Z(e,"/api/organizations",t)},server:{getConfig:()=>Y(e,"/api/server/config"),updateConfig:t=>Z(e,"/api/server/config",t)},getHealth:()=>Y(e,"/api/health"),org:t=>({invitations:{createOrgInvitation:n=>Z(e,`/api/organizations/${t}/invitations`,n),listOrgInvitations:()=>Y(e,`/api/organizations/${t}/invitations`)},notion:{getStatus:n=>Y(e,`/api/organizations/${t}/notion/import/${n}/status`),startImport:n=>Z(e,`/api/organizations/${t}/notion/import`,n)},organizations:{getOrganization:()=>Y(e,`/api/organizations/${t}`),updateOrganization:n=>Z(e,`/api/organizations/${t}`,n)},settings:{updateOrgPreferences:n=>Z(e,`/api/organizations/${t}/settings`,n)},users:{listUsers:()=>Y(e,`/api/organizations/${t}/users`),updateOrgMemberRole:n=>Z(e,`/api/organizations/${t}/users/role`,n)},workspaces:{createWorkspace:n=>Z(e,`/api/organizations/${t}/workspaces`,n)}}),ws:t=>({invitations:{createWSInvitation:n=>Z(e,`/api/workspaces/${t}/invitations`,n),listWSInvitations:()=>Y(e,`/api/workspaces/${t}/invitations`)},nodes:{assets:{deleteNodeAsset:(n,r)=>Z(e,`/api/workspaces/${t}/nodes/${n}/assets/${r}/delete`),listNodeAssets:n=>Y(e,`/api/workspaces/${t}/nodes/${n}/assets`)},history:{getNodeVersion:(n,r)=>Y(e,`/api/workspaces/${t}/nodes/${n}/history/${r}`),async listNodeVersions(n,r){const i=new URLSearchParams;r.Limit&&i.set("limit",String(r.Limit));const o=`/api/workspaces/${t}/nodes/${n}/history`+(i.toString()?`?${i}`:"");return Y(e,o)}},page:{createPage:(n,r)=>Z(e,`/api/workspaces/${t}/nodes/${n}/page/create`,r),deletePage:n=>Z(e,`/api/workspaces/${t}/nodes/${n}/page/delete`),getPage:n=>Y(e,`/api/workspaces/${t}/nodes/${n}/page`),updatePage:(n,r)=>Z(e,`/api/workspaces/${t}/nodes/${n}/page`,r)},table:{records:{createRecord:(n,r)=>Z(e,`/api/workspaces/${t}/nodes/${n}/table/records/create`,r),deleteRecord:(n,r)=>Z(e,`/api/workspaces/${t}/nodes/${n}/table/records/${r}/delete`),getRecord:(n,r)=>Y(e,`/api/workspaces/${t}/nodes/${n}/table/records/${r}`),async listRecords(n,r){const i=new URLSearchParams;r.ViewID&&i.set("view_id",r.ViewID),r.Filters&&i.set("filters",r.Filters),r.Sorts&&i.set("sorts",r.Sorts),r.Offset&&i.set("offset",String(r.Offset)),r.Limit&&i.set("limit",String(r.Limit));const o=`/api/workspaces/${t}/nodes/${n}/table/records`+(i.toString()?`?${i}`:"");return Y(e,o)},updateRecord:(n,r,i)=>Z(e,`/api/workspaces/${t}/nodes/${n}/table/records/${r}`,i)},createTable:(n,r)=>Z(e,`/api/workspaces/${t}/nodes/${n}/table/create`,r),deleteTable:n=>Z(e,`/api/workspaces/${t}/nodes/${n}/table/delete`),getTable:n=>Y(e,`/api/workspaces/${t}/nodes/${n}/table`),updateTable:(n,r)=>Z(e,`/api/workspaces/${t}/nodes/${n}/table`,r)},views:{createView:(n,r)=>Z(e,`/api/workspaces/${t}/nodes/${n}/views/create`,r),deleteView:(n,r)=>Z(e,`/api/workspaces/${t}/nodes/${n}/views/${r}/delete`),updateView:(n,r,i)=>Z(e,`/api/workspaces/${t}/nodes/${n}/views/${r}`,i)},deleteNode:n=>Z(e,`/api/workspaces/${t}/nodes/${n}/delete`),getNode:n=>Y(e,`/api/workspaces/${t}/nodes/${n}`),async getNodeTitles(n){const r=new URLSearchParams;n.IDs&&r.set("ids",n.IDs);const i=`/api/workspaces/${t}/nodes/titles`+(r.toString()?`?${r}`:"");return Y(e,i)},listNodeChildren:n=>Y(e,`/api/workspaces/${t}/nodes/${n}/children`)},notion:{cancelImport:()=>Z(e,`/api/workspaces/${t}/notion/import/cancel`)},settings:{git:{deleteGitRemote:()=>Z(e,`/api/workspaces/${t}/settings/git/delete`),getGitRemote:()=>Y(e,`/api/workspaces/${t}/settings/git`),pushGit:()=>Z(e,`/api/workspaces/${t}/settings/git/push`),updateGitRemote:n=>Z(e,`/api/workspaces/${t}/settings/git`,n)},updateWSMembershipSettings:n=>Z(e,`/api/workspaces/${t}/settings/membership`,n)},users:{updateWSMemberRole:n=>Z(e,`/api/workspaces/${t}/users/role`,n)},workspaces:{getWorkspace:()=>Y(e,`/api/workspaces/${t}`),updateWorkspace:n=>Z(e,`/api/workspaces/${t}`,n)},search:n=>Z(e,`/api/workspaces/${t}/search`,n)})}}const ee=3,te=1e3,ne=3e4;function re(e){return 429===e||e>=500&&e<600}function ie(e){if(!e)return null;const t=parseInt(e,10);if(!isNaN(t))return 1e3*t;const n=Date.parse(e);return isNaN(n)?null:Math.max(0,n-Date.now())}function oe(e,t){if(null!==t)return Math.min(t,ne);const n=te*Math.pow(2,e);return Math.min(n,ne)}function ae(e,t){return n=async(n,r)=>{const i=e(),o={...r?.headers};i&&(o.Authorization=`Bearer ${i}`);const a=await fetch(n,{...r,headers:o});return 401===a.status&&t&&t(),a},async(e,t)=>{let r=0;for(;;){const i=await n(e,t);if(!re(i.status)||r>=ee)return i;const o=oe(r,ie(i.headers.get("Retry-After")));await new Promise(e=>setTimeout(e,o)),r++}};var n}function se(e,t){return Q(ae(e,t))}const le=i(),de=e=>{const[n,i]=t(null),[o,a]=t(localStorage.getItem("mddb_token")),[s,u]=t(!1),p=async()=>{const e=o();if(e)try{const t=se(()=>e,()=>{});await t.auth.logout()}catch{}localStorage.removeItem("mddb_token"),a(null),i(null)},g=l(()=>se(()=>o(),p)),h=l(()=>{const e=n()?.workspace_id;return e?g().ws(e):null}),_=l(()=>{const e=n()?.organization_id;return e?g().org(e):null});d(async()=>{const e=new URLSearchParams(window.location.search).get("token");e&&(localStorage.setItem("mddb_token",e),a(e),window.history.replaceState({},document.title,window.location.pathname));if(e||localStorage.getItem("mddb_token"))try{const e=await g().auth.getMe();i(e)}catch(t){console.error("Failed to load user",t),t instanceof X&&401===t.status&&(localStorage.removeItem("mddb_token"),a(null))}u(!0)});let v=!0;c(()=>{const e=o(),t=n();v?v=!1:e&&!t&&(async()=>{try{const e=await g().auth.getMe();i(e)}catch(e){console.error("Failed to load user",e),e instanceof X&&401===e.status&&(localStorage.removeItem("mddb_token"),a(null))}})()});const f={user:n,token:o,ready:s,api:g,wsApi:h,orgApi:_,login:(e,t)=>{localStorage.setItem("mddb_token",e),a(e),i(t)},logout:p,setUser:i,refreshUser:async()=>{try{const e=await g().auth.getMe();i(e)}catch(e){console.error("Failed to refresh user",e),e instanceof X&&401===e.status&&(localStorage.removeItem("mddb_token"),a(null),i(null))}}};return r(le.Provider,{value:f,get children(){return e.children}})};function ce(){const t=e(le);if(!t)throw new Error("useAuth must be used within an AuthProvider");return t}const ue="select",pe="org:owner",ge="org:admin",he="ws:admin",_e="google",ve="microsoft",fe="github",me=i(),we=e=>{const{t:n,ready:i}=J(),{user:o,setUser:a,api:s,wsApi:l,login:d}=ce(),[_,v]=u([]),[f,m]=t(null),[w,b]=t(null),[k,y]=t([]),[$,C]=t(!1),[S,x]=t(null),[I,N]=t(!1),[T,z]=t(!1);let E=!1,L=null,R=null,P=null;function D(){const e=o();if(!e?.name)return"";return e.name.split(" ")[0]||e.name}async function j(e){await s().organizations.createOrganization({name:e.name});const t=await s().auth.getMe();a(t)}async function A(e){const t=o();if(!t||!t.organization_id)throw new Error("No organization selected");const n=await s().org(t.organization_id).workspaces.createWorkspace({name:e.name}),r=await s().auth.getMe();a(r),await O(n.id)}async function O(e){try{C(!0);const t=await s().auth.switchWorkspace({ws_id:e});if(!t.user)throw new Error("No user data returned");d(t.token,t.user),h(()=>{m(null),b(null),y([])}),P=null,L=null,await V()}catch(t){x(`${n("errors.failedToSwitch")}: ${t}`)}finally{C(!1)}}async function V(e=!1){const t=l(),r=o()?.workspace_id;if(t&&!E&&!(!e&&r&&L===r&&_.length>0))try{E=!0,C(!0);const e=await t.nodes.listNodeChildren("0");let i=e?.nodes||[];if(0===i.length&&I()){const e=await async function(){const e=l(),t=o();if(!e||!t)return null;if(t.workspace_role!==he&&"ws:editor"!==t.workspace_role)return null;try{const t=await e.nodes.page.createPage("0",{title:n("welcome.welcomePageTitle"),content:n("welcome.welcomePageContent")});return t?.id?String(t.id):null}catch(r){return x(`${n("errors.failedToCreate")}: ${r}`),null}}();if(e){const e=await t.nodes.listNodeChildren("0");i=e?.nodes||[]}}v(p(i)),L=r||null,x(null)}catch(i){x(`${n("errors.failedToLoad")}: ${i}`)}finally{E=!1,C(!1)}}c(()=>{const e=o();if(!e||!i()||I()||T())return;const t=e.organizations||[];if(0===t.length)return z(!0),void async function(){try{C(!0);const e=D(),t=e?n("onboarding.defaultOrgName",{name:e}):n("onboarding.defaultOrgNameFallback");await j({name:t})}catch(e){x(`${n("errors.failedToCreate")}: ${e}`)}finally{C(!1)}}().finally(()=>z(!1));const r=t[0];if(r){if(0===(e.workspaces?.filter(e=>e.organization_id===r.organization_id)||[]).length&&(r.role===ge||r.role===pe))return z(!0),void async function(){try{C(!0);const e=D(),t=e?n("onboarding.defaultWorkspaceName",{name:e}):n("onboarding.defaultWorkspaceNameFallback");await A({name:t})}catch(e){x(`${n("errors.failedToCreate")}: ${e}`)}finally{C(!1)}}().finally(()=>z(!1))}e.workspace_id&&N(!0)}),c(()=>{o()&&V()}),c(()=>{const e=o()?.workspace_id;e&&L!==e&&(P=null)});const W={nodes:_,setNodes:e=>{v(g(e))},selectedNodeId:f,setSelectedNodeId:m,selectedNodeData:w,setSelectedNodeData:b,breadcrumbPath:k,setBreadcrumbPath:y,loading:$,setLoading:C,error:S,setError:x,firstLoginCheckDone:I,setFirstLoginCheckDone:N,switchWorkspace:O,createOrganization:j,createWorkspace:A,loadNodes:V,loadNode:async function(e){const t=l();if(t&&R!==e&&P!==e)try{R=e,C(!0);const n=await t.nodes.getNode(e);h(()=>{m(n.id),b(n)}),P=n.id,x(null);const r=[n];let i=n;for(;i.parent_id&&"0"!==i.parent_id;)try{const e=await t.nodes.getNode(i.parent_id);r.unshift(e),i=e}catch{break}return y(r),n}catch(r){return void x(`${n("errors.failedToLoad")}: ${r}`)}finally{R=null,C(!1)}},fetchNodeChildren:async function(e){const t=l();if(t)try{const n=await t.nodes.listNodeChildren(e),r=n.nodes?.filter(Boolean)||[];v(g(t=>{const n=t=>{for(const i of t){if(i.id===e)return i.children=r,i.has_children=r.length>0,!0;if(i.children&&n(i.children))return!0}return!1};n(t)}))}catch(n){console.error("Failed to fetch children:",n)}},removeNode:e=>{v(g(t=>{const n=t=>{const r=t.findIndex(t=>t.id===e);if(-1!==r)return t.splice(r,1),!0;for(const e of t)if(e.children&&n(e.children))return 0===e.children.length&&(e.has_children=!1),!0;return!1};n(t)}))},updateNodeTitle:(e,t)=>{v(g(n=>{const r=n=>{for(const i of n){if(i.id===e)return i.title=t,!0;if(i.children&&r(i.children))return!0}return!1};r(n)})),y(n=>n.map(n=>n.id===e?{...n,title:t}:n))}};return r(me.Provider,{value:W,get children(){return e.children}})};function be(){const t=e(me);if(!t)throw new Error("useWorkspace must be used within a WorkspaceProvider");return t}function ke(e){const t=e.indexOf("+");return t>=0?e.substring(0,t):e}function ye(e){return e.toString().toLowerCase().trim().replace(/\s+/g,"-").replace(/[^\w-]+/g,"").replace(/--+/g,"-")}function $e(e,t){return`/w/${e}+${ye(t||"workspace")}/`}function Ce(e,t,n,r){const i=ye(t||"workspace"),o=r?ye(r):"";return`/w/${e}+${i}/${n}${o?"+"+o:""}`}function Se(e,t,n){if(!e||"user"===e)return"/settings/user";if("server"===e)return"/settings/server";return`/settings/${e}/${t}+${ye(n||e)}`}function xe(e){return!e.includes("://")&&!e.startsWith("/")}function Ie(e,t){if(!t||0===Object.keys(t).length)return e;let n=e.replace(/!\[([^\]]*)\]\(([^/)][^)]*)\)/g,(e,n,r)=>{if(!xe(r))return e;const i=t[r];return i?`![${n}](${i})`:e});return n=n.replace(/\[([^\]]+)\]\(([^/)][^)]*)\)/g,(e,n,r)=>{if(!xe(r))return e;const i=t[r];return i?`[${n}](${i})`:e}),n}const Ne=/^\/assets\/[^/]+\/[^/]+\/([^?]+)/;function Te(e){const t=e.match(Ne);return t&&t[1]?decodeURIComponent(t[1]):null}function ze(e,t){const n={};for(const[i,o]of Object.entries(t||{}))n[o]=i;let r=e.replace(/!\[([^\]]*)\]\(([^)]+)\)/g,(e,t,r)=>{const i=n[o=r]?n[o]:Te(o);var o;return i?`![${t}](${i})`:e});return r=r.replace(/\[([^\]]+)\]\(([^)]+)\)/g,(e,t,n)=>{const r=Te(n);return r?`[${t}](${r})`:e}),r}const Ee=/\[([^\]]*)\]\(\/w\/([^/+]+)(?:\+[^/]*)?\/([A-Za-z0-9]+)(?:\+[^)]*)?\)/g;function Le(e,t,n){return e&&n&&t&&0!==Object.keys(t).length?e.replace(/\[([^\]]*)\]\((\/w\/([^/+]+)(?:\+[^/]*)?\/([A-Za-z0-9]+)(?:\+[^)]*)?)\)/g,(e,r,i,o,a)=>{if(o!==n)return e;const s=t[a];return void 0!==s?`[${s}](${i})`:e}):e}const Re=i(),Pe=e=>{const{t:n}=J(),{user:i,wsApi:o}=ce(),{selectedNodeId:a,selectedNodeData:s,updateNodeTitle:l,setLoading:d,setError:u}=be(),[p,g]=t(""),[h,v]=t(""),[f,m]=t(!1),[w,b]=t("idle"),[k,y]=t({}),[$,C]=t(!1),[S,x]=t([]),I=function(e,t){let n=null,r=null;const i=(...i)=>{r=i,null!==n&&clearTimeout(n),n=setTimeout(()=>{n=null,r=null,e(...i)},t)};return i.flush=()=>{if(null!==n&&null!==r){clearTimeout(n);const t=r;n=null,r=null,e(...t)}},i.cancel=()=>{null!==n&&(clearTimeout(n),n=null,r=null)},i.pending=()=>null!==n,i}(async()=>{const e=a(),t=o();if(e&&f()&&t)try{b("saving"),await t.nodes.page.updatePage(e,{title:p(),content:h()}),m(!1),b("saved");const n=i()?.workspace_id,r=i()?.workspace_name;if(n){const t=window.location.pathname,i=Ce(n,r,e,p());t!==i&&window.history.replaceState(null,"",i)}setTimeout(()=>{"saved"===w()&&b("idle")},2e3)}catch(r){u(`${n("errors.autoSaveFailed")}: ${r}`),b("idle")}},2e3);async function N(e){const t=o(),n=i()?.workspace_id;if(!t||!n||!e)return void y({});const r=function(e,t){if(!e||!t)return[];const n=new Set,r=new RegExp(Ee.source,"g");let i;for(;null!==(i=r.exec(e));){const e=i[2],r=i[3];e===t&&r&&!n.has(r)&&n.add(r)}return Array.from(n)}(e,n);if(0!==r.length)try{const e=await t.nodes.getNodeTitles({IDs:r.join(",")});y(e.titles||{})}catch{y({})}else y({})}function T(){g(""),v(""),m(!1),b("idle"),C(!1),x([]),y({})}_(()=>{I.flush()}),c(()=>{const e=s();e?(g(e.title),v(e.content||""),m(!1),b("idle"),C(!1),N(e.content||"")):T()});const z={title:p,setTitle:g,content:h,setContent:v,hasUnsavedChanges:f,setHasUnsavedChanges:m,autoSaveStatus:w,assetUrls:()=>s()?.asset_urls||{},linkedNodeTitles:k,showHistory:$,setShowHistory:C,history:S,loadHistory:async function(e){if($())return void C(!1);const t=o();if(t)try{d(!0);const n=await t.nodes.history.listNodeVersions(e,{Limit:100});x(n.history?.filter(Boolean)||[]),C(!0)}catch(r){u(`${n("errors.failedToLoad")}: ${r}`)}finally{d(!1)}},loadVersion:async function(e,t){if(!confirm(n("editor.restoreConfirm")||"This will replace current editor content. Continue?"))return;const r=o();if(r)try{d(!0);const n=await r.nodes.history.getNodeVersion(e,t);v(n.content||""),m(!0),C(!1)}catch(i){u(`${n("errors.failedToLoad")}: ${i}`)}finally{d(!1)}},triggerAutoSave:I,flushAutoSave:I.flush,resetEditor:T,handleTitleChange:function(e){g(e);const t=a();t&&l(t,e),m(!0),I()},handleContentChange:function(e){v(e),m(!0),I()}};return r(Re.Provider,{value:z,get children(){return e.children}})};function De(){const t=e(Re);if(!t)throw new Error("useEditor must be used within an EditorProvider");return t}const je=i(),Ae=e=>{const{t:n}=J(),{wsApi:i}=ce(),{selectedNodeId:o,selectedNodeData:a,loading:s,setLoading:l,setError:d}=be(),[u,p]=t([]),[g,_]=t(!1),[v,f]=t([]),[m,w]=t(),[b,k]=t([]),[y,$]=t([]),C="__default__";function S(){p([]),_(!1),f([]),w(void 0),k([]),$([])}function x(e){if(e===m())return;const t=v().find(t=>t.id===e);h(()=>{w(e),t?(k(t.filters||[]),$(t.sorts||[])):(k([]),$([]))});const n=o();n&&I(n)}async function I(e){const t=i();if(t)try{l(!0);const n=b().length>0?JSON.stringify(b()):void 0,r=y().length>0?JSON.stringify(y()):void 0,i=m(),o=i===C?"":i||"",a=(await t.nodes.table.records.listRecords(e,{Offset:0,Limit:50,ViewID:o,Filters:n||"",Sorts:r||""})).records||[];p(a),_(50===a.length)}catch(r){d(`${n("errors.failedToLoad")}: ${r}`)}finally{l(!1)}}c(()=>{const e=a();e?.has_table?(h(()=>{const t=e.views||[];if(t.length>0){f(t);const e=t.find(e=>e.default)||t[0];e&&(w(e.id),k(e.filters||[]),$(e.sorts||[]))}else{const e={id:C,name:n("table.all")||"All",type:"table",default:!0,filters:[],sorts:[],columns:[],groups:[]};f([e]),w(C),k([]),$([])}}),I(e.id)):S()});const N={records:u,hasMore:g,views:v,activeViewId:m,activeFilters:b,activeSorts:y,loadRecords:I,loadMoreRecords:async function(){const e=o(),t=i();if(e&&!s()&&t)try{l(!0);const n=u().length,r=b().length>0?JSON.stringify(b()):void 0,i=y().length>0?JSON.stringify(y()):void 0,o=m(),a=o===C?"":o||"",s=(await t.nodes.table.records.listRecords(e,{Offset:n,Limit:50,ViewID:a,Filters:r||"",Sorts:i||""})).records||[];p([...u(),...s]),_(50===s.length)}catch(r){d(`${n("errors.failedToLoad")}: ${r}`)}finally{l(!1)}},addRecord:async function(e){const t=o(),r=i();if(t&&r)try{l(!0),await r.nodes.table.records.createRecord(t,{data:e}),await I(t),d(null)}catch(a){d(`${n("errors.failedToCreate")}: ${a}`)}finally{l(!1)}},updateRecord:async function(e,t){const r=o(),a=i();if(r&&a)try{l(!0),await a.nodes.table.records.updateRecord(r,e,{data:t}),await I(r),d(null)}catch(s){d(`${n("errors.failedToSave")}: ${s}`)}finally{l(!1)}},deleteRecord:async function(e){const t=o(),r=i();if(t&&r&&confirm(n("table.confirmDeleteRecord")||"Delete this record?"))try{l(!0),await r.nodes.table.records.deleteRecord(t,e),await I(t),d(null)}catch(a){d(`${n("errors.failedToDelete")}: ${a}`)}finally{l(!1)}},clearRecords:S,setActiveViewId:x,setFilters:function(e){k(e);const t=o();t&&I(t)},setSorts:function(e){$(e);const t=o();t&&I(t)},createView:async function(e,t){const r=o(),a=i();if(r&&a)try{l(!0);const n=await a.nodes.views.createView(r,{name:e,type:t}),i={id:n.id,name:e,type:t,default:!1,filters:[],sorts:[],columns:[],groups:[]};h(()=>{f([...v(),i]),w(n.id),k([]),$([])})}catch(s){d(`${n("errors.failedToCreate")}: ${s}`)}finally{l(!1)}},updateView:async function(e,t){const r=o(),a=i();if(r&&a)try{l(!0),await a.nodes.views.updateView(r,e,t),f(v().map(n=>n.id===e?{...n,...t}:n)),e===m()&&(t.filters&&k(t.filters),t.sorts&&$(t.sorts),(t.filters||t.sorts)&&await I(r))}catch(s){d(`${n("errors.failedToSave")}: ${s}`)}finally{l(!1)}},deleteView:async function(e){const t=o(),r=i();if(t&&r&&confirm(n("table.confirmDeleteView")||"Delete this view?"))try{l(!0),await r.nodes.views.deleteView(t,e);const n=v().filter(t=>t.id!==e);if(f(n),m()===e){const e=n[0];x(e?e.id:void 0)}}catch(a){d(`${n("errors.failedToDelete")}: ${a}`)}finally{l(!1)}}};return r(je.Provider,{value:N,get children(){return e.children}})};function Oe(){const t=e(je);if(!t)throw new Error("useRecords must be used within a RecordsProvider");return t}const Ve="_errorBoundary_1gyxj_3",We="_errorMessage_1gyxj_21",Me="_errorDetails_1gyxj_27",Ue="_retryButton_1gyxj_51";var Be=k("<div role=alert><h2>Something went wrong</h2><p></p><details><summary>Technical details</summary><pre></pre></details><button>Try again");function Fe(e){return t=Be(),n=t.firstChild.nextSibling,r=n.nextSibling,i=r.firstChild.nextSibling,o=r.nextSibling,m(n,()=>e.error.message),m(i,()=>e.error.stack),o.$$click=()=>e.reset(),w(e=>{var i=Ve,a=We,s=Me,l=Ue;return i!==e.e&&b(t,e.e=i),a!==e.t&&b(n,e.t=a),s!==e.a&&b(r,e.a=s),l!==e.o&&b(o,e.o=l),e},{e:void 0,t:void 0,a:void 0,o:void 0}),t;var t,n,r,i,o}const He=e=>r(f,{fallback:(e,t)=>r(Fe,{error:e,reset:t}),get children(){return e.children}});v(["click"]);const qe="_banner_172qk_1",Ke="_content_172qk_23",Ge="_title_172qk_27",Je="_message_172qk_32",Xe="_actions_172qk_37",Ye="_installButton_172qk_42",Ze="_dismissButton_172qk_56";var Qe=k("<div><div><div></div><div></div></div><div><button></button><button>");const et="mddb_pwa_dismissed";function tt(){const{t:e}=J(),[n,i]=t(null),[o,a]=t(!1);d(()=>{if(function(){const e=localStorage.getItem(et);if(!e)return!1;const t=new Date(e);return((new Date).getTime()-t.getTime())/864e5<30}())return;const e=e=>{e.preventDefault(),i(e),a(!0)},t=()=>{a(!1),i(null)};window.addEventListener("beforeinstallprompt",e),window.addEventListener("appinstalled",t),_(()=>{window.removeEventListener("beforeinstallprompt",e),window.removeEventListener("appinstalled",t)})});const s=async()=>{const e=n();if(!e)return;await e.prompt();const{outcome:t}=await e.userChoice;"accepted"===t&&a(!1),i(null)},l=()=>{localStorage.setItem(et,(new Date).toISOString()),a(!1)};return r(y,{get when(){return $(()=>!!o())()&&n()},get children(){var t=Qe(),n=t.firstChild,r=n.firstChild,i=r.nextSibling,o=n.nextSibling,a=o.firstChild,d=a.nextSibling;return m(r,()=>e("pwa.installTitle")),m(i,()=>e("pwa.installMessage")),a.$$click=l,m(a,()=>e("pwa.dismissButton")),d.$$click=s,m(d,()=>e("pwa.installButton")),w(e=>{var s=qe,l=Ke,c=Ge,u=Je,p=Xe,g=Ze,h=Ye;return s!==e.e&&b(t,e.e=s),l!==e.t&&b(n,e.t=l),c!==e.a&&b(r,e.a=c),u!==e.o&&b(i,e.o=u),p!==e.i&&b(o,e.i=p),g!==e.n&&b(a,e.n=g),h!==e.s&&b(d,e.s=h),e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),t}})}v(["click"]);const nt="_navItemWrapper_p232u_3",rt="_navItem_p232u_3",it="_active_p232u_27",ot="_section_p232u_34",at="_separator_p232u_56",st="_expandIcon_p232u_62",lt="_expanded_p232u_80",dt="_expandSpacer_p232u_84",ct="_label_p232u_90",ut="_children_p232u_97";var pt=k("<span>‚ñ∂"),gt=k("<div>"),ht=k("<div><a><span>"),_t=k("<span>");function vt(e){const n=()=>e.item.children&&e.item.children.length>0,i=()=>{if(!n())return!1;const t=e.currentRoute,r=n=>{for(const i of n){if(e.isActive(i.url,t))return!0;if(i.children&&r(i.children))return!0}return!1};return r(e.item.children||[])},[o,a]=t(C(()=>0===e.depth||i()));c(()=>{e.currentRoute&&i()&&a(!0)});const s=t=>{t.preventDefault(),n()&&!e.item.url?a(!o()):e.item.url&&(n()&&a(!0),e.onNavigate(e.item.url))},l=e=>{e.preventDefault(),e.stopPropagation(),a(!o())};return d=ht(),u=d.firstChild,p=u.firstChild,u.$$click=s,m(u,r(y,{get when(){return n()},get fallback(){return e=_t(),w(()=>b(e,dt)),e;var e},get children(){var e=pt();return e.$$click=l,w(()=>b(e,(()=>{let e=st;return o()&&(e+=" "+lt),e})())),e}}),p),m(p,()=>e.item.label),m(d,r(y,{get when(){return $(()=>!!o())()&&n()},get children(){var t=gt();return m(t,r(S,{get each(){return e.item.children},children:t=>r(vt,{item:t,get depth(){return e.depth+1},get isActive(){return e.isActive},get onNavigate(){return e.onNavigate},get currentRoute(){return e.currentRoute}})})),w(()=>b(t,ut)),t}}),null),w(t=>{var r=nt,i=e.item.url||"#",o=(()=>{let t=rt;return e.isActive(e.item.url,e.currentRoute)&&(t+=" "+it),0===e.depth&&n()&&(t+=" "+ot),e.item.separator&&(t+=" "+at),t})(),a=12*e.depth+16+"px",s=ct;return r!==t.e&&b(d,t.e=r),i!==t.t&&x(u,"href",t.t=i),o!==t.a&&b(u,t.a=o),a!==t.o&&I(u,"padding-left",t.o=a),s!==t.i&&b(p,t.i=s),t},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),d;var d,u,p}v(["click"]);const ft="_sidebar_dpyfy_3",mt="_nav_dpyfy_13",wt="_mobileOpen_dpyfy_31";var bt=k("<aside><nav>");function kt(e){const{t:t}=J(),{user:n}=ce(),i=N(),o=T(),a=()=>e.currentRoute??(()=>{const e=i.pathname,t=i.hash?.slice(1)||void 0;if("/settings/user"===e||"/settings/user/"===e)return{type:"profile"};if("/settings/server"===e||"/settings/server/"===e)return{type:"server"};const n=e.match(/^\/settings\/workspace\/([^+/]+)/);if(n)return{type:"workspace",id:n[1],section:t};const r=e.match(/^\/settings\/org\/([^+/]+)/);return r?{type:"org",id:r[1],section:t}:{type:"profile"}})(),s=t=>{e.onNavigate?e.onNavigate(t):o(t)},l=(e,t)=>{if(!e)return!1;if("/settings/user"===e&&"profile"===t.type)return!0;if("/settings/server"===e&&"server"===t.type)return!0;if("workspace"===t.type&&t.id){const n=e.match(/^\/settings\/workspace\/([^+/]+)/);if(n&&n[1]===t.id){const[,n]=e.split("#");return n?t.section===n:!t.section}}if("org"===t.type&&t.id){const n=e.match(/^\/settings\/org\/([^+/]+)/);if(n&&n[1]===t.id){const[,n]=e.split("#");return n?t.section===n:!t.section}}return!1};return d=bt(),c=d.firstChild,m(c,r(S,{get each(){return(()=>{const e=[],r=n();if(!r)return e;e.push({id:"user",label:t("settings.personal"),url:Se("user")});const i=r.workspaces||[];if(i.length>0){const n=i.map(e=>{const n=e.workspace_id,r=e.workspace_name||n,i=e.role===he,o=[{id:`ws-${n}-members`,label:t("settings.members"),url:Se("workspace",n,r)+"#members"},{id:`ws-${n}-settings`,label:t("settings.settings"),url:Se("workspace",n,r)+"#settings"}];return i&&o.push({id:`ws-${n}-sync`,label:t("settings.gitSync"),url:Se("workspace",n,r)+"#sync"}),{id:`ws-${n}`,label:r,url:Se("workspace",n,r),children:o}});e.push({id:"workspaces",label:t("settings.workspaces"),url:"",children:n})}const o=(r.organizations||[]).filter(e=>e.role===ge||e.role===pe);if(o.length>0){const n=o.map(e=>{const n=e.organization_id,r=e.organization_name||n;return{id:`org-${n}`,label:r,url:Se("org",n,r),children:[{id:`org-${n}-members`,label:t("settings.members"),url:Se("org",n,r)+"#members"},{id:`org-${n}-settings`,label:t("settings.settings"),url:Se("org",n,r)+"#settings"}]}});e.push({id:"organizations",label:t("settings.organizations"),url:"",children:n})}return r.is_global_admin&&e.push({id:"server",label:t("server.serverSettings"),url:Se("server")}),e.push({id:"privacy",label:t("app.privacyPolicy"),url:"/privacy",separator:!0}),e.push({id:"terms",label:t("app.terms"),url:"/terms"}),e})()},children:e=>r(vt,{item:e,depth:0,isActive:l,onNavigate:s,get currentRoute(){return a()}})})),w(t=>{var n=`${ft} ${e.isOpen?wt:""}`,r=mt;return n!==t.e&&b(d,t.e=n),r!==t.t&&b(c,t.t=r),t},{e:void 0,t:void 0}),d;var d,c}const yt="_settingsPage_1ihhv_3",$t="_header_1ihhv_10",Ct="_headerLeft_1ihhv_21",St="_hamburger_1ihhv_27",xt="_backButton_1ihhv_37",It="_title_1ihhv_53",Nt="_layout_1ihhv_64",Tt="_content_1ihhv_70",zt="_mobileBackdrop_1ihhv_81";var Et=k("<div>"),Lt=k('<div><header><div><button aria-label="Toggle settings menu">&#9776;</button><button>&larr; </button><h1></h1></div></header><div><main>');function Rt(e){const{t:n}=J(),{user:i}=ce(),o=T(),a=N(),[s,l]=t(!1),c=e=>{"Escape"===e.key&&s()&&l(!1)};d(()=>{window.addEventListener("keydown",c),_(()=>window.removeEventListener("keydown",c))});const u=()=>{o(-1)},p=()=>{const e=i()?.workspace_id,t=i()?.workspace_name;e&&o($e(e,t))},g=e=>{l(!1),o(e)};return(()=>{var t=Lt(),i=t.firstChild,o=i.firstChild,d=o.firstChild,c=d.nextSibling;c.firstChild;var h=c.nextSibling,_=i.nextSibling,v=_.firstChild;return d.$$click=()=>l(!s()),c.$$click=u,m(c,()=>n("common.back"),null),h.$$click=p,m(h,()=>n("settings.title")),m(_,r(y,{get when(){return s()},get children(){var e=Et();return e.$$click=()=>l(!1),w(()=>b(e,zt)),e}}),v),m(_,r(kt,{get isOpen(){return s()},get currentRoute(){return(()=>{const e=a.pathname,t=a.hash?.slice(1)||void 0;if("/settings/user"===e||"/settings/user/"===e)return{type:"profile"};if("/settings/server"===e||"/settings/server/"===e)return{type:"server"};const n=e.match(/^\/settings\/workspace\/([^+/]+)/);if(n)return{type:"workspace",id:n[1],section:t};const r=e.match(/^\/settings\/org\/([^+/]+)/);return r?{type:"org",id:r[1],section:t}:{type:"profile"}})()},onNavigate:g}),v),m(v,()=>e.children),w(e=>{var n=yt,r=$t,a=Ct,s=St,l=xt,u=It,p=Nt,g=Tt;return n!==e.e&&b(t,e.e=n),r!==e.t&&b(i,e.t=r),a!==e.a&&b(o,e.a=a),s!==e.o&&b(d,e.o=s),l!==e.i&&b(c,e.i=l),u!==e.n&&b(h,e.n=u),p!==e.s&&b(_,e.s=p),g!==e.h&&b(v,e.h=g),e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),t})()}v(["click"]);var Pt=k("<div style=padding:2rem;color:var(--c-text-light)>");const Dt=R(()=>H(()=>import("./ProfileSettings-DDDQL9M5.js"),__vite__mapDeps([0,1,2]))),jt=R(()=>H(()=>import("./WorkspaceSettingsPanel-Dj1ipeJE.js"),__vite__mapDeps([3,1,4,5,6]))),At=R(()=>H(()=>import("./OrgSettingsPanel-ZFYoeN2n.js"),__vite__mapDeps([7,1,4,5,8]))),Ot=R(()=>H(()=>import("./ServerSettingsPanel-DxCo2cSb.js"),__vite__mapDeps([9,1,10])));function Vt(){const{t:e}=J();return t=Pt(),m(t,()=>e("common.loading")),t;var t}function Wt(){const{user:e}=ce();return r(y,{get when(){return e()?.is_global_admin},get fallback(){return r(z,{href:"/settings/user"})},get children(){return r(E,{get fallback(){return r(Vt,{})},get children(){return r(Ot,{})}})}})}function Mt(){const e=L(),t=N(),n=T(),{user:i}=ce(),o=()=>{const t=e.wsId;return t?.split("+")[0]||""},a=(e,t)=>{n(Se("org",e,t))};return r(y,{get when(){return(()=>{const e=i();return e?.workspaces?.some(e=>e.workspace_id===o())})()},get fallback(){return r(z,{href:"/settings/user"})},get children(){return r(E,{get fallback(){return r(Vt,{})},get children(){return r(jt,{get wsId(){return o()},get section(){return t.hash?.slice(1)||void 0},onNavigateToOrgSettings:a})}})}})}function Ut(){const e=L(),t=N(),{user:n}=ce(),i=()=>{const t=e.orgId;return t?.split("+")[0]||""};return r(y,{get when(){return(()=>{const e=n();return e?.organizations?.some(e=>e.organization_id===i())})()},get fallback(){return r(z,{href:"/settings/user"})},get children(){return r(E,{get fallback(){return r(Vt,{})},get children(){return r(At,{get orgId(){return i()},get section(){return t.hash?.slice(1)||void 0}})}})}})}function Bt(){return r(E,{get fallback(){return r(Vt,{})},get children(){return r(Dt,{})}})}function Ft(){return r(z,{href:"/settings/user"})}function Ht(e){return r(Rt,{get children(){return e.children}})}const qt="_sidebarNodeWrapper_i1nam_1",Kt="_childList_i1nam_2",Gt="_pageItem_i1nam_13",Jt="_active_i1nam_28",Xt="_nodeIcon_i1nam_34",Yt="_pageTitleText_i1nam_41",Zt="_expandIcon_i1nam_49",Qt="_hidden_i1nam_67",en="_loading_i1nam_67",tn="_expanded_i1nam_72",nn="_contextMenu_i1nam_95",rn="_contextMenuItem_i1nam_107",on="_contextMenuDivider_i1nam_124",an="_hoverDeleteButton_i1nam_131";var sn=k("<div><button>üìÑ </button><button>üìä </button><div></div><button>üïê "),ln=k("<ul>"),dn=k("<li><div><span></span><span></span><span></span><button>üóë");function cn(e){const{t:n}=J(),i=C(()=>0===e.depth||e.ancestorIds.includes(e.node.id)),[o,a]=t(i),[s,l]=t(!1),[d,u]=t({x:0,y:0}),[p,g]=t(!1),h=()=>e.node.children??[],_=()=>!!(e.node.children&&e.node.children.length>0)||!0===e.node.has_children;c(()=>{const t=e.selectedId,n=h();t&&n.some(e=>e.id===t)&&a(!0)});let v=!1;c(P(()=>e.ancestorIds.length,(t,n)=>{(void 0===n||0===n)&&t>0&&!v&&e.ancestorIds.includes(e.node.id)&&(v=!0,a(!0))})),c(()=>{o()&&_()&&!e.node.children&&e.onFetchChildren&&(g(!0),e.onFetchChildren(e.node.id).finally(()=>g(!1)))});const f=e=>{e.stopPropagation(),a(!o())},k=e=>{e.preventDefault(),e.stopPropagation(),u({x:e.clientX,y:e.clientY}),l(!0)},N=()=>l(!1);return T=dn(),z=T.firstChild,E=z.firstChild,L=E.nextSibling,R=L.nextSibling,j=R.nextSibling,T.$$click=N,z.$$contextmenu=k,z.$$click=()=>e.onSelect(e.node),E.$$click=f,m(E,()=>p()?"‚óã":"‚ñ∂"),m(L,()=>e.node.has_table&&!e.node.has_page?"üìä":"üìÑ"),m(R,()=>e.node.title),j.$$click=t=>{t.stopPropagation(),e.onDeleteNode?.(e.node.id)},m(T,r(y,{get when(){return s()},get children(){var t=sn(),r=t.firstChild;r.firstChild;var i=r.nextSibling;i.firstChild;var o=i.nextSibling,a=o.nextSibling;return a.firstChild,t.$$click=e=>e.stopPropagation(),r.$$click=()=>{e.onCreateChildPage(e.node.id),l(!1)},m(r,()=>n("app.createSubPage"),null),i.$$click=()=>{e.onCreateChildTable(e.node.id),l(!1)},m(i,()=>n("app.createSubTable"),null),a.$$click=()=>{e.onShowHistory?.(e.node.id),l(!1)},m(a,()=>n("editor.history"),null),w(e=>{var n=nn,s=`${d().x}px`,l=`${d().y}px`,c=rn,u=rn,p=on,g=rn;return n!==e.e&&b(t,e.e=n),s!==e.t&&I(t,"left",e.t=s),l!==e.a&&I(t,"top",e.a=l),c!==e.o&&b(r,e.o=c),u!==e.i&&b(i,e.i=u),p!==e.n&&b(o,e.n=p),g!==e.s&&b(a,e.s=g),e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),t}}),null),m(T,r(y,{get when(){return $(()=>!!o())()&&h().length>0},get children(){var t=ln();return m(t,r(S,{get each(){return h()},children:t=>r(cn,{node:t,get selectedId(){return e.selectedId},get ancestorIds(){return e.ancestorIds},get onSelect(){return e.onSelect},get onCreateChildPage(){return e.onCreateChildPage},get onCreateChildTable(){return e.onCreateChildTable},get onFetchChildren(){return e.onFetchChildren},get onDeleteNode(){return e.onDeleteNode},get onShowHistory(){return e.onShowHistory},get depth(){return e.depth+1}})})),w(()=>b(t,Kt)),t}}),null),w(t=>{var r=qt,i=`sidebar-node-${e.node.id}`,a=Gt,s={[`${Jt}`]:e.selectedId===e.node.id},l=12*e.depth+8+"px",d=Zt,c={[`${tn}`]:o(),[`${Qt}`]:!_(),[`${en}`]:p()},u=`expand-icon-${e.node.id}`,g=Xt,h=Yt,v=an,f=n("common.delete")||"Delete";return r!==t.e&&b(T,t.e=r),i!==t.t&&x(T,"data-testid",t.t=i),a!==t.a&&b(z,t.a=a),t.o=D(z,s,t.o),l!==t.i&&I(z,"padding-left",t.i=l),d!==t.n&&b(E,t.n=d),t.s=D(E,c,t.s),u!==t.h&&x(E,"data-testid",t.h=u),g!==t.r&&b(L,t.r=g),h!==t.d&&b(R,t.d=h),v!==t.l&&b(j,t.l=v),f!==t.u&&x(j,"title",t.u=f),t},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0}),T;var T,z,E,L,R,j}v(["click","contextmenu"]);const un="_sidebar_9pf58_1",pn="_open_9pf58_16",gn="_collapseButton_9pf58_20",hn="_sidebarHeader_9pf58_36",_n="_sidebarActions_9pf58_51",vn="_actionButton_9pf58_58",fn="_loading_9pf58_74",mn="_pageList_9pf58_80";var wn=k("<p>"),bn=k("<aside><div><h2></h2><button>¬´</button></div><div><button>+ </button><button>+ </button></div><ul>");function kn(e){const{t:t}=J();return(()=>{var n=bn(),i=n.firstChild,o=i.firstChild,a=o.nextSibling,s=i.nextSibling,l=s.firstChild;l.firstChild;var d=l.nextSibling;d.firstChild;var c=s.nextSibling;return m(o,()=>t("app.workspace")),a.$$click=()=>e.onCloseMobileSidebar(),l.$$click=()=>e.onCreatePage(),m(l,()=>t("app.page"),null),d.$$click=()=>e.onCreateTable(),m(d,()=>t("app.table"),null),m(n,r(y,{get when(){return $(()=>!!e.loading)()&&0===e.nodes.length},get children(){var e=wn();return m(e,()=>t("common.loading")),w(()=>b(e,fn)),e}}),c),m(c,r(S,{get each(){return e.nodes},children:t=>r(cn,{node:t,get selectedId(){return e.selectedNodeId},get ancestorIds(){return e.ancestorIds},get onSelect(){return e.onSelectNode},get onCreateChildPage(){return e.onCreateChildPage},get onCreateChildTable(){return e.onCreateChildTable},get onFetchChildren(){return e.onFetchChildren},get onDeleteNode(){return e.onDeleteNode},get onShowHistory(){return e.onShowHistory},depth:0})})),w(r=>{var o=`${un} ${e.isOpen?pn:""}`,u=hn,p=gn,g=t("app.collapseSidebar")||"Collapse sidebar",h=_n,_=t("app.newPage")||"New Page",v=vn,f=t("app.newTable")||"New Table",m=vn,w=mn;return o!==r.e&&b(n,r.e=o),u!==r.t&&b(i,r.t=u),p!==r.a&&b(a,r.a=p),g!==r.o&&x(a,"title",r.o=g),h!==r.i&&b(s,r.i=h),_!==r.n&&x(l,"title",r.n=_),v!==r.s&&b(l,r.s=v),f!==r.h&&x(d,"title",r.h=f),m!==r.r&&b(d,r.r=m),w!==r.d&&b(c,r.d=w),r},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0}),n})()}function yn(e,t){d(()=>{const n=n=>{const r=e();r&&!r.contains(n.target)&&t()};document.addEventListener("mousedown",n),_(()=>{document.removeEventListener("mousedown",n)})})}v(["click"]);const $n="_wsMenu_1kkrz_1",Cn="_wsButton_1kkrz_5",Sn="_wsName_1kkrz_23",xn="_chevron_1kkrz_31",In="_dropdown_1kkrz_36",Nn="_wsList_1kkrz_49",Tn="_orgHeader_1kkrz_54",zn="_wsItem_1kkrz_65",En="_active_1kkrz_84",Ln="_wsItemName_1kkrz_88",Rn="_checkmark_1kkrz_94",Pn="_divider_1kkrz_99",Dn="_menuItem_1kkrz_104",jn="_icon_1kkrz_123",An="_plusIcon_1kkrz_127";var On=k("<div role=menu><div></div><div></div><button role=menuitem><span aria-hidden=true>‚öô</span></button><button role=menuitem><span aria-hidden=true>+</span></button><button role=menuitem><span aria-hidden=true>&#x2B07;"),Vn=k("<div><button aria-haspopup=menu><span></span><span aria-hidden=true>"),Wn=k("<div>"),Mn=k("<span aria-hidden=true>‚úì"),Un=k("<button role=menuitem><span>");function Bn(e){const{t:n}=J(),i=T(),{user:o}=ce(),{switchWorkspace:a}=be(),[s,d]=t(!1);let c;const u=l(()=>{const e=o();if(!e)return[];const t=new Map,n=e.organizations||[],r=e.workspaces||[];for(const i of n)t.set(i.organization_id,{orgId:i.organization_id,orgName:i.organization_name||i.organization_id,workspaces:[]});for(const i of r){const e=t.get(i.organization_id);e&&e.workspaces.push(i)}return Array.from(t.values()).filter(e=>e.workspaces.length>0)}),p=()=>o()?.workspace_id||"",g=()=>{const e=o();if(!e)return n("app.workspace");const t=e.workspaces?.find(t=>t.workspace_id===e.workspace_id);return t?.workspace_name||n("app.workspace")};yn(()=>c,()=>d(!1));const h=()=>{d(!1),e.onOpenSettings()},_=()=>{d(!1),e.onCreateWorkspace()},v=()=>{d(!1),e.onImportFromNotion()},f=l(()=>u().length>1);return k=Vn(),$=k.firstChild,C=$.firstChild,I=C.nextSibling,"function"==typeof c?j(c,k):c=k,$.$$click=()=>d(!s()),m(C,g),m(I,()=>s()?"‚ñ≤":"‚ñº"),m(k,r(y,{get when(){return s()},get children(){var t=On(),s=t.firstChild,l=s.nextSibling,c=l.nextSibling,g=c.firstChild,k=c.nextSibling,$=k.firstChild,C=k.nextSibling,x=C.firstChild;return m(s,r(S,{get each(){return u()},children:t=>[r(y,{get when(){return f()},get children(){var e=Wn();return m(e,()=>t.orgName),w(()=>b(e,Tn)),e}}),r(S,{get each(){return t.workspaces},children:t=>{return n=Un(),s=n.firstChild,n.$$click=()=>(async t=>{if(d(!1),e.onSwitchWorkspace?.(),t!==p()){await a(t);const e=o(),n=e?.workspace_id,r=e?.workspace_name;n&&i($e(n,r))}})(t.workspace_id),m(s,()=>t.workspace_name||t.workspace_id),m(n,r(y,{get when(){return t.workspace_id===p()},get children(){var e=Mn();return w(()=>b(e,Rn)),e}}),null),w(e=>{var r=`${zn} ${t.workspace_id===p()?En:""}`,i=Ln;return r!==e.e&&b(n,e.e=r),i!==e.t&&b(s,e.t=i),e},{e:void 0,t:void 0}),n;var n,s}})]})),c.$$click=h,m(c,()=>n("app.settings"),null),k.$$click=_,m(k,()=>n("createWorkspace.title"),null),C.$$click=v,m(C,()=>n("notionImport.title"),null),w(e=>{var n=In,r=Nn,i=Pn,o=Dn,a=jn,d=Dn,u=An,p=Dn,h=jn;return n!==e.e&&b(t,e.e=n),r!==e.t&&b(s,e.t=r),i!==e.a&&b(l,e.a=i),o!==e.o&&b(c,e.o=o),a!==e.i&&b(g,e.i=a),d!==e.n&&b(k,e.n=d),u!==e.s&&b($,e.s=u),p!==e.h&&b(C,e.h=p),h!==e.r&&b(x,e.r=h),e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0}),t}}),null),w(e=>{var t=$n,r=Cn,i=g(),o=n("app.switchWorkspace")||"Switch workspace",a=s(),l=Sn,d=xn;return t!==e.e&&b(k,e.e=t),r!==e.t&&b($,e.t=r),i!==e.a&&x($,"title",e.a=i),o!==e.o&&x($,"aria-label",e.o=o),a!==e.i&&x($,"aria-expanded",e.i=a),l!==e.n&&b(C,e.n=l),d!==e.s&&b(I,e.s=d),e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),k;var k,$,C,I}v(["click"]);const Fn="_userMenu_o60yu_1",Hn="_avatarButton_o60yu_5",qn="_avatarImage_o60yu_24",Kn="_initials_o60yu_30",Gn="_dropdown_o60yu_37",Jn="_userInfo_o60yu_50",Xn="_userName_o60yu_57",Yn="_userEmail_o60yu_63",Zn="_userRole_o60yu_68",Qn="_divider_o60yu_78",er="_menuItem_o60yu_83";var tr=k("<span>"),nr=k("<div role=menu><div><span></span><span></span></div><div></div><button role=menuitem></button><button role=menuitem>"),rr=k("<div><button aria-haspopup=menu data-testid=user-menu-button>"),ir=k("<img referrerpolicy=no-referrer>");function or(e){const n=T(),{t:i}=J(),{user:o,logout:a}=ce(),[s,l]=t(!1);let d;const c=()=>{const e=o();if(!e)return"";const t=e.name||e.email||"",n=t.split(/[\s@]+/);return n.length>=2&&n[0]&&n[1]?((n[0][0]||"")+(n[1][0]||"")).toUpperCase():t.slice(0,2).toUpperCase()},u=()=>o()?.name||"",p=()=>o()?.email||"",g=()=>o()?.workspace_role;yn(()=>d,()=>l(!1));const h=async()=>{l(!1),await a(),n("/")},_=()=>{l(!1),e.onProfile()};return v=rr(),f=v.firstChild,"function"==typeof d?j(d,v):d=v,f.$$click=()=>l(!s()),m(f,r(y,{get when(){return(()=>{const e=o();if(!e)return null;const t=e.oauth_identities;if(!t)return null;for(const n of t)if(n.avatar_url)return n.avatar_url;return null})()},get fallback(){return e=tr(),m(e,c),w(()=>b(e,Kn)),e;var e},children:e=>{return t=ir(),w(n=>{var r=e(),i=u()||"User",o=qn;return r!==n.e&&x(t,"src",n.e=r),i!==n.t&&x(t,"alt",n.t=i),o!==n.a&&b(t,n.a=o),n},{e:void 0,t:void 0,a:void 0}),t;var t}})),m(v,r(y,{get when(){return s()},get children(){var e=nr(),t=e.firstChild,n=t.firstChild,o=n.nextSibling,a=t.nextSibling,s=a.nextSibling,l=s.nextSibling;return m(n,u),m(o,p),m(t,r(y,{get when(){return g()},get children(){var e=tr();return m(e,g),w(()=>b(e,Zn)),e}}),null),s.$$click=_,m(s,()=>i("userMenu.profile")),l.$$click=h,m(l,()=>i("userMenu.logout")),w(r=>{var i=Gn,d=Jn,c=Xn,u=Yn,p=Qn,g=er,h=er;return i!==r.e&&b(e,r.e=i),d!==r.t&&b(t,r.t=d),c!==r.a&&b(n,r.a=c),u!==r.o&&b(o,r.o=u),p!==r.i&&b(a,r.i=p),g!==r.n&&b(s,r.n=g),h!==r.s&&b(l,r.s=h),r},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),e}}),null),w(e=>{var t=Fn,n=Hn,r=u()||p(),o=i("userMenu.profile")||"User menu",a=s();return t!==e.e&&b(v,e.e=t),n!==e.t&&b(f,e.t=n),r!==e.a&&x(f,"title",e.a=r),o!==e.o&&x(f,"aria-label",e.o=o),a!==e.i&&x(f,"aria-expanded",e.i=a),e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),v;var v,f}v(["click"]);const ar="_banner_tmw21_1",sr="_success_tmw21_11",lr="_error_tmw21_16",dr="_cancelled_tmw21_21",cr="_icon_tmw21_26",ur="_content_tmw21_30",pr="_message_tmw21_37",gr="_progress_tmw21_41",hr="_stats_tmw21_46",_r="_stat_tmw21_46",vr="_statValue_tmw21_58",fr="_actions_tmw21_63",mr="_cancelButton_tmw21_68",wr="_dismissButton_tmw21_82",br="_spinner_tmw21_95";var kr=k("<span>&#x21BB;"),yr=k("<span>&#x2713;"),$r=k("<span>&#x2717;"),Cr=k("<span>&#x26A0;"),Sr=k("<span>/<!>: "),xr=k("<span><span></span> "),Ir=k("<div>"),Nr=k("<span>"),Tr=k("<button>"),zr=k("<div><span></span><div><span></span></div><div>");function Er(e){const{t:t}=J(),n=()=>e.status,i=()=>{switch(n().status){case"running":return t("notionImport.importInProgress");case"completed":return t("notionImport.importCompleted");case"failed":return t("notionImport.importFailed");case"cancelled":return t("notionImport.importCancelled");default:return""}},o=()=>{switch(n().status){case"running":return e=kr(),w(()=>b(e,br)),e;case"completed":return yr();case"failed":return $r();case"cancelled":return Cr();default:return null}var e},a=()=>["completed","failed","cancelled"].includes(n().status);return s=zr(),l=s.firstChild,d=l.nextSibling,c=d.firstChild,u=d.nextSibling,m(l,o),m(c,i),m(d,r(y,{get when(){return $(()=>"running"===n().status)()&&n().message},get children(){var e=Sr(),t=e.firstChild,r=t.nextSibling;return r.nextSibling,m(e,()=>n().progress,t),m(e,()=>n().total,r),m(e,()=>n().message,null),w(()=>b(e,gr)),e}}),null),m(d,r(y,{get when(){return $(()=>!!a())()&&(n().pages||n().databases||n().records)},get children(){var e=Ir();return m(e,r(y,{get when(){return n().pages},get children(){var e=xr(),r=e.firstChild;return r.nextSibling,m(r,()=>n().pages),m(e,()=>t("notionImport.pagesImported"),null),w(t=>{var n=_r,i=vr;return n!==t.e&&b(e,t.e=n),i!==t.t&&b(r,t.t=i),t},{e:void 0,t:void 0}),e}}),null),m(e,r(y,{get when(){return n().databases},get children(){var e=xr(),r=e.firstChild;return r.nextSibling,m(r,()=>n().databases),m(e,()=>t("notionImport.databasesImported"),null),w(t=>{var n=_r,i=vr;return n!==t.e&&b(e,t.e=n),i!==t.t&&b(r,t.t=i),t},{e:void 0,t:void 0}),e}}),null),m(e,r(y,{get when(){return n().records},get children(){var e=xr(),r=e.firstChild;return r.nextSibling,m(r,()=>n().records),m(e,()=>t("notionImport.recordsImported"),null),w(t=>{var n=_r,i=vr;return n!==t.e&&b(e,t.e=n),i!==t.t&&b(r,t.t=i),t},{e:void 0,t:void 0}),e}}),null),m(e,r(y,{get when(){return n().assets},get children(){var e=xr(),r=e.firstChild;return r.nextSibling,m(r,()=>n().assets),m(e,()=>t("notionImport.assetsImported"),null),w(t=>{var n=_r,i=vr;return n!==t.e&&b(e,t.e=n),i!==t.t&&b(r,t.t=i),t},{e:void 0,t:void 0}),e}}),null),m(e,r(y,{get when(){return n().errors},get children(){var e=xr(),r=e.firstChild;return r.nextSibling,m(r,()=>n().errors),m(e,()=>t("notionImport.errorsEncountered"),null),w(t=>{var n=_r,i=vr;return n!==t.e&&b(e,t.e=n),i!==t.t&&b(r,t.t=i),t},{e:void 0,t:void 0}),e}}),null),w(()=>b(e,hr)),e}}),null),m(d,r(y,{get when(){return $(()=>"failed"===n().status)()&&n().message},get children(){var e=Nr();return m(e,()=>n().message),w(()=>b(e,gr)),e}}),null),m(u,r(y,{get when(){return"running"===n().status},get children(){var n=Tr();return n.$$click=()=>e.onCancel(),m(n,()=>t("notionImport.cancel")),w(()=>b(n,mr)),n}}),null),m(u,r(y,{get when(){return a()},get children(){var n=Tr();return n.$$click=()=>e.onDismiss(),m(n,()=>t("notionImport.dismiss")),w(()=>b(n,wr)),n}}),null),w(e=>{var t=(()=>{switch(n().status){case"completed":return`${ar} ${sr}`;case"failed":return`${ar} ${lr}`;case"cancelled":return`${ar} ${dr}`;default:return ar}})(),r=cr,i=ur,o=pr,a=fr;return t!==e.e&&b(s,e.e=t),r!==e.t&&b(l,e.t=r),i!==e.a&&b(d,e.a=i),o!==e.o&&b(c,e.o=o),a!==e.i&&b(u,e.i=a),e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),s;var s,l,d,c,u}v(["click"]);const Lr="_overlay_v0iwf_1",Rr="_modal_v0iwf_11",Pr="_header_v0iwf_28",Dr="_formGroup_v0iwf_53",jr="_primaryButton_v0iwf_76",Ar="_secondaryButton_v0iwf_99",Or="_actions_v0iwf_113",Vr="_error_v0iwf_127";var Wr=k("<button type=button>"),Mr=k("<div><div><header><h2></h2><p></p></header><form><div><label></label><input type=text autofocus></div><div><button type=submit>"),Ur=k("<div>");function Br(e){const{t:n}=J(),[i,o]=t(""),[a,s]=t(!1),[l,d]=t(null),c=async t=>{if(t.preventDefault(),i().trim())try{s(!0),d(null),await e.onCreate({name:i().trim()}),e.onClose()}catch(n){d(String(n))}finally{s(!1)}},u=t=>{e.isFirstWorkspace||t.target!==t.currentTarget||e.onClose()};return v=Mr(),f=v.firstChild,k=f.firstChild,C=k.firstChild,S=C.nextSibling,I=k.nextSibling,N=I.firstChild,T=N.firstChild,z=T.nextSibling,E=N.nextSibling,L=E.firstChild,v.$$click=u,m(C,(p=$(()=>!!e.isFirstWorkspace),()=>p()?n("createWorkspace.firstWorkspaceTitle"):n("createWorkspace.title"))),m(S,(g=$(()=>!!e.isFirstWorkspace),()=>g()?n("createWorkspace.firstWorkspaceDescription"):n("createWorkspace.description"))),m(f,(h=$(()=>!!l()),()=>{return h()&&(e=Ur(),m(e,l),w(()=>b(e,Vr)),e);var e}),I),I.addEventListener("submit",c),m(T,()=>n("createWorkspace.nameLabel")),z.$$input=e=>o(e.target.value),m(E,r(y,{get when(){return!e.isFirstWorkspace},get children(){var t=Wr();return t.$$click=()=>e.onClose(),m(t,()=>n("common.cancel")),w(()=>b(t,Ar)),t}}),L),m(L,(_=$(()=>!!a()),()=>_()?n("common.creating"):n("createWorkspace.create"))),w(t=>{var r=Lr,o=Rr,s=Pr,l=Dr,d=n("createWorkspace.namePlaceholder")||"",c=Or,u=jr,p=!i().trim()||a(),g=e.isFirstWorkspace?{flex:1}:void 0;return r!==t.e&&b(v,t.e=r),o!==t.t&&b(f,t.t=o),s!==t.a&&b(k,t.a=s),l!==t.o&&b(N,t.o=l),d!==t.i&&x(z,"placeholder",t.i=d),c!==t.n&&b(E,t.n=c),u!==t.s&&b(L,t.s=u),p!==t.h&&(L.disabled=t.h=p),t.r=A(L,g,t.r),t},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0}),w(()=>z.value=i()),v;var p,g,h,_,v,f,k,C,S,I,N,T,z,E,L}v(["click","input"]);const Fr="_overlay_1l8b3_1",Hr="_modal_1l8b3_11",qr="_header_1l8b3_28",Kr="_error_1l8b3_43",Gr="_setupBox_1l8b3_53",Jr="_setupHeader_1l8b3_61",Xr="_setupTitle_1l8b3_70",Yr="_createLink_1l8b3_75",Zr="_setupSteps_1l8b3_93",Qr="_subSteps_1l8b3_109",ei="_formGroup_1l8b3_119",ti="_actions_1l8b3_137",ni="_primaryButton_1l8b3_143",ri="_secondaryButton_1l8b3_166";var ii=k('<div><div><header><h2></h2><p></p></header><div><div><span></span><a href=https://www.notion.so/profile/integrations/form/new-integration target=_blank rel="noopener noreferrer"> &#x2197;</a></div><ol><li><ol><li></li><li></li><li></li><li></li></ol></li><li><ol><li></li><li></li></ol></li><li><ol><li></li><li></li></ol></li></ol></div><form><div><label></label><input type=password autofocus></div><div><button type=button></button><button type=submit>'),oi=k("<div>");function ai(e){const{t:n}=J(),[r,i]=t(""),[o,a]=t(!1),[s,l]=t(null),c=t=>{"Escape"!==t.key||o()||e.onClose()};d(()=>{document.addEventListener("keydown",c)}),_(()=>{document.removeEventListener("keydown",c)});const u=async t=>{if(t.preventDefault(),r().trim())try{a(!0),l(null),await e.onImport({notionToken:r().trim()}),e.onClose()}catch(n){l(String(n))}finally{a(!1)}},p=t=>{t.target===t.currentTarget&&e.onClose()};return v=ii(),f=v.firstChild,k=f.firstChild,y=k.firstChild,C=y.nextSibling,S=k.nextSibling,I=S.firstChild,N=I.firstChild,T=N.nextSibling,z=T.firstChild,E=I.nextSibling,L=E.firstChild,R=L.firstChild,P=R.firstChild,D=P.nextSibling,j=D.nextSibling,A=j.nextSibling,O=L.nextSibling,V=O.firstChild,W=V.firstChild,M=W.nextSibling,U=O.nextSibling,B=U.firstChild,F=B.firstChild,H=F.nextSibling,q=S.nextSibling,K=q.firstChild,G=K.firstChild,X=G.nextSibling,Y=K.nextSibling,Z=Y.firstChild,Q=Z.nextSibling,v.$$click=p,m(y,()=>n("notionImport.title")),m(C,()=>n("notionImport.description")),m(f,(g=$(()=>!!s()),()=>{return g()&&(e=oi(),m(e,s),w(()=>b(e,Kr)),e);var e}),S),m(N,()=>n("notionImport.setupTitle")),m(T,()=>n("notionImport.createIntegration"),z),m(L,()=>n("notionImport.step1Header"),R),m(P,()=>n("notionImport.step1a")),m(D,()=>n("notionImport.step1b")),m(j,()=>n("notionImport.step1c")),m(A,()=>n("notionImport.step1d")),m(O,()=>n("notionImport.step2Header"),V),m(W,()=>n("notionImport.step2a")),m(M,()=>n("notionImport.step2b")),m(U,()=>n("notionImport.step3Header"),B),m(F,()=>n("notionImport.step3a")),m(H,()=>n("notionImport.step3b")),q.addEventListener("submit",u),m(G,()=>n("notionImport.notionToken")),X.$$input=e=>i(e.target.value),Z.$$click=()=>e.onClose(),m(Z,()=>n("common.cancel")),m(Q,(h=$(()=>!!o()),()=>h()?n("notionImport.importing"):n("notionImport.startImport"))),w(e=>{var t=Fr,i=Hr,a=qr,s=Gr,l=Jr,d=Xr,c=Yr,u=Zr,p=Qr,g=Qr,h=Qr,_=ei,m=n("notionImport.notionTokenPlaceholder")||"",w=ti,y=ri,$=ni,C=!r().trim()||o();return t!==e.e&&b(v,e.e=t),i!==e.t&&b(f,e.t=i),a!==e.a&&b(k,e.a=a),s!==e.o&&b(S,e.o=s),l!==e.i&&b(I,e.i=l),d!==e.n&&b(N,e.n=d),c!==e.s&&b(T,e.s=c),u!==e.h&&b(E,e.h=u),p!==e.r&&b(R,e.r=p),g!==e.d&&b(V,e.d=g),h!==e.l&&b(B,e.l=h),_!==e.u&&b(K,e.u=_),m!==e.c&&x(X,"placeholder",e.c=m),w!==e.w&&b(Y,e.w=w),y!==e.m&&b(Z,e.m=y),$!==e.f&&b(Q,e.f=$),C!==e.y&&(Q.disabled=e.y=C),e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0}),w(()=>X.value=r()),v;var g,h,v,f,k,y,C,S,I,N,T,z,E,L,R,P,D,j,A,O,V,W,M,U,B,F,H,q,K,G,X,Y,Z,Q}v(["click","input"]);const si="_app_1xgtz_3",li="_sidebarOpen_1xgtz_11",di="_hamburger_1xgtz_15",ci="_header_1xgtz_19",ui="_headerLeft_1xgtz_31",pi="_userInfo_1xgtz_39",gi="_container_1xgtz_46",hi="_main_1xgtz_52",_i="_error_1xgtz_60",vi="_editor_1xgtz_68",fi="_editorLoading_1xgtz_76",mi="_editorHeader_1xgtz_81",wi="_editorStatus_1xgtz_90",bi="_unsavedIndicator_1xgtz_98",ki="_savingIndicator_1xgtz_103",yi="_savedIndicator_1xgtz_108",$i="_titleInput_1xgtz_118",Ci="_nodeContent_1xgtz_128",Si="_tableView_1xgtz_135",xi="_breadcrumbs_1xgtz_143",Ii="_breadcrumbItem_1xgtz_154",Ni="_breadcrumbSeparator_1xgtz_165",Ti="_historyPanel_1xgtz_170",zi="_historyList_1xgtz_184",Ei="_historyItem_1xgtz_191",Li="_historyMeta_1xgtz_204",Ri="_historyDate_1xgtz_212",Pi="_historyHash_1xgtz_216",Di="_historyMessage_1xgtz_223",ji="_mobileBackdrop_1xgtz_242",Ai="_mobileBackdropVisible_1xgtz_246";var Oi=k("<nav>"),Vi=k("<div role=alert aria-live=polite>"),Wi=k('<div><header><div><button aria-label="Toggle menu">‚ò∞</button></div><div></div></header><div><div></div><main>'),Mi=k("<span>/"),Ui=k("<span>");const Bi=e=>{const{t:n}=J(),i=T(),{user:o,wsApi:a,orgApi:s}=ce(),{nodes:l,selectedNodeId:d,breadcrumbPath:c,loading:u,setLoading:p,error:g,setError:h,switchWorkspace:v,createWorkspace:f,loadNodes:k,fetchNodeChildren:$,removeNode:C}=be(),{flushAutoSave:x,loadHistory:I}=De(),[N,z]=t(window.innerWidth>768),[E,L]=t(!1),[R,P]=t(!1),[D,j]=t(null),[A,O]=t(null),[V,W]=t(null);let M;const U=async e=>{const t=s();if(!t)return;const n=await t.notion.startImport({notion_token:e.notionToken});await v(n.workspace_id);const r=o(),a=r?.workspace_id,l=r?.workspace_name;var d;a&&i($e(a,l)),d=n.workspace_id,O(d),M=window.setInterval(async()=>{const e=s();if(e)try{const t=await e.notion.getStatus(d);j(t),["completed","failed","cancelled"].includes(t.status)&&(window.clearInterval(M),M=void 0,"completed"===t.status&&k(!0))}catch{window.clearInterval(M),M=void 0}},2e3),j({status:"running",progress:0,total:0})},B=async()=>{const e=a(),t=A();if(e&&t)try{await e.notion.cancelImport(),j(e=>e?{...e,status:"cancelled"}:null)}catch{}},F=()=>{M&&(window.clearInterval(M),M=void 0),j(null),O(null)};async function H(e="document",t){const r=a();if(r)try{p(!0);const a=t||V()||"0";let s;const l="table"===e?n("welcome.untitledTable")||"Untitled Table":n("welcome.untitledPage")||"Untitled Page";if("table"===e){s=(await r.nodes.table.createTable(a,{title:l,properties:[{name:"Name",type:"text",required:!1}]})).id}else{s=(await r.nodes.page.createPage(a,{title:l})).id}await k(!0);const d=o(),c=d?.workspace_id,u=d?.workspace_name;c&&i(Ce(c,u,String(s),l)),h(null),W(null)}catch(s){h(`${n("errors.failedToCreate")}: ${s}`)}finally{p(!1)}}_(()=>{M&&window.clearInterval(M)});const q=e=>{x();const t=o(),n=t?.workspace_id,r=t?.workspace_name;n&&i(Ce(n,r,e.id,e.title)),window.innerWidth<=768&&z(!1)};function K(e,t=l,n=null){const r=t.findIndex(t=>t.id===e);if(-1!==r)return{parent:n,siblings:t,index:r};for(const i of t)if(i.children){const t=K(e,i.children,i);if(t)return t}return null}async function G(e){const t=a();if(!t)return;if(!confirm(n("table.confirmDeleteRecord")||"Delete this item?"))return;let r=null;if(e===d()){const t=K(e);if(t){const{parent:e,siblings:n,index:i}=t;e&&"0"!==e.id?r=e:i>0?r=n[i-1]??null:n.length>1&&(r=n[1]??null)}}try{if(p(!0),await t.nodes.deleteNode(e),C(e),e===d()){const e=o(),t=e?.workspace_id,n=e?.workspace_name;r&&t?i(Ce(t,n,r.id,r.title)):t&&(await k(!0),i(`/w/${t}+${n||"workspace"}/`))}}catch(s){h(`${n("errors.failedToDelete")}: ${s}`)}finally{p(!1)}}return X=Wi(),Y=X.firstChild,Z=Y.firstChild,Q=Z.firstChild,ee=Z.nextSibling,te=Y.nextSibling,ne=te.firstChild,re=ne.nextSibling,m(X,r(y,{get when(){return D()},keyed:!0,children:e=>r(Er,{status:e,onCancel:B,onDismiss:F})}),Y),Q.$$click=()=>z(!N()),m(Z,r(Bn,{onOpenSettings:()=>{const e=o()?.workspace_id,t=o()?.workspace_name;e&&(z(!1),i(Se("workspace",e,t)))},onSwitchWorkspace:()=>{},onCreateWorkspace:()=>L(!0),onImportFromNotion:()=>P(!0)}),null),m(Z,r(y,{get when(){return d()},get children(){var e=Oi();return m(e,r(S,{get each(){return c()},children:(e,t)=>{return[r(y,{get when(){return t()>0},get children(){var e=Mi();return w(()=>b(e,Ni)),e}}),(n=Ui(),n.$$click=()=>q(e),m(n,()=>e.title),w(()=>b(n,Ii)),n)];var n}})),w(()=>b(e,xi)),e}}),null),m(ee,r(or,{onProfile:()=>{i(Se("user"))}})),ne.$$click=()=>z(!1),m(te,r(kn,{get isOpen(){return N()},get loading(){return u()},nodes:l,get selectedNodeId(){return d()},get ancestorIds(){return c().map(e=>e.id)},onCreatePage:()=>{W(null),H("document"),z(!1)},onCreateTable:()=>{W(null),H("table"),z(!1)},onCreateChildPage:e=>{W(e),H("document",e),z(!1)},onCreateChildTable:e=>{W(e),H("table",e),z(!1)},onSelectNode:q,onCloseMobileSidebar:()=>z(!1),onFetchChildren:$,onDeleteNode:G,onShowHistory:e=>{const t=o(),n=t?.workspace_id,r=t?.workspace_name;e!==d()&&n?(i(Ce(n,r,e)),setTimeout(()=>I(e),100)):I(e)}}),re),m(re,r(y,{get when(){return g()},get children(){var e=Vi();return m(e,g),w(()=>b(e,_i)),e}}),null),m(re,()=>e.children,null),m(X,r(y,{get when(){return E()},get children(){return r(Br,{onClose:()=>L(!1),onCreate:f,isFirstWorkspace:!0})}}),null),m(X,r(y,{get when(){return R()},get children(){return r(ai,{onClose:()=>P(!1),onImport:U})}}),null),w(e=>{var t=`${si} ${N()?li:""}`,n=ci,r=ui,i=di,o=pi,a=gi,s=`${ji} ${N()?Ai:""}`,l=hi;return t!==e.e&&b(X,e.e=t),n!==e.t&&b(Y,e.t=n),r!==e.a&&b(Z,e.a=r),i!==e.o&&b(Q,e.o=i),o!==e.i&&b(ee,e.i=o),a!==e.n&&b(te,e.n=a),s!==e.s&&b(ne,e.s=s),l!==e.h&&b(re,e.h=l),e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),X;var X,Y,Z,Q,ee,te,ne,re};function Fi(){const e=T(),t=L(),{user:n}=ce(),{nodes:r,loading:i}=be();return c(()=>{if(i())return;const o=r;if(o.length>0&&o[0]){const r=o[0],i=n(),a=i?.workspace_id||ke(t.wsId),s=i?.workspace_name;a&&e(Ce(a,s,r.id,r.title),{replace:!0})}}),null}v(["click"]);const Hi="_container_4rjtw_3",qi="_tableWrapper_4rjtw_11",Ki="_table_4rjtw_11",Gi="_headerRow_4rjtw_23",Ji="_headerCell_4rjtw_31",Xi="_row_4rjtw_43",Yi="_actionsCell_4rjtw_51",Zi="_deleteBtn_4rjtw_51",Qi="_actionsHeader_4rjtw_56",eo="_cell_4rjtw_69",to="_editing_4rjtw_77",no="_cellContent_4rjtw_82",ro="_input_4rjtw_93",io="_required_4rjtw_129",oo="_newRow_4rjtw_136",ao="_newRowPlaceholder_4rjtw_148",so="_empty_4rjtw_159",lo="_loadMore_4rjtw_166",co="_addColumnCell_4rjtw_186",uo="_addColumnWrapper_4rjtw_191",po="_addColumnBtn_4rjtw_196",go="_addColumnDropdown_4rjtw_217",ho="_columnNameInput_4rjtw_234",_o="_columnTypeSelect_4rjtw_235",vo="_addColumnActions_4rjtw_251",fo="_addColumnConfirm_4rjtw_257",mo="_addColumnCancel_4rjtw_258";var wo=k("<input type=checkbox>"),bo=k("<select><option value>--"),ko=k("<option>"),yo=k("<input type=text>"),$o=k("<input type=number>"),Co=k("<input type=date>"),So=k("<th>"),xo=k("<div><input type=text autofocus><select></select><div><button></button><button>"),Io=k("<th><div><button>+"),No=k("<tr><td>+ "),To=k("<span> "),zo=k("<div>"),Eo=k("<div><button>"),Lo=k("<div><div><table><thead><tr></tr></thead><tbody>"),Ro=k("<span>*"),Po=k("<td><button>‚úï"),Do=k("<tr>"),jo=k("<td>");const Ao=[{type:"text",labelKey:"table.typeText"},{type:"number",labelKey:"table.typeNumber"},{type:"checkbox",labelKey:"table.typeCheckbox"},{type:"date",labelKey:"table.typeDate"},{type:"select",labelKey:"table.typeSelect"},{type:"url",labelKey:"table.typeUrl"},{type:"email",labelKey:"table.typeEmail"}];function Oo(e){const{t:n}=J(),[i,o]=t(null),[a,s]=t(""),[l,d]=t(!1),[c,u]=t(!1),[p,g]=t(""),[h,_]=t("text"),v=()=>{const t=p().trim();if(!t||!e.onAddColumn)return;const n={name:t,type:h(),required:!1};e.onAddColumn(n),g(""),_("text"),u(!1)},f=(t,n)=>{if(l()||!i())return;const r=e.columns.find(e=>e.name===n);if(!r||!e.onUpdateRecord)return void o(null);const s=e.records.find(e=>e.id===t);if(!s)return void o(null);const d={...s.data};d[r.name]=a(),e.onUpdateRecord(t,d),o(null)},k=()=>{e.onAddRecord&&e.columns.length>0&&e.onAddRecord({})},C=(t,n)=>{const r=((t,n)=>{const r=e.columns.find(e=>e.name===n);return r?t.data[r.name]??"":""})(t,n.name);switch(n.type){case"checkbox":return r?"‚úì":"";case"select":case"multi_select":case"number":default:return String(r);case"date":return r?new Date(r).toLocaleDateString():""}};let I;const N=(e,t,n,i)=>{const a=e=>{I=e,setTimeout(()=>{e.focus(),e instanceof HTMLInputElement&&"text"===e.type&&e.select()},0)},c=()=>I?I instanceof HTMLInputElement&&"checkbox"===I.type?String(I.checked):I.value:t,u=e=>{"Enter"!==e.key&&"Tab"!==e.key||s(c()),((e,t,n)=>{"Enter"!==e.key||e.shiftKey?"Escape"===e.key?(e.preventDefault(),d(!0),o(null)):"Tab"===e.key&&f(t,n):(e.preventDefault(),f(t,n))})(e,n,i)},p=()=>{s(c()),f(n,i)},g=()=>{s(c()),((e,t)=>{l()?d(!1):f(e,t)})(n,i)};switch(e.type){case"checkbox":return($=wo()).$$keydown=u,$.addEventListener("change",p),j(a,$),$.checked="true"===t,w(()=>b($,ro)),$;case ue:return e.options&&e.options.length>0?((y=bo()).firstChild,y.$$keydown=u,y.addEventListener("blur",g),y.addEventListener("change",p),j(a,y),y.value=t,m(y,r(S,{get each(){return e.options},children:e=>{return t=ko(),m(t,()=>e.name),w(()=>t.value=e.id),t;var t}}),null),w(()=>b(y,ro)),y):((k=yo()).$$keydown=u,k.addEventListener("blur",g),j(a,k),k.value=t,w(()=>b(k,ro)),k);case"number":return(v=$o()).$$keydown=u,v.addEventListener("blur",g),j(a,v),v.value=t,w(()=>b(v,ro)),v;case"date":return(_=Co()).$$keydown=u,_.addEventListener("blur",g),j(a,_),_.value=t,w(()=>b(_,ro)),_;default:return(h=yo()).$$keydown=u,h.addEventListener("blur",g),j(a,h),h.value=t,w(()=>b(h,ro)),h}var h,_,v,k,y,$};return T=Lo(),z=T.firstChild,E=z.firstChild,L=E.firstChild,R=L.firstChild,P=L.nextSibling,m(R,r(y,{get when(){return e.onDeleteRecord},get children(){var e=So();return w(()=>b(e,Qi)),e}}),null),m(R,r(S,{get each(){return e.columns},children:e=>{return t=So(),m(t,()=>e.name,null),m(t,r(y,{get when(){return e.required},get children(){var e=Ro();return w(()=>b(e,io)),e}}),null),w(()=>b(t,Ji)),t;var t}}),null),m(R,r(y,{get when(){return e.onAddColumn},get children(){var e=Io(),t=e.firstChild,i=t.firstChild;return i.$$click=()=>u(!c()),m(t,r(y,{get when(){return c()},get children(){var e=xo(),t=e.firstChild,i=t.nextSibling,o=i.nextSibling,a=o.firstChild,s=a.nextSibling;return t.$$input=e=>g(e.target.value),i.addEventListener("change",e=>_(e.target.value)),m(i,r(S,{each:Ao,children:e=>{return t=ko(),m(t,()=>n(e.labelKey)||e.type),w(()=>t.value=e.type),t;var t}})),a.$$click=v,m(a,()=>n("common.confirm")||"Add"),s.$$click=()=>u(!1),m(s,()=>n("common.cancel")||"Cancel"),w(r=>{var l=go,d=n("table.columnName")||"Column Name",c=ho,u=_o,p=vo,g=fo,h=mo;return l!==r.e&&b(e,r.e=l),d!==r.t&&x(t,"placeholder",r.t=d),c!==r.a&&b(t,r.a=c),u!==r.o&&b(i,r.o=u),p!==r.i&&b(o,r.i=p),g!==r.n&&b(a,r.n=g),h!==r.s&&b(s,r.s=h),r},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),w(()=>t.value=p()),w(()=>i.value=h()),e}}),null),w(r=>{var o=co,a=uo,s=po,l=n("table.addColumn")||"Add Column";return o!==r.e&&b(e,r.e=o),a!==r.t&&b(t,r.t=a),s!==r.a&&b(i,r.a=s),l!==r.o&&x(i,"title",r.o=l),r},{e:void 0,t:void 0,a:void 0,o:void 0}),e}}),null),m(P,r(S,{get each(){return e.records},children:t=>{return l=Do(),m(l,r(y,{get when(){return e.onDeleteRecord},get children(){var r=Po(),i=r.firstChild;return i.$$click=()=>e.onDeleteRecord?.(t.id),w(e=>{var t=Yi,o=Zi,a=n("table.deleteRecord")||"Delete";return t!==e.e&&b(r,e.e=t),o!==e.t&&b(i,e.t=o),a!==e.a&&x(i,"title",e.a=a),e},{e:void 0,t:void 0,a:void 0}),r}}),null),m(l,r(S,{get each(){return e.columns},children:n=>{const l=()=>i()?.recordId===t.id&&i()?.columnId===n.name;return(d=jo()).$$click=()=>!l()&&((t,n)=>{const r=e.columns.find(e=>e.name===n),i=e.records.find(e=>e.id===t)?.data[r?.name??""]??"";o({recordId:t,columnId:n}),s(String(i))})(t.id,n.name),m(d,r(y,{get when(){return l()},get fallback(){return e=zo(),m(e,()=>C(t,n)),w(()=>b(e,no)),e;var e},get children(){return N(n,a(),t.id,n.name)}})),w(()=>b(d,`${eo}${l()?` ${to}`:""}`)),d;var d}}),null),w(()=>b(l,Xi)),l;var l}}),null),m(P,r(y,{get when(){return $(()=>!!e.onAddRecord)()&&e.columns.length>0},get children(){var t=No(),r=t.firstChild;return r.firstChild,r.$$click=k,m(r,()=>n("table.addRecord")||"New",null),w(n=>{var i=oo,o=ao,a=e.columns.length+(e.onDeleteRecord?1:0)+(e.onAddColumn?1:0);return i!==n.e&&b(t,n.e=i),o!==n.t&&b(r,n.t=o),a!==n.a&&x(r,"colspan",n.a=a),n},{e:void 0,t:void 0,a:void 0}),t}}),null),m(T,r(y,{get when(){return 0===e.columns.length},get children(){var t=zo();return m(t,()=>n("table.noColumns"),null),m(t,r(y,{get when(){return e.onAddColumn},get children(){var e=To();return e.firstChild,m(e,()=>n("table.addColumnFirst")||"Click + to add a column.",null),e}}),null),w(()=>b(t,so)),t}}),null),m(T,r(y,{get when(){return e.hasMore},get children(){var t=Eo(),r=t.firstChild;return r.$$click=()=>e.onLoadMore?.(),m(r,()=>n("table.loadMore")),w(()=>b(t,lo)),t}}),null),w(e=>{var t=Hi,n=qi,r=Ki,i=Gi;return t!==e.e&&b(T,e.e=t),n!==e.t&&b(z,e.t=n),r!==e.a&&b(E,e.a=r),i!==e.o&&b(R,e.o=i),e},{e:void 0,t:void 0,a:void 0,o:void 0}),T;var T,z,E,L,R,P}function Vo(e,t,n,r){if(e.data[t]===n||!r)return;const i={...e.data,[t]:n};r(e.id,i)}function Wo(e){"Enter"===e.key&&e.currentTarget.blur()}function Mo(e,t){if(!t)return"";const n=e.data[t];return null!=n?String(n):""}function Uo(e,t){const n=t[0];return n?Mo(e,n.name):""}v(["keydown","click","input"]);const Bo="_grid_3ff2z_1",Fo="_card_3ff2z_8",Ho="_cardHeader_3ff2z_20",qo="_deleteBtn_3ff2z_28",Ko="_cardBody_3ff2z_40",Go="_field_3ff2z_46",Jo="_fieldName_3ff2z_51",Xo="_titleInput_3ff2z_58",Yo="_fieldValueInput_3ff2z_75";var Zo=k("<div>"),Qo=k("<div><div><strong><input type=text></strong><button>‚úï</button></div><div>"),ea=k("<div><span>:</span><input type=text>");function ta(e){const{t:t}=J();return n=Zo(),m(n,r(S,{get each(){return e.records},children:n=>{return i=Qo(),o=i.firstChild,a=o.firstChild,s=a.firstChild,l=a.nextSibling,d=o.nextSibling,O(s,"keydown",Wo),s.addEventListener("blur",t=>e.columns[0]&&Vo(n,e.columns[0].name,t.target.value,e.onUpdateRecord)),l.$$click=()=>e.onDeleteRecord(n.id),m(d,r(S,{get each(){return e.columns.slice(1,4)},children:t=>{return r=ea(),i=r.firstChild,o=i.firstChild,a=i.nextSibling,m(i,()=>t.name,o),O(a,"keydown",Wo),a.addEventListener("blur",r=>Vo(n,t.name,r.target.value,e.onUpdateRecord)),w(e=>{var t=Go,n=Jo,o=Yo;return t!==e.e&&b(r,e.e=t),n!==e.t&&b(i,e.t=n),o!==e.a&&b(a,e.a=o),e},{e:void 0,t:void 0,a:void 0}),w(()=>a.value=Mo(n,t.name)),r;var r,i,o,a}})),w(e=>{var n=Fo,r=Ho,a=t("table.untitled")||"Untitled",c=Xo,u=qo,p=Ko;return n!==e.e&&b(i,e.e=n),r!==e.t&&b(o,e.t=r),a!==e.a&&x(s,"placeholder",e.a=a),c!==e.o&&b(s,e.o=c),u!==e.i&&b(l,e.i=u),p!==e.n&&b(d,e.n=p),e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0}),w(()=>s.value=Uo(n,e.columns)),i;var i,o,a,s,l,d}})),w(()=>b(n,Bo)),n;var n}v(["keydown","click"]);const na="_gallery_1i7ro_1",ra="_card_1i7ro_8",ia="_imageContainer_1i7ro_23",oa="_image_1i7ro_23",aa="_imagePlaceholder_1i7ro_38",sa="_cardContent_1i7ro_43",la="_cardHeader_1i7ro_47",da="_deleteBtn_1i7ro_54",ca="_cardBody_1i7ro_67",ua="_field_1i7ro_71",pa="_fieldName_1i7ro_77",ga="_titleInput_1i7ro_83",ha="_fieldValueInput_1i7ro_100";var _a=k("<div>"),va=k("<div><div><div><strong><input type=text></strong><button>‚úï</button></div><div>"),fa=k("<img>"),ma=k("<div><span>:</span><input type=text>");function wa(e){const{t:t}=J();return n=_a(),m(n,r(S,{get each(){return e.records},children:n=>{const i=e.columns.find(e=>e.name.toLowerCase().includes("image")||e.name.toLowerCase().includes("cover")||e.name.toLowerCase().includes("url"));return o=va(),a=o.firstChild,s=a.firstChild,l=s.firstChild,d=l.firstChild,c=l.nextSibling,u=s.nextSibling,m(o,r(y,{when:i,children:i=>{return o=_a(),m(o,r(y,{get when(){return n.data[i().name]},get fallback(){return e=_a(),m(e,()=>t("table.noImage")),w(()=>b(e,aa)),e;var e},get children(){var t=fa();return w(r=>{var o=String(n.data[i().name]),a=Uo(n,e.columns)||"Record",s=oa;return o!==r.e&&x(t,"src",r.e=o),a!==r.t&&x(t,"alt",r.t=a),s!==r.a&&b(t,r.a=s),r},{e:void 0,t:void 0,a:void 0}),t}})),w(()=>b(o,ia)),o;var o}}),a),O(d,"keydown",Wo),d.addEventListener("blur",t=>e.columns[0]&&Vo(n,e.columns[0].name,t.target.value,e.onUpdateRecord)),c.$$click=()=>e.onDeleteRecord(n.id),m(u,r(S,{get each(){return e.columns.slice(1,3)},children:t=>{return r=ma(),i=r.firstChild,o=i.firstChild,a=i.nextSibling,m(i,()=>t.name,o),O(a,"keydown",Wo),a.addEventListener("blur",r=>Vo(n,t.name,r.target.value,e.onUpdateRecord)),w(e=>{var t=ua,n=pa,o=ha;return t!==e.e&&b(r,e.e=t),n!==e.t&&b(i,e.t=n),o!==e.a&&b(a,e.a=o),e},{e:void 0,t:void 0,a:void 0}),w(()=>a.value=Mo(n,t.name)),r;var r,i,o,a}})),w(e=>{var n=ra,r=sa,i=la,l=t("table.untitled")||"Untitled",p=ga,g=da,h=ca;return n!==e.e&&b(o,e.e=n),r!==e.t&&b(a,e.t=r),i!==e.a&&b(s,e.a=i),l!==e.o&&x(d,"placeholder",e.o=l),p!==e.i&&b(d,e.i=p),g!==e.n&&b(c,e.n=g),h!==e.s&&b(u,e.s=h),e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),w(()=>d.value=Uo(n,e.columns)),o;var o,a,s,l,d,c,u}})),w(()=>b(n,na)),n;var n}v(["keydown","click"]);const ba="_board_ojcu7_1",ka="_noGroup_ojcu7_7",ya="_columns_ojcu7_16",$a="_column_ojcu7_16",Ca="_columnHeader_ojcu7_31",Sa="_columnName_ojcu7_38",xa="_columnCount_ojcu7_45",Ia="_cards_ojcu7_53",Na="_card_ojcu7_53",Ta="_cardHeader_ojcu7_68",za="_deleteBtn_ojcu7_80",Ea="_cardBody_ojcu7_93",La="_field_ojcu7_97",Ra="_fieldName_ojcu7_103",Pa="_titleInput_ojcu7_108",Da="_fieldValueInput_ojcu7_125";var ja=k("<div>"),Aa=k("<div><div><span></span><span></span></div><div>"),Oa=k("<div><div><strong><input type=text></strong><button>‚úï</button></div><div>"),Va=k("<div><span>:</span><input type=text>");function Wa(e){const{t:t}=J(),n=l(()=>e.columns.find(e=>e.type===ue||"multi_select"===e.type)),i=l(()=>{const r=n();if(!r)return[{name:"All Records",records:e.records,fromOptions:!0}];const i={};return r.options&&r.options.forEach(e=>{i[e.id]={name:e.name,records:[],fromOptions:!0}}),i.__none__={name:t("table.noGroup")||"No Group",records:[],fromOptions:!0},e.records.forEach(e=>{const t=e.data[r.name];t&&"string"==typeof t?(i[t]||(i[t]={name:t,records:[]}),i[t].records.push(e)):i.__none__?.records.push(e)}),Object.values(i).filter(e=>e.records.length>0||e.fromOptions)});return o=ja(),m(o,r(y,{get when(){return n()},get fallback(){return e=ja(),m(e,()=>t("table.addSelectColumn")),w(()=>b(e,ka)),e;var e},get children(){var o=ja();return m(o,r(S,{get each(){return i()},children:i=>{return o=Aa(),a=o.firstChild,s=a.firstChild,l=s.nextSibling,d=a.nextSibling,m(s,()=>i.name),m(l,()=>i.records.length),m(d,r(S,{get each(){return i.records},children:i=>{return o=Oa(),a=o.firstChild,s=a.firstChild,l=s.firstChild,d=s.nextSibling,c=a.nextSibling,O(l,"keydown",Wo),l.addEventListener("blur",t=>e.columns[0]&&Vo(i,e.columns[0].name,t.target.value,e.onUpdateRecord)),d.$$click=()=>e.onDeleteRecord(i.id),m(c,r(S,{get each(){return e.columns.slice(1,4).filter(e=>e.name!==n()?.name)},children:t=>{return n=Va(),r=n.firstChild,o=r.firstChild,a=r.nextSibling,m(r,()=>t.name,o),O(a,"keydown",Wo),a.addEventListener("blur",n=>Vo(i,t.name,n.target.value,e.onUpdateRecord)),w(e=>{var t=La,i=Ra,o=Da;return t!==e.e&&b(n,e.e=t),i!==e.t&&b(r,e.t=i),o!==e.a&&b(a,e.a=o),e},{e:void 0,t:void 0,a:void 0}),w(()=>a.value=Mo(i,t.name)),n;var n,r,o,a}})),w(e=>{var n=Na,r=Ta,i=t("table.untitled")||"Untitled",s=Pa,u=za,p=Ea;return n!==e.e&&b(o,e.e=n),r!==e.t&&b(a,e.t=r),i!==e.a&&x(l,"placeholder",e.a=i),s!==e.o&&b(l,e.o=s),u!==e.i&&b(d,e.i=u),p!==e.n&&b(c,e.n=p),e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0}),w(()=>l.value=Uo(i,e.columns)),o;var o,a,s,l,d,c}})),w(e=>{var t=$a,n=Ca,r=Sa,i=xa,c=Ia;return t!==e.e&&b(o,e.e=t),n!==e.t&&b(a,e.t=n),r!==e.a&&b(s,e.a=r),i!==e.o&&b(l,e.o=i),c!==e.i&&b(d,e.i=c),e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),o;var o,a,s,l,d}})),w(()=>b(o,ya)),o}})),w(()=>b(o,ba)),o;var o}v(["keydown","click"]);const Ma="_container_1uha7_3",Ua="_tabs_1uha7_7",Ba="_tab_1uha7_7",Fa="_active_1uha7_35",Ha="_icon_1uha7_41",qa="_name_1uha7_46",Ka="_defaultBadge_1uha7_52",Ga="_addWrapper_1uha7_61",Ja="_addButton_1uha7_65",Xa="_dropdown_1uha7_81",Ya="_overlay_1uha7_113",Za="_contextMenu_1uha7_119",Qa="_deleteAction_1uha7_146";var es=k("<div data-testid=view-type-menu><button data-testid=view-type-table><span></span></button><button data-testid=view-type-list><span></span></button><button data-testid=view-type-gallery><span></span></button><button data-testid=view-type-board><span>"),ts=k("<div>"),ns=k("<div><div><div><button data-testid=add-view-button>+"),rs=k("<span>"),is=k("<button><span></span><span>"),os=k("<div><button>");const as={table:"‚ò∞",board:"‚ò∑",gallery:"‚ñ¶",list:"‚ò∞",calendar:"üìÖ"};function ss(){const{t:e}=J(),{views:n,activeViewId:i,setActiveViewId:o,createView:a,deleteView:s}=Oe(),[l,d]=t(!1),[c,u]=t(null),[p,g]=t(null),h=t=>{const n=e("table.newView")||"New View";a(n,t),d(!1)},_=()=>{const e=c();e&&s(e.id),u(null),g(null)},v=()=>{d(!1),u(null),g(null)};return f=ns(),k=f.firstChild,$=k.firstChild,C=$.firstChild,m(k,r(S,{get each(){return n()},children:t=>{return n=is(),a=n.firstChild,s=a.nextSibling,n.$$contextmenu=e=>((e,t)=>{e.preventDefault(),u(t),g({x:e.clientX,y:e.clientY})})(e,t),n.$$click=()=>{return e=t.id,void o(e);var e},m(a,()=>as[t.type]||"‚ò∞"),m(s,()=>t.name),m(n,r(y,{get when(){return t.default},get children(){var t=rs();return m(t,()=>e("table.defaultView")||"Default"),w(()=>b(t,Ka)),t}}),null),w(e=>{var r=Ba,o={[`${Fa}`]:t.id===i()},l=t.name,d=Ha,c=qa;return r!==e.e&&b(n,e.e=r),e.t=D(n,o,e.t),l!==e.a&&x(n,"title",e.a=l),d!==e.o&&b(a,e.o=d),c!==e.i&&b(s,e.i=c),e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),n;var n,a,s}}),$),C.$$click=()=>d(!l()),m($,r(y,{get when(){return l()},get children(){var t=es(),n=t.firstChild,r=n.firstChild,i=n.nextSibling,o=i.firstChild,a=i.nextSibling,s=a.firstChild,l=a.nextSibling,d=l.firstChild;return n.$$click=()=>h("table"),m(r,()=>as.table),m(n,()=>e("table.table"),null),i.$$click=()=>h("list"),m(o,()=>as.list),m(i,()=>e("table.list"),null),a.$$click=()=>h("gallery"),m(s,()=>as.gallery),m(a,()=>e("table.gallery"),null),l.$$click=()=>h("board"),m(d,()=>as.board),m(l,()=>e("table.board"),null),w(e=>{var n=Xa,i=Ha,a=Ha,l=Ha,c=Ha;return n!==e.e&&b(t,e.e=n),i!==e.t&&b(r,e.t=i),a!==e.a&&b(o,e.a=a),l!==e.o&&b(s,e.o=l),c!==e.i&&b(d,e.i=c),e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),t}}),null),m(f,r(y,{get when(){return p()},children:t=>r(y,{get when(){return c()},get children(){return[(i=ts(),i.$$click=v,w(()=>b(i,Ya)),i),(n=os(),r=n.firstChild,r.$$click=_,m(r,()=>e("common.delete")),w(e=>{var i=Za,o=`${t().x}px`,a=`${t().y}px`,s=Qa;return i!==e.e&&b(n,e.e=i),o!==e.t&&I(n,"left",e.t=o),a!==e.a&&I(n,"top",e.a=a),s!==e.o&&b(r,e.o=s),e},{e:void 0,t:void 0,a:void 0,o:void 0}),n)];var n,r,i}})}),null),m(f,r(y,{get when(){return l()},get children(){var e=ts();return e.$$click=v,w(()=>b(e,Ya)),e}}),null),w(t=>{var n=Ma,r=Ua,i=Ga,o=Ja,a=e("table.newView")||"New View";return n!==t.e&&b(f,t.e=n),r!==t.t&&b(k,t.t=r),i!==t.a&&b($,t.a=i),o!==t.o&&b(C,t.o=o),a!==t.i&&x(C,"title",t.i=a),t},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),f;var f,k,$,C}v(["click","contextmenu"]);var ls=k("<span>‚óè "),ds=k("<span>‚ü≥ "),cs=k("<span>‚úì "),us=k("<li>"),ps=k("<div><h3></h3><ul>"),gs=k("<div>"),hs=k("<div><div><input type=text><div></div></div><div>"),_s=k("<li><div><span></span><span></span></div><div>");const vs=R(()=>H(()=>import("./Editor-Bjt_A5UT.js"),__vite__mapDeps([11,1,12,13])));function fs(){const{t:e}=J(),t=T(),n=L(),{user:i,token:o,wsApi:a}=ce(),{selectedNodeId:s,selectedNodeData:d,setLoading:u,setError:p,loadNode:g}=be(),{title:h,content:_,hasUnsavedChanges:v,autoSaveStatus:f,assetUrls:k,showHistory:C,history:I,loadVersion:N,flushAutoSave:z,handleTitleChange:R,handleContentChange:P,linkedNodeTitles:D}=De(),{records:j,hasMore:A,loadMoreRecords:O,addRecord:V,updateRecord:W,deleteRecord:M,views:U,activeViewId:B}=Oe(),F=l(()=>U().find(e=>e.id===B())),H=l(()=>F()?.type||"table");async function q(t){const n=s(),r=d(),i=a();if(n&&r&&i)try{u(!0);const e=[...r.properties||[],t];await i.nodes.table.updateTable(n,{title:r.title,properties:e}),await g(n),p(null)}catch(o){p(`${e("errors.failedToSave")}: ${o}`)}finally{u(!1)}}c(()=>{const e=ke(n.nodeId);e&&e!==s()&&(z(),g(e))});const K=e=>{z();const n=i(),r=n?.workspace_id,o=n?.workspace_name;r&&t(Ce(r,o,e))};return r(y,{get when(){return s()},get children(){var t=hs(),n=t.firstChild,a=n.firstChild,l=a.nextSibling,c=n.nextSibling;return a.$$input=e=>R(e.target.value),m(l,r(y,{get when(){return $(()=>!!v())()&&"idle"===f()},get children(){var t=ls();return t.firstChild,m(t,()=>e("editor.unsaved"),null),w(()=>b(t,bi)),t}}),null),m(l,r(y,{get when(){return"saving"===f()},get children(){var t=ds();return t.firstChild,m(t,()=>e("common.saving"),null),w(()=>b(t,ki)),t}}),null),m(l,r(y,{get when(){return"saved"===f()},get children(){var t=cs();return t.firstChild,m(t,()=>e("common.saved"),null),w(()=>b(t,yi)),t}}),null),m(t,r(y,{get when(){return C()},get children(){var t=ps(),n=t.firstChild,i=n.nextSibling;return m(n,()=>e("editor.versionHistory")),m(i,r(S,{get each(){return I()},children:e=>{return t=_s(),n=t.firstChild,r=n.firstChild,i=r.nextSibling,o=n.nextSibling,t.$$click=()=>{const t=s();t&&N(t,e.hash)},m(r,()=>new Date(e.timestamp).toLocaleString()),m(i,()=>e.hash.substring(0,7)),m(o,()=>e.message),w(e=>{var a=Ei,s=Li,l=Ri,d=Pi,c=Di;return a!==e.e&&b(t,e.e=a),s!==e.t&&b(n,e.t=s),l!==e.a&&b(r,e.a=l),d!==e.o&&b(i,e.o=d),c!==e.i&&b(o,e.i=c),e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),t;var t,n,r,i,o}}),null),m(i,r(y,{get when(){return 0===I().length},get children(){var t=us();return m(t,()=>e("editor.noHistory")),w(()=>b(t,Ei)),t}}),null),w(e=>{var n=Ti,r=zi;return n!==e.e&&b(t,e.e=n),r!==e.t&&b(i,e.t=r),e},{e:void 0,t:void 0}),t}}),c),m(c,r(y,{get when(){return d()?.has_page},get children(){return r(E,{get fallback(){return t=gs(),m(t,()=>e("common.loading")),w(()=>b(t,fi)),t;var t},get children(){return r(vs,{get content(){return _()},get nodeId(){return s()??void 0},get assetUrls(){return k()},get linkedNodeTitles(){return D()},onChange:P,get wsId(){return i()?.workspace_id},getToken:()=>o(),onAssetUploaded:()=>{const e=s();e&&g(e)},onError:p,onNavigateToNode:K})}})}}),null),m(c,r(y,{get when(){return d()?.has_table},get children(){var e=gs();return m(e,r(ss,{}),null),m(e,r(y,{get when(){return"table"===H()},get children(){return r(Oo,{get tableId(){return s()||""},get columns(){return d()?.properties||[]},get records(){return j()},onAddRecord:V,onUpdateRecord:W,onDeleteRecord:M,onAddColumn:q,onLoadMore:O,get hasMore(){return A()}})}}),null),m(e,r(y,{get when(){return"list"===H()},get children(){return r(ta,{get records(){return j()},get columns(){return d()?.properties||[]},onUpdateRecord:W,onDeleteRecord:M})}}),null),m(e,r(y,{get when(){return"gallery"===H()},get children(){return r(wa,{get records(){return j()},get columns(){return d()?.properties||[]},onUpdateRecord:W,onDeleteRecord:M})}}),null),m(e,r(y,{get when(){return"board"===H()},get children(){return r(Wa,{get records(){return j()},get columns(){return d()?.properties||[]},onUpdateRecord:W,onDeleteRecord:M})}}),null),w(()=>b(e,Si)),e}}),null),w(r=>{var i=vi,o=mi,s=e("editor.titlePlaceholder")||"Title",d=$i,u=wi,p=Ci;return i!==r.e&&b(t,r.e=i),o!==r.t&&b(n,r.t=o),s!==r.a&&x(a,"placeholder",r.a=s),d!==r.o&&b(a,r.o=d),u!==r.i&&b(l,r.i=u),p!==r.n&&b(c,r.n=p),r},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0}),w(()=>a.value=h()),t}})}v(["input","click"]);const ms=e=>r(we,{get children(){return r(Pe,{get children(){return r(Ae,{get children(){return e.children}})}})}});var ws=k("<div style=padding:2rem;text-align:center>Loading...");const bs=R(()=>H(()=>import("./Auth-WEGKTAWU.js"),__vite__mapDeps([14,1,15]))),ks=R(()=>H(()=>import("./Privacy-CMfhCaSi.js"),__vite__mapDeps([16,1,17]))),ys=R(()=>H(()=>import("./Terms-D02UdGWT.js"),__vite__mapDeps([18,1,17]))),$s=R(()=>H(()=>import("./Onboarding-BkH41v_l.js"),__vite__mapDeps([19,1])));function Cs(){return ws()}const Ss=e=>{const{user:t,ready:n}=ce();return r(y,{get when(){return n()},get fallback(){return r(Cs,{})},get children(){return r(y,{get when(){return t()},get fallback(){return r(z,{href:"/login"})},get children(){return e.children}})}})};function xs(){const{user:e,login:t,ready:n}=ce();return r(y,{get when(){return n()},get fallback(){return r(Cs,{})},get children(){return r(y,{get when(){return!e()||!e()?.workspace_id},get fallback(){return r(z,{get href(){return`/w/${e()?.workspace_id}`}})},get children(){return r(E,{get fallback(){return r(Cs,{})},get children(){return r(bs,{onLogin:t})}})}})}})}function Is(){const{user:e,ready:t}=ce();return r(U,{get fallback(){return r(Cs,{})},get children(){return[r(M,{get when(){return $(()=>!!t())()&&e()?.workspace_id},get children(){return r(z,{get href(){return`/w/${e()?.workspace_id}`}})}}),r(M,{get when(){return $(()=>!(!t()||!e()))()&&!e()?.workspace_id},get children(){return r(z,{href:"/onboarding"})}}),r(M,{get when(){return $(()=>!!t())()&&!e()},get children(){return r(z,{href:"/login"})}})]}})}const Ns=e=>r(Ss,{get children(){return r(E,{get fallback(){return r(Cs,{})},get children(){return r(Ht,{get children(){return e.children}})}})}}),Ts=e=>r(Ss,{get children(){return r(E,{get fallback(){return r(Cs,{})},get children(){return r(ms,{get children(){return e.children}})}})}});function zs(){return r(W,{get children(){return[r(V,{path:"/login",component:xs}),r(V,{path:"/onboarding",component:()=>r(Ss,{get children(){return r(E,{get fallback(){return r(Cs,{})},get children(){return r($s,{})}})}})}),r(V,{path:"/privacy",component:()=>r(E,{get fallback(){return r(Cs,{})},get children(){return r(ks,{})}})}),r(V,{path:"/terms",component:()=>r(E,{get fallback(){return r(Cs,{})},get children(){return r(ys,{})}})}),r(V,{path:"/settings",component:Ns,get children(){return[r(V,{path:"/",component:Ft}),r(V,{path:"/user",component:Bt}),r(V,{path:"/server",component:Wt}),r(V,{path:"/workspace/:wsId",component:Mt}),r(V,{path:"/org/:orgId",component:Ut})]}}),r(V,{path:"/w/:wsId",component:Ts,get children(){return r(V,{path:"/",component:Bi,get children(){return[r(V,{path:"/",component:Fi}),r(V,{path:"/:nodeId",component:fs})]}})}}),r(V,{path:"/",component:Is}),r(V,{path:"*",component:()=>r(z,{href:"/login"})})]}})}function Es(){return r(He,{get children(){return r(de,{get children(){return[r(zs,{}),r(tt,{})]}})}})}const Ls=localStorage.getItem("mddb_locale"),Rs=Ls&&["en","fr","de","es"].includes(Ls)?Ls:"en",Ps=document.getElementById("app");Ps&&B(()=>r(G,{initialLocale:Rs,get children(){return r(Es,{})}}),Ps);export{X as A,fe as O,he as W,ve as a,_e as b,Q as c,ce as d,ge as e,pe as f,be as g,De as h,yn as i,Le as j,ze as k,Ce as n,Ie as r,Se as s,J as u,$e as w};
