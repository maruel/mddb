import{j as e,G as t,c as i,g as n,h as r,v as a,d as s,w as l,x as o,S as u,y as m,s as g}from"./vendor-B2Zg8RtX.js";import{u as d,d as b,f as v,e as p}from"./index-BazlIzq9.js";import{M as c,I as _}from"./InviteForm-BWc5rOox.js";import"./editor-vendor-HH1666TS.js";const x="_panel_1lewj_3",f="_tabs_1lewj_7",h="_activeTab_1lewj_29",y="_section_1lewj_34",$="_error_1lewj_43",w="_success_1lewj_51",S="_settingsForm_1lewj_59",I="_formItem_1lewj_66",C="_formGrid_1lewj_85",j="_saveButton_1lewj_106";var O=m("<div>"),k=m("<section><h3>"),z=m("<form><div><label></label><input type=text required></div><h4></h4><div><div><label></label><input type=number min=1></div><div><label></label><input type=number min=1></div><div><label></label><input type=number min=1></div><div><label></label><input type=number min=1></div><div><label></label><input type=number min=0></div><div><label></label><input type=number min=0></div><div><label></label><input type=number min=0></div><div><label></label><input type=number min=0></div><div><label></label><input type=number min=0></div><div><label></label><input type=number min=0></div></div><button type=submit>"),q=m("<div><div><button></button><button>"),M=m("<p>");function P(m){const{t:g}=d(),P=e(),R=t(),{user:T,api:U}=b(),[B,A]=i("settings"===m.section?"settings":"members"),[F,W]=i([]),[G,L]=i([]),[D,E]=i(""),[N,Q]=i(""),[H,J]=i(0),[K,V]=i(0),[X,Y]=i(0),[Z,ee]=i(0),[te,ie]=i(0),[ne,re]=i(0),[ae,se]=i(0),[le,oe]=i(0),[ue,me]=i(0),[ge,de]=i(0),[be,ve]=i(!1),[pe,ce]=i(null),[_e,xe]=i(null),fe=n(()=>U().org(m.orgId)),he=n(()=>{const e=T()?.organizations?.find(e=>e.organization_id===m.orgId);return e?.role}),ye=n(()=>{const e=he();return e===v||e===p}),$e=e=>{A(e);const t="members"===e?"":`#${e}`;P(R.pathname+t,{replace:!0})},we=async()=>{const e=fe();try{if(ve(!0),ce(null),"members"===B()&&ye()){const[t,i]=await Promise.all([e.users.listUsers(),e.invitations.listOrgInvitations()]);W(t.users?.filter(e=>!!e)||[]),L(i.invitations?.filter(e=>!!e)||[])}if("settings"===B()){const t=await e.organizations.getOrganization();E(t.name),Q(t.name),J(t.quotas.max_workspaces_per_org),V(t.quotas.max_members_per_org),Y(t.quotas.max_members_per_workspace),ee(t.quotas.max_total_storage_bytes),ie(t.quotas.max_pages),re(t.quotas.max_storage_bytes),se(t.quotas.max_records_per_table),oe(t.quotas.max_asset_size_bytes),me(t.quotas.max_tables_per_workspace),de(t.quotas.max_columns_per_table)}}catch(t){ce(`${g("errors.failedToLoad")}: ${t}`)}finally{ve(!1)}};r(()=>{we()}),r(()=>{const e=m.section;"settings"===e?A("settings"):"members"!==e&&e||A("members")});const Se=async(e,t)=>{const i=fe();try{ve(!0),await i.invitations.createOrgInvitation({email:e,role:t}),xe(g("success.invitationSent")||"Invitation sent successfully"),we()}catch(n){ce(`${g("errors.failedToInvite")}: ${n}`)}finally{ve(!1)}},Ie=async e=>{if(!confirm(g("settings.confirmRemoveMember")))return;const t=fe();try{ve(!0),await t.users.removeOrgMember({user_id:e}),xe(g("success.memberRemoved")),we()}catch(i){ce(`${g("errors.failedToRemoveMember")}: ${i}`)}finally{ve(!1)}},Ce=async(e,t)=>{const i=fe();try{ve(!0),await i.users.updateOrgMemberRole({user_id:e,role:t}),xe(g("success.roleUpdated")||"Role updated"),we()}catch(n){ce(`${g("errors.failedToUpdateRole")}: ${n}`)}finally{ve(!1)}},je=async e=>{e.preventDefault();const t=fe();try{ve(!0),ce(null),xe(null),D()!==N()&&D().trim()&&(await t.organizations.updateOrganization({name:D().trim()}),Q(D().trim())),await t.settings.updateOrgPreferences({quotas:{max_workspaces_per_org:H(),max_members_per_org:K(),max_members_per_workspace:X(),max_total_storage_bytes:Z(),max_pages:te(),max_storage_bytes:ne(),max_records_per_table:ae(),max_asset_size_bytes:le(),max_tables_per_workspace:ue(),max_columns_per_table:ge()}}),xe(g("success.orgSettingsSaved")||"Organization settings saved")}catch(i){ce(`${g("errors.failedToSave")}: ${i}`)}finally{ve(!1)}},Oe=[{value:"owner",label:g("settings.roleOwner")},{value:"admin",label:g("settings.roleAdmin")},{value:"member",label:g("settings.roleMember")}],ke=[{value:"admin",label:g("settings.roleAdmin")},{value:"member",label:g("settings.roleMember")}];return ze=q(),qe=ze.firstChild,Me=qe.firstChild,Pe=Me.nextSibling,Me.$$click=()=>$e("members"),a(Me,()=>g("settings.members")),Pe.$$click=()=>$e("settings"),a(Pe,()=>g("settings.settings")),a(ze,s(u,{get when(){return pe()},get children(){var e=O();return a(e,pe),l(()=>o(e,$)),e}}),null),a(ze,s(u,{get when(){return _e()},get children(){var e=O();return a(e,_e),l(()=>o(e,w)),e}}),null),a(ze,s(u,{get when(){return"members"===B()},get children(){var e=k(),t=e.firstChild;return a(t,()=>g("settings.organizationMembers")),a(e,s(u,{get when(){return ye()},get fallback(){return e=M(),a(e,()=>g("settings.adminOnlyMembers")),e;var e},get children(){return[s(c,{get members(){return F()},get currentUserId(){return T()?.id||""},roleOptions:Oe,roleField:"org_role",onUpdateRole:Ce,onRemove:Ie,get loading(){return be()}}),s(_,{roleOptions:ke,defaultRole:"member",get pendingInvitations(){return G().map(e=>({email:e.email,role:e.role,created:e.created}))},onInvite:Se,get loading(){return be()}})]}}),null),l(()=>o(e,y)),e}}),null),a(ze,s(u,{get when(){return"settings"===B()},get children(){var e=k(),t=e.firstChild;return a(t,()=>g("settings.organizationPreferences")),a(e,s(u,{get when(){return ye()},get fallback(){return e=M(),a(e,()=>g("settings.adminOnlySettings")),e;var e},get children(){var e=z(),t=e.firstChild,i=t.firstChild,n=i.nextSibling,r=t.nextSibling,s=r.nextSibling,u=s.firstChild,m=u.firstChild,d=m.nextSibling,b=u.nextSibling,v=b.firstChild,p=v.nextSibling,c=b.nextSibling,_=c.firstChild,x=_.nextSibling,f=c.nextSibling,h=f.firstChild,y=h.nextSibling,$=f.nextSibling,w=$.firstChild,O=w.nextSibling,k=$.nextSibling,q=k.firstChild,M=q.nextSibling,P=k.nextSibling,R=P.firstChild,T=R.nextSibling,U=P.nextSibling,B=U.firstChild,A=B.nextSibling,F=U.nextSibling,W=F.firstChild,G=W.nextSibling,L=F.nextSibling,N=L.firstChild,Q=N.nextSibling,ve=s.nextSibling;return e.addEventListener("submit",je),a(i,()=>g("settings.organizationName")),n.$$input=e=>E(e.target.value),a(r,()=>g("settings.organizationQuotas")),a(m,()=>g("settings.maxWorkspacesPerOrg")),d.$$input=e=>J(parseInt(e.target.value)||1),a(v,()=>g("settings.maxMembersPerOrg")),p.$$input=e=>V(parseInt(e.target.value)||1),a(_,()=>g("settings.maxMembersPerWorkspace")),x.$$input=e=>Y(parseInt(e.target.value)||1),a(h,()=>g("settings.maxTotalStorageBytes")),y.$$input=e=>ee(parseInt(e.target.value)||1),a(w,()=>g("settings.maxPages")),O.$$input=e=>ie(parseInt(e.target.value)||0),a(q,()=>g("settings.maxStorageBytes")),M.$$input=e=>re(parseInt(e.target.value)||0),a(R,()=>g("settings.maxRecordsPerTable")),T.$$input=e=>se(parseInt(e.target.value)||0),a(B,()=>g("settings.maxAssetSizeBytes")),A.$$input=e=>oe(parseInt(e.target.value)||0),a(W,()=>g("settings.maxTablesPerWorkspace")),G.$$input=e=>me(parseInt(e.target.value)||0),a(N,()=>g("settings.maxColumnsPerTable")),Q.$$input=e=>de(parseInt(e.target.value)||0),a(ve,()=>g("common.save")),l(i=>{var n=S,r=I,a=C,l=I,m=I,g=I,d=I,v=I,p=I,_=I,x=I,h=I,y=I,w=j,O=be();return n!==i.e&&o(e,i.e=n),r!==i.t&&o(t,i.t=r),a!==i.a&&o(s,i.a=a),l!==i.o&&o(u,i.o=l),m!==i.i&&o(b,i.i=m),g!==i.n&&o(c,i.n=g),d!==i.s&&o(f,i.s=d),v!==i.h&&o($,i.h=v),p!==i.r&&o(k,i.r=p),_!==i.d&&o(P,i.d=_),x!==i.l&&o(U,i.l=x),h!==i.u&&o(F,i.u=h),y!==i.c&&o(L,i.c=y),w!==i.w&&o(ve,i.w=w),O!==i.m&&(ve.disabled=i.m=O),i},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0}),l(()=>n.value=D()),l(()=>d.value=H()),l(()=>p.value=K()),l(()=>x.value=X()),l(()=>y.value=Z()),l(()=>O.value=te()),l(()=>M.value=ne()),l(()=>T.value=ae()),l(()=>A.value=le()),l(()=>G.value=ue()),l(()=>Q.value=ge()),e}}),null),l(()=>o(e,y)),e}}),null),l(e=>{var t=x,i=f,n="members"===B()?h:"",r="settings"===B()?h:"";return t!==e.e&&o(ze,e.e=t),i!==e.t&&o(qe,e.t=i),n!==e.a&&o(Me,e.a=n),r!==e.o&&o(Pe,e.o=r),e},{e:void 0,t:void 0,a:void 0,o:void 0}),ze;var ze,qe,Me,Pe}g(["click","input"]);export{P as default};
//# sourceMappingURL=OrgSettingsPanel-BjhYluKf.js.map
