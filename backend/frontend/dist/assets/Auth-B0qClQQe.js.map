{"version":3,"file":"Auth-B0qClQQe.js","sources":["../../../../frontend/src/components/Auth.tsx"],"sourcesContent":["// Authentication component handling login and registration forms.\n\nimport { createSignal, createResource, createMemo, Show, For, type JSX } from 'solid-js';\nimport { A } from '@solidjs/router';\nimport { createAPIClient, APIError } from '@sdk/api.gen';\nimport type { UserResponse, OAuthProvider } from '@sdk/types.gen';\nimport { OAuthProviderGoogle, OAuthProviderMicrosoft, OAuthProviderGitHub } from '@sdk/types.gen';\nimport styles from './Auth.module.css';\nimport { useI18n } from '../i18n';\n\ninterface AuthProps {\n  onLogin: (token: string, user: UserResponse) => void;\n}\n\n// OAuth provider icons following official branding guidelines\nfunction GoogleIcon(): JSX.Element {\n  return (\n    <svg class={styles.oauthIcon} viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\n      <path\n        fill=\"#4285F4\"\n        d=\"M23.745 12.27c0-.79-.07-1.54-.19-2.27h-11.3v4.51h6.47c-.29 1.48-1.14 2.73-2.4 3.58v3h3.86c2.26-2.09 3.56-5.17 3.56-8.82z\"\n      />\n      <path\n        fill=\"#34A853\"\n        d=\"M12.255 24c3.24 0 5.95-1.08 7.93-2.91l-3.86-3c-1.08.72-2.45 1.16-4.07 1.16-3.13 0-5.78-2.11-6.73-4.96h-3.98v3.09C3.515 21.3 7.565 24 12.255 24z\"\n      />\n      <path\n        fill=\"#FBBC05\"\n        d=\"M5.525 14.29c-.25-.72-.38-1.49-.38-2.29s.14-1.57.38-2.29V6.62h-3.98a11.86 11.86 0 000 10.76l3.98-3.09z\"\n      />\n      <path\n        fill=\"#EA4335\"\n        d=\"M12.255 4.75c1.77 0 3.35.61 4.6 1.8l3.42-3.42C18.205 1.19 15.495 0 12.255 0c-4.69 0-8.74 2.7-10.71 6.62l3.98 3.09c.95-2.85 3.6-4.96 6.73-4.96z\"\n      />\n    </svg>\n  );\n}\n\nfunction MicrosoftIcon(): JSX.Element {\n  return (\n    <svg class={styles.oauthIcon} viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\n      <path fill=\"#F25022\" d=\"M0 0v11.408h11.408V0z\" />\n      <path fill=\"#00A4EF\" d=\"M12.594 0v11.408H24V0z\" />\n      <path fill=\"#7FBA00\" d=\"M0 12.594V24h11.408V12.594z\" />\n      <path fill=\"#FFB900\" d=\"M12.594 12.594V24H24V12.594z\" />\n    </svg>\n  );\n}\n\nfunction GitHubIcon(): JSX.Element {\n  return (\n    <svg class={styles.oauthIcon} viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\n      <path\n        fill=\"currentColor\"\n        d=\"M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12\"\n      />\n    </svg>\n  );\n}\n\n// Map providers to their icon components\nconst providerIcons: Record<OAuthProvider, () => JSX.Element> = {\n  [OAuthProviderGoogle]: GoogleIcon,\n  [OAuthProviderMicrosoft]: MicrosoftIcon,\n  [OAuthProviderGitHub]: GitHubIcon,\n};\n\n// Provider-specific configuration for OAuth buttons\nconst providerConfig: Record<OAuthProvider, { style: string; labelKey: string }> = {\n  [OAuthProviderGoogle]: { style: styles.googleButton ?? '', labelKey: 'auth.loginWithGoogle' },\n  [OAuthProviderMicrosoft]: { style: styles.microsoftButton ?? '', labelKey: 'auth.loginWithMicrosoft' },\n  [OAuthProviderGitHub]: { style: styles.githubButton ?? '', labelKey: 'auth.loginWithGitHub' },\n};\n\nfunction getProviderConfig(provider: OAuthProvider): { style: string; label: string } {\n  const config = providerConfig[provider];\n  if (config) {\n    return { style: config.style, label: config.labelKey };\n  }\n  // Fallback for unknown providers: use generic style and capitalize provider name\n  return { style: styles.oauthButton ?? '', label: provider.charAt(0).toUpperCase() + provider.slice(1) };\n}\n\n// Create an unauthenticated API client for login/register\nconst api = createAPIClient((url, init) => fetch(url, init));\n\nexport default function Auth(props: AuthProps) {\n  const { t } = useI18n();\n  const [providers] = createResource(() => api.auth.listProviders().then((r) => r.providers));\n  const sortedProviders = createMemo(() => {\n    const list = providers() ?? [];\n    const order = [OAuthProviderGoogle, OAuthProviderGitHub, OAuthProviderMicrosoft];\n    return [...list].sort((a, b) => {\n      let ia = order.indexOf(a);\n      let ib = order.indexOf(b);\n      if (ia === -1) ia = order.length;\n      if (ib === -1) ib = order.length;\n      return ia - ib;\n    });\n  });\n  const [isRegister, setIsRegister] = createSignal(false);\n  const [email, setEmail] = createSignal('');\n  const [password, setPassword] = createSignal('');\n  const [name, setName] = createSignal('');\n  const [error, setError] = createSignal<string | null>(null);\n  const [loading, setLoading] = createSignal(false);\n\n  const handleSubmit = async (e: Event) => {\n    e.preventDefault();\n    setError(null);\n    setLoading(true);\n\n    try {\n      const data = isRegister()\n        ? await api.auth.register({ email: email(), password: password(), name: name() })\n        : await api.auth.login({ email: email(), password: password() });\n\n      if (data.token && data.user) {\n        props.onLogin(data.token, data.user);\n      } else {\n        setError('Invalid response from server');\n      }\n    } catch (err) {\n      if (err instanceof APIError) {\n        setError(err.response.error?.message || 'Authentication failed');\n      } else {\n        setError('An error occurred. Please try again.');\n      }\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div class={styles.authContainer}>\n      <form class={styles.authForm} onSubmit={handleSubmit}>\n        <h2>{isRegister() ? t('auth.createAccount') : t('auth.loginTitle')}</h2>\n\n        {error() && <div class={styles.error}>{error()}</div>}\n\n        <Show when={sortedProviders().length > 0}>\n          <div class={styles.oauthButtons}>\n            <For each={sortedProviders()}>\n              {(provider) => {\n                const config = getProviderConfig(provider);\n                const isKnown = provider in providerConfig;\n                const Icon = providerIcons[provider];\n                return (\n                  <a href={`/api/v1/auth/oauth/${provider}`} class={config.style} target=\"_self\">\n                    {Icon && <Icon />}\n                    {isKnown ? t(config.label) : config.label}\n                  </a>\n                );\n              }}\n            </For>\n          </div>\n          <div class={styles.divider}>\n            <span>{t('auth.or')}</span>\n          </div>\n        </Show>\n\n        <Show when={isRegister()}>\n          <div class={styles.formGroup}>\n            <label for=\"name\">{t('auth.name')}</label>\n            <input\n              id=\"name\"\n              name=\"name\"\n              type=\"text\"\n              value={name()}\n              onInput={(e) => setName(e.target.value)}\n              required\n              autocomplete=\"name\"\n            />\n          </div>\n        </Show>\n\n        <div class={styles.formGroup}>\n          <label for=\"email\">{t('auth.email')}</label>\n          <input\n            id=\"email\"\n            name=\"email\"\n            type=\"email\"\n            value={email()}\n            onInput={(e) => setEmail(e.target.value)}\n            required\n            autocomplete=\"email\"\n          />\n        </div>\n\n        <div class={styles.formGroup}>\n          <label for=\"password\">{t('auth.password')}</label>\n          <input\n            id=\"password\"\n            name=\"password\"\n            type=\"password\"\n            value={password()}\n            onInput={(e) => setPassword(e.target.value)}\n            required\n            autocomplete={isRegister() ? 'new-password' : 'current-password'}\n          />\n        </div>\n\n        <button type=\"submit\" disabled={loading()}>\n          {loading() ? t('auth.pleaseWait') : isRegister() ? t('auth.register') : t('auth.login')}\n        </button>\n\n        <p class={styles.toggle}>\n          {isRegister() ? t('auth.alreadyHaveAccount') : t('auth.dontHaveAccount')}{' '}\n          <button type=\"button\" onClick={() => setIsRegister(!isRegister())}>\n            {isRegister() ? t('auth.login') : t('auth.register')}\n          </button>\n        </p>\n\n        <div class={styles.authFooter}>\n          <A href=\"/privacy\">{t('app.privacyPolicy')}</A>\n        </div>\n      </form>\n    </div>\n  );\n}\n"],"names":["providerIcons","OAuthProviderGoogle","_el$","_tmpl$","_$effect","_$setAttribute","styles","OAuthProviderMicrosoft","_el$2","_tmpl$2","OAuthProviderGitHub","_el$3","_tmpl$3","providerConfig","style","labelKey","api","createAPIClient","url","init","fetch","Auth","props","t","useI18n","providers","createResource","auth","listProviders","then","r","sortedProviders","createMemo","list","order","sort","a","b","ia","indexOf","ib","length","isRegister","setIsRegister","createSignal","email","setEmail","password","setPassword","name","setName","error","setError","loading","setLoading","handleSubmit","async","e","preventDefault","data","register","login","token","user","onLogin","err","APIError","response","message","_el$4","_tmpl$7","_el$5","firstChild","_el$6","_el$11","nextSibling","_el$12","_el$13","_el$14","_el$15","_el$16","_el$17","_el$18","_el$19","_el$20","_el$21","addEventListener","_$insert","_c$","_$memo","_c$2","_el$22","_tmpl$4","_$className","_$createComponent","Show","when","children","_el$7","For","each","provider","config","label","charAt","toUpperCase","slice","getProviderConfig","isKnown","Icon","_el$23","_tmpl$8","_el$8","_tmpl$5","_el$9","_el$0","_tmpl$6","_el$1","_el$10","$$input","target","value","_c$3","_c$4","$$click","_c$5","A","href","_p$","_v$","_v$2","_v$3","_v$4","_v$5","_v$6","_v$7","_v$8","o","i","n","disabled","s","h","undefined","_$delegateEvents"],"mappings":"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"}