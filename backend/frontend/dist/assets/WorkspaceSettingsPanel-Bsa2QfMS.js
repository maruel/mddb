import{j as t,G as e,c as i,h as n,v as r,d as s,w as a,x as l,S as o,z as u,C as d,F as c,y as g,s as v}from"./vendor-B2Zg8RtX.js";import{u as p,d as b,W as h}from"./index-BazlIzq9.js";import{M as m,I as _}from"./InviteForm-BWc5rOox.js";import"./editor-vendor-HH1666TS.js";const f="_panel_nru80_3",y="_tabs_nru80_7",S="_activeTab_nru80_29",x="_section_nru80_34",$="_error_nru80_43",w="_success_nru80_51",C="_settingsForm_nru80_59",k="_formItem_nru80_66",R="_formGrid_nru80_87",I="_saveButton_nru80_108",A="_hint_nru80_127",T="_table_nru80_133",G="_actions_nru80_151",P="_smallButton_nru80_156",H="_deleteButtonSmall_nru80_170",W="_addRemoteSection_nru80_184",q="_orgLink_nru80_196",L="_linkButton_nru80_210",z="_conflictAlert_nru80_224",B="_conflictFiles_nru80_233",E="_syncBadge_nru80_240",F="_autoPushRow_nru80_268",U="_checkboxLabel_nru80_276",O="_setupTabs_nru80_288",j="_setupTab_nru80_288",D="_activeSetupTab_nru80_295",M="_inputRow_nru80_311";var N=g("<button>"),Q=g("<div>"),V=g("<section><h3>"),J=g("<form><div><label></label><input type=text required></div><h4></h4><div><div><label></label><input type=number min=0></div><div><label></label><input type=number min=0></div><div><label></label><input type=number min=0></div><div><label></label><input type=number min=0></div><div><label></label><input type=number min=0></div><div><label></label><input type=number min=0></div></div><button type=submit>"),K=g("<section><h3></h3><div><p></p><button> â†’"),X=g("<pre>"),Y=g("<div><button></button><button>"),Z=g("<div><label></label><select required><option value>--"),tt=g("<div><label></label><input type=text placeholder=main>"),et=g("<button type=submit>"),it=g("<div><h4></h4><form><div><label>Installation ID</label><div><input type=number placeholder=12345678 required><button type=button>"),nt=g("<div><h4></h4><form><div><label></label><input type=url required></div><div><label></label><input type=password><p></p></div><button type=submit>"),rt=g("<section><h3></h3><p>"),st=g("<div><div><button></button><button>"),at=g("<p>"),lt=g("<th>"),ot=g("<td>"),ut=g("<table><thead><tr><th></th><th></th><th></th><th></th></tr></thead><tbody><tr><td></td><td><span></span></td><td></td><td><button></button><button></button><button>"),dt=g("<div><label><input type=checkbox></label><p>"),ct=g("<option>");function gt(g){const{t:v}=p(),gt=t(),vt=e(),{user:pt,orgApi:bt,wsApi:ht,api:mt}=b(),[_t,ft]=i("settings"===g.section?"settings":"sync"===g.section?"sync":"members"),[yt,St]=i([]),[xt,$t]=i([]),[wt,Ct]=i(null),[kt,Rt]=i(""),[It,At]=i(""),[Tt,Gt]=i(!1),[Pt,Ht]=i([]),[Wt,qt]=i(""),[Lt,zt]=i(""),[Bt,Et]=i("main"),[Ft,Ut]=i(!1),[Ot,jt]=i("github"),[Dt,Mt]=i(""),[Nt,Qt]=i(""),[Vt,Jt]=i(""),[Kt,Xt]=i(""),[Yt,Zt]=i(!1),[te,ee]=i(0),[ie,ne]=i(0),[re,se]=i(0),[ae,le]=i(0),[oe,ue]=i(0),[de,ce]=i(0),[ge,ve]=i(!1),[pe,be]=i(null),[he,me]=i(null),_e=()=>pt()?.workspace_role===h,fe=t=>{ft(t);const e="members"===t?"":`#${t}`;gt(vt.pathname+e,{replace:!0})},ye=async()=>{const t=bt();if(t)try{ve(!0),be(null);const e=ht();if("members"===_t()&&_e()){const[i,n]=await Promise.all([t.users.listUsers(),e?e.invitations.listWSInvitations():Promise.resolve({invitations:[]})]);St(i.users?.filter(t=>!!t)||[]),$t(n.invitations?.filter(t=>!!t)||[])}if("settings"===_t()&&e){const t=await e.workspaces.getWorkspace();Jt(t.name),Xt(t.name),Zt(t.settings.git_auto_push),ee(t.quotas.max_pages),ne(t.quotas.max_storage_bytes),se(t.quotas.max_records_per_table),le(t.quotas.max_asset_size_bytes),ue(t.quotas.max_tables_per_workspace),ce(t.quotas.max_columns_per_table)}if("sync"===_t()&&_e()&&e){try{const t=await mt().githubApp.isGitHubAppAvailable();Gt(t.available),t.available||jt("manual")}catch{Gt(!1),jt("manual")}try{const t=await e.settings.git.getGitRemote();Ct(t)}catch{Ct(null)}try{const t=await e.settings.git.getSyncStatus();Mt(t.sync_status||""),Qt(t.last_sync_error||"")}catch{}}}catch(e){be(`${v("errors.failedToLoad")}: ${e}`)}finally{ve(!1)}};n(()=>{ye()}),n(()=>{const t=g.section;"settings"===t?ft("settings"):"sync"===t?ft("sync"):"members"!==t&&t||ft("members")});const Se=async(t,e)=>{const i=ht();if(i)try{ve(!0),await i.invitations.createWSInvitation({email:t,role:e}),me(v("success.invitationSent")||"Invitation sent successfully"),ye()}catch(n){be(`${v("errors.failedToInvite")}: ${n}`)}finally{ve(!1)}},xe=async(t,e)=>{const i=ht();if(i)try{ve(!0),await i.users.updateWSMemberRole({user_id:t,role:e}),me(v("success.roleUpdated")||"Role updated"),ye()}catch(n){be(`${v("errors.failedToUpdateRole")}: ${n}`)}finally{ve(!1)}},$e=async t=>{t.preventDefault();const e=ht();if(e)try{ve(!0),be(null),me(null),Vt()!==Kt()&&Vt().trim()&&(await e.workspaces.updateWorkspace({name:Vt().trim()}),Xt(Vt().trim())),await e.workspaces.updateWorkspace({quotas:{max_pages:te(),max_storage_bytes:ie(),max_records_per_table:re(),max_asset_size_bytes:ae(),max_tables_per_workspace:oe(),max_columns_per_table:de()}}),me(v("success.workspaceSettingsSaved")||"Workspace settings saved successfully")}catch(i){be(`${v("errors.failedToSave")}: ${i}`)}finally{ve(!1)}},we=async t=>{t.preventDefault();const e=ht();if(e)try{ve(!0),be(null);const t=await e.settings.git.updateGitRemote({url:kt(),token:It(),type:"custom",auth_type:It()?"token":"none"});Ct(t),me(v("success.remoteAdded")||"Git remote configured"),Rt(""),At("")}catch(i){be(`${v("errors.failedToAddRemote")}: ${i}`)}finally{ve(!1)}},Ce=async()=>{const t=ht();if(t)try{ve(!0),be(null),me(null),await t.settings.git.pushGit(),me(v("success.pushSuccessful")||"Push successful"),ye()}catch(e){be(`${v("errors.pushFailed")}: ${e}`)}finally{ve(!1)}},ke=async()=>{const t=ht();if(t)try{ve(!0),be(null),me(null),await t.settings.git.pullGit(),me(v("success.pullSuccessful")||"Pull successful"),ye()}catch(e){be(`${v("errors.pullFailed")}: ${e}`)}finally{ve(!1)}},Re=async()=>{if(!confirm(v("settings.confirmRemoveRemote")||"Are you sure you want to remove this remote?"))return;const t=ht();if(t)try{ve(!0),be(null),await t.settings.git.deleteGitRemote(),Ct(null),me(v("success.remoteRemoved")||"Remote removed")}catch(e){be(`${v("errors.failedToRemoveRemote")}: ${e}`)}finally{ve(!1)}},Ie=async()=>{const t=parseInt(Wt(),10);if(t)try{Ut(!0),be(null);const e=await mt().githubApp.listGitHubAppRepos({installation_id:t});Ht(e.repos||[])}catch(e){be(`${v("errors.failedToLoad")}: ${e}`)}finally{Ut(!1)}},Ae=async t=>{t.preventDefault();const e=ht();if(!e)return;const i=Pt().find(t=>t.full_name===Lt());if(i)try{ve(!0),be(null);const t=await e.settings.git.setupGitHubAppRemote({installation_id:parseInt(Wt(),10),repo_owner:i.owner,repo_name:i.name,branch:Bt()||"main"});Ct(t),me(v("success.gitHubAppConfigured")||"GitHub App remote configured"),Ht([]),qt(""),zt("")}catch(n){be(`${v("errors.failedToAddRemote")}: ${n}`)}finally{ve(!1)}},Te=async()=>{const t=ht();if(!t)return;const e=!Yt();try{ve(!0),be(null),await t.workspaces.updateWorkspace({}),Zt(e)}catch(i){be(`${v("errors.failedToSave")}: ${i}`)}finally{ve(!1)}},Ge=()=>{switch(Dt()){case"syncing":return v("settings.syncStatusSyncing");case"error":return v("settings.syncStatusError");case"conflict":return v("settings.syncStatusConflict");default:return v("settings.syncStatusIdle")}},Pe=[{value:"admin",label:v("settings.roleAdmin")},{value:"editor",label:v("settings.roleEditor")},{value:"viewer",label:v("settings.roleViewer")}];return He=st(),We=He.firstChild,qe=We.firstChild,Le=qe.nextSibling,qe.$$click=()=>fe("members"),r(qe,()=>v("settings.members")),Le.$$click=()=>fe("settings"),r(Le,()=>v("settings.workspace")),r(We,s(o,{get when(){return _e()},get children(){var t=N();return t.$$click=()=>fe("sync"),r(t,()=>v("settings.gitSync")),a(()=>l(t,"sync"===_t()?S:"")),t}}),null),r(He,s(o,{get when(){return pe()},get children(){var t=Q();return r(t,pe),a(()=>l(t,$)),t}}),null),r(He,s(o,{get when(){return he()},get children(){var t=Q();return r(t,he),a(()=>l(t,w)),t}}),null),r(He,s(o,{get when(){return"members"===_t()},get children(){var t=V(),e=t.firstChild;return r(e,()=>v("settings.members")),r(t,s(o,{get when(){return _e()},get fallback(){return t=at(),r(t,()=>v("settings.adminOnlyMembers")),t;var t},get children(){return[s(m,{get members(){return yt()},get currentUserId(){return pt()?.id||""},roleOptions:Pe,roleField:"workspace_role",onUpdateRole:xe,get loading(){return ge()}}),s(_,{roleOptions:Pe,defaultRole:"viewer",get pendingInvitations(){return xt().map(t=>({email:t.email,role:t.role,created:t.created}))},onInvite:Se,get loading(){return ge()}})]}}),null),a(()=>l(t,x)),t}}),null),r(He,s(o,{get when(){return"settings"===_t()},get children(){var t=K(),e=t.firstChild,i=e.nextSibling,n=i.firstChild,u=n.nextSibling,d=u.firstChild;return r(e,()=>v("settings.workspaceSettings")),r(t,s(o,{get when(){return _e()},get fallback(){return t=at(),r(t,()=>v("settings.adminOnlyWorkspace")),t;var t},get children(){var t=J(),e=t.firstChild,i=e.firstChild,n=i.nextSibling,s=e.nextSibling,o=s.nextSibling,u=o.firstChild,d=u.firstChild,c=d.nextSibling,g=u.nextSibling,p=g.firstChild,b=p.nextSibling,h=g.nextSibling,m=h.firstChild,_=m.nextSibling,f=h.nextSibling,y=f.firstChild,S=y.nextSibling,x=f.nextSibling,$=x.firstChild,w=$.nextSibling,A=x.nextSibling,T=A.firstChild,G=T.nextSibling,P=o.nextSibling;return t.addEventListener("submit",$e),r(i,()=>v("settings.workspaceName")),n.$$input=t=>Jt(t.target.value),r(s,()=>v("settings.workspaceQuotas")),r(d,()=>v("settings.maxPages")),c.$$input=t=>ee(parseInt(t.target.value)||0),r(p,()=>v("settings.maxStorageBytes")),b.$$input=t=>ne(parseInt(t.target.value)||0),r(m,()=>v("settings.maxRecordsPerTable")),_.$$input=t=>se(parseInt(t.target.value)||0),r(y,()=>v("settings.maxAssetSizeBytes")),S.$$input=t=>le(parseInt(t.target.value)||0),r($,()=>v("settings.maxTablesPerWorkspace")),w.$$input=t=>ue(parseInt(t.target.value)||0),r(T,()=>v("settings.maxColumnsPerTable")),G.$$input=t=>ce(parseInt(t.target.value)||0),r(P,()=>v("settings.saveWorkspaceSettings")),a(i=>{var n=C,r=k,s=R,a=k,d=k,c=k,v=k,p=k,b=k,m=I,_=ge();return n!==i.e&&l(t,i.e=n),r!==i.t&&l(e,i.t=r),s!==i.a&&l(o,i.a=s),a!==i.o&&l(u,i.o=a),d!==i.i&&l(g,i.i=d),c!==i.n&&l(h,i.n=c),v!==i.s&&l(f,i.s=v),p!==i.h&&l(x,i.h=p),b!==i.r&&l(A,i.r=b),m!==i.d&&l(P,i.d=m),_!==i.l&&(P.disabled=i.l=_),i},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0}),a(()=>n.value=Vt()),a(()=>c.value=te()),a(()=>b.value=ie()),a(()=>_.value=re()),a(()=>S.value=ae()),a(()=>w.value=oe()),a(()=>G.value=de()),t}}),i),r(n,()=>v("settings.orgSettingsHint")),u.$$click=()=>{const t=pt(),e=t?.organization_id,i=t?.organizations?.find(t=>t.organization_id===e),n=i?.organization_name||"";e&&g.onNavigateToOrgSettings(e,n)},r(u,()=>v("settings.openOrgSettings"),d),a(e=>{var n=x,r=q,s=L;return n!==e.e&&l(t,e.e=n),r!==e.t&&l(i,e.t=r),s!==e.a&&l(u,e.a=s),e},{e:void 0,t:void 0,a:void 0}),t}}),null),r(He,s(o,{get when(){return"sync"===_t()},get children(){var t=rt(),e=t.firstChild,i=e.nextSibling;return r(e,()=>v("settings.gitSynchronization")),r(i,()=>v("settings.gitSyncHint")),r(t,s(o,{get when(){return"conflict"===Dt()},get children(){var t=Q();return r(t,()=>v("settings.conflictMessage"),null),r(t,s(o,{get when(){return Nt()},get children(){var t=X();return r(t,Nt),a(()=>l(t,B)),t}}),null),a(()=>l(t,z)),t}}),null),r(t,s(o,{get when(){return u(()=>"error"===Dt())()&&Nt()},get children(){var t=Q();return r(t,Nt),a(()=>l(t,$)),t}}),null),r(t,s(o,{get when(){return wt()},children:t=>{const e=t().last_sync;return[(g=ut(),p=g.firstChild,b=p.firstChild,h=b.firstChild,m=h.nextSibling,_=m.nextSibling,f=_.nextSibling,y=p.nextSibling.firstChild,S=y.firstChild,x=S.nextSibling,$=x.firstChild,w=x.nextSibling,C=w.nextSibling,k=C.firstChild,R=k.nextSibling,I=R.nextSibling,r(h,()=>v("settings.urlColumn")),r(b,s(o,{get when(){return t().branch},get children(){var t=lt();return r(t,()=>v("settings.branchColumn")),t}}),m),r(m,()=>v("settings.statusColumn")),r(_,()=>v("settings.lastSyncColumn")),r(f,()=>v("common.actions")),r(S,()=>t().url),r(y,s(o,{get when(){return t().branch},get children(){var e=ot();return r(e,()=>t().branch),e}}),x),r($,Ge),r(w,()=>e?new Date(e).toLocaleString():v("settings.never")),k.$$click=Ce,r(k,()=>v("common.push")),R.$$click=ke,r(R,()=>v("settings.pull")),I.$$click=Re,r(I,()=>v("common.remove")),a(t=>{var e=T,i=E,n=Dt()||"idle",r=G,s=ge(),a=P,o=ge(),u=P,c=ge(),v=H;return e!==t.e&&l(g,t.e=e),i!==t.t&&l($,t.t=i),n!==t.a&&d($,"data-status",t.a=n),r!==t.o&&l(C,t.o=r),s!==t.i&&(k.disabled=t.i=s),a!==t.n&&l(k,t.n=a),o!==t.s&&(R.disabled=t.s=o),u!==t.h&&l(R,t.h=u),c!==t.r&&(I.disabled=t.r=c),v!==t.d&&l(I,t.d=v),t},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0}),g),(i=dt(),n=i.firstChild,u=n.firstChild,c=n.nextSibling,u.addEventListener("change",Te),r(n,()=>v("settings.autoPush"),null),r(c,()=>v("settings.autoPushHint")),a(t=>{var e=F,r=U,s=A;return e!==t.e&&l(i,t.e=e),r!==t.t&&l(n,t.t=r),s!==t.a&&l(c,t.a=s),t},{e:void 0,t:void 0,a:void 0}),a(()=>u.checked=Yt()),i)];var i,n,u,c,g,p,b,h,m,_,f,y,S,x,$,w,C,k,R,I}}),null),r(t,s(o,{get when(){return!wt()},get children(){return[s(o,{get when(){return Tt()},get children(){var t=Y(),e=t.firstChild,i=e.nextSibling;return e.$$click=()=>jt("github"),r(e,()=>v("settings.gitHubAppSetup")),i.$$click=()=>jt("manual"),r(i,()=>v("settings.manualSetup")),a(n=>{var r=O,s="github"===Ot()?D:j,a="manual"===Ot()?D:j;return r!==n.e&&l(t,n.e=r),s!==n.t&&l(e,n.t=s),a!==n.a&&l(i,n.a=a),n},{e:void 0,t:void 0,a:void 0}),t}}),s(o,{get when(){return u(()=>"github"===Ot())()&&Tt()},get children(){var t,e=it(),i=e.firstChild,n=i.nextSibling,d=n.firstChild,g=d.firstChild.nextSibling,p=g.firstChild,b=p.nextSibling;return r(i,()=>v("settings.gitHubAppSetup")),n.addEventListener("submit",Ae),p.$$input=t=>qt(t.target.value),b.$$click=Ie,r(b,(t=u(()=>!!Ft()),()=>t()?v("common.loading"):v("settings.selectRepository"))),r(n,s(o,{get when(){return Pt().length>0},get children(){return[(o=Z(),u=o.firstChild,d=u.nextSibling,d.firstChild,r(u,()=>v("settings.selectRepository")),d.addEventListener("change",t=>zt(t.target.value)),r(d,s(c,{get each(){return Pt()},children:t=>{return e=ct(),r(e,()=>t.full_name,null),r(e,()=>t.private?" (private)":"",null),a(()=>e.value=t.full_name),e;var e}}),null),a(()=>l(o,k)),a(()=>d.value=Lt()),o),(e=tt(),i=e.firstChild,n=i.nextSibling,r(i,()=>v("settings.branchColumn")),n.$$input=t=>Et(t.target.value),a(()=>l(e,k)),a(()=>n.value=Bt()),e),(t=et(),r(t,()=>v("settings.connectGitHub")),a(e=>{var i=I,n=ge()||!Lt();return i!==e.e&&l(t,e.e=i),n!==e.t&&(t.disabled=e.t=n),e},{e:void 0,t:void 0}),t)];var t,e,i,n,o,u,d}}),null),a(t=>{var i=W,r=C,s=k,a=M,o=P,u=Ft()||!Wt();return i!==t.e&&l(e,t.e=i),r!==t.t&&l(n,t.t=r),s!==t.a&&l(d,t.a=s),a!==t.o&&l(g,t.o=a),o!==t.i&&l(b,t.i=o),u!==t.n&&(b.disabled=t.n=u),t},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0}),a(()=>p.value=Wt()),e}}),s(o,{get when(){return"manual"===Ot()||!Tt()},get children(){var t=nt(),e=t.firstChild,i=e.nextSibling,n=i.firstChild,s=n.firstChild,o=s.nextSibling,u=n.nextSibling,c=u.firstChild,g=c.nextSibling,p=g.nextSibling,b=u.nextSibling;return r(e,()=>v("settings.addNewRemote")),i.addEventListener("submit",we),r(s,()=>v("settings.repositoryUrl")),o.$$input=t=>Rt(t.target.value),r(c,()=>v("settings.personalAccessToken")),g.$$input=t=>At(t.target.value),r(p,()=>v("settings.tokenHint")),r(b,()=>v("settings.addRemote")),a(e=>{var r=W,s=C,a=k,c=v("settings.repositoryUrlPlaceholder")||"https://github.com/user/repo.git",h=k,m=v("settings.tokenPlaceholder")||"ghp_...",_=A,f=I,y=ge();return r!==e.e&&l(t,e.e=r),s!==e.t&&l(i,e.t=s),a!==e.a&&l(n,e.a=a),c!==e.o&&d(o,"placeholder",e.o=c),h!==e.i&&l(u,e.i=h),m!==e.n&&d(g,"placeholder",e.n=m),_!==e.s&&l(p,e.s=_),f!==e.h&&l(b,e.h=f),y!==e.r&&(b.disabled=e.r=y),e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0}),a(()=>o.value=kt()),a(()=>g.value=It()),t}})]}}),null),a(e=>{var n=x,r=A;return n!==e.e&&l(t,e.e=n),r!==e.t&&l(i,e.t=r),e},{e:void 0,t:void 0}),t}}),null),a(t=>{var e=f,i=y,n="members"===_t()?S:"",r="settings"===_t()?S:"";return e!==t.e&&l(He,t.e=e),i!==t.t&&l(We,t.t=i),n!==t.a&&l(qe,t.a=n),r!==t.o&&l(Le,t.o=r),t},{e:void 0,t:void 0,a:void 0,o:void 0}),He;var He,We,qe,Le}v(["click","input"]);export{gt as default};
//# sourceMappingURL=WorkspaceSettingsPanel-Bsa2QfMS.js.map
