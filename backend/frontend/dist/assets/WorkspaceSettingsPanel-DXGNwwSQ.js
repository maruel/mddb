import{j as t,G as e,c as i,h as n,v as s,d as r,w as a,x as l,S as o,z as u,C as c,F as d,y as g,s as v}from"./vendor-BFNoaq9W.js";import{u as b,d as p,W as h}from"./index-BL3eS8m-.js";import{M as m,I as _}from"./InviteForm-TxYpSwWA.js";import"./editor-vendor-BEwVq1OK.js";const y="_panel_1yc88_3",f="_tabs_1yc88_7",S="_activeTab_1yc88_29",x="_section_1yc88_34",w="_error_1yc88_43",$="_success_1yc88_51",C="_settingsForm_1yc88_59",k="_formItem_1yc88_66",R="_formGrid_1yc88_87",A="_saveButton_1yc88_108",I="_hint_1yc88_127",T="_table_1yc88_133",G="_actions_1yc88_151",H="_smallButton_1yc88_156",P="_deleteButtonSmall_1yc88_170",W="_addRemoteSection_1yc88_184",q="_orgLink_1yc88_196",L="_linkButton_1yc88_210",z="_conflictAlert_1yc88_224",E="_conflictFiles_1yc88_233",B="_syncBadge_1yc88_240",F="_autoPushRow_1yc88_268",U="_checkboxLabel_1yc88_276",O="_setupTabs_1yc88_288",j="_setupTab_1yc88_288",M="_activeSetupTab_1yc88_295",D="_disabledSetupTab_1yc88_311",N="_notConfiguredMessage_1yc88_322";var Q=g("<button>"),V=g("<div>"),J=g("<section><h3>"),K=g("<form><div><label></label><input type=text required></div><h4></h4><div><div><label></label><input type=number min=0></div><div><label></label><input type=number min=0></div><div><label></label><input type=number min=0></div><div><label></label><input type=number min=0></div><div><label></label><input type=number min=0></div><div><label></label><input type=number min=0></div></div><button type=submit>"),X=g("<section><h3></h3><div><p></p><button> â†’"),Y=g("<pre>"),Z=g("<div><button></button><button>"),tt=g("<p>"),et=g("<div><label></label><select required><option value>--"),it=g("<div><label></label><input type=text placeholder=main>"),nt=g("<button type=submit>"),st=g("<div><h4></h4><form><div><label></label><select required><option value>--"),rt=g("<div><h4></h4><form><div><label></label><input type=url required></div><div><label></label><input type=password><p></p></div><button type=submit>"),at=g("<section><h3></h3><p>"),lt=g("<div><div><button></button><button>"),ot=g("<th>"),ut=g("<td>"),ct=g("<table><thead><tr><th></th><th></th><th></th><th></th></tr></thead><tbody><tr><td></td><td><span></span></td><td></td><td><button></button><button></button><button>"),dt=g("<div><label><input type=checkbox></label><p>"),gt=g("<option> (<!>)"),vt=g("<option>");function bt(g){const{t:v}=b(),bt=t(),pt=e(),{user:ht,orgApi:mt,wsApi:_t,api:yt}=p(),[ft,St]=i("settings"===g.section?"settings":"sync"===g.section?"sync":"members"),[xt,wt]=i([]),[$t,Ct]=i([]),[kt,Rt]=i(null),[At,It]=i(""),[Tt,Gt]=i(""),[Ht,Pt]=i(!1),[Wt,qt]=i([]),[Lt,zt]=i([]),[Et,Bt]=i(""),[Ft,Ut]=i(""),[Ot,jt]=i("main"),[Mt,Dt]=i(!1),[Nt,Qt]=i("github"),[Vt,Jt]=i(""),[Kt,Xt]=i(""),[Yt,Zt]=i(""),[te,ee]=i(""),[ie,ne]=i(!1),[se,re]=i(0),[ae,le]=i(0),[oe,ue]=i(0),[ce,de]=i(0),[ge,ve]=i(0),[be,pe]=i(0),[he,me]=i(!1),[_e,ye]=i(null),[fe,Se]=i(null),xe=()=>ht()?.workspace_role===h,we=t=>{St(t);const e="members"===t?"":`#${t}`;bt(pt.pathname+e,{replace:!0})},$e=async()=>{const t=mt();if(t)try{me(!0),ye(null);const e=_t();if("members"===ft()&&xe()){const[i,n]=await Promise.all([t.users.listUsers(),e?e.invitations.listWSInvitations():Promise.resolve({invitations:[]})]);wt(i.users?.filter(t=>!!t)||[]),Ct(n.invitations?.filter(t=>!!t)||[])}if("settings"===ft()&&e){const t=await e.workspaces.getWorkspace();Zt(t.name),ee(t.name),ne(t.settings.git_auto_push),re(t.quotas.max_pages),le(t.quotas.max_storage_bytes),ue(t.quotas.max_records_per_table),de(t.quotas.max_asset_size_bytes),ve(t.quotas.max_tables_per_workspace),pe(t.quotas.max_columns_per_table)}if("sync"===ft()&&xe()&&e){try{const t=await yt().githubApp.isGitHubAppAvailable();if(Pt(t.available),t.available)try{const t=await yt().githubApp.listGitHubAppInstallations();qt(t.installations||[])}catch{qt([])}else Qt("manual")}catch{Pt(!1),Qt("manual")}try{const t=await e.settings.git.getGitRemote();Rt(t)}catch{Rt(null)}try{const t=await e.settings.git.getSyncStatus();Jt(t.sync_status||""),Xt(t.last_sync_error||"")}catch{}}}catch(e){ye(`${v("errors.failedToLoad")}: ${e}`)}finally{me(!1)}};n(()=>{$e()}),n(()=>{const t=g.section;"settings"===t?St("settings"):"sync"===t?St("sync"):"members"!==t&&t||St("members")});const Ce=async(t,e)=>{const i=_t();if(i)try{me(!0),await i.invitations.createWSInvitation({email:t,role:e}),Se(v("success.invitationSent")||"Invitation sent successfully"),$e()}catch(n){ye(`${v("errors.failedToInvite")}: ${n}`)}finally{me(!1)}},ke=async(t,e)=>{const i=_t();if(i)try{me(!0),await i.users.updateWSMemberRole({user_id:t,role:e}),Se(v("success.roleUpdated")||"Role updated"),$e()}catch(n){ye(`${v("errors.failedToUpdateRole")}: ${n}`)}finally{me(!1)}},Re=async t=>{t.preventDefault();const e=_t();if(e)try{me(!0),ye(null),Se(null),Yt()!==te()&&Yt().trim()&&(await e.workspaces.updateWorkspace({name:Yt().trim()}),ee(Yt().trim())),await e.workspaces.updateWorkspace({quotas:{max_pages:se(),max_storage_bytes:ae(),max_records_per_table:oe(),max_asset_size_bytes:ce(),max_tables_per_workspace:ge(),max_columns_per_table:be()}}),Se(v("success.workspaceSettingsSaved")||"Workspace settings saved successfully")}catch(i){ye(`${v("errors.failedToSave")}: ${i}`)}finally{me(!1)}},Ae=async t=>{t.preventDefault();const e=_t();if(e)try{me(!0),ye(null);const t=await e.settings.git.updateGitRemote({url:At(),token:Tt(),type:"custom",auth_type:Tt()?"token":"none"});Rt(t),Se(v("success.remoteAdded")||"Git remote configured"),It(""),Gt("")}catch(i){ye(`${v("errors.failedToAddRemote")}: ${i}`)}finally{me(!1)}},Ie=async()=>{const t=_t();if(t)try{me(!0),ye(null),Se(null),await t.settings.git.pushGit(),Se(v("success.pushSuccessful")||"Push successful"),$e()}catch(e){ye(`${v("errors.pushFailed")}: ${e}`)}finally{me(!1)}},Te=async()=>{const t=_t();if(t)try{me(!0),ye(null),Se(null),await t.settings.git.pullGit(),Se(v("success.pullSuccessful")||"Pull successful"),$e()}catch(e){ye(`${v("errors.pullFailed")}: ${e}`)}finally{me(!1)}},Ge=async()=>{if(!confirm(v("settings.confirmRemoveRemote")||"Are you sure you want to remove this remote?"))return;const t=_t();if(t)try{me(!0),ye(null),await t.settings.git.deleteGitRemote(),Rt(null),Se(v("success.remoteRemoved")||"Remote removed")}catch(e){ye(`${v("errors.failedToRemoveRemote")}: ${e}`)}finally{me(!1)}},He=async t=>{t.preventDefault();const e=_t();if(!e)return;const i=Lt().find(t=>t.full_name===Ft());if(i)try{me(!0),ye(null);const t=await e.settings.git.setupGitHubAppRemote({installation_id:parseInt(Et(),10),repo_owner:i.owner,repo_name:i.name,branch:Ot()||"main"});Rt(t),Se(v("success.gitHubAppConfigured")||"GitHub App remote configured"),zt([]),Bt(""),Ut("")}catch(n){ye(`${v("errors.failedToAddRemote")}: ${n}`)}finally{me(!1)}},Pe=async()=>{const t=_t();if(!t)return;const e=!ie();try{me(!0),ye(null),await t.workspaces.updateWorkspace({}),ne(e)}catch(i){ye(`${v("errors.failedToSave")}: ${i}`)}finally{me(!1)}},We=()=>{switch(Vt()){case"syncing":return v("settings.syncStatusSyncing");case"error":return v("settings.syncStatusError");case"conflict":return v("settings.syncStatusConflict");default:return v("settings.syncStatusIdle")}},qe=[{value:"admin",label:v("settings.roleAdmin")},{value:"editor",label:v("settings.roleEditor")},{value:"viewer",label:v("settings.roleViewer")}];return Le=lt(),ze=Le.firstChild,Ee=ze.firstChild,Be=Ee.nextSibling,Ee.$$click=()=>we("members"),s(Ee,()=>v("settings.members")),Be.$$click=()=>we("settings"),s(Be,()=>v("settings.workspace")),s(ze,r(o,{get when(){return xe()},get children(){var t=Q();return t.$$click=()=>we("sync"),s(t,()=>v("settings.gitSync")),a(()=>l(t,"sync"===ft()?S:"")),t}}),null),s(Le,r(o,{get when(){return _e()},get children(){var t=V();return s(t,_e),a(()=>l(t,w)),t}}),null),s(Le,r(o,{get when(){return fe()},get children(){var t=V();return s(t,fe),a(()=>l(t,$)),t}}),null),s(Le,r(o,{get when(){return"members"===ft()},get children(){var t=J(),e=t.firstChild;return s(e,()=>v("settings.members")),s(t,r(o,{get when(){return xe()},get fallback(){return t=tt(),s(t,()=>v("settings.adminOnlyMembers")),t;var t},get children(){return[r(m,{get members(){return xt()},get currentUserId(){return ht()?.id||""},roleOptions:qe,roleField:"workspace_role",onUpdateRole:ke,get loading(){return he()}}),r(_,{roleOptions:qe,defaultRole:"viewer",get pendingInvitations(){return $t().map(t=>({email:t.email,role:t.role,created:t.created}))},onInvite:Ce,get loading(){return he()}})]}}),null),a(()=>l(t,x)),t}}),null),s(Le,r(o,{get when(){return"settings"===ft()},get children(){var t=X(),e=t.firstChild,i=e.nextSibling,n=i.firstChild,u=n.nextSibling,c=u.firstChild;return s(e,()=>v("settings.workspaceSettings")),s(t,r(o,{get when(){return xe()},get fallback(){return t=tt(),s(t,()=>v("settings.adminOnlyWorkspace")),t;var t},get children(){var t=K(),e=t.firstChild,i=e.firstChild,n=i.nextSibling,r=e.nextSibling,o=r.nextSibling,u=o.firstChild,c=u.firstChild,d=c.nextSibling,g=u.nextSibling,b=g.firstChild,p=b.nextSibling,h=g.nextSibling,m=h.firstChild,_=m.nextSibling,y=h.nextSibling,f=y.firstChild,S=f.nextSibling,x=y.nextSibling,w=x.firstChild,$=w.nextSibling,I=x.nextSibling,T=I.firstChild,G=T.nextSibling,H=o.nextSibling;return t.addEventListener("submit",Re),s(i,()=>v("settings.workspaceName")),n.$$input=t=>Zt(t.target.value),s(r,()=>v("settings.workspaceQuotas")),s(c,()=>v("settings.maxPages")),d.$$input=t=>re(parseInt(t.target.value)||0),s(b,()=>v("settings.maxStorageBytes")),p.$$input=t=>le(parseInt(t.target.value)||0),s(m,()=>v("settings.maxRecordsPerTable")),_.$$input=t=>ue(parseInt(t.target.value)||0),s(f,()=>v("settings.maxAssetSizeBytes")),S.$$input=t=>de(parseInt(t.target.value)||0),s(w,()=>v("settings.maxTablesPerWorkspace")),$.$$input=t=>ve(parseInt(t.target.value)||0),s(T,()=>v("settings.maxColumnsPerTable")),G.$$input=t=>pe(parseInt(t.target.value)||0),s(H,()=>v("settings.saveWorkspaceSettings")),a(i=>{var n=C,s=k,r=R,a=k,c=k,d=k,v=k,b=k,p=k,m=A,_=he();return n!==i.e&&l(t,i.e=n),s!==i.t&&l(e,i.t=s),r!==i.a&&l(o,i.a=r),a!==i.o&&l(u,i.o=a),c!==i.i&&l(g,i.i=c),d!==i.n&&l(h,i.n=d),v!==i.s&&l(y,i.s=v),b!==i.h&&l(x,i.h=b),p!==i.r&&l(I,i.r=p),m!==i.d&&l(H,i.d=m),_!==i.l&&(H.disabled=i.l=_),i},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0}),a(()=>n.value=Yt()),a(()=>d.value=se()),a(()=>p.value=ae()),a(()=>_.value=oe()),a(()=>S.value=ce()),a(()=>$.value=ge()),a(()=>G.value=be()),t}}),i),s(n,()=>v("settings.orgSettingsHint")),u.$$click=()=>{const t=ht(),e=t?.organization_id,i=t?.organizations?.find(t=>t.organization_id===e),n=i?.organization_name||"";e&&g.onNavigateToOrgSettings(e,n)},s(u,()=>v("settings.openOrgSettings"),c),a(e=>{var n=x,s=q,r=L;return n!==e.e&&l(t,e.e=n),s!==e.t&&l(i,e.t=s),r!==e.a&&l(u,e.a=r),e},{e:void 0,t:void 0,a:void 0}),t}}),null),s(Le,r(o,{get when(){return"sync"===ft()},get children(){var t=at(),e=t.firstChild,i=e.nextSibling;return s(e,()=>v("settings.gitSynchronization")),s(i,()=>v("settings.gitSyncHint")),s(t,r(o,{get when(){return"conflict"===Vt()},get children(){var t=V();return s(t,()=>v("settings.conflictMessage"),null),s(t,r(o,{get when(){return Kt()},get children(){var t=Y();return s(t,Kt),a(()=>l(t,E)),t}}),null),a(()=>l(t,z)),t}}),null),s(t,r(o,{get when(){return u(()=>"error"===Vt())()&&Kt()},get children(){var t=V();return s(t,Kt),a(()=>l(t,w)),t}}),null),s(t,r(o,{get when(){return kt()},children:t=>{const e=t().last_sync;return[(g=ct(),b=g.firstChild,p=b.firstChild,h=p.firstChild,m=h.nextSibling,_=m.nextSibling,y=_.nextSibling,f=b.nextSibling.firstChild,S=f.firstChild,x=S.nextSibling,w=x.firstChild,$=x.nextSibling,C=$.nextSibling,k=C.firstChild,R=k.nextSibling,A=R.nextSibling,s(h,()=>v("settings.urlColumn")),s(p,r(o,{get when(){return t().branch},get children(){var t=ot();return s(t,()=>v("settings.branchColumn")),t}}),m),s(m,()=>v("settings.statusColumn")),s(_,()=>v("settings.lastSyncColumn")),s(y,()=>v("common.actions")),s(S,()=>t().url),s(f,r(o,{get when(){return t().branch},get children(){var e=ut();return s(e,()=>t().branch),e}}),x),s(w,We),s($,()=>e?new Date(e).toLocaleString():v("settings.never")),k.$$click=Ie,s(k,()=>v("common.push")),R.$$click=Te,s(R,()=>v("settings.pull")),A.$$click=Ge,s(A,()=>v("common.remove")),a(t=>{var e=T,i=B,n=Vt()||"idle",s=G,r=he(),a=H,o=he(),u=H,d=he(),v=P;return e!==t.e&&l(g,t.e=e),i!==t.t&&l(w,t.t=i),n!==t.a&&c(w,"data-status",t.a=n),s!==t.o&&l(C,t.o=s),r!==t.i&&(k.disabled=t.i=r),a!==t.n&&l(k,t.n=a),o!==t.s&&(R.disabled=t.s=o),u!==t.h&&l(R,t.h=u),d!==t.r&&(A.disabled=t.r=d),v!==t.d&&l(A,t.d=v),t},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0}),g),(i=dt(),n=i.firstChild,u=n.firstChild,d=n.nextSibling,u.addEventListener("change",Pe),s(n,()=>v("settings.autoPush"),null),s(d,()=>v("settings.autoPushHint")),a(t=>{var e=F,s=U,r=I;return e!==t.e&&l(i,t.e=e),s!==t.t&&l(n,t.t=s),r!==t.a&&l(d,t.a=r),t},{e:void 0,t:void 0,a:void 0}),a(()=>u.checked=ie()),i)];var i,n,u,d,g,b,p,h,m,_,y,f,S,x,w,$,C,k,R,A}}),null),s(t,r(o,{get when(){return!kt()},get children(){return[(t=Z(),e=t.firstChild,i=e.nextSibling,e.$$click=()=>Ht()&&Qt("github"),s(e,()=>v("settings.gitHubAppSetup")),i.$$click=()=>Qt("manual"),s(i,()=>v("settings.manualSetup")),a(n=>{var s=O,r=Ht()?"github"===Nt()?M:j:D,a=!Ht(),o="manual"===Nt()?M:j;return s!==n.e&&l(t,n.e=s),r!==n.t&&l(e,n.t=r),a!==n.a&&(e.disabled=n.a=a),o!==n.o&&l(i,n.o=o),n},{e:void 0,t:void 0,a:void 0,o:void 0}),t),r(o,{get when(){return u(()=>"github"===Nt())()&&!Ht()},get children(){var t=V();return s(t,()=>v("settings.gitHubAppNotConfigured")),a(()=>l(t,N)),t}}),r(o,{get when(){return u(()=>"github"===Nt())()&&Ht()},get children(){var t=st(),e=t.firstChild,i=e.nextSibling,n=i.firstChild,u=n.firstChild,c=u.nextSibling;return c.firstChild,s(e,()=>v("settings.gitHubAppSetup")),i.addEventListener("submit",He),s(u,()=>v("settings.selectInstallation")),c.addEventListener("change",t=>{Bt(t.target.value),t.target.value&&(async t=>{const e=t??Et(),i=parseInt(e,10);if(i)try{Dt(!0),zt([]),Ut(""),ye(null);const t=await yt().githubApp.listGitHubAppRepos({installation_id:i});zt(t.repos||[])}catch(n){ye(`${v("errors.failedToLoad")}: ${n}`)}finally{Dt(!1)}})(t.target.value)}),s(c,r(d,{get each(){return Wt()},children:t=>{return e=gt(),i=e.firstChild,(n=i.nextSibling).nextSibling,s(e,()=>t.account,i),s(e,()=>t.id,n),a(()=>e.value=String(t.id)),e;var e,i,n}}),null),s(i,r(o,{get when(){return Mt()},get children(){var t=tt();return s(t,()=>v("common.loading")),a(()=>l(t,I)),t}}),null),s(i,r(o,{get when(){return Lt().length>0},get children(){return[(o=et(),u=o.firstChild,c=u.nextSibling,c.firstChild,s(u,()=>v("settings.selectRepository")),c.addEventListener("change",t=>Ut(t.target.value)),s(c,r(d,{get each(){return Lt()},children:t=>{return e=vt(),s(e,()=>t.full_name,null),s(e,()=>t.private?" (private)":"",null),a(()=>e.value=t.full_name),e;var e}}),null),a(()=>l(o,k)),a(()=>c.value=Ft()),o),(e=it(),i=e.firstChild,n=i.nextSibling,s(i,()=>v("settings.branchColumn")),n.$$input=t=>jt(t.target.value),a(()=>l(e,k)),a(()=>n.value=Ot()),e),(t=nt(),s(t,()=>v("settings.connectGitHub")),a(e=>{var i=A,n=he()||!Ft();return i!==e.e&&l(t,e.e=i),n!==e.t&&(t.disabled=e.t=n),e},{e:void 0,t:void 0}),t)];var t,e,i,n,o,u,c}}),null),a(e=>{var s=W,r=C,a=k;return s!==e.e&&l(t,e.e=s),r!==e.t&&l(i,e.t=r),a!==e.a&&l(n,e.a=a),e},{e:void 0,t:void 0,a:void 0}),a(()=>c.value=Et()),t}}),r(o,{get when(){return"manual"===Nt()},get children(){var t=rt(),e=t.firstChild,i=e.nextSibling,n=i.firstChild,r=n.firstChild,o=r.nextSibling,u=n.nextSibling,d=u.firstChild,g=d.nextSibling,b=g.nextSibling,p=u.nextSibling;return s(e,()=>v("settings.addNewRemote")),i.addEventListener("submit",Ae),s(r,()=>v("settings.repositoryUrl")),o.$$input=t=>It(t.target.value),s(d,()=>v("settings.personalAccessToken")),g.$$input=t=>Gt(t.target.value),s(b,()=>v("settings.tokenHint")),s(p,()=>v("settings.addRemote")),a(e=>{var s=W,r=C,a=k,d=v("settings.repositoryUrlPlaceholder")||"https://github.com/user/repo.git",h=k,m=v("settings.tokenPlaceholder")||"ghp_...",_=I,y=A,f=he();return s!==e.e&&l(t,e.e=s),r!==e.t&&l(i,e.t=r),a!==e.a&&l(n,e.a=a),d!==e.o&&c(o,"placeholder",e.o=d),h!==e.i&&l(u,e.i=h),m!==e.n&&c(g,"placeholder",e.n=m),_!==e.s&&l(b,e.s=_),y!==e.h&&l(p,e.h=y),f!==e.r&&(p.disabled=e.r=f),e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0}),a(()=>o.value=At()),a(()=>g.value=Tt()),t}})];var t,e,i}}),null),a(e=>{var n=x,s=I;return n!==e.e&&l(t,e.e=n),s!==e.t&&l(i,e.t=s),e},{e:void 0,t:void 0}),t}}),null),a(t=>{var e=y,i=f,n="members"===ft()?S:"",s="settings"===ft()?S:"";return e!==t.e&&l(Le,t.e=e),i!==t.t&&l(ze,t.t=i),n!==t.a&&l(Ee,t.a=n),s!==t.o&&l(Be,t.o=s),t},{e:void 0,t:void 0,a:void 0,o:void 0}),Le;var Le,ze,Ee,Be}v(["click","input"]);export{bt as default};
//# sourceMappingURL=WorkspaceSettingsPanel-DXGNwwSQ.js.map
