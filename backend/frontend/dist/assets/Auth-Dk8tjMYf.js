import{a as t,g as e,c as a,v as i,z as r,w as n,x as l,d as o,F as s,C as u,S as d,ad as c,y as h,s as p}from"./vendor-BFNoaq9W.js";import{u as v,O as g,a as _,b as m,A as b,c as f}from"./index-D5tXwI8s.js";import{G as w,M as x,a as y}from"./OAuthIcons-BnwC0yRh.js";import"./editor-vendor-BEwVq1OK.js";const C="_authContainer_dcxwu_1",S="_authForm_dcxwu_9",$="_formGroup_dcxwu_24",A="_error_dcxwu_62",B="_toggle_dcxwu_72",j="_authFooter_dcxwu_87",k="_divider_dcxwu_104",G="_oauthButtons_dcxwu_124",K="_oauthIcon_dcxwu_130",O="_googleButton_dcxwu_137",W="_microsoftButton_dcxwu_138",q="_githubButton_dcxwu_139",F="_oauthButton_dcxwu_124";var H=h("<div>"),I=h("<div><span>"),P=h("<div><label for=name></label><input id=name name=name type=text required autocomplete=name>"),L=h("<div><form><h2></h2><div><label for=email></label><input id=email name=email type=email required autocomplete=email></div><div><label for=password></label><input id=password name=password type=password required></div><button type=submit></button><p> <button type=button></button></p><div>"),M=h("<a target=_self>");const z={[g]:y,[m]:x,[_]:w},D={[g]:{style:O,labelKey:"auth.loginWithGoogle"},[m]:{style:W,labelKey:"auth.loginWithMicrosoft"},[_]:{style:q,labelKey:"auth.loginWithGitHub"}};const E=f((t,e)=>fetch(t,e));function T(h){const{t:p}=v(),[f]=t(()=>E.auth.listProviders().then(t=>t.providers)),w=e(()=>{const t=f()??[],e=[g,_,m];return[...t].sort((t,a)=>{let i=e.indexOf(t),r=e.indexOf(a);return-1===i&&(i=e.length),-1===r&&(r=e.length),i-r})}),[x,y]=a(!1),[O,W]=a(""),[q,T]=a(""),[U,J]=a(""),[N,Q]=a(null),[R,V]=a(!1),X=async t=>{t.preventDefault(),Q(null),V(!0);try{const t=x()?await E.auth.register({email:O(),password:q(),name:U()}):await E.auth.login({email:O(),password:q()});t.token&&t.user?h.onLogin(t.token,t.user):Q("Invalid response from server")}catch(e){Q(e instanceof b?e.response.error?.message||"Authentication failed":"An error occurred. Please try again.")}finally{V(!1)}};return it=L(),rt=it.firstChild,nt=rt.firstChild,lt=nt.nextSibling,ot=lt.firstChild,st=ot.nextSibling,ut=lt.nextSibling,dt=ut.firstChild,ct=dt.nextSibling,ht=ut.nextSibling,pt=ht.nextSibling,vt=pt.firstChild,gt=vt.nextSibling,_t=pt.nextSibling,rt.addEventListener("submit",X),i(nt,(Y=r(()=>!!x()),()=>Y()?p("auth.createAccount"):p("auth.loginTitle"))),i(rt,(Z=r(()=>!!N()),()=>{return Z()&&(t=H(),i(t,N),n(()=>l(t,A)),t);var t}),lt),i(rt,o(d,{get when(){return w().length>0},get children(){return[(a=H(),i(a,o(s,{get each(){return w()},children:t=>{const e=function(t){const e=D[t];return e?{style:e.style,label:e.labelKey}:{style:F,label:t.charAt(0).toUpperCase()+t.slice(1)}}(t),a=t in D,r=z[t];return s=M(),u(s,"href",`/api/v1/auth/oauth/${t}`),i(s,r&&o(r,{get class(){return K}}),null),i(s,()=>a?p(e.label):e.label,null),n(()=>l(s,e.style)),s;var s}})),n(()=>l(a,G)),a),(t=I(),e=t.firstChild,i(e,()=>p("auth.or")),n(()=>l(t,k)),t)];var t,e,a}}),lt),i(rt,o(d,{get when(){return x()},get children(){var t=P(),e=t.firstChild,a=e.nextSibling;return i(e,()=>p("auth.name")),a.$$input=t=>J(t.target.value),n(()=>l(t,$)),n(()=>a.value=U()),t}}),lt),i(ot,()=>p("auth.email")),st.$$input=t=>W(t.target.value),i(dt,()=>p("auth.password")),ct.$$input=t=>T(t.target.value),i(ht,(tt=r(()=>!!R()),()=>tt()?p("auth.pleaseWait"):r(()=>!!x())()?p("auth.register"):p("auth.login"))),i(pt,(et=r(()=>!!x()),()=>et()?p("auth.alreadyHaveAccount"):p("auth.dontHaveAccount")),vt),gt.$$click=()=>y(!x()),i(gt,(at=r(()=>!!x()),()=>at()?p("auth.login"):p("auth.register"))),i(_t,o(c,{href:"/privacy",get children(){return p("app.privacyPolicy")}})),n(t=>{var e=C,a=S,i=$,r=$,n=x()?"new-password":"current-password",o=R(),s=B,d=j;return e!==t.e&&l(it,t.e=e),a!==t.t&&l(rt,t.t=a),i!==t.a&&l(lt,t.a=i),r!==t.o&&l(ut,t.o=r),n!==t.i&&u(ct,"autocomplete",t.i=n),o!==t.n&&(ht.disabled=t.n=o),s!==t.s&&l(pt,t.s=s),d!==t.h&&l(_t,t.h=d),t},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),n(()=>st.value=O()),n(()=>ct.value=q()),it;var Y,Z,tt,et,at,it,rt,nt,lt,ot,st,ut,dt,ct,ht,pt,vt,gt,_t}p(["input","click"]);export{T as default};
//# sourceMappingURL=Auth-Dk8tjMYf.js.map
